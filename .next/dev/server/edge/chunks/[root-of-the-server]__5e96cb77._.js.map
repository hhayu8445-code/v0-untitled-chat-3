{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/Pictures/APPLICATION DECRYPT FULL NO FXAP/TOOLS WEBSITE/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n\nconst RATE_LIMIT_MAP = new Map<string, { count: number; resetAt: number }>()\n\nfunction rateLimit(ip: string, limit = 100, windowMs = 60000): boolean {\n  const now = Date.now()\n  const record = RATE_LIMIT_MAP.get(ip)\n\n  if (RATE_LIMIT_MAP.size > 10000) {\n    for (const [key, value] of RATE_LIMIT_MAP.entries()) {\n      if (now > value.resetAt) RATE_LIMIT_MAP.delete(key)\n    }\n  }\n\n  if (!record || now > record.resetAt) {\n    RATE_LIMIT_MAP.set(ip, { count: 1, resetAt: now + windowMs })\n    return true\n  }\n\n  if (record.count >= limit) return false\n\n  record.count++\n  return true\n}\n\nexport function middleware(request: NextRequest) {\n  const ip = request.headers.get('x-forwarded-for')?.split(',')[0] || request.ip || 'unknown'\n  \n  if (!rateLimit(ip)) {\n    return NextResponse.json({ error: 'Too many requests' }, { status: 429 })\n  }\n\n  const response = NextResponse.next()\n  \n  response.headers.set('X-Content-Type-Options', 'nosniff')\n  response.headers.set('X-Frame-Options', 'DENY')\n  response.headers.set('X-XSS-Protection', '1; mode=block')\n  response.headers.set('Referrer-Policy', 'strict-origin-when-cross-origin')\n  \n  return response\n}\n\nexport const config = {\n  matcher: ['/api/:path*', '/admin/:path*'],\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAGA,MAAM,iBAAiB,IAAI;AAE3B,SAAS,UAAU,EAAU,EAAE,QAAQ,GAAG,EAAE,WAAW,KAAK;IAC1D,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,SAAS,eAAe,GAAG,CAAC;IAElC,IAAI,eAAe,IAAI,GAAG,OAAO;QAC/B,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,eAAe,OAAO,GAAI;YACnD,IAAI,MAAM,MAAM,OAAO,EAAE,eAAe,MAAM,CAAC;QACjD;IACF;IAEA,IAAI,CAAC,UAAU,MAAM,OAAO,OAAO,EAAE;QACnC,eAAe,GAAG,CAAC,IAAI;YAAE,OAAO;YAAG,SAAS,MAAM;QAAS;QAC3D,OAAO;IACT;IAEA,IAAI,OAAO,KAAK,IAAI,OAAO,OAAO;IAElC,OAAO,KAAK;IACZ,OAAO;AACT;AAEO,SAAS,WAAW,OAAoB;IAC7C,MAAM,KAAK,QAAQ,OAAO,CAAC,GAAG,CAAC,oBAAoB,MAAM,IAAI,CAAC,EAAE,IAAI,QAAQ,EAAE,IAAI;IAElF,IAAI,CAAC,UAAU,KAAK;QAClB,OAAO,sQAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAoB,GAAG;YAAE,QAAQ;QAAI;IACzE;IAEA,MAAM,WAAW,sQAAY,CAAC,IAAI;IAElC,SAAS,OAAO,CAAC,GAAG,CAAC,0BAA0B;IAC/C,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;IACxC,SAAS,OAAO,CAAC,GAAG,CAAC,oBAAoB;IACzC,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;IAExC,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAe;KAAgB;AAC3C"}}]
}