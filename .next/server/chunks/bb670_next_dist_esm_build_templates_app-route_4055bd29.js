module.exports=[66629,e=>{"use strict";let t,r,n,i,s,a,o,l,u,c,h,f,p,d,g,m,b,y,v,S,x,_,w,k,O,E,C,F,I,T,R,N,M,A,j,D,P,$,z,L,U,B,q,J,H,W,K,V,G,Z,Q,Y,X,ee,et;var er,en,ei,es,ea,eo,el,eu,ec,eh,ef,ep,ed,eg,em,eb,ey,ev,eS,ex,e_,ew,ek=e.i(92333),eO=e.i(26750),eE=e.i(60762),eC=e.i(94586),eF=e.i(27541),eI=e.i(58594),eT=e.i(53319),eR=e.i(76127),eN=e.i(39423),eM=e.i(49313),eA=e.i(782),ej=e.i(59682),eD=e.i(91286),eP=e.i(5098),e$=e.i(70504),ez=e.i(53490),eL=e.i(93695);e.i(16536);var eU=e.i(27662),eB="7.7.4";let eq=e=>{console.warn(`⚠️ [uploadthing][deprecated] ${e}`)},eJ=function(e,t){if("function"==typeof e)return function(){return e(arguments)?t.apply(this,arguments):e=>t(e,...arguments)};switch(e){case 0:case 1:throw RangeError(`Invalid arity ${e}`);case 2:return function(e,r){return arguments.length>=2?t(e,r):function(r){return t(r,e)}};case 3:return function(e,r,n){return arguments.length>=3?t(e,r,n):function(n){return t(n,e,r)}};case 4:return function(e,r,n,i){return arguments.length>=4?t(e,r,n,i):function(i){return t(i,e,r,n)}};case 5:return function(e,r,n,i,s){return arguments.length>=5?t(e,r,n,i,s):function(s){return t(s,e,r,n,i)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(e){return t(e,...r)}}}},eH=e=>e,eW=e=>()=>e,eK=eW(void 0),eV="effect/GlobalValue",eG=(e,r)=>(t||(globalThis[eV]??=new Map,t=globalThis[eV]),t.has(e)||t.set(e,r()),t.get(e)),eZ=e=>"object"==typeof e&&null!==e,eQ=eJ(2,(e,t)=>(eZ(e)||"function"==typeof e)&&t in e),eY=((e,t)=>eQ(e,"_tag")&&e._tag===t,Symbol.for("effect/Gen/GenKind"));Symbol.iterator;class eX{self;called=!1;constructor(e){this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(e){return{value:e,done:!0}}throw(e){throw e}[Symbol.iterator](){return new eX(this.self)}}let e0=Symbol.for("effect/Utils/YieldWrap");class e1{#e;constructor(e){this.#e=e}[e0](){return this.#e}}let e2=eG("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),e3=((H=()=>Error().stack)()?.includes("effect_internal_function"),eG(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap)),e5=Symbol.for("effect/Hash"),e4=e=>{if(!0===e2.enabled)return 0;switch(typeof e){case"number":return te(e);case"bigint":return tt(e.toString(10));case"boolean":case"symbol":return tt(String(e));case"string":return tt(e);case"undefined":return tt("undefined");case"function":case"object":if(null===e)return tt("null");if(e instanceof Date)return e4(e.toISOString());if(e instanceof URL)return e4(e.href);else if(e9(e))return e[e5]();else return e6(e);default:throw Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},e6=e=>(e3.has(e)||e3.set(e,te(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),e3.get(e)),e8=e=>t=>53*t^e,e7=e=>0xbfffffff&e|e>>>1&0x40000000,e9=e=>eQ(e,e5),te=e=>{if(e!=e||e===1/0)return 0;let t=0|e;for(t!==e&&(t^=0xffffffff*e);e>0xffffffff;)t^=e/=0xffffffff;return e7(t)},tt=e=>{let t=5381,r=e.length;for(;r;)t=33*t^e.charCodeAt(--r);return e7(t)},tr=function(){if(1==arguments.length){let e=arguments[0];return function(t){return Object.defineProperty(e,e5,{value:()=>t,enumerable:!1}),t}}let e=arguments[0],t=arguments[1];return Object.defineProperty(e,e5,{value:()=>t,enumerable:!1}),t},tn=Symbol.for("effect/Equal");function ti(){return 1==arguments.length?e=>ts(e,arguments[0]):ts(arguments[0],arguments[1])}function ts(e,t){if(e===t)return!0;let r=typeof e;if(r!==typeof t)return!1;if("object"===r||"function"===r){if(null!==e&&null!==t){if(ta(e)&&ta(t))if(e4(e)===e4(t)&&e[tn](t))return!0;else return!!e2.enabled&&!!e2.tester&&e2.tester(e,t);else if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString();else if(e instanceof URL&&t instanceof URL)return e.href===t.href}if(e2.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((e,r)=>ts(e,t[r]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){let r=Object.keys(e),n=Object.keys(t);if(r.length===n.length){for(let n of r)if(!(n in t&&ts(e[n],t[n])))return!!e2.tester&&e2.tester(e,t);return!0}}return!!e2.tester&&e2.tester(e,t)}}return!!e2.enabled&&!!e2.tester&&e2.tester(e,t)}let ta=e=>eQ(e,tn),to=Symbol.for("nodejs.util.inspect.custom"),tl=e=>{try{let t;if(eQ(e,"toJSON")&&(t=e.toJSON,"function"==typeof t)&&0===e.toJSON.length)return e.toJSON();if(Array.isArray(e))return e.map(tl)}catch{return{}}return tf(e)},tu=Symbol.for("effect/Inspectable/Redactable"),tc=e=>"object"==typeof e&&null!==e&&tu in e,th=eG("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),tf=e=>tc(e)&&void 0!==th.fiberRefs?e[tu](th.fiberRefs):e,tp=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let e=0,n=t.length;e<n;e++)r=t[e](r);return r}}},td=Symbol.for("effect/Effect"),tg=Symbol.for("effect/Stream"),tm=Symbol.for("effect/Sink"),tb=Symbol.for("effect/Channel"),ty={_R:e=>e,_E:e=>e,_A:e=>e,_V:"3.17.7"},tv={[td]:ty,[tg]:ty,[tm]:{_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},[tb]:{_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},[tn](e){return this===e},[e5](){return tr(this,e6(this))},[Symbol.iterator](){return new eX(new e1(this))},pipe(){return tp(this,arguments)}},tS={[e5](){return tr(this,((e,t)=>{let r=12289;for(let n=0;n<t.length;n++)r^=function(e,t,r,n,i,s,a,o,l){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return n(r(t(e)));case 5:return i(n(r(t(e))));case 6:return s(i(n(r(t(e)))));case 7:return a(s(i(n(r(t(e))))));case 8:return o(a(s(i(n(r(t(e)))))));case 9:return l(o(a(s(i(n(r(t(e))))))));default:{let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return e}}}(tt(t[n]),e8(e4(e[t[n]])));return e7(r)})(this,Object.keys(this)))},[tn](e){let t=Object.keys(this),r=Object.keys(e);if(t.length!==r.length)return!1;for(let r of t)if(!(r in e&&ti(this[r],e[r])))return!1;return!0}},tx=Symbol.for("effect/Option"),t_={...tv,[tx]:{_A:e=>e},[to](){return this.toJSON()},toString(){return JSON.stringify(this.toJSON(),null,2)}},tw=Object.assign(Object.create(t_),{_tag:"Some",_op:"Some",[tn](e){return tE(e)&&tF(e)&&ti(this.value,e.value)},[e5](){return tr(this,e8(e4(this._tag))(e4(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:tl(this.value)}}}),tk=e4("None"),tO=Object.assign(Object.create(t_),{_tag:"None",_op:"None",[tn]:e=>tE(e)&&tC(e),[e5]:()=>tk,toJSON(){return{_id:"Option",_tag:this._tag}}}),tE=e=>eQ(e,tx),tC=e=>"None"===e._tag,tF=e=>"Some"===e._tag,tI=Object.create(tO),tT=e=>{let t=Object.create(tw);return t.value=e,t},tR=Symbol.for("effect/Either"),tN={...tv,[tR]:{_R:e=>e},[to](){return this.toJSON()},toString(){return JSON.stringify(this.toJSON(),null,2)}},tM=Object.assign(Object.create(tN),{_tag:"Right",_op:"Right",[tn](e){return tj(e)&&tP(e)&&ti(this.right,e.right)},[e5](){return e8(e4(this._tag))(e4(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:tl(this.right)}}}),tA=Object.assign(Object.create(tN),{_tag:"Left",_op:"Left",[tn](e){return tj(e)&&tD(e)&&ti(this.left,e.left)},[e5](){return e8(e4(this._tag))(e4(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:tl(this.left)}}}),tj=e=>eQ(e,tR),tD=e=>"Left"===e._tag,tP=e=>"Right"===e._tag,t$=e=>{let t=Object.create(tA);return t.left=e,t},tz=e=>{let t=Object.create(tM);return t.right=e,t},tL=eJ(2,(e,t)=>tP(e)?tz(t(e.right)):t$(e.left)),tU=eJ(2,(e,t)=>tD(e)?t$(e.left):t(e.right)),tB=((e,t,r)=>tU(e,e=>tL(t,t=>r(e,t))),e=>e.length>0),tq=eJ(2,(e,t)=>tC(e)?tI:tT(t(e.value))),tJ=eJ(2,(e,t)=>tC(e)?tI:t(e.value)),tH=((e,t)=>tJ(e,e=>tq(t(e),()=>e)),eJ(2,(e,t)=>({[Symbol.iterator](){let r,n=e[Symbol.iterator](),i=!1;return{next(){if(!i){let e=n.next();return e.done?(i=!0,(r=t[Symbol.iterator]()).next()):e}return r.next()}}}})));(e,t,r)=>({[Symbol.iterator](){let n=e[Symbol.iterator](),i=t[Symbol.iterator]();return{next(){let e=n.next(),t=i.next();return e.done||t.done?{done:!0,value:void 0}:{done:!1,value:r(e.value,t.value)}}}}});let tW=eJ(2,(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),n=0;return{next(){let e=r.next();return e.done?{done:!0,value:void 0}:{done:!1,value:t(e.value,n++)}}}}})),tK=eJ(2,(e,t)=>tV(tW(e,t))),tV=e=>({[Symbol.iterator](){let t,r=e[Symbol.iterator]();return{next:function e(){if(void 0===t){let e=r.next();if(e.done)return e;t=e.value[Symbol.iterator]()}let n=t.next();return n.done?(t=void 0,e()):n}}}});(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),n=0;return{next(){let e=r.next();for(;!e.done;){let i=t(e.value,n++);if(tF(i))return{done:!1,value:i.value};e=r.next()}return{done:!0,value:void 0}}}}});(e,t,r)=>tK(e,e=>tW(t,t=>r(e,t)));let tG=eJ(2,(e,t)=>Object.prototype.hasOwnProperty.call(e,t));(e,t,r)=>tG(e,t)?tT({...e,[t]:r(e[t])}):tI,(e,t)=>{if(!tG(e,t))return{...e};let r={...e};return delete r[t],r};let tZ=((e,t)=>{let r=Math.max(1,Math.floor(e)),n=Array(r);for(let e=0;e<r;e++)n[e]=t(e);return n},e=>Array.isArray(e)?e:Array.from(e)),tQ=eJ(2,(e,t)=>[t,...e]),tY=eJ(2,(e,t)=>[...e,t]),tX=eJ(2,(e,t)=>tZ(e).concat(tZ(t))),t0=(e,t)=>e<0||e>=t.length,t1=eJ(2,(e,t)=>{let r=Math.floor(t);if(t0(r,e))throw Error(`Index ${r} out of bounds`);return e[r]})(0),t2=((e,t)=>{let r=tZ(e);return r.slice(0,Math.floor(Math.min(Math.max(0,t),r.length)))},eJ(2,(e,t)=>{let r=tZ(e);if(tB(r)){let n=r.length,i=Math.round(t)%n;if(t0(Math.abs(i),r)||0===i)return t6(r);if(!(i<0))return t2(e,i-n);{let[e,t]=t4(r,-i);return tX(t,e)}}return[]})),t3=eJ(2,(e,t)=>{let r=tZ(e);if(tB(r)){let[e,n]=t(r),i=[e],s=n;for(;tB(s);){let[e,r]=t(s);i.push(e),s=r}return i}return[]}),t5=eJ(2,(e,t)=>{let r=Array.from(e),n=Math.floor(t);return tB(r)?n>=1?t4(r,n):[[],r]:[r,[]]}),t4=eJ(2,(e,t)=>{let r=Math.max(1,Math.floor(t));return r>=e.length?[t6(e),[]]:[tQ(e.slice(1,r),t1(e)),e.slice(r)]}),t6=e=>e.slice();(e,t)=>{let r=tZ(e);return tB(r)?t3(r,t4(t)):[]};(e,t,r)=>{let n=tZ(e),i=tZ(t);return tB(n)?tB(i)?t9(r)(tX(n,i)):n:i};let t8=eJ(2,(e,t)=>e.map(t)),t7=eJ(2,(e,t)=>{if(0===e.length)return[];let r=[];for(let n=0;n<e.length;n++){let i=t(e[n],n);for(let e=0;e<i.length;e++)r.push(i[e])}return r}),t9=eJ(2,(e,t)=>{let r=tZ(e);if(tB(r)){let e=[t1(r)];for(let n of r.slice(1))e.every(e=>!t(n,e))&&e.push(n);return e}return[]});(e,t,r)=>t7(e,e=>t8(t,t=>r(e,t)));let re=Symbol.for("effect/Context/Tag"),rt=Symbol.for("effect/Context/Reference"),rr=Symbol.for("effect/STM"),rn={...tv,_op:"Tag",[rr]:ty,[re]:{_Service:e=>e,_Identifier:e=>e},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[to](){return this.toJSON()},of:e=>e,context(e){return ru(this,e)}},ri={...rn,[rt]:rt},rs=Symbol.for("effect/Context"),ra={[rs]:{_Services:e=>e},[tn](e){if(rl(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!ti(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[e5](){return tr(this,te(this.unsafeMap.size))},pipe(){return tp(this,arguments)},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(tl)}},[to](){return this.toJSON()}},ro=e=>{let t=Object.create(ra);return t.unsafeMap=e,t},rl=e=>eQ(e,rs),ru=(e,t)=>ro(new Map([[e.key,t]])),rc=eJ(3,(e,t,r)=>{let n=new Map(e.unsafeMap);return n.set(t.key,r),ro(n)}),rh=eG("effect/Context/defaultValueCache",()=>new Map),rf=e=>{if(rh.has(e.key))return rh.get(e.key);let t=e.defaultValue();return rh.set(e.key,t),t},rp=((e,t)=>{if(!e.unsafeMap.has(t.key)){if(rt in t)return rf(t);throw(e=>{let t=Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){let r=e.stack.split("\n");if(r.length>2){let e=r[2].match(/at (.*)/);e&&(t.message=t.message+` (defined at ${e[1]})`)}}if(t.stack){let e=t.stack.split("\n");e.splice(1,3),t.stack=e.join("\n")}return t})(t)}return e.unsafeMap.get(t.key)},()=>(e,t)=>{let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=Error();function i(){}return Error.stackTraceLimit=r,Object.setPrototypeOf(i,ri),i.key=e,i.defaultValue=t.defaultValue,Object.defineProperty(i,"stack",{get:()=>n.stack}),i}),rd=Symbol.for("effect/Micro"),rg=Symbol.for("effect/Micro/MicroExit"),rm=e=>"object"==typeof e&&null!==e&&rd in e,rb=Symbol.for("effect/Micro/MicroCause"),ry={_E:eH};class rv extends globalThis.Error{_tag;traces;[rb];constructor(e,t,r){let n,i,s;const a=`MicroCause.${e}`;if(t instanceof globalThis.Error){n=`(${a}) ${t.name}`;const e=(i=t.message).split("\n").length;s=t.stack?`(${a}) ${t.stack.split("\n").slice(0,e+3).join("\n")}`:`${n}: ${i}`}else n=a,i=((e,t=2)=>{if("string"==typeof e)return e;try{var r,n;let i,s;return"object"==typeof e?(r=e,n=t,i=[],s=JSON.stringify(r,(e,t)=>"object"==typeof t&&null!==t?i.includes(t)?void 0:i.push(t)&&(void 0!==th.fiberRefs&&tc(t)?t[tu](th.fiberRefs):t):t,n),i=void 0,s):String(e)}catch{return String(e)}})(t,0),s=`${n}: ${i}`;r.length>0&&(s+=`
    ${r.join("\n    ")}`),super(i),this._tag=e,this.traces=r,this[rb]=ry,this.name=n,this.stack=s}pipe(){return tp(this,arguments)}toString(){return this.stack}[to](){return this.stack}}class rS extends rv{error;constructor(e,t=[]){super("Fail",e,t),this.error=e}}let rx=(e,t=[])=>new rS(e,t);class r_ extends rv{defect;constructor(e,t=[]){super("Die",e,t),this.defect=e}}let rw=(e,t=[])=>new r_(e,t);class rk extends rv{constructor(e=[]){super("Interrupt","interrupted",e)}}let rO=(e=[])=>new rk(e),rE=e=>"Fail"===e._tag,rC=e=>"Interrupt"===e._tag,rF=eJ(2,(e,t)=>{let r=[...e.traces,t];switch(e._tag){case"Die":return rw(e.defect,r);case"Interrupt":return rO(r);case"Fail":return rx(e.error,r)}}),rI=Symbol.for("effect/Micro/MicroFiber"),rT={_A:eH,_E:eH};class rR{context;interruptible;[rI];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(e,t=!0){this.context=e,this.interruptible=t,this[rI]=rT}getRef(e){let t;return t=this.context,t.unsafeMap.has(e.key)?t.unsafeMap.get(e.key):rf(e)}addObserver(e){return this._exit?(e(this._exit),eK):(this._observers.push(e),()=>{let t=this._observers.indexOf(e);t>=0&&this._observers.splice(t,1)})}_interrupted=!1;unsafeInterrupt(){!this._exit&&(this._interrupted=!0,this.interruptible&&this.evaluate(no))}unsafePoll(){return this._exit}evaluate(e){if(this._exit)return;if(void 0!==this._yielded){let e=this._yielded;this._yielded=void 0,e()}let t=this.runLoop(e);if(t===rL)return;let r=rN.interruptChildren&&rN.interruptChildren(this);if(void 0!==r)return this.evaluate(nt(r,()=>t));this._exit=t;for(let e=0;e<this._observers.length;e++)this._observers[e](t);this._observers.length=0}runLoop(e){let t=!1,r=e;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!t&&this.getRef(nb).shouldYield(this)){t=!0;let e=r;r=nt(rQ,()=>e)}if((r=r[rD](this))===rL){let e=this._yielded;if(rg in e)return this._yielded=void 0,e;return rL}}}catch(e){if(!eQ(r,rD))return nl(`MicroFiber.runLoop: Not a valid effect: ${String(r)}`);return nl(e)}}getCont(e){for(;;){let t=this._stack.pop();if(!t)return;let r=t[rz]&&t[rz](this);if(r)return{[e]:r};if(t[e])return t}}_yielded=void 0;yieldWith(e){return this._yielded=e,rL}children(){return this._children??=new Set}}let rN=eG("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),rM=e=>rZ(()=>{for(let t of e)t.unsafeInterrupt();let t=e[Symbol.iterator](),r=rZ(()=>{let e=t.next();for(;!e.done;){if(e.value.unsafePoll()){e=t.next();continue}let n=e.value;return r5(e=>{n.addObserver(t=>{e(r)})})}return nc});return r}),rA=Symbol.for("effect/Micro/identifier"),rj=Symbol.for("effect/Micro/args"),rD=Symbol.for("effect/Micro/evaluate"),rP=Symbol.for("effect/Micro/successCont"),r$=Symbol.for("effect/Micro/failureCont"),rz=Symbol.for("effect/Micro/ensureCont"),rL=Symbol.for("effect/Micro/Yield"),rU={...tv,_op:"Micro",[rd]:{_A:eH,_E:eH,_R:eH},pipe(){return tp(this,arguments)},[Symbol.iterator](){return new eX(new e1(this))},toJSON(){return{_id:"Micro",op:this[rA],...rj in this?{args:this[rj]}:void 0}},toString(){return JSON.stringify(this,null,2)},[to](){return JSON.stringify(this,null,2)}};function rB(e){return nl("Micro.evaluate: Not implemented")}let rq=e=>({...rU,[rA]:e.op,[rD]:e.eval??rB,[rP]:e.contA,[r$]:e.contE,[rz]:e.ensure}),rJ=e=>{let t=rq(e);return function(){let r=Object.create(t);return r[rj]=!1===e.single?arguments:arguments[0],r}},rH=e=>{let t={...rq(e),[rg]:rg,_tag:e.op,get[e.prop](){return this[rj]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[rj]}},[tn](t){return ni(t)&&t._tag===e.op&&ti(this[rj],t[rj])},[e5](){return tr(this,e8(tt(e.op))(e4(this[rj])))}};return function(e){let r=Object.create(t);return r[rj]=e,r[rP]=void 0,r[r$]=void 0,r[rz]=void 0,r}},rW=rH({op:"Success",prop:"value",eval(e){let t=e.getCont(rP);return t?t[rP](this[rj],e):e.yieldWith(this)}}),rK=rH({op:"Failure",prop:"cause",eval(e){let t=e.getCont(r$);for(;rC(this[rj])&&t&&e.interruptible;)t=e.getCont(r$);return t?t[r$](this[rj],e):e.yieldWith(this)}}),rV=e=>rK(rx(e)),rG=rJ({op:"Sync",eval(e){let t=this[rj](),r=e.getCont(rP);return r?r[rP](t,e):e.yieldWith(ns(t))}}),rZ=rJ({op:"Suspend",eval(e){return this[rj]()}}),rQ=rJ({op:"Yield",eval(e){let t=!1;return e.getRef(nb).scheduleTask(()=>{t||e.evaluate(nc)},this[rj]??0),e.yieldWith(()=>{t=!0})}})(0),rY=rW(void 0),rX=e=>r2(function(t,r){e(r).then(e=>t(rW(e)),e=>t(nl(e)))},0!==e.length),r0=e=>r2(function(t,r){try{e.try(r).then(e=>t(rW(e)),r=>t(rV(e.catch(r))))}catch(r){t(rV(e.catch(r)))}},0!==e.try.length),r1=rJ({op:"WithMicroFiber",eval(e){return this[rj](e)}}),r2=rJ({op:"Async",single:!1,eval(e){let t=this[rj][0],r=!1,n=!1,i=this[rj][1]?new AbortController:void 0,s=t(t=>{r||(r=!0,n?e.evaluate(t):n=t)},i?.signal);return!1!==n?n:(n=!0,e._yielded=()=>{r=!0},void 0===i&&void 0===s||e._stack.push(r3(()=>(r=!0,i?.abort(),s??nc))),rL)}}),r3=rJ({op:"AsyncFinalizer",ensure(e){e.interruptible&&(e.interruptible=!1,e._stack.push(nM(!0)))},contE(e,t){return rC(e)?nt(this[rj](),()=>rK(e)):rK(e)}}),r5=e=>r2(e,e.length>=2),r4=(...e)=>rZ(()=>r6(1===e.length?e[0]():e[1].call(e[0]))),r6=rJ({op:"Iterator",contA(e,t){let r=this[rj].next(e);if(r.done)return rW(r.value);t._stack.push(this);var n=r.value;if("object"==typeof n&&null!==n&&e0 in n)return n[e0]();throw Error("BUG: yieldWrapGet - please report an issue at https://github.com/Effect-TS/effect/issues")},eval(e){return this[rP](void 0,e)}}),r8=eJ(2,(e,t)=>nn(e,e=>t)),r7=eJ(2,(e,t)=>nt(e,e=>{let r=rm(t)?t:"function"==typeof t?t(e):t;return rm(r)?r:rW(r)})),r9=((e,t)=>nt(e,e=>{let r=rm(t)?t:"function"==typeof t?t(e):t;return rm(r)?r8(r,e):rW(e)}),e=>nE(e,{onFailure:na,onSuccess:ns})),ne=eJ(2,(e,t)=>{let r;return r=[e,t],r1(e=>r5(t=>{let n=!1,i=new Set,s=e=>{n=!0,t(0===i.size?e:nt(rM(i),()=>e))};for(let t of r){if(n)break;let r=nz(e,nA(t),!0,!0);i.add(r),r.addObserver(e=>{i.delete(r),s(e)})}return rM(i)}))}),nt=eJ(2,(e,t)=>{let r=Object.create(nr);return r[rj]=e,r[rP]=t,r}),nr=rq({op:"OnSuccess",eval(e){return e._stack.push(this),this[rj]}}),nn=eJ(2,(e,t)=>nt(e,e=>rW(t(e)))),ni=e=>eQ(e,rg),ns=rW,na=rK,no=na(rO()),nl=e=>na(rw(e)),nu=e=>"Failure"===e._tag,nc=ns(void 0),nh=e=>{for(let t of e)if("Failure"===t._tag)return t;return nc},nf="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class np{tasks=[];running=!1;scheduleTask(e,t){this.tasks.push(e),this.running||(this.running=!0,nf(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let e=this.tasks;this.tasks=[];for(let t=0,r=e.length;t<r;t++)e[t]()}shouldYield(e){return e.currentOpCount>=e.getRef(ng)}flush(){for(;this.tasks.length>0;)this.runTasks()}}let nd=eJ(2,(e,t)=>r1(r=>{let n=r.context;return r.context=t(n),nT(e,()=>(r.context=n,rY))}));(e,t,r)=>nd(e,rc(t,r));class ng extends rp()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class nm extends rp()("effect/Micro/currentConcurrency",{defaultValue:()=>"unbounded"}){}class nb extends rp()("effect/Micro/currentScheduler",{defaultValue:()=>new np}){}e=>rm(e[1]),(e,t)=>Array.from({length:t},()=>e);let ny=eJ(2,(e,t)=>{let r=Object.create(nv);return r[rj]=e,r[r$]=t,r}),nv=rq({op:"OnFailure",eval(e){return e._stack.push(this),this[rj]}}),nS=eJ(3,(e,t,r)=>ny(e,e=>t(e)?r(e):rK(e))),nx=eJ(2,(e,t)=>nS(e,rE,e=>t(e.error))),n_=((e,t,r)=>nS(e,t,e=>r7(r(e),rK(e))),eJ(2,(e,t)=>nx(e,e=>rG(t)))),nw=function(){let e=globalThis.Error.stackTraceLimit;globalThis.Error.stackTraceLimit=2;let t=new globalThis.Error;globalThis.Error.stackTraceLimit=e;let r=e=>r=>nN(r,r=>rK(function(e,r){let n=t.stack;if(!n)return r;let i=n.split("\n")[2]?.trim().replace(/^at /,"");if(!i)return r;let s=i.match(/\((.*)\)$/);return rF(r,`at ${e} (${s?s[1]:i})`)}(e,r)));return 2==arguments.length?r(arguments[1])(arguments[0]):r(arguments[0])},nk=eJ(2,(e,t)=>{let r=Object.create(nO);return r[rj]=e,r[rP]=t.onSuccess,r[r$]=t.onFailure,r}),nO=rq({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[rj]}}),nE=eJ(2,(e,t)=>nk(e,{onFailure:e=>rG(()=>t.onFailure(e)),onSuccess:e=>rG(()=>t.onSuccess(e))})),nC=((e,t)=>nk(e,{onFailure:e=>"Fail"===e._tag?t.onFailure(e.error):rK(e),onSuccess:t.onSuccess}),e=>r5(t=>{let r=setTimeout(()=>{t(rY)},e);return rG(()=>{clearTimeout(r)})})),nF=((e,t)=>ne(e,r7(nA(nC(t.duration)),t.onTimeout)),Symbol.for("effect/Micro/MicroScope"));i=Error.stackTraceLimit,Error.stackTraceLimit=2,s=Error(),Error.stackTraceLimit=i,Object.defineProperty(a=Object.create(rn),"stack",{get:()=>s.stack}),a.key="effect/Micro/MicroScope";class nI{[nF];state={_tag:"Open",finalizers:new Set};constructor(){this[nF]=nF}unsafeAddFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.add(e)}addFinalizer(e){return rZ(()=>"Open"===this.state._tag?(this.state.finalizers.add(e),rY):e(this.state.exit))}unsafeRemoveFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.delete(e)}close(e){return rZ(()=>{if("Open"===this.state._tag){let t=Array.from(this.state.finalizers).reverse();return this.state={_tag:"Closed",exit:e},nt(n$(t,t=>r9(t(e))),nh)}return rY})}get fork(){return rG(()=>{let e=new nI;if("Closed"===this.state._tag)return e.state=this.state,e;function t(t){return e.close(t)}return this.state.finalizers.add(t),e.unsafeAddFinalizer(e=>rG(()=>this.unsafeRemoveFinalizer(t))),e})}}let nT=eJ(2,(e,t)=>nj(r=>nk(r(e),{onFailure:e=>nt(t(na(e)),()=>rK(e)),onSuccess:e=>nt(t(ns(e)),()=>rW(e))}))),nR=eJ(3,(e,t,r)=>nT(e,e=>t(e)?r(e):nc)),nN=eJ(2,(e,t)=>nR(e,nu,e=>t(e.cause))),nM=rJ({op:"SetInterruptible",ensure(e){if(e.interruptible=this[rj],e._interrupted&&e.interruptible)return()=>no}}),nA=e=>r1(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(nM(!1)),t._interrupted)?no:e),nj=e=>r1(t=>t.interruptible?(t.interruptible=!1,t._stack.push(nM(!0)),e(nA)):e(eH)),nD=(e,t)=>Array.isArray(e)||eQ(e,Symbol.iterator)?n$(e,eH,t):t?.discard?n$(Object.values(e),eH,t):rZ(()=>{let r={};return r8(n$(Object.entries(e),([e,t])=>nn(t,t=>{r[e]=t}),{discard:!0,concurrency:t?.concurrency}),r)}),nP=rJ({op:"While",contA(e,t){return(this[rj].step(e),this[rj].while())?(t._stack.push(this),this[rj].body()):nc},eval(e){return this[rj].while()?(e._stack.push(this),this[rj].body()):nc}}),n$=(e,t,r)=>r1(n=>{let i=r?.concurrency==="inherit"?n.getRef(nm):r?.concurrency??1,s="unbounded"===i?1/0:Math.max(1,i),a=tZ(e),o=a.length;if(0===o)return r?.discard?rY:rW([]);let l=r?.discard?void 0:Array(o),u=0;return 1===s?r8(nP({while:()=>u<a.length,body:()=>t(a[u],u),step:l?e=>l[u++]=e:e=>u++}),l):r5(e=>{let r,i=new Set,c=0,h=0,f=!1,p=!1;return!function d(){for(f=!0;c<s&&u<o;){let g=u,m=a[g];u++,c++;try{let a=nz(n,t(m,g),!0,!0);i.add(a),a.addObserver(t=>{i.delete(a),p||("Failure"===t._tag?void 0===r&&(r=t,o=u,i.forEach(e=>e.unsafeInterrupt())):void 0!==l&&(l[g]=t.value),h++,c--,h===o?e(r??rW(l)):!f&&c<s&&d())})}catch(e){r=nl(e),o=u,i.forEach(e=>e.unsafeInterrupt())}}f=!1}(),rZ(()=>(p=!0,u=o,rM(i)))})}),nz=(e,t,r=!1,n=!1)=>{let i=new rR(e.context,e.interruptible);return n||(e.children().add(i),i.addObserver(()=>e.children().delete(i))),r?i.evaluate(t):e.getRef(nb).scheduleTask(()=>i.evaluate(t),0),i},nL=function(){class e extends globalThis.Error{}return Object.assign(e.prototype,rU,tS,{[rA]:"Failure",[rD](){return rV(this)},toString(){return this.message?`${this.name}: ${this.message}`:this.name},toJSON(){return{...this}},[to](){let e=this.stack;return e?`${this.toString()}
${e.split("\n").slice(1).join("\n")}`:this.toString()}}),e}(),nU=class extends nL{constructor(e){super(),e&&Object.assign(this,e)}},nB=e=>{class t extends nU{_tag=e}return t.prototype.name=e,t},nq={"application/andrew-inset":{source:"iana",extensions:["ez"]},"application/applixware":{source:"apache",extensions:["aw"]},"application/atom+xml":{source:"iana",extensions:["atom"]},"application/atomcat+xml":{source:"iana",extensions:["atomcat"]},"application/atomdeleted+xml":{source:"iana",extensions:["atomdeleted"]},"application/atomsvc+xml":{source:"iana",extensions:["atomsvc"]},"application/atsc-dwd+xml":{source:"iana",extensions:["dwd"]},"application/atsc-held+xml":{source:"iana",extensions:["held"]},"application/atsc-rsat+xml":{source:"iana",extensions:["rsat"]},"application/calendar+xml":{source:"iana",extensions:["xcs"]},"application/ccxml+xml":{source:"iana",extensions:["ccxml"]},"application/cdfx+xml":{source:"iana",extensions:["cdfx"]},"application/cdmi-capability":{source:"iana",extensions:["cdmia"]},"application/cdmi-container":{source:"iana",extensions:["cdmic"]},"application/cdmi-domain":{source:"iana",extensions:["cdmid"]},"application/cdmi-object":{source:"iana",extensions:["cdmio"]},"application/cdmi-queue":{source:"iana",extensions:["cdmiq"]},"application/cpl+xml":{source:"iana",extensions:["cpl"]},"application/cu-seeme":{source:"apache",extensions:["cu"]},"application/dash+xml":{source:"iana",extensions:["mpd"]},"application/dash-patch+xml":{source:"iana",extensions:["mpp"]},"application/davmount+xml":{source:"iana",extensions:["davmount"]},"application/dicom":{source:"iana",extensions:["dcm"]},"application/docbook+xml":{source:"apache",extensions:["dbk"]},"application/dssc+der":{source:"iana",extensions:["dssc"]},"application/dssc+xml":{source:"iana",extensions:["xdssc"]},"application/ecmascript":{source:"iana",extensions:["es","ecma"]},"application/emma+xml":{source:"iana",extensions:["emma"]},"application/emotionml+xml":{source:"iana",extensions:["emotionml"]},"application/epub+zip":{source:"iana",extensions:["epub"]},"application/exi":{source:"iana",extensions:["exi"]},"application/express":{source:"iana",extensions:["exp"]},"application/fdt+xml":{source:"iana",extensions:["fdt"]},"application/font-tdpfr":{source:"iana",extensions:["pfr"]},"application/geo+json":{source:"iana",extensions:["geojson"]},"application/gml+xml":{source:"iana",extensions:["gml"]},"application/gpx+xml":{source:"apache",extensions:["gpx"]},"application/gxf":{source:"apache",extensions:["gxf"]},"application/gzip":{source:"iana",extensions:["gz"]},"application/hyperstudio":{source:"iana",extensions:["stk"]},"application/inkml+xml":{source:"iana",extensions:["ink","inkml"]},"application/ipfix":{source:"iana",extensions:["ipfix"]},"application/its+xml":{source:"iana",extensions:["its"]},"application/java-archive":{source:"apache",extensions:["jar","war","ear"]},"application/java-serialized-object":{source:"apache",extensions:["ser"]},"application/java-vm":{source:"apache",extensions:["class"]},"application/javascript":{source:"iana",charset:"UTF-8",extensions:["js","mjs"]},"application/json":{source:"iana",charset:"UTF-8",extensions:["json","map"]},"application/jsonml+json":{source:"apache",extensions:["jsonml"]},"application/ld+json":{source:"iana",extensions:["jsonld"]},"application/lgr+xml":{source:"iana",extensions:["lgr"]},"application/lost+xml":{source:"iana",extensions:["lostxml"]},"application/mac-binhex40":{source:"iana",extensions:["hqx"]},"application/mac-compactpro":{source:"apache",extensions:["cpt"]},"application/mads+xml":{source:"iana",extensions:["mads"]},"application/manifest+json":{source:"iana",charset:"UTF-8",extensions:["webmanifest"]},"application/marc":{source:"iana",extensions:["mrc"]},"application/marcxml+xml":{source:"iana",extensions:["mrcx"]},"application/mathematica":{source:"iana",extensions:["ma","nb","mb"]},"application/mathml+xml":{source:"iana",extensions:["mathml"]},"application/mbox":{source:"iana",extensions:["mbox"]},"application/media-policy-dataset+xml":{source:"iana",extensions:["mpf"]},"application/mediaservercontrol+xml":{source:"iana",extensions:["mscml"]},"application/metalink+xml":{source:"apache",extensions:["metalink"]},"application/metalink4+xml":{source:"iana",extensions:["meta4"]},"application/mets+xml":{source:"iana",extensions:["mets"]},"application/mmt-aei+xml":{source:"iana",extensions:["maei"]},"application/mmt-usd+xml":{source:"iana",extensions:["musd"]},"application/mods+xml":{source:"iana",extensions:["mods"]},"application/mp21":{source:"iana",extensions:["m21","mp21"]},"application/mp4":{source:"iana",extensions:["mp4s","m4p"]},"application/msword":{source:"iana",extensions:["doc","dot"]},"application/mxf":{source:"iana",extensions:["mxf"]},"application/n-quads":{source:"iana",extensions:["nq"]},"application/n-triples":{source:"iana",extensions:["nt"]},"application/node":{source:"iana",extensions:["cjs"]},"application/octet-stream":{source:"iana",extensions:["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"]},"application/oda":{source:"iana",extensions:["oda"]},"application/oebps-package+xml":{source:"iana",extensions:["opf"]},"application/ogg":{source:"iana",extensions:["ogx"]},"application/omdoc+xml":{source:"apache",extensions:["omdoc"]},"application/onenote":{source:"apache",extensions:["onetoc","onetoc2","onetmp","onepkg"]},"application/oxps":{source:"iana",extensions:["oxps"]},"application/p2p-overlay+xml":{source:"iana",extensions:["relo"]},"application/patch-ops-error+xml":{source:"iana",extensions:["xer"]},"application/pdf":{source:"iana",extensions:["pdf"]},"application/pgp-encrypted":{source:"iana",extensions:["pgp"]},"application/pgp-keys":{source:"iana",extensions:["asc"]},"application/pgp-signature":{source:"iana",extensions:["asc","sig"]},"application/pics-rules":{source:"apache",extensions:["prf"]},"application/pkcs10":{source:"iana",extensions:["p10"]},"application/pkcs7-mime":{source:"iana",extensions:["p7m","p7c"]},"application/pkcs7-signature":{source:"iana",extensions:["p7s"]},"application/pkcs8":{source:"iana",extensions:["p8"]},"application/pkix-attr-cert":{source:"iana",extensions:["ac"]},"application/pkix-cert":{source:"iana",extensions:["cer"]},"application/pkix-crl":{source:"iana",extensions:["crl"]},"application/pkix-pkipath":{source:"iana",extensions:["pkipath"]},"application/pkixcmp":{source:"iana",extensions:["pki"]},"application/pls+xml":{source:"iana",extensions:["pls"]},"application/postscript":{source:"iana",extensions:["ai","eps","ps"]},"application/provenance+xml":{source:"iana",extensions:["provx"]},"application/prs.cww":{source:"iana",extensions:["cww"]},"application/pskc+xml":{source:"iana",extensions:["pskcxml"]},"application/rdf+xml":{source:"iana",extensions:["rdf","owl"]},"application/reginfo+xml":{source:"iana",extensions:["rif"]},"application/relax-ng-compact-syntax":{source:"iana",extensions:["rnc"]},"application/resource-lists+xml":{source:"iana",extensions:["rl"]},"application/resource-lists-diff+xml":{source:"iana",extensions:["rld"]},"application/rls-services+xml":{source:"iana",extensions:["rs"]},"application/route-apd+xml":{source:"iana",extensions:["rapd"]},"application/route-s-tsid+xml":{source:"iana",extensions:["sls"]},"application/route-usd+xml":{source:"iana",extensions:["rusd"]},"application/rpki-ghostbusters":{source:"iana",extensions:["gbr"]},"application/rpki-manifest":{source:"iana",extensions:["mft"]},"application/rpki-roa":{source:"iana",extensions:["roa"]},"application/rsd+xml":{source:"apache",extensions:["rsd"]},"application/rss+xml":{source:"apache",extensions:["rss"]},"application/rtf":{source:"iana",extensions:["rtf"]},"application/sbml+xml":{source:"iana",extensions:["sbml"]},"application/scvp-cv-request":{source:"iana",extensions:["scq"]},"application/scvp-cv-response":{source:"iana",extensions:["scs"]},"application/scvp-vp-request":{source:"iana",extensions:["spq"]},"application/scvp-vp-response":{source:"iana",extensions:["spp"]},"application/sdp":{source:"iana",extensions:["sdp"]},"application/senml+xml":{source:"iana",extensions:["senmlx"]},"application/sensml+xml":{source:"iana",extensions:["sensmlx"]},"application/set-payment-initiation":{source:"iana",extensions:["setpay"]},"application/set-registration-initiation":{source:"iana",extensions:["setreg"]},"application/shf+xml":{source:"iana",extensions:["shf"]},"application/sieve":{source:"iana",extensions:["siv","sieve"]},"application/smil+xml":{source:"iana",extensions:["smi","smil"]},"application/sparql-query":{source:"iana",extensions:["rq"]},"application/sparql-results+xml":{source:"iana",extensions:["srx"]},"application/srgs":{source:"iana",extensions:["gram"]},"application/srgs+xml":{source:"iana",extensions:["grxml"]},"application/sru+xml":{source:"iana",extensions:["sru"]},"application/ssdl+xml":{source:"apache",extensions:["ssdl"]},"application/ssml+xml":{source:"iana",extensions:["ssml"]},"application/swid+xml":{source:"iana",extensions:["swidtag"]},"application/tei+xml":{source:"iana",extensions:["tei","teicorpus"]},"application/thraud+xml":{source:"iana",extensions:["tfi"]},"application/timestamped-data":{source:"iana",extensions:["tsd"]},"application/trig":{source:"iana",extensions:["trig"]},"application/ttml+xml":{source:"iana",extensions:["ttml"]},"application/urc-ressheet+xml":{source:"iana",extensions:["rsheet"]},"application/urc-targetdesc+xml":{source:"iana",extensions:["td"]},"application/vnd.1000minds.decision-model+xml":{source:"iana",extensions:["1km"]},"application/vnd.3gpp.pic-bw-large":{source:"iana",extensions:["plb"]},"application/vnd.3gpp.pic-bw-small":{source:"iana",extensions:["psb"]},"application/vnd.3gpp.pic-bw-var":{source:"iana",extensions:["pvb"]},"application/vnd.3gpp2.tcap":{source:"iana",extensions:["tcap"]},"application/vnd.3m.post-it-notes":{source:"iana",extensions:["pwn"]},"application/vnd.accpac.simply.aso":{source:"iana",extensions:["aso"]},"application/vnd.accpac.simply.imp":{source:"iana",extensions:["imp"]},"application/vnd.acucobol":{source:"iana",extensions:["acu"]},"application/vnd.acucorp":{source:"iana",extensions:["atc","acutc"]},"application/vnd.adobe.air-application-installer-package+zip":{source:"apache",extensions:["air"]},"application/vnd.adobe.formscentral.fcdt":{source:"iana",extensions:["fcdt"]},"application/vnd.adobe.fxp":{source:"iana",extensions:["fxp","fxpl"]},"application/vnd.adobe.xdp+xml":{source:"iana",extensions:["xdp"]},"application/vnd.adobe.xfdf":{source:"iana",extensions:["xfdf"]},"application/vnd.age":{source:"iana",extensions:["age"]},"application/vnd.ahead.space":{source:"iana",extensions:["ahead"]},"application/vnd.airzip.filesecure.azf":{source:"iana",extensions:["azf"]},"application/vnd.airzip.filesecure.azs":{source:"iana",extensions:["azs"]},"application/vnd.amazon.ebook":{source:"apache",extensions:["azw"]},"application/vnd.americandynamics.acc":{source:"iana",extensions:["acc"]},"application/vnd.amiga.ami":{source:"iana",extensions:["ami"]},"application/vnd.android.package-archive":{source:"apache",extensions:["apk"]},"application/vnd.anser-web-certificate-issue-initiation":{source:"iana",extensions:["cii"]},"application/vnd.anser-web-funds-transfer-initiation":{source:"apache",extensions:["fti"]},"application/vnd.antix.game-component":{source:"iana",extensions:["atx"]},"application/vnd.apple.installer+xml":{source:"iana",extensions:["mpkg"]},"application/vnd.apple.keynote":{source:"iana",extensions:["key"]},"application/vnd.apple.mpegurl":{source:"iana",extensions:["m3u8"]},"application/vnd.apple.numbers":{source:"iana",extensions:["numbers"]},"application/vnd.apple.pages":{source:"iana",extensions:["pages"]},"application/vnd.aristanetworks.swi":{source:"iana",extensions:["swi"]},"application/vnd.astraea-software.iota":{source:"iana",extensions:["iota"]},"application/vnd.audiograph":{source:"iana",extensions:["aep"]},"application/vnd.balsamiq.bmml+xml":{source:"iana",extensions:["bmml"]},"application/vnd.blueice.multipass":{source:"iana",extensions:["mpm"]},"application/vnd.bmi":{source:"iana",extensions:["bmi"]},"application/vnd.businessobjects":{source:"iana",extensions:["rep"]},"application/vnd.chemdraw+xml":{source:"iana",extensions:["cdxml"]},"application/vnd.chipnuts.karaoke-mmd":{source:"iana",extensions:["mmd"]},"application/vnd.cinderella":{source:"iana",extensions:["cdy"]},"application/vnd.citationstyles.style+xml":{source:"iana",extensions:["csl"]},"application/vnd.claymore":{source:"iana",extensions:["cla"]},"application/vnd.cloanto.rp9":{source:"iana",extensions:["rp9"]},"application/vnd.clonk.c4group":{source:"iana",extensions:["c4g","c4d","c4f","c4p","c4u"]},"application/vnd.cluetrust.cartomobile-config":{source:"iana",extensions:["c11amc"]},"application/vnd.cluetrust.cartomobile-config-pkg":{source:"iana",extensions:["c11amz"]},"application/vnd.commonspace":{source:"iana",extensions:["csp"]},"application/vnd.contact.cmsg":{source:"iana",extensions:["cdbcmsg"]},"application/vnd.cosmocaller":{source:"iana",extensions:["cmc"]},"application/vnd.crick.clicker":{source:"iana",extensions:["clkx"]},"application/vnd.crick.clicker.keyboard":{source:"iana",extensions:["clkk"]},"application/vnd.crick.clicker.palette":{source:"iana",extensions:["clkp"]},"application/vnd.crick.clicker.template":{source:"iana",extensions:["clkt"]},"application/vnd.crick.clicker.wordbank":{source:"iana",extensions:["clkw"]},"application/vnd.criticaltools.wbs+xml":{source:"iana",extensions:["wbs"]},"application/vnd.ctc-posml":{source:"iana",extensions:["pml"]},"application/vnd.cups-ppd":{source:"iana",extensions:["ppd"]},"application/vnd.curl.car":{source:"apache",extensions:["car"]},"application/vnd.curl.pcurl":{source:"apache",extensions:["pcurl"]},"application/vnd.dart":{source:"iana",extensions:["dart"]},"application/vnd.data-vision.rdz":{source:"iana",extensions:["rdz"]},"application/vnd.dbf":{source:"iana",extensions:["dbf"]},"application/vnd.dece.data":{source:"iana",extensions:["uvf","uvvf","uvd","uvvd"]},"application/vnd.dece.ttml+xml":{source:"iana",extensions:["uvt","uvvt"]},"application/vnd.dece.unspecified":{source:"iana",extensions:["uvx","uvvx"]},"application/vnd.dece.zip":{source:"iana",extensions:["uvz","uvvz"]},"application/vnd.denovo.fcselayout-link":{source:"iana",extensions:["fe_launch"]},"application/vnd.dna":{source:"iana",extensions:["dna"]},"application/vnd.dolby.mlp":{source:"apache",extensions:["mlp"]},"application/vnd.dpgraph":{source:"iana",extensions:["dpg"]},"application/vnd.dreamfactory":{source:"iana",extensions:["dfac"]},"application/vnd.ds-keypoint":{source:"apache",extensions:["kpxx"]},"application/vnd.dvb.ait":{source:"iana",extensions:["ait"]},"application/vnd.dvb.service":{source:"iana",extensions:["svc"]},"application/vnd.dynageo":{source:"iana",extensions:["geo"]},"application/vnd.ecowin.chart":{source:"iana",extensions:["mag"]},"application/vnd.enliven":{source:"iana",extensions:["nml"]},"application/vnd.epson.esf":{source:"iana",extensions:["esf"]},"application/vnd.epson.msf":{source:"iana",extensions:["msf"]},"application/vnd.epson.quickanime":{source:"iana",extensions:["qam"]},"application/vnd.epson.salt":{source:"iana",extensions:["slt"]},"application/vnd.epson.ssf":{source:"iana",extensions:["ssf"]},"application/vnd.eszigno3+xml":{source:"iana",extensions:["es3","et3"]},"application/vnd.ezpix-album":{source:"iana",extensions:["ez2"]},"application/vnd.ezpix-package":{source:"iana",extensions:["ez3"]},"application/vnd.fdf":{source:"iana",extensions:["fdf"]},"application/vnd.fdsn.mseed":{source:"iana",extensions:["mseed"]},"application/vnd.fdsn.seed":{source:"iana",extensions:["seed","dataless"]},"application/vnd.flographit":{source:"iana",extensions:["gph"]},"application/vnd.fluxtime.clip":{source:"iana",extensions:["ftc"]},"application/vnd.framemaker":{source:"iana",extensions:["fm","frame","maker","book"]},"application/vnd.frogans.fnc":{source:"iana",extensions:["fnc"]},"application/vnd.frogans.ltf":{source:"iana",extensions:["ltf"]},"application/vnd.fsc.weblaunch":{source:"iana",extensions:["fsc"]},"application/vnd.fujitsu.oasys":{source:"iana",extensions:["oas"]},"application/vnd.fujitsu.oasys2":{source:"iana",extensions:["oa2"]},"application/vnd.fujitsu.oasys3":{source:"iana",extensions:["oa3"]},"application/vnd.fujitsu.oasysgp":{source:"iana",extensions:["fg5"]},"application/vnd.fujitsu.oasysprs":{source:"iana",extensions:["bh2"]},"application/vnd.fujixerox.ddd":{source:"iana",extensions:["ddd"]},"application/vnd.fujixerox.docuworks":{source:"iana",extensions:["xdw"]},"application/vnd.fujixerox.docuworks.binder":{source:"iana",extensions:["xbd"]},"application/vnd.fuzzysheet":{source:"iana",extensions:["fzs"]},"application/vnd.genomatix.tuxedo":{source:"iana",extensions:["txd"]},"application/vnd.geogebra.file":{source:"iana",extensions:["ggb"]},"application/vnd.geogebra.tool":{source:"iana",extensions:["ggt"]},"application/vnd.geometry-explorer":{source:"iana",extensions:["gex","gre"]},"application/vnd.geonext":{source:"iana",extensions:["gxt"]},"application/vnd.geoplan":{source:"iana",extensions:["g2w"]},"application/vnd.geospace":{source:"iana",extensions:["g3w"]},"application/vnd.gmx":{source:"iana",extensions:["gmx"]},"application/vnd.google-earth.kml+xml":{source:"iana",extensions:["kml"]},"application/vnd.google-earth.kmz":{source:"iana",extensions:["kmz"]},"application/vnd.grafeq":{source:"iana",extensions:["gqf","gqs"]},"application/vnd.groove-account":{source:"iana",extensions:["gac"]},"application/vnd.groove-help":{source:"iana",extensions:["ghf"]},"application/vnd.groove-identity-message":{source:"iana",extensions:["gim"]},"application/vnd.groove-injector":{source:"iana",extensions:["grv"]},"application/vnd.groove-tool-message":{source:"iana",extensions:["gtm"]},"application/vnd.groove-tool-template":{source:"iana",extensions:["tpl"]},"application/vnd.groove-vcard":{source:"iana",extensions:["vcg"]},"application/vnd.hal+xml":{source:"iana",extensions:["hal"]},"application/vnd.handheld-entertainment+xml":{source:"iana",extensions:["zmm"]},"application/vnd.hbci":{source:"iana",extensions:["hbci"]},"application/vnd.hhe.lesson-player":{source:"iana",extensions:["les"]},"application/vnd.hp-hpgl":{source:"iana",extensions:["hpgl"]},"application/vnd.hp-hpid":{source:"iana",extensions:["hpid"]},"application/vnd.hp-hps":{source:"iana",extensions:["hps"]},"application/vnd.hp-jlyt":{source:"iana",extensions:["jlt"]},"application/vnd.hp-pcl":{source:"iana",extensions:["pcl"]},"application/vnd.hp-pclxl":{source:"iana",extensions:["pclxl"]},"application/vnd.hydrostatix.sof-data":{source:"iana",extensions:["sfd-hdstx"]},"application/vnd.ibm.minipay":{source:"iana",extensions:["mpy"]},"application/vnd.ibm.modcap":{source:"iana",extensions:["afp","listafp","list3820"]},"application/vnd.ibm.rights-management":{source:"iana",extensions:["irm"]},"application/vnd.ibm.secure-container":{source:"iana",extensions:["sc"]},"application/vnd.iccprofile":{source:"iana",extensions:["icc","icm"]},"application/vnd.igloader":{source:"iana",extensions:["igl"]},"application/vnd.immervision-ivp":{source:"iana",extensions:["ivp"]},"application/vnd.immervision-ivu":{source:"iana",extensions:["ivu"]},"application/vnd.insors.igm":{source:"iana",extensions:["igm"]},"application/vnd.intercon.formnet":{source:"iana",extensions:["xpw","xpx"]},"application/vnd.intergeo":{source:"iana",extensions:["i2g"]},"application/vnd.intu.qbo":{source:"iana",extensions:["qbo"]},"application/vnd.intu.qfx":{source:"iana",extensions:["qfx"]},"application/vnd.ipunplugged.rcprofile":{source:"iana",extensions:["rcprofile"]},"application/vnd.irepository.package+xml":{source:"iana",extensions:["irp"]},"application/vnd.is-xpr":{source:"iana",extensions:["xpr"]},"application/vnd.isac.fcs":{source:"iana",extensions:["fcs"]},"application/vnd.jam":{source:"iana",extensions:["jam"]},"application/vnd.jcp.javame.midlet-rms":{source:"iana",extensions:["rms"]},"application/vnd.jisp":{source:"iana",extensions:["jisp"]},"application/vnd.joost.joda-archive":{source:"iana",extensions:["joda"]},"application/vnd.kahootz":{source:"iana",extensions:["ktz","ktr"]},"application/vnd.kde.karbon":{source:"iana",extensions:["karbon"]},"application/vnd.kde.kchart":{source:"iana",extensions:["chrt"]},"application/vnd.kde.kformula":{source:"iana",extensions:["kfo"]},"application/vnd.kde.kivio":{source:"iana",extensions:["flw"]},"application/vnd.kde.kontour":{source:"iana",extensions:["kon"]},"application/vnd.kde.kpresenter":{source:"iana",extensions:["kpr","kpt"]},"application/vnd.kde.kspread":{source:"iana",extensions:["ksp"]},"application/vnd.kde.kword":{source:"iana",extensions:["kwd","kwt"]},"application/vnd.kenameaapp":{source:"iana",extensions:["htke"]},"application/vnd.kidspiration":{source:"iana",extensions:["kia"]},"application/vnd.kinar":{source:"iana",extensions:["kne","knp"]},"application/vnd.koan":{source:"iana",extensions:["skp","skd","skt","skm"]},"application/vnd.kodak-descriptor":{source:"iana",extensions:["sse"]},"application/vnd.las.las+xml":{source:"iana",extensions:["lasxml"]},"application/vnd.llamagraphics.life-balance.desktop":{source:"iana",extensions:["lbd"]},"application/vnd.llamagraphics.life-balance.exchange+xml":{source:"iana",extensions:["lbe"]},"application/vnd.lotus-1-2-3":{source:"iana",extensions:["123"]},"application/vnd.lotus-approach":{source:"iana",extensions:["apr"]},"application/vnd.lotus-freelance":{source:"iana",extensions:["pre"]},"application/vnd.lotus-notes":{source:"iana",extensions:["nsf"]},"application/vnd.lotus-organizer":{source:"iana",extensions:["org"]},"application/vnd.lotus-screencam":{source:"iana",extensions:["scm"]},"application/vnd.lotus-wordpro":{source:"iana",extensions:["lwp"]},"application/vnd.macports.portpkg":{source:"iana",extensions:["portpkg"]},"application/vnd.mapbox-vector-tile":{source:"iana",extensions:["mvt"]},"application/vnd.mcd":{source:"iana",extensions:["mcd"]},"application/vnd.medcalcdata":{source:"iana",extensions:["mc1"]},"application/vnd.mediastation.cdkey":{source:"iana",extensions:["cdkey"]},"application/vnd.mfer":{source:"iana",extensions:["mwf"]},"application/vnd.mfmp":{source:"iana",extensions:["mfm"]},"application/vnd.micrografx.flo":{source:"iana",extensions:["flo"]},"application/vnd.micrografx.igx":{source:"iana",extensions:["igx"]},"application/vnd.mif":{source:"iana",extensions:["mif"]},"application/vnd.mobius.daf":{source:"iana",extensions:["daf"]},"application/vnd.mobius.dis":{source:"iana",extensions:["dis"]},"application/vnd.mobius.mbk":{source:"iana",extensions:["mbk"]},"application/vnd.mobius.mqy":{source:"iana",extensions:["mqy"]},"application/vnd.mobius.msl":{source:"iana",extensions:["msl"]},"application/vnd.mobius.plc":{source:"iana",extensions:["plc"]},"application/vnd.mobius.txf":{source:"iana",extensions:["txf"]},"application/vnd.mophun.application":{source:"iana",extensions:["mpn"]},"application/vnd.mophun.certificate":{source:"iana",extensions:["mpc"]},"application/vnd.mozilla.xul+xml":{source:"iana",extensions:["xul"]},"application/vnd.ms-artgalry":{source:"iana",extensions:["cil"]},"application/vnd.ms-cab-compressed":{source:"iana",extensions:["cab"]},"application/vnd.ms-excel":{source:"iana",extensions:["xls","xlm","xla","xlc","xlt","xlw"]},"application/vnd.ms-excel.addin.macroenabled.12":{source:"iana",extensions:["xlam"]},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{source:"iana",extensions:["xlsb"]},"application/vnd.ms-excel.sheet.macroenabled.12":{source:"iana",extensions:["xlsm"]},"application/vnd.ms-excel.template.macroenabled.12":{source:"iana",extensions:["xltm"]},"application/vnd.ms-fontobject":{source:"iana",extensions:["eot"]},"application/vnd.ms-htmlhelp":{source:"iana",extensions:["chm"]},"application/vnd.ms-ims":{source:"iana",extensions:["ims"]},"application/vnd.ms-lrm":{source:"iana",extensions:["lrm"]},"application/vnd.ms-officetheme":{source:"iana",extensions:["thmx"]},"application/vnd.ms-pki.seccat":{source:"apache",extensions:["cat"]},"application/vnd.ms-pki.stl":{source:"apache",extensions:["stl"]},"application/vnd.ms-powerpoint":{source:"iana",extensions:["ppt","pps","pot"]},"application/vnd.ms-powerpoint.addin.macroenabled.12":{source:"iana",extensions:["ppam"]},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{source:"iana",extensions:["pptm"]},"application/vnd.ms-powerpoint.slide.macroenabled.12":{source:"iana",extensions:["sldm"]},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{source:"iana",extensions:["ppsm"]},"application/vnd.ms-powerpoint.template.macroenabled.12":{source:"iana",extensions:["potm"]},"application/vnd.ms-project":{source:"iana",extensions:["mpp","mpt"]},"application/vnd.ms-word.document.macroenabled.12":{source:"iana",extensions:["docm"]},"application/vnd.ms-word.template.macroenabled.12":{source:"iana",extensions:["dotm"]},"application/vnd.ms-works":{source:"iana",extensions:["wps","wks","wcm","wdb"]},"application/vnd.ms-wpl":{source:"iana",extensions:["wpl"]},"application/vnd.ms-xpsdocument":{source:"iana",extensions:["xps"]},"application/vnd.mseq":{source:"iana",extensions:["mseq"]},"application/vnd.musician":{source:"iana",extensions:["mus"]},"application/vnd.muvee.style":{source:"iana",extensions:["msty"]},"application/vnd.mynfc":{source:"iana",extensions:["taglet"]},"application/vnd.neurolanguage.nlu":{source:"iana",extensions:["nlu"]},"application/vnd.nitf":{source:"iana",extensions:["ntf","nitf"]},"application/vnd.noblenet-directory":{source:"iana",extensions:["nnd"]},"application/vnd.noblenet-sealer":{source:"iana",extensions:["nns"]},"application/vnd.noblenet-web":{source:"iana",extensions:["nnw"]},"application/vnd.nokia.n-gage.ac+xml":{source:"iana",extensions:["ac"]},"application/vnd.nokia.n-gage.data":{source:"iana",extensions:["ngdat"]},"application/vnd.nokia.n-gage.symbian.install":{source:"iana",extensions:["n-gage"]},"application/vnd.nokia.radio-preset":{source:"iana",extensions:["rpst"]},"application/vnd.nokia.radio-presets":{source:"iana",extensions:["rpss"]},"application/vnd.novadigm.edm":{source:"iana",extensions:["edm"]},"application/vnd.novadigm.edx":{source:"iana",extensions:["edx"]},"application/vnd.novadigm.ext":{source:"iana",extensions:["ext"]},"application/vnd.oasis.opendocument.chart":{source:"iana",extensions:["odc"]},"application/vnd.oasis.opendocument.chart-template":{source:"iana",extensions:["otc"]},"application/vnd.oasis.opendocument.database":{source:"iana",extensions:["odb"]},"application/vnd.oasis.opendocument.formula":{source:"iana",extensions:["odf"]},"application/vnd.oasis.opendocument.formula-template":{source:"iana",extensions:["odft"]},"application/vnd.oasis.opendocument.graphics":{source:"iana",extensions:["odg"]},"application/vnd.oasis.opendocument.graphics-template":{source:"iana",extensions:["otg"]},"application/vnd.oasis.opendocument.image":{source:"iana",extensions:["odi"]},"application/vnd.oasis.opendocument.image-template":{source:"iana",extensions:["oti"]},"application/vnd.oasis.opendocument.presentation":{source:"iana",extensions:["odp"]},"application/vnd.oasis.opendocument.presentation-template":{source:"iana",extensions:["otp"]},"application/vnd.oasis.opendocument.spreadsheet":{source:"iana",extensions:["ods"]},"application/vnd.oasis.opendocument.spreadsheet-template":{source:"iana",extensions:["ots"]},"application/vnd.oasis.opendocument.text":{source:"iana",extensions:["odt"]},"application/vnd.oasis.opendocument.text-master":{source:"iana",extensions:["odm"]},"application/vnd.oasis.opendocument.text-template":{source:"iana",extensions:["ott"]},"application/vnd.oasis.opendocument.text-web":{source:"iana",extensions:["oth"]},"application/vnd.olpc-sugar":{source:"iana",extensions:["xo"]},"application/vnd.oma.dd2+xml":{source:"iana",extensions:["dd2"]},"application/vnd.openblox.game+xml":{source:"iana",extensions:["obgx"]},"application/vnd.openofficeorg.extension":{source:"apache",extensions:["oxt"]},"application/vnd.openstreetmap.data+xml":{source:"iana",extensions:["osm"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{source:"iana",extensions:["pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.slide":{source:"iana",extensions:["sldx"]},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{source:"iana",extensions:["ppsx"]},"application/vnd.openxmlformats-officedocument.presentationml.template":{source:"iana",extensions:["potx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{source:"iana",extensions:["xlsx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{source:"iana",extensions:["xltx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{source:"iana",extensions:["docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{source:"iana",extensions:["dotx"]},"application/vnd.osgeo.mapguide.package":{source:"iana",extensions:["mgp"]},"application/vnd.osgi.dp":{source:"iana",extensions:["dp"]},"application/vnd.osgi.subsystem":{source:"iana",extensions:["esa"]},"application/vnd.palm":{source:"iana",extensions:["pdb","pqa","oprc"]},"application/vnd.pawaafile":{source:"iana",extensions:["paw"]},"application/vnd.pg.format":{source:"iana",extensions:["str"]},"application/vnd.pg.osasli":{source:"iana",extensions:["ei6"]},"application/vnd.picsel":{source:"iana",extensions:["efif"]},"application/vnd.pmi.widget":{source:"iana",extensions:["wg"]},"application/vnd.pocketlearn":{source:"iana",extensions:["plf"]},"application/vnd.powerbuilder6":{source:"iana",extensions:["pbd"]},"application/vnd.previewsystems.box":{source:"iana",extensions:["box"]},"application/vnd.proteus.magazine":{source:"iana",extensions:["mgz"]},"application/vnd.publishare-delta-tree":{source:"iana",extensions:["qps"]},"application/vnd.pvi.ptid1":{source:"iana",extensions:["ptid"]},"application/vnd.quark.quarkxpress":{source:"iana",extensions:["qxd","qxt","qwd","qwt","qxl","qxb"]},"application/vnd.rar":{source:"iana",extensions:["rar"]},"application/vnd.realvnc.bed":{source:"iana",extensions:["bed"]},"application/vnd.recordare.musicxml":{source:"iana",extensions:["mxl"]},"application/vnd.recordare.musicxml+xml":{source:"iana",extensions:["musicxml"]},"application/vnd.rig.cryptonote":{source:"iana",extensions:["cryptonote"]},"application/vnd.rim.cod":{source:"apache",extensions:["cod"]},"application/vnd.rn-realmedia":{source:"apache",extensions:["rm"]},"application/vnd.rn-realmedia-vbr":{source:"apache",extensions:["rmvb"]},"application/vnd.route66.link66+xml":{source:"iana",extensions:["link66"]},"application/vnd.sailingtracker.track":{source:"iana",extensions:["st"]},"application/vnd.seemail":{source:"iana",extensions:["see"]},"application/vnd.sema":{source:"iana",extensions:["sema"]},"application/vnd.semd":{source:"iana",extensions:["semd"]},"application/vnd.semf":{source:"iana",extensions:["semf"]},"application/vnd.shana.informed.formdata":{source:"iana",extensions:["ifm"]},"application/vnd.shana.informed.formtemplate":{source:"iana",extensions:["itp"]},"application/vnd.shana.informed.interchange":{source:"iana",extensions:["iif"]},"application/vnd.shana.informed.package":{source:"iana",extensions:["ipk"]},"application/vnd.simtech-mindmapper":{source:"iana",extensions:["twd","twds"]},"application/vnd.smaf":{source:"iana",extensions:["mmf"]},"application/vnd.smart.teacher":{source:"iana",extensions:["teacher"]},"application/vnd.software602.filler.form+xml":{source:"iana",extensions:["fo"]},"application/vnd.solent.sdkm+xml":{source:"iana",extensions:["sdkm","sdkd"]},"application/vnd.spotfire.dxp":{source:"iana",extensions:["dxp"]},"application/vnd.spotfire.sfs":{source:"iana",extensions:["sfs"]},"application/vnd.stardivision.calc":{source:"apache",extensions:["sdc"]},"application/vnd.stardivision.draw":{source:"apache",extensions:["sda"]},"application/vnd.stardivision.impress":{source:"apache",extensions:["sdd"]},"application/vnd.stardivision.math":{source:"apache",extensions:["smf"]},"application/vnd.stardivision.writer":{source:"apache",extensions:["sdw","vor"]},"application/vnd.stardivision.writer-global":{source:"apache",extensions:["sgl"]},"application/vnd.stepmania.package":{source:"iana",extensions:["smzip"]},"application/vnd.stepmania.stepchart":{source:"iana",extensions:["sm"]},"application/vnd.sun.wadl+xml":{source:"iana",extensions:["wadl"]},"application/vnd.sun.xml.calc":{source:"apache",extensions:["sxc"]},"application/vnd.sun.xml.calc.template":{source:"apache",extensions:["stc"]},"application/vnd.sun.xml.draw":{source:"apache",extensions:["sxd"]},"application/vnd.sun.xml.draw.template":{source:"apache",extensions:["std"]},"application/vnd.sun.xml.impress":{source:"apache",extensions:["sxi"]},"application/vnd.sun.xml.impress.template":{source:"apache",extensions:["sti"]},"application/vnd.sun.xml.math":{source:"apache",extensions:["sxm"]},"application/vnd.sun.xml.writer":{source:"apache",extensions:["sxw"]},"application/vnd.sun.xml.writer.global":{source:"apache",extensions:["sxg"]},"application/vnd.sun.xml.writer.template":{source:"apache",extensions:["stw"]},"application/vnd.sus-calendar":{source:"iana",extensions:["sus","susp"]},"application/vnd.svd":{source:"iana",extensions:["svd"]},"application/vnd.symbian.install":{source:"apache",extensions:["sis","sisx"]},"application/vnd.syncml+xml":{source:"iana",charset:"UTF-8",extensions:["xsm"]},"application/vnd.syncml.dm+wbxml":{source:"iana",charset:"UTF-8",extensions:["bdm"]},"application/vnd.syncml.dm+xml":{source:"iana",charset:"UTF-8",extensions:["xdm"]},"application/vnd.syncml.dmddf+xml":{source:"iana",charset:"UTF-8",extensions:["ddf"]},"application/vnd.tao.intent-module-archive":{source:"iana",extensions:["tao"]},"application/vnd.tcpdump.pcap":{source:"iana",extensions:["pcap","cap","dmp"]},"application/vnd.tmobile-livetv":{source:"iana",extensions:["tmo"]},"application/vnd.trid.tpt":{source:"iana",extensions:["tpt"]},"application/vnd.triscape.mxs":{source:"iana",extensions:["mxs"]},"application/vnd.trueapp":{source:"iana",extensions:["tra"]},"application/vnd.ufdl":{source:"iana",extensions:["ufd","ufdl"]},"application/vnd.uiq.theme":{source:"iana",extensions:["utz"]},"application/vnd.umajin":{source:"iana",extensions:["umj"]},"application/vnd.unity":{source:"iana",extensions:["unityweb"]},"application/vnd.uoml+xml":{source:"iana",extensions:["uoml"]},"application/vnd.vcx":{source:"iana",extensions:["vcx"]},"application/vnd.visio":{source:"iana",extensions:["vsd","vst","vss","vsw"]},"application/vnd.visionary":{source:"iana",extensions:["vis"]},"application/vnd.vsf":{source:"iana",extensions:["vsf"]},"application/vnd.wap.wbxml":{source:"iana",charset:"UTF-8",extensions:["wbxml"]},"application/vnd.wap.wmlc":{source:"iana",extensions:["wmlc"]},"application/vnd.wap.wmlscriptc":{source:"iana",extensions:["wmlsc"]},"application/vnd.webturbo":{source:"iana",extensions:["wtb"]},"application/vnd.wolfram.player":{source:"iana",extensions:["nbp"]},"application/vnd.wordperfect":{source:"iana",extensions:["wpd"]},"application/vnd.wqd":{source:"iana",extensions:["wqd"]},"application/vnd.wt.stf":{source:"iana",extensions:["stf"]},"application/vnd.xara":{source:"iana",extensions:["xar"]},"application/vnd.xfdl":{source:"iana",extensions:["xfdl"]},"application/vnd.yamaha.hv-dic":{source:"iana",extensions:["hvd"]},"application/vnd.yamaha.hv-script":{source:"iana",extensions:["hvs"]},"application/vnd.yamaha.hv-voice":{source:"iana",extensions:["hvp"]},"application/vnd.yamaha.openscoreformat":{source:"iana",extensions:["osf"]},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{source:"iana",extensions:["osfpvg"]},"application/vnd.yamaha.smaf-audio":{source:"iana",extensions:["saf"]},"application/vnd.yamaha.smaf-phrase":{source:"iana",extensions:["spf"]},"application/vnd.yellowriver-custom-menu":{source:"iana",extensions:["cmp"]},"application/vnd.zul":{source:"iana",extensions:["zir","zirz"]},"application/vnd.zzazz.deck+xml":{source:"iana",extensions:["zaz"]},"application/voicexml+xml":{source:"iana",extensions:["vxml"]},"application/wasm":{source:"iana",extensions:["wasm"]},"application/watcherinfo+xml":{source:"iana",extensions:["wif"]},"application/widget":{source:"iana",extensions:["wgt"]},"application/winhlp":{source:"apache",extensions:["hlp"]},"application/wsdl+xml":{source:"iana",extensions:["wsdl"]},"application/wspolicy+xml":{source:"iana",extensions:["wspolicy"]},"application/x-7z-compressed":{source:"apache",extensions:["7z"]},"application/x-abiword":{source:"apache",extensions:["abw"]},"application/x-ace-compressed":{source:"apache",extensions:["ace"]},"application/x-apple-diskimage":{source:"apache",extensions:["dmg"]},"application/x-authorware-bin":{source:"apache",extensions:["aab","x32","u32","vox"]},"application/x-authorware-map":{source:"apache",extensions:["aam"]},"application/x-authorware-seg":{source:"apache",extensions:["aas"]},"application/x-bcpio":{source:"apache",extensions:["bcpio"]},"application/x-bittorrent":{source:"apache",extensions:["torrent"]},"application/x-blorb":{source:"apache",extensions:["blb","blorb"]},"application/x-bzip":{source:"apache",extensions:["bz"]},"application/x-bzip2":{source:"apache",extensions:["bz2","boz"]},"application/x-cbr":{source:"apache",extensions:["cbr","cba","cbt","cbz","cb7"]},"application/x-cdlink":{source:"apache",extensions:["vcd"]},"application/x-cfs-compressed":{source:"apache",extensions:["cfs"]},"application/x-chat":{source:"apache",extensions:["chat"]},"application/x-chess-pgn":{source:"apache",extensions:["pgn"]},"application/x-cocoa":{source:"nginx",extensions:["cco"]},"application/x-conference":{source:"apache",extensions:["nsc"]},"application/x-cpio":{source:"apache",extensions:["cpio"]},"application/x-csh":{source:"apache",extensions:["csh"]},"application/x-debian-package":{source:"apache",extensions:["deb","udeb"]},"application/x-dgc-compressed":{source:"apache",extensions:["dgc"]},"application/x-director":{source:"apache",extensions:["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"]},"application/x-doom":{source:"apache",extensions:["wad"]},"application/x-dtbncx+xml":{source:"apache",extensions:["ncx"]},"application/x-dtbook+xml":{source:"apache",extensions:["dtb"]},"application/x-dtbresource+xml":{source:"apache",extensions:["res"]},"application/x-dvi":{source:"apache",extensions:["dvi"]},"application/x-envoy":{source:"apache",extensions:["evy"]},"application/x-eva":{source:"apache",extensions:["eva"]},"application/x-font-bdf":{source:"apache",extensions:["bdf"]},"application/x-font-ghostscript":{source:"apache",extensions:["gsf"]},"application/x-font-linux-psf":{source:"apache",extensions:["psf"]},"application/x-font-pcf":{source:"apache",extensions:["pcf"]},"application/x-font-snf":{source:"apache",extensions:["snf"]},"application/x-font-type1":{source:"apache",extensions:["pfa","pfb","pfm","afm"]},"application/x-freearc":{source:"apache",extensions:["arc"]},"application/x-futuresplash":{source:"apache",extensions:["spl"]},"application/x-gca-compressed":{source:"apache",extensions:["gca"]},"application/x-glulx":{source:"apache",extensions:["ulx"]},"application/x-gnumeric":{source:"apache",extensions:["gnumeric"]},"application/x-gramps-xml":{source:"apache",extensions:["gramps"]},"application/x-gtar":{source:"apache",extensions:["gtar"]},"application/x-hdf":{source:"apache",extensions:["hdf"]},"application/x-install-instructions":{source:"apache",extensions:["install"]},"application/x-iso9660-image":{source:"apache",extensions:["iso"]},"application/x-java-archive-diff":{source:"nginx",extensions:["jardiff"]},"application/x-java-jnlp-file":{source:"apache",extensions:["jnlp"]},"application/x-latex":{source:"apache",extensions:["latex"]},"application/x-lzh-compressed":{source:"apache",extensions:["lzh","lha"]},"application/x-makeself":{source:"nginx",extensions:["run"]},"application/x-mie":{source:"apache",extensions:["mie"]},"application/x-mobipocket-ebook":{source:"apache",extensions:["prc","mobi"]},"application/x-ms-application":{source:"apache",extensions:["application"]},"application/x-ms-shortcut":{source:"apache",extensions:["lnk"]},"application/x-ms-wmd":{source:"apache",extensions:["wmd"]},"application/x-ms-wmz":{source:"apache",extensions:["wmz"]},"application/x-ms-xbap":{source:"apache",extensions:["xbap"]},"application/x-msaccess":{source:"apache",extensions:["mdb"]},"application/x-msbinder":{source:"apache",extensions:["obd"]},"application/x-mscardfile":{source:"apache",extensions:["crd"]},"application/x-msclip":{source:"apache",extensions:["clp"]},"application/x-msdownload":{source:"apache",extensions:["exe","dll","com","bat","msi"]},"application/x-msmediaview":{source:"apache",extensions:["mvb","m13","m14"]},"application/x-msmetafile":{source:"apache",extensions:["wmf","wmz","emf","emz"]},"application/x-msmoney":{source:"apache",extensions:["mny"]},"application/x-mspublisher":{source:"apache",extensions:["pub"]},"application/x-msschedule":{source:"apache",extensions:["scd"]},"application/x-msterminal":{source:"apache",extensions:["trm"]},"application/x-mswrite":{source:"apache",extensions:["wri"]},"application/x-netcdf":{source:"apache",extensions:["nc","cdf"]},"application/x-nzb":{source:"apache",extensions:["nzb"]},"application/x-perl":{source:"nginx",extensions:["pl","pm"]},"application/x-pilot":{source:"nginx",extensions:["prc","pdb"]},"application/x-pkcs12":{source:"apache",extensions:["p12","pfx"]},"application/x-pkcs7-certificates":{source:"apache",extensions:["p7b","spc"]},"application/x-pkcs7-certreqresp":{source:"apache",extensions:["p7r"]},"application/x-rar-compressed":{source:"apache",extensions:["rar"]},"application/x-redhat-package-manager":{source:"nginx",extensions:["rpm"]},"application/x-research-info-systems":{source:"apache",extensions:["ris"]},"application/x-sea":{source:"nginx",extensions:["sea"]},"application/x-sh":{source:"apache",extensions:["sh"]},"application/x-shar":{source:"apache",extensions:["shar"]},"application/x-shockwave-flash":{source:"apache",extensions:["swf"]},"application/x-silverlight-app":{source:"apache",extensions:["xap"]},"application/x-sql":{source:"apache",extensions:["sql"]},"application/x-stuffit":{source:"apache",extensions:["sit"]},"application/x-stuffitx":{source:"apache",extensions:["sitx"]},"application/x-subrip":{source:"apache",extensions:["srt"]},"application/x-sv4cpio":{source:"apache",extensions:["sv4cpio"]},"application/x-sv4crc":{source:"apache",extensions:["sv4crc"]},"application/x-t3vm-image":{source:"apache",extensions:["t3"]},"application/x-tads":{source:"apache",extensions:["gam"]},"application/x-tar":{source:"apache",extensions:["tar"]},"application/x-tcl":{source:"apache",extensions:["tcl","tk"]},"application/x-tex":{source:"apache",extensions:["tex"]},"application/x-tex-tfm":{source:"apache",extensions:["tfm"]},"application/x-texinfo":{source:"apache",extensions:["texinfo","texi"]},"application/x-tgif":{source:"apache",extensions:["obj"]},"application/x-ustar":{source:"apache",extensions:["ustar"]},"application/x-wais-source":{source:"apache",extensions:["src"]},"application/x-x509-ca-cert":{source:"iana",extensions:["der","crt","pem"]},"application/x-xfig":{source:"apache",extensions:["fig"]},"application/x-xliff+xml":{source:"apache",extensions:["xlf"]},"application/x-xpinstall":{source:"apache",extensions:["xpi"]},"application/x-xz":{source:"apache",extensions:["xz"]},"application/x-zmachine":{source:"apache",extensions:["z1","z2","z3","z4","z5","z6","z7","z8"]},"application/xaml+xml":{source:"apache",extensions:["xaml"]},"application/xcap-att+xml":{source:"iana",extensions:["xav"]},"application/xcap-caps+xml":{source:"iana",extensions:["xca"]},"application/xcap-diff+xml":{source:"iana",extensions:["xdf"]},"application/xcap-el+xml":{source:"iana",extensions:["xel"]},"application/xcap-ns+xml":{source:"iana",extensions:["xns"]},"application/xenc+xml":{source:"iana",extensions:["xenc"]},"application/xhtml+xml":{source:"iana",extensions:["xhtml","xht"]},"application/xliff+xml":{source:"iana",extensions:["xlf"]},"application/xml":{source:"iana",extensions:["xml","xsl","xsd","rng"]},"application/xml-dtd":{source:"iana",extensions:["dtd"]},"application/xop+xml":{source:"iana",extensions:["xop"]},"application/xproc+xml":{source:"apache",extensions:["xpl"]},"application/xslt+xml":{source:"iana",extensions:["xsl","xslt"]},"application/xspf+xml":{source:"apache",extensions:["xspf"]},"application/xv+xml":{source:"iana",extensions:["mxml","xhvml","xvml","xvm"]},"application/yaml":{source:"iana",extensions:["yaml","yml"]},"application/yang":{source:"iana",extensions:["yang"]},"application/yin+xml":{source:"iana",extensions:["yin"]},"application/zip":{source:"iana",extensions:["zip"]},"audio/3gpp":{source:"iana",extensions:["3gpp"]},"audio/adpcm":{source:"apache",extensions:["adp"]},"audio/amr":{source:"iana",extensions:["amr"]},"audio/basic":{source:"iana",extensions:["au","snd"]},"audio/midi":{source:"apache",extensions:["mid","midi","kar","rmi"]},"audio/mobile-xmf":{source:"iana",extensions:["mxmf"]},"audio/mp4":{source:"iana",extensions:["m4a","mp4a"]},"audio/mpeg":{source:"iana",extensions:["mpga","mp2","mp2a","mp3","m2a","m3a"]},"audio/ogg":{source:"iana",extensions:["oga","ogg","spx","opus"]},"audio/s3m":{source:"apache",extensions:["s3m"]},"audio/silk":{source:"apache",extensions:["sil"]},"audio/vnd.dece.audio":{source:"iana",extensions:["uva","uvva"]},"audio/vnd.digital-winds":{source:"iana",extensions:["eol"]},"audio/vnd.dra":{source:"iana",extensions:["dra"]},"audio/vnd.dts":{source:"iana",extensions:["dts"]},"audio/vnd.dts.hd":{source:"iana",extensions:["dtshd"]},"audio/vnd.lucent.voice":{source:"iana",extensions:["lvp"]},"audio/vnd.ms-playready.media.pya":{source:"iana",extensions:["pya"]},"audio/vnd.nuera.ecelp4800":{source:"iana",extensions:["ecelp4800"]},"audio/vnd.nuera.ecelp7470":{source:"iana",extensions:["ecelp7470"]},"audio/vnd.nuera.ecelp9600":{source:"iana",extensions:["ecelp9600"]},"audio/vnd.rip":{source:"iana",extensions:["rip"]},"audio/webm":{source:"apache",extensions:["weba"]},"audio/x-aac":{source:"apache",extensions:["aac"]},"audio/x-aiff":{source:"apache",extensions:["aif","aiff","aifc"]},"audio/x-caf":{source:"apache",extensions:["caf"]},"audio/x-flac":{source:"apache",extensions:["flac"]},"audio/x-m4a":{source:"nginx",extensions:["m4a"]},"audio/x-matroska":{source:"apache",extensions:["mka"]},"audio/x-mpegurl":{source:"apache",extensions:["m3u"]},"audio/x-ms-wax":{source:"apache",extensions:["wax"]},"audio/x-ms-wma":{source:"apache",extensions:["wma"]},"audio/x-pn-realaudio":{source:"apache",extensions:["ram","ra"]},"audio/x-pn-realaudio-plugin":{source:"apache",extensions:["rmp"]},"audio/x-realaudio":{source:"nginx",extensions:["ra"]},"audio/x-wav":{source:"apache",extensions:["wav"]},"audio/x-gsm":{source:"apache",extensions:["gsm"]},"audio/xm":{source:"apache",extensions:["xm"]},"image/aces":{source:"iana",extensions:["exr"]},"image/avci":{source:"iana",extensions:["avci"]},"image/avcs":{source:"iana",extensions:["avcs"]},"image/avif":{source:"iana",extensions:["avif"]},"image/bmp":{source:"iana",extensions:["bmp"]},"image/cgm":{source:"iana",extensions:["cgm"]},"image/dicom-rle":{source:"iana",extensions:["drle"]},"image/emf":{source:"iana",extensions:["emf"]},"image/fits":{source:"iana",extensions:["fits"]},"image/g3fax":{source:"iana",extensions:["g3"]},"image/gif":{source:"iana",extensions:["gif"]},"image/heic":{source:"iana",extensions:["heic"]},"image/heic-sequence":{source:"iana",extensions:["heics"]},"image/heif":{source:"iana",extensions:["heif"]},"image/heif-sequence":{source:"iana",extensions:["heifs"]},"image/hej2k":{source:"iana",extensions:["hej2"]},"image/hsj2":{source:"iana",extensions:["hsj2"]},"image/ief":{source:"iana",extensions:["ief"]},"image/jls":{source:"iana",extensions:["jls"]},"image/jp2":{source:"iana",extensions:["jp2","jpg2"]},"image/jpeg":{source:"iana",extensions:["jpeg","jpg","jpe","jfif","pjpeg","pjp"]},"image/jph":{source:"iana",extensions:["jph"]},"image/jphc":{source:"iana",extensions:["jhc"]},"image/jpm":{source:"iana",extensions:["jpm"]},"image/jpx":{source:"iana",extensions:["jpx","jpf"]},"image/jxr":{source:"iana",extensions:["jxr"]},"image/jxra":{source:"iana",extensions:["jxra"]},"image/jxrs":{source:"iana",extensions:["jxrs"]},"image/jxs":{source:"iana",extensions:["jxs"]},"image/jxsc":{source:"iana",extensions:["jxsc"]},"image/jxsi":{source:"iana",extensions:["jxsi"]},"image/jxss":{source:"iana",extensions:["jxss"]},"image/ktx":{source:"iana",extensions:["ktx"]},"image/ktx2":{source:"iana",extensions:["ktx2"]},"image/png":{source:"iana",extensions:["png"]},"image/prs.btif":{source:"iana",extensions:["btif"]},"image/prs.pti":{source:"iana",extensions:["pti"]},"image/sgi":{source:"apache",extensions:["sgi"]},"image/svg+xml":{source:"iana",extensions:["svg","svgz"]},"image/t38":{source:"iana",extensions:["t38"]},"image/tiff":{source:"iana",extensions:["tif","tiff"]},"image/tiff-fx":{source:"iana",extensions:["tfx"]},"image/vnd.adobe.photoshop":{source:"iana",extensions:["psd"]},"image/vnd.airzip.accelerator.azv":{source:"iana",extensions:["azv"]},"image/vnd.dece.graphic":{source:"iana",extensions:["uvi","uvvi","uvg","uvvg"]},"image/vnd.djvu":{source:"iana",extensions:["djvu","djv"]},"image/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"image/vnd.dwg":{source:"iana",extensions:["dwg"]},"image/vnd.dxf":{source:"iana",extensions:["dxf"]},"image/vnd.fastbidsheet":{source:"iana",extensions:["fbs"]},"image/vnd.fpx":{source:"iana",extensions:["fpx"]},"image/vnd.fst":{source:"iana",extensions:["fst"]},"image/vnd.fujixerox.edmics-mmr":{source:"iana",extensions:["mmr"]},"image/vnd.fujixerox.edmics-rlc":{source:"iana",extensions:["rlc"]},"image/vnd.microsoft.icon":{source:"iana",extensions:["ico"]},"image/vnd.ms-modi":{source:"iana",extensions:["mdi"]},"image/vnd.ms-photo":{source:"apache",extensions:["wdp"]},"image/vnd.net-fpx":{source:"iana",extensions:["npx"]},"image/vnd.pco.b16":{source:"iana",extensions:["b16"]},"image/vnd.tencent.tap":{source:"iana",extensions:["tap"]},"image/vnd.valve.source.texture":{source:"iana",extensions:["vtf"]},"image/vnd.wap.wbmp":{source:"iana",extensions:["wbmp"]},"image/vnd.xiff":{source:"iana",extensions:["xif"]},"image/vnd.zbrush.pcx":{source:"iana",extensions:["pcx"]},"image/webp":{source:"apache",extensions:["webp"]},"image/wmf":{source:"iana",extensions:["wmf"]},"image/x-3ds":{source:"apache",extensions:["3ds"]},"image/x-cmu-raster":{source:"apache",extensions:["ras"]},"image/x-cmx":{source:"apache",extensions:["cmx"]},"image/x-freehand":{source:"apache",extensions:["fh","fhc","fh4","fh5","fh7"]},"image/x-icon":{source:"apache",extensions:["ico"]},"image/x-jng":{source:"nginx",extensions:["jng"]},"image/x-mrsid-image":{source:"apache",extensions:["sid"]},"image/x-ms-bmp":{source:"nginx",extensions:["bmp"]},"image/x-pcx":{source:"apache",extensions:["pcx"]},"image/x-pict":{source:"apache",extensions:["pic","pct"]},"image/x-portable-anymap":{source:"apache",extensions:["pnm"]},"image/x-portable-bitmap":{source:"apache",extensions:["pbm"]},"image/x-portable-graymap":{source:"apache",extensions:["pgm"]},"image/x-portable-pixmap":{source:"apache",extensions:["ppm"]},"image/x-rgb":{source:"apache",extensions:["rgb"]},"image/x-tga":{source:"apache",extensions:["tga"]},"image/x-xbitmap":{source:"apache",extensions:["xbm"]},"image/x-xpixmap":{source:"apache",extensions:["xpm"]},"image/x-xwindowdump":{source:"apache",extensions:["xwd"]},"text/cache-manifest":{source:"iana",extensions:["appcache","manifest"]},"text/calendar":{source:"iana",extensions:["ics","ifb"]},"text/css":{source:"iana",charset:"UTF-8",extensions:["css"]},"text/csv":{source:"iana",extensions:["csv"]},"text/html":{source:"iana",extensions:["html","htm","shtml"]},"text/markdown":{source:"iana",extensions:["markdown","md"]},"text/mathml":{source:"nginx",extensions:["mml"]},"text/n3":{source:"iana",charset:"UTF-8",extensions:["n3"]},"text/plain":{source:"iana",extensions:["txt","text","conf","def","list","log","in","ini"]},"text/prs.lines.tag":{source:"iana",extensions:["dsc"]},"text/richtext":{source:"iana",extensions:["rtx"]},"text/rtf":{source:"iana",extensions:["rtf"]},"text/sgml":{source:"iana",extensions:["sgml","sgm"]},"text/shex":{source:"iana",extensions:["shex"]},"text/spdx":{source:"iana",extensions:["spdx"]},"text/tab-separated-values":{source:"iana",extensions:["tsv"]},"text/troff":{source:"iana",extensions:["t","tr","roff","man","me","ms"]},"text/turtle":{source:"iana",charset:"UTF-8",extensions:["ttl"]},"text/uri-list":{source:"iana",extensions:["uri","uris","urls"]},"text/vcard":{source:"iana",extensions:["vcard"]},"text/vnd.curl":{source:"iana",extensions:["curl"]},"text/vnd.curl.dcurl":{source:"apache",extensions:["dcurl"]},"text/vnd.curl.mcurl":{source:"apache",extensions:["mcurl"]},"text/vnd.curl.scurl":{source:"apache",extensions:["scurl"]},"text/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"text/vnd.familysearch.gedcom":{source:"iana",extensions:["ged"]},"text/vnd.fly":{source:"iana",extensions:["fly"]},"text/vnd.fmi.flexstor":{source:"iana",extensions:["flx"]},"text/vnd.graphviz":{source:"iana",extensions:["gv"]},"text/vnd.in3d.3dml":{source:"iana",extensions:["3dml"]},"text/vnd.in3d.spot":{source:"iana",extensions:["spot"]},"text/vnd.sun.j2me.app-descriptor":{source:"iana",charset:"UTF-8",extensions:["jad"]},"text/vnd.wap.wml":{source:"iana",extensions:["wml"]},"text/vnd.wap.wmlscript":{source:"iana",extensions:["wmls"]},"text/vtt":{source:"iana",charset:"UTF-8",extensions:["vtt"]},"text/x-asm":{source:"apache",extensions:["s","asm"]},"text/x-c":{source:"apache",extensions:["c","cc","cxx","cpp","h","hh","dic"]},"text/x-component":{source:"nginx",extensions:["htc"]},"text/x-fortran":{source:"apache",extensions:["f","for","f77","f90"]},"text/x-java-source":{source:"apache",extensions:["java"]},"text/x-nfo":{source:"apache",extensions:["nfo"]},"text/x-opml":{source:"apache",extensions:["opml"]},"text/x-pascal":{source:"apache",extensions:["p","pas"]},"text/x-setext":{source:"apache",extensions:["etx"]},"text/x-sfv":{source:"apache",extensions:["sfv"]},"text/x-uuencode":{source:"apache",extensions:["uu"]},"text/x-vcalendar":{source:"apache",extensions:["vcs"]},"text/x-vcard":{source:"apache",extensions:["vcf"]},"text/xml":{source:"iana",extensions:["xml"]},"video/3gpp":{source:"iana",extensions:["3gp","3gpp"]},"video/3gpp2":{source:"iana",extensions:["3g2"]},"video/h261":{source:"iana",extensions:["h261"]},"video/h263":{source:"iana",extensions:["h263"]},"video/h264":{source:"iana",extensions:["h264"]},"video/iso.segment":{source:"iana",extensions:["m4s"]},"video/jpeg":{source:"iana",extensions:["jpgv"]},"video/jpm":{source:"apache",extensions:["jpm","jpgm"]},"video/mj2":{source:"iana",extensions:["mj2","mjp2"]},"video/mp2t":{source:"iana",extensions:["ts"]},"video/mp4":{source:"iana",extensions:["mp4","mp4v","mpg4"]},"video/mpeg":{source:"iana",extensions:["mpeg","mpg","mpe","m1v","m2v"]},"video/ogg":{source:"iana",extensions:["ogv"]},"video/quicktime":{source:"iana",extensions:["qt","mov"]},"video/vnd.dece.hd":{source:"iana",extensions:["uvh","uvvh"]},"video/vnd.dece.mobile":{source:"iana",extensions:["uvm","uvvm"]},"video/vnd.dece.pd":{source:"iana",extensions:["uvp","uvvp"]},"video/vnd.dece.sd":{source:"iana",extensions:["uvs","uvvs"]},"video/vnd.dece.video":{source:"iana",extensions:["uvv","uvvv"]},"video/vnd.dvb.file":{source:"iana",extensions:["dvb"]},"video/vnd.fvt":{source:"iana",extensions:["fvt"]},"video/vnd.mpegurl":{source:"iana",extensions:["mxu","m4u"]},"video/vnd.ms-playready.media.pyv":{source:"iana",extensions:["pyv"]},"video/vnd.uvvu.mp4":{source:"iana",extensions:["uvu","uvvu"]},"video/vnd.vivo":{source:"iana",extensions:["viv"]},"video/webm":{source:"apache",extensions:["webm"]},"video/x-f4v":{source:"apache",extensions:["f4v"]},"video/x-fli":{source:"apache",extensions:["fli"]},"video/x-flv":{source:"apache",extensions:["flv"]},"video/x-m4v":{source:"apache",extensions:["m4v"]},"video/x-matroska":{source:"apache",extensions:["mkv","mk3d","mks"]},"video/x-mng":{source:"apache",extensions:["mng"]},"video/x-ms-asf":{source:"apache",extensions:["asf","asx"]},"video/x-ms-vob":{source:"apache",extensions:["vob"]},"video/x-ms-wm":{source:"apache",extensions:["wm"]},"video/x-ms-wmv":{source:"apache",extensions:["wmv"]},"video/x-ms-wmx":{source:"apache",extensions:["wmx"]},"video/x-ms-wvx":{source:"apache",extensions:["wvx"]},"video/x-msvideo":{source:"apache",extensions:["avi"]},"video/x-sgi-movie":{source:"apache",extensions:["movie"]},"video/x-smv":{source:"apache",extensions:["smv"]},"chemical/x-cdx":{source:"apache",extensions:["cdx"]},"chemical/x-cif":{source:"apache",extensions:["cif"]},"chemical/x-cmdf":{source:"apache",extensions:["cmdf"]},"chemical/x-cml":{source:"apache",extensions:["cml"]},"chemical/x-csml":{source:"apache",extensions:["csml"]},"chemical/x-xyz":{source:"apache",extensions:["xyz"]},"font/collection":{source:"iana",extensions:["ttc"]},"font/otf":{source:"iana",extensions:["otf"]},"font/ttf":{source:"iana",extensions:["ttf"]},"font/woff":{source:"iana",extensions:["woff"]},"font/woff2":{source:"iana",extensions:["woff2"]},"message/disposition-notification":{source:"iana",extensions:["disposition-notification"]},"message/global":{source:"iana",extensions:["u8msg"]},"message/global-delivery-status":{source:"iana",extensions:["u8dsn"]},"message/global-disposition-notification":{source:"iana",extensions:["u8mdn"]},"message/global-headers":{source:"iana",extensions:["u8hdr"]},"message/rfc822":{source:"iana",extensions:["eml","mime"]},"message/vnd.wfa.wsc":{source:"iana",extensions:["wsc"]},"model/3mf":{source:"iana",extensions:["3mf"]},"model/gltf+json":{source:"iana",extensions:["gltf"]},"model/gltf-binary":{source:"iana",extensions:["glb"]},"model/iges":{source:"iana",extensions:["igs","iges"]},"model/mesh":{source:"iana",extensions:["msh","mesh","silo"]},"model/mtl":{source:"iana",extensions:["mtl"]},"model/obj":{source:"iana",extensions:["obj"]},"model/step":{source:"iana",extensions:[".p21",".stp",".step",".stpnc",".210"]},"model/step+xml":{source:"iana",extensions:["stpx"]},"model/step+zip":{source:"iana",extensions:["stpz"]},"model/step-xml+zip":{source:"iana",extensions:["stpxz"]},"model/stl":{source:"iana",extensions:["stl"]},"model/vnd.collada+xml":{source:"iana",extensions:["dae"]},"model/vnd.dwf":{source:"iana",extensions:["dwf"]},"model/vnd.gdl":{source:"iana",extensions:["gdl"]},"model/vnd.gtw":{source:"iana",extensions:["gtw"]},"model/vnd.mts":{source:"iana",extensions:["mts"]},"model/vnd.opengex":{source:"iana",extensions:["ogex"]},"model/vnd.parasolid.transmit.binary":{source:"iana",extensions:["x_b"]},"model/vnd.parasolid.transmit.text":{source:"iana",extensions:["x_t"]},"model/vnd.sap.vds":{source:"iana",extensions:["vds"]},"model/vnd.usdz+zip":{source:"iana",extensions:["usdz"]},"model/vnd.valve.source.compiled-map":{source:"iana",extensions:["bsp"]},"model/vnd.vtu":{source:"iana",extensions:["vtu"]},"model/vrml":{source:"iana",extensions:["wrl","vrml"]},"model/x3d+binary":{source:"apache",extensions:["x3db","x3dbz"]},"model/x3d+fastinfoset":{source:"iana",extensions:["x3db"]},"model/x3d+vrml":{source:"apache",extensions:["x3dv","x3dvz"]},"model/x3d+xml":{source:"iana",extensions:["x3d","x3dz"]},"model/x3d-vrml":{source:"iana",extensions:["x3dv"]},"x-conference/x-cooltalk":{source:"apache",extensions:["ice"]}},nJ={},nH={},nW=!1,nK=Symbol.for("effect/Encoding/errors/Decode"),nV=(e,t)=>{let r={_tag:"DecodeException",[nK]:nK,input:e};return"string"==typeof t&&(r.message=t),r},nG=new TextEncoder,nZ=e=>{let t="";for(let r=0;r<e.length;++r)t+=nQ[e[r]];return t},nQ=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],nY=e=>{if(48<=e&&e<=57)return e-48;if(97<=e&&e<=102)return e-97+10;if(65<=e&&e<=70)return e-65+10;throw TypeError("Invalid input")},nX=eG("effect/Redacted/redactedRegistry",()=>new WeakMap),n0=e=>{if(nX.has(e))return nX.get(e);throw Error("Unable to get redacted value")},n1={alphabet:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",minLength:0,blocklist:new Set(["0rgasm","1d10t","1d1ot","1di0t","1diot","1eccacu10","1eccacu1o","1eccacul0","1eccaculo","1mbec11e","1mbec1le","1mbeci1e","1mbecile","a11upat0","a11upato","a1lupat0","a1lupato","aand","ah01e","ah0le","aho1e","ahole","al1upat0","al1upato","allupat0","allupato","ana1","ana1e","anal","anale","anus","arrapat0","arrapato","arsch","arse","ass","b00b","b00be","b01ata","b0ceta","b0iata","b0ob","b0obe","b0sta","b1tch","b1te","b1tte","ba1atkar","balatkar","bastard0","bastardo","batt0na","battona","bitch","bite","bitte","bo0b","bo0be","bo1ata","boceta","boiata","boob","boobe","bosta","bran1age","bran1er","bran1ette","bran1eur","bran1euse","branlage","branler","branlette","branleur","branleuse","c0ck","c0g110ne","c0g11one","c0g1i0ne","c0g1ione","c0gl10ne","c0gl1one","c0gli0ne","c0glione","c0na","c0nnard","c0nnasse","c0nne","c0u111es","c0u11les","c0u1l1es","c0u1lles","c0ui11es","c0ui1les","c0uil1es","c0uilles","c11t","c11t0","c11to","c1it","c1it0","c1ito","cabr0n","cabra0","cabrao","cabron","caca","cacca","cacete","cagante","cagar","cagare","cagna","cara1h0","cara1ho","caracu10","caracu1o","caracul0","caraculo","caralh0","caralho","cazz0","cazz1mma","cazzata","cazzimma","cazzo","ch00t1a","ch00t1ya","ch00tia","ch00tiya","ch0d","ch0ot1a","ch0ot1ya","ch0otia","ch0otiya","ch1asse","ch1avata","ch1er","ch1ng0","ch1ngadaz0s","ch1ngadazos","ch1ngader1ta","ch1ngaderita","ch1ngar","ch1ngo","ch1ngues","ch1nk","chatte","chiasse","chiavata","chier","ching0","chingadaz0s","chingadazos","chingader1ta","chingaderita","chingar","chingo","chingues","chink","cho0t1a","cho0t1ya","cho0tia","cho0tiya","chod","choot1a","choot1ya","chootia","chootiya","cl1t","cl1t0","cl1to","clit","clit0","clito","cock","cog110ne","cog11one","cog1i0ne","cog1ione","cogl10ne","cogl1one","cogli0ne","coglione","cona","connard","connasse","conne","cou111es","cou11les","cou1l1es","cou1lles","coui11es","coui1les","couil1es","couilles","cracker","crap","cu10","cu1att0ne","cu1attone","cu1er0","cu1ero","cu1o","cul0","culatt0ne","culattone","culer0","culero","culo","cum","cunt","d11d0","d11do","d1ck","d1ld0","d1ldo","damn","de1ch","deich","depp","di1d0","di1do","dick","dild0","dildo","dyke","encu1e","encule","enema","enf01re","enf0ire","enfo1re","enfoire","estup1d0","estup1do","estupid0","estupido","etr0n","etron","f0da","f0der","f0ttere","f0tters1","f0ttersi","f0tze","f0utre","f1ca","f1cker","f1ga","fag","fica","ficker","figa","foda","foder","fottere","fotters1","fottersi","fotze","foutre","fr0c10","fr0c1o","fr0ci0","fr0cio","fr0sc10","fr0sc1o","fr0sci0","fr0scio","froc10","froc1o","froci0","frocio","frosc10","frosc1o","frosci0","froscio","fuck","g00","g0o","g0u1ne","g0uine","gandu","go0","goo","gou1ne","gouine","gr0gnasse","grognasse","haram1","harami","haramzade","hund1n","hundin","id10t","id1ot","idi0t","idiot","imbec11e","imbec1le","imbeci1e","imbecile","j1zz","jerk","jizz","k1ke","kam1ne","kamine","kike","leccacu10","leccacu1o","leccacul0","leccaculo","m1erda","m1gn0tta","m1gnotta","m1nch1a","m1nchia","m1st","mam0n","mamahuev0","mamahuevo","mamon","masturbat10n","masturbat1on","masturbate","masturbati0n","masturbation","merd0s0","merd0so","merda","merde","merdos0","merdoso","mierda","mign0tta","mignotta","minch1a","minchia","mist","musch1","muschi","n1gger","neger","negr0","negre","negro","nerch1a","nerchia","nigger","orgasm","p00p","p011a","p01la","p0l1a","p0lla","p0mp1n0","p0mp1no","p0mpin0","p0mpino","p0op","p0rca","p0rn","p0rra","p0uff1asse","p0uffiasse","p1p1","p1pi","p1r1a","p1rla","p1sc10","p1sc1o","p1sci0","p1scio","p1sser","pa11e","pa1le","pal1e","palle","pane1e1r0","pane1e1ro","pane1eir0","pane1eiro","panele1r0","panele1ro","paneleir0","paneleiro","patakha","pec0r1na","pec0rina","pecor1na","pecorina","pen1s","pendej0","pendejo","penis","pip1","pipi","pir1a","pirla","pisc10","pisc1o","pisci0","piscio","pisser","po0p","po11a","po1la","pol1a","polla","pomp1n0","pomp1no","pompin0","pompino","poop","porca","porn","porra","pouff1asse","pouffiasse","pr1ck","prick","pussy","put1za","puta","puta1n","putain","pute","putiza","puttana","queca","r0mp1ba11e","r0mp1ba1le","r0mp1bal1e","r0mp1balle","r0mpiba11e","r0mpiba1le","r0mpibal1e","r0mpiballe","rand1","randi","rape","recch10ne","recch1one","recchi0ne","recchione","retard","romp1ba11e","romp1ba1le","romp1bal1e","romp1balle","rompiba11e","rompiba1le","rompibal1e","rompiballe","ruff1an0","ruff1ano","ruffian0","ruffiano","s1ut","sa10pe","sa1aud","sa1ope","sacanagem","sal0pe","salaud","salope","saugnapf","sb0rr0ne","sb0rra","sb0rrone","sbattere","sbatters1","sbattersi","sborr0ne","sborra","sborrone","sc0pare","sc0pata","sch1ampe","sche1se","sche1sse","scheise","scheisse","schlampe","schwachs1nn1g","schwachs1nnig","schwachsinn1g","schwachsinnig","schwanz","scopare","scopata","sexy","sh1t","shit","slut","sp0mp1nare","sp0mpinare","spomp1nare","spompinare","str0nz0","str0nza","str0nzo","stronz0","stronza","stronzo","stup1d","stupid","succh1am1","succh1ami","succhiam1","succhiami","sucker","t0pa","tapette","test1c1e","test1cle","testic1e","testicle","tette","topa","tr01a","tr0ia","tr0mbare","tr1ng1er","tr1ngler","tring1er","tringler","tro1a","troia","trombare","turd","twat","vaffancu10","vaffancu1o","vaffancul0","vaffanculo","vag1na","vagina","verdammt","verga","w1chsen","wank","wichsen","x0ch0ta","x0chota","xana","xoch0ta","xochota","z0cc01a","z0cc0la","z0cco1a","z0ccola","z1z1","z1zi","ziz1","zizi","zocc01a","zocc0la","zocco1a","zoccola"])};class n2{constructor(e){var t,r,n;const i=null!=(t=null==e?void 0:e.alphabet)?t:n1.alphabet,s=null!=(r=null==e?void 0:e.minLength)?r:n1.minLength,a=null!=(n=null==e?void 0:e.blocklist)?n:n1.blocklist;if(new Blob([i]).size!==i.length)throw Error("Alphabet cannot contain multibyte characters");if(i.length<3)throw Error("Alphabet length must be at least 3");if(new Set(i).size!==i.length)throw Error("Alphabet must contain unique characters");if("number"!=typeof s||s<0||s>255)throw Error("Minimum length has to be between 0 and 255");const o=new Set,l=i.toLowerCase().split("");for(const e of a)if(e.length>=3){const t=e.toLowerCase(),r=t.split("");r.filter(e=>l.includes(e)).length===r.length&&o.add(t)}this.alphabet=this.shuffle(i),this.minLength=s,this.blocklist=o}encode(e){if(0===e.length)return"";if(e.filter(e=>e>=0&&e<=this.maxValue()).length!==e.length)throw Error(`Encoding supports numbers between 0 and ${this.maxValue()}`);return this.encodeNumbers(e)}decode(e){let t=[];if(""===e)return t;let r=this.alphabet.split("");for(let n of e.split(""))if(!r.includes(n))return t;let n=e.charAt(0),i=this.alphabet.indexOf(n),s=this.alphabet.slice(i)+this.alphabet.slice(0,i);s=s.split("").reverse().join("");let a=e.slice(1);for(;a.length>0;){let e=s.slice(0,1),r=a.split(e);if(r.length>0){if(""===r[0])return t;t.push(this.toNumber(r[0],s.slice(1))),r.length>1&&(s=this.shuffle(s))}a=r.slice(1).join(e)}return t}encodeNumbers(e,t=0){if(t>this.alphabet.length)throw Error("Reached max attempts to re-generate the ID");let r=e.reduce((e,t,r)=>this.alphabet[t%this.alphabet.length].codePointAt(0)+r+e,e.length)%this.alphabet.length;r=(r+t)%this.alphabet.length;let n=this.alphabet.slice(r)+this.alphabet.slice(0,r),i=n.charAt(0);n=n.split("").reverse().join("");let s=[i];for(let t=0;t!==e.length;t++){let r=e[t];s.push(this.toId(r,n.slice(1))),t<e.length-1&&(s.push(n.slice(0,1)),n=this.shuffle(n))}let a=s.join("");if(this.minLength>a.length)for(a+=n.slice(0,1);this.minLength-a.length>0;)n=this.shuffle(n),a+=n.slice(0,Math.min(this.minLength-a.length,n.length));return this.isBlockedId(a)&&(a=this.encodeNumbers(e,t+1)),a}shuffle(e){let t=e.split("");for(let e=0,r=t.length-1;r>0;e++,r--){let n=(e*r+t[e].codePointAt(0)+t[r].codePointAt(0))%t.length;[t[e],t[n]]=[t[n],t[e]]}return t.join("")}toId(e,t){let r=[],n=t.split(""),i=e;do r.unshift(n[i%n.length]),i=Math.floor(i/n.length);while(i>0)return r.join("")}toNumber(e,t){let r=t.split("");return e.split("").reduce((e,t)=>e*r.length+r.indexOf(t),0)}isBlockedId(e){let t=e.toLowerCase();for(let e of this.blocklist)if(e.length<=t.length){if(t.length<=3||e.length<=3){if(t===e)return!0}else if(/\d/.test(e)){if(t.startsWith(e)||t.endsWith(e))return!0}else if(t.includes(e))return!0}return!1}maxValue(){return Number.MAX_SAFE_INTEGER}}var n3=class extends nB("InvalidRouteConfig"){constructor(e,t){super({reason:t?`Expected route config to have a ${t} for key ${e} but none was found.`:`Encountered an invalid route config during backfilling. ${e} was not found.`})}},n5=class extends nB("UnknownFileType"){constructor(e){super({reason:`Could not determine type for ${e}`})}},n4=class extends nB("InvalidFileType"){constructor(e,t){super({reason:`File type ${e} not allowed for ${t}`})}},n6=class extends nB("InvalidFileSize"){constructor(e){super({reason:`Invalid file size: ${e}`})}};function n8(e){return{maxFileSize:"image"===e?"4MB":"video"===e?"16MB":"audio"===e||"blob"===e?"8MB":"pdf"===e?"4MB":"text"===e?"64KB":"4MB",maxFileCount:1,minFileCount:1,contentDisposition:"inline"}}nB("InvalidURL"),nB("RetryError"),nB("FetchError"),nB("InvalidJson"),nB("BadRequestError"),nB("UploadAborted"),nB("UploadAborted");let n7=e=>{if(Array.isArray(e))return rW(e.reduce((e,t)=>(e[t]=n8(t),e),{}));let t={};for(let r of ir(e)){let n=e[r];if(!n)return rV(new n3(r));t[r]={...n8(r),...n}}return rW(JSON.parse(JSON.stringify(t,ii)))},n9=(e,t)=>{let r=e.type||function(e){var t;let r;if(!e||"string"!=typeof e)return!1;let n=((r=(t="x."+e).lastIndexOf("."))<0?"":t.substring(r)).toLowerCase().substring(1);return!!n&&((function(e,t){if(nW)return;nW=!0;let r=["nginx","apache",void 0,"iana"];Object.keys(nq).forEach(n=>{let i=nq[n],s=i.extensions;if(s.length)for(let a of(e[n]=s,s)){if(a in t){let e=r.indexOf(nq[t[a]].source),n=r.indexOf(i.source);if("application/octet-stream"!==t[a]&&(e>n||e===n&&t[a].startsWith("application/")))continue}t[a]=n}})}(nJ,nH),nH)[n]||!1)}(e.name);if(!r)return t.includes("blob")?rW("blob"):rV(new n5(e.name));if(t.some(e=>e.includes("/"))&&t.includes(r))return rW(r);let n="application/pdf"===r.toLowerCase()?"pdf":r.split("/")[0];if(!t.includes(n))if(t.includes("blob"))return rW("blob");else return rV(new n4(n,e.name));return rW(n)},ie=["B","KB","MB","GB","TB"],it=e=>{let t=RegExp(`^(\\d+)(\\.\\d+)?\\s*(${ie.join("|")})$`,"i"),r=e.match(t);if(!r?.[1]||!r[3])return rV(new n6(e));let n=parseFloat(r[1]),i=r[3].toUpperCase();return rW(Math.floor(n*Math.pow(1024,ie.indexOf(i))))};function ir(e){return Object.keys(e)}let ii=(e,t)=>"number"!=typeof t||Number.isSafeInteger(t)||t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER?t:t===1/0?Number.MAX_SAFE_INTEGER:t===-1/0?Number.MIN_SAFE_INTEGER:Number.isNaN(t)?0:void 0,is={BAD_REQUEST:400,NOT_FOUND:404,FORBIDDEN:403,INTERNAL_SERVER_ERROR:500,INTERNAL_CLIENT_ERROR:500,TOO_LARGE:413,TOO_SMALL:400,TOO_MANY_FILES:400,KEY_TOO_LONG:400,URL_GENERATION_FAILED:500,UPLOAD_FAILED:500,MISSING_ENV:500,INVALID_SERVER_CONFIG:500,FILE_LIMIT_EXCEEDED:500};var ia=class e extends nU{_tag="UploadThingError";name="UploadThingError";cause;code;data;constructor(e){const t="string"==typeof e?{code:"INTERNAL_SERVER_ERROR",message:e}:e;(super({message:t.message??function(e,t){return"string"==typeof e?e:e instanceof Error||e&&"object"==typeof e&&"message"in e&&"string"==typeof e.message?e.message:t??"An unknown error occurred"}(t.cause,t.code)}),this.code=t.code,this.data=t.data,t.cause instanceof Error)?this.cause=t.cause:(e=>eZ(e)&&!Array.isArray(e))(t.cause)&&"number"==typeof t.cause.status&&"string"==typeof t.cause.statusText?this.cause=Error(`Response ${t.cause.status} ${t.cause.statusText}`):"string"==typeof t.cause?this.cause=Error(t.cause):this.cause=t.cause}static toObject(e){return{code:e.code,message:e.message,data:e.data}}static serialize(t){return JSON.stringify(e.toObject(t))}};(W="uploadthing/Fetch",()=>{let e=Error.stackTraceLimit;Error.stackTraceLimit=2;let t=Error();function r(){}return Error.stackTraceLimit=e,Object.setPrototypeOf(r,rn),r.key=W,Object.defineProperty(r,"stack",{get:()=>t.stack}),r})();let io={name:"HMAC",hash:"SHA-256"},il=new TextEncoder,iu=(e,t,r)=>r4(function*(){let n,i=t?.slice(12);if(!i)return!1;let s=il.encode(n0(r)),a=yield*rX(()=>crypto.subtle.importKey("raw",s,io,!1,["verify"])),o=yield*"Right"===(n=(e=>{let t=new TextEncoder().encode(e);if(t.length%2!=0)return t$(nV(e,`Length must be a multiple of 2, but is ${t.length}`));try{let e=t.length/2,r=new Uint8Array(e);for(let n=0;n<e;n++){let e=nY(t[2*n]),i=nY(t[2*n+1]);r[n]=e<<4|i}return tz(r)}catch(t){return t$(nV(e,t instanceof Error?t.message:"Invalid input"))}})(i))._tag?rW(n.right):rV(n.left),l=il.encode(e);return yield*rX(()=>crypto.subtle.verify(io,a,o,l))}).pipe(nw("verifySignature"),n_(()=>!1)),ic=function(e,t){if("function"==typeof e)return function(){return e(arguments)?t.apply(this,arguments):e=>t(e,...arguments)};switch(e){case 0:case 1:throw RangeError(`Invalid arity ${e}`);case 2:return function(e,r){return arguments.length>=2?t(e,r):function(r){return t(r,e)}};case 3:return function(e,r,n){return arguments.length>=3?t(e,r,n):function(n){return t(n,e,r)}};case 4:return function(e,r,n,i){return arguments.length>=4?t(e,r,n,i):function(i){return t(i,e,r,n)}};case 5:return function(e,r,n,i,s){return arguments.length>=5?t(e,r,n,i,s):function(s){return t(s,e,r,n,i)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(e){return t(e,...r)}}}},ih=e=>e,ip=e=>()=>e,id=ip(!0),ig=ip(!1),im=ip(void 0);function ib(e,t,r,n,i,s,a,o,l){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return n(r(t(e)));case 5:return i(n(r(t(e))));case 6:return s(i(n(r(t(e)))));case 7:return a(s(i(n(r(t(e))))));case 8:return o(a(s(i(n(r(t(e)))))));case 9:return l(o(a(s(i(n(r(t(e))))))));default:{let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return e}}}let iy=e=>(t,r)=>t===r||e(t,r),iv=(e,t)=>e===t,iS=ic(2,(e,t)=>iy((r,n)=>e(t(r),t(n)))),ix=iS(iv,e=>e.getTime()),i_=e=>iy((t,r)=>{if(t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}),iw="effect/GlobalValue",ik=(e,t)=>(r||(globalThis[iw]??=new Map,r=globalThis[iw]),r.has(e)||r.set(e,t()),r.get(e)),iO=e=>"string"==typeof e,iE=e=>"number"==typeof e,iC=e=>"boolean"==typeof e,iF=e=>"bigint"==typeof e,iI=e=>"symbol"==typeof e,iT=e=>void 0===e,iR=e=>void 0!==e,iN=e=>null!==e,iM=e=>!1,iA=e=>"object"==typeof e&&null!==e,ij=e=>iA(e)||"function"==typeof e,iD=ic(2,(e,t)=>ij(e)&&t in e),iP=ic(2,(e,t)=>iD(e,"_tag")&&e._tag===t),i$=e=>null!=e,iz=e=>e instanceof Uint8Array,iL=e=>e instanceof Date,iU=e=>iD(e,"then")&&"function"==typeof e.then,iB=e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`,iq=Symbol.for("effect/Gen/GenKind");Symbol.iterator;class iJ{self;called=!1;constructor(e){this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(e){return{value:e,done:!0}}throw(e){throw e}[Symbol.iterator](){return new iJ(this.self)}}class iH{_state;constructor(e,t,r,n){return null==t&&null==e?(t=0xffffffff*Math.random()>>>0,e=0):null==t&&(t=e,e=0),null==n&&null==r?(n=this._state?this._state[3]:0xf767814f,r=this._state?this._state[2]:0x14057b7e):null==n&&(n=r,r=0),this._state=new Int32Array([0,0,r>>>0,(1|(n||0))>>>0]),this._next(),iW(this._state,this._state[0],this._state[1],e>>>0,t>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(e){this._state[0]=e[0],this._state[1]=e[1],this._state[2]=e[2],this._state[3]=1|e[3]}integer(e){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%e}number(){return(0x8000000*((0x3ffffff&this._next())*1)+(0x7ffffff&this._next())*1)/0x20000000000000}_next(){var e,t,r;let n,i,s,a,o=this._state[0]>>>0,l=this._state[1]>>>0;e=this._state,t=o,n=((r=l)>>>16)*32557>>>0,i=(65535&r)*19605>>>0,s=(65535&r)*32557>>>0,a=(r>>>16)*19605+((i>>>16)+(n>>>16))>>>0,(s=s+(i=i<<16>>>0)>>>0)>>>0<i>>>0&&(a=a+1>>>0),(s=s+(n=n<<16>>>0)>>>0)>>>0<n>>>0&&(a=a+1>>>0),a=(a=a+Math.imul(r,0x5851f42d)>>>0)+Math.imul(t,0x4c957f2d)>>>0,e[0]=a,e[1]=s,iW(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let u=o>>>18,c=(l>>>18|o<<14)>>>0;u=(u^o)>>>0;let h=((c=(c^l)>>>0)>>>27|u<<5)>>>0,f=o>>>27;return(h>>>f|h<<((-f>>>0&31)>>>0))>>>0}}function iW(e,t,r,n,i){let s=t+n>>>0,a=r+i>>>0;a>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=a}let iK=Symbol.for("effect/Utils/YieldWrap");class iV{#e;constructor(e){this.#e=e}[iK](){return this.#e}}let iG=ik("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),iZ=e=>e(),iQ=iZ(()=>Error().stack)?.includes("effect_internal_function")===!0?iZ:e=>e(),iY=(function*(){}).constructor,iX=ik(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),i0=Symbol.for("effect/Hash"),i1=e=>{if(!0===iG.enabled)return 0;switch(typeof e){case"number":return i6(e);case"bigint":return i8(e.toString(10));case"boolean":case"symbol":return i8(String(e));case"string":return i8(e);case"undefined":return i8("undefined");case"function":case"object":if(null===e)return i8("null");if(e instanceof Date)return i1(e.toISOString());if(e instanceof URL)return i1(e.href);else if(i4(e))return e[i0]();else return i2(e);default:throw Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},i2=e=>(iX.has(e)||iX.set(e,i6(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),iX.get(e)),i3=e=>t=>53*t^e,i5=e=>0xbfffffff&e|e>>>1&0x40000000,i4=e=>iD(e,i0),i6=e=>{if(e!=e||e===1/0)return 0;let t=0|e;for(t!==e&&(t^=0xffffffff*e);e>0xffffffff;)t^=e/=0xffffffff;return i5(t)},i8=e=>{let t=5381,r=e.length;for(;r;)t=33*t^e.charCodeAt(--r);return i5(t)},i7=e=>((e,t)=>{let r=12289;for(let n=0;n<t.length;n++)r^=ib(i8(t[n]),i3(i1(e[t[n]])));return i5(r)})(e,Object.keys(e)),i9=e=>{let t=6151;for(let r=0;r<e.length;r++)t=ib(t,i3(i1(e[r])));return i5(t)},se=function(){if(1==arguments.length){let e=arguments[0];return function(t){return Object.defineProperty(e,i0,{value:()=>t,enumerable:!1}),t}}let e=arguments[0],t=arguments[1];return Object.defineProperty(e,i0,{value:()=>t,enumerable:!1}),t},st=Symbol.for("effect/Equal");function sr(){return 1==arguments.length?e=>sn(e,arguments[0]):sn(arguments[0],arguments[1])}function sn(e,t){if(e===t)return!0;let r=typeof e;if(r!==typeof t)return!1;if("object"===r||"function"===r){if(null!==e&&null!==t){if(si(e)&&si(t))if(i1(e)===i1(t)&&e[st](t))return!0;else return!!iG.enabled&&!!iG.tester&&iG.tester(e,t);else if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString();else if(e instanceof URL&&t instanceof URL)return e.href===t.href}if(iG.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((e,r)=>sn(e,t[r]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){let r=Object.keys(e),n=Object.keys(t);if(r.length===n.length){for(let n of r)if(!(n in t&&sn(e[n],t[n])))return!!iG.tester&&iG.tester(e,t);return!0}}return!!iG.tester&&iG.tester(e,t)}}return!!iG.enabled&&!!iG.tester&&iG.tester(e,t)}let si=e=>iD(e,st),ss=Symbol.for("nodejs.util.inspect.custom"),sa=e=>{try{let t;if(iD(e,"toJSON")&&(t=e.toJSON,"function"==typeof t)&&0===e.toJSON.length)return e.toJSON();if(Array.isArray(e))return e.map(sa)}catch{return{}}return sf(e)},so=(e,t=2)=>{if("string"==typeof e)return e;try{return"object"==typeof e?sl(e,t):String(e)}catch{return String(e)}},sl=(e,t)=>{let r=[],n=JSON.stringify(e,(e,t)=>"object"==typeof t&&null!==t?r.includes(t)?void 0:r.push(t)&&(void 0!==sh.fiberRefs&&sc(t)?t[su](sh.fiberRefs):t):t,t);return r=void 0,n},su=Symbol.for("effect/Inspectable/Redactable"),sc=e=>"object"==typeof e&&null!==e&&su in e,sh=ik("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),sf=e=>sc(e)&&void 0!==sh.fiberRefs?e[su](sh.fiberRefs):e,sp=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let e=0,n=t.length;e<n;e++)r=t[e](r);return r}}},sd="Async",sg="Commit",sm="Failure",sb="OnFailure",sy="OnSuccess",sv="OnSuccessAndFailure",sS="Success",sx="Sync",s_="UpdateRuntimeFlags",sw="While",sk="Iterator",sO="WithRuntime",sE="Yield",sC="RevertFlags",sF=()=>"3.17.7",sI=Symbol.for("effect/Effect"),sT=Symbol.for("effect/Stream"),sR=Symbol.for("effect/Sink"),sN=Symbol.for("effect/Channel"),sM={_R:e=>e,_E:e=>e,_A:e=>e,_V:sF()},sA={[sI]:sM,[sT]:sM,[sR]:{_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},[sN]:{_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},[st](e){return this===e},[i0](){return se(this,i2(this))},[Symbol.iterator](){return new iJ(new iV(this))},pipe(){return sp(this,arguments)}},sj={[i0](){return se(this,i7(this))},[st](e){let t=Object.keys(this),r=Object.keys(e);if(t.length!==r.length)return!1;for(let r of t)if(!(r in e&&sr(this[r],e[r])))return!1;return!0}},sD={...sA,_op:sg},sP={...sD,...sj},s$=function(){function e(){}return e.prototype=sD,e}(),sz=Symbol.for("effect/Option"),sL={...sA,[sz]:{_A:e=>e},[ss](){return this.toJSON()},toString(){return JSON.stringify(this.toJSON(),null,2)}},sU=Object.assign(Object.create(sL),{_tag:"Some",_op:"Some",[st](e){return sJ(e)&&sW(e)&&sr(this.value,e.value)},[i0](){return se(this,i3(i1(this._tag))(i1(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:sa(this.value)}}}),sB=i1("None"),sq=Object.assign(Object.create(sL),{_tag:"None",_op:"None",[st]:e=>sJ(e)&&sH(e),[i0]:()=>sB,toJSON(){return{_id:"Option",_tag:this._tag}}}),sJ=e=>iD(e,sz),sH=e=>"None"===e._tag,sW=e=>"Some"===e._tag,sK=Object.create(sq),sV=e=>{let t=Object.create(sU);return t.value=e,t},sG=Symbol.for("effect/Either"),sZ={...sA,[sG]:{_R:e=>e},[ss](){return this.toJSON()},toString(){return JSON.stringify(this.toJSON(),null,2)}},sQ=Object.assign(Object.create(sZ),{_tag:"Right",_op:"Right",[st](e){return sX(e)&&s1(e)&&sr(this.right,e.right)},[i0](){return i3(i1(this._tag))(i1(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:sa(this.right)}}}),sY=Object.assign(Object.create(sZ),{_tag:"Left",_op:"Left",[st](e){return sX(e)&&s0(e)&&sr(this.left,e.left)},[i0](){return i3(i1(this._tag))(i1(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:sa(this.left)}}}),sX=e=>iD(e,sG),s0=e=>"Left"===e._tag,s1=e=>"Right"===e._tag,s2=e=>{let t=Object.create(sY);return t.left=e,t},s3=e=>{let t=Object.create(sQ);return t.right=e,t},s5=ic(2,(e,t)=>sH(e)?s2(t()):s3(e.value)),s4=ic(2,(e,{onLeft:t,onRight:r})=>s0(e)?s2(t(e.left)):s3(r(e.right))),s6=ic(2,(e,t)=>s0(e)?s2(t(e.left)):s3(e.right)),s8=ic(2,(e,t)=>s1(e)?s3(t(e.right)):s2(e.left)),s7=ic(2,(e,{onLeft:t,onRight:r})=>s0(e)?t(e.left):r(e.right)),s9=s7({onLeft:ih,onRight:ih}),ae=ic(2,(e,t)=>{if(s1(e))return e.right;throw t(e.left)}),at=ae(()=>Error("getOrThrow called on a Left")),ar=ic(2,(e,t)=>s0(e)?s2(e.left):t(e.right)),an=((e,t,r)=>ar(e,e=>s8(t,t=>r(e,t))),e=>e.length>0),ai=e=>(t,r)=>t===r?0:e(t,r),as=ai((e,t)=>e<t?-1:1),aa=ai((e,t)=>e<t?-1:1),ao=ic(2,(e,t)=>ai((r,n)=>e(t(r),t(n)))),al=e=>ic(2,(t,r)=>1===e(t,r)),au=e=>ic(2,(t,r)=>t===r||1>e(t,r)?t:r),ac=e=>ic(2,(t,r)=>t===r||e(t,r)>-1?t:r),ah=()=>sK,af=ic(2,(e,{onNone:t,onSome:r})=>sH(e)?t():r(e.value)),ap=ic(2,(e,t)=>sH(e)?t():e.value),ad=ic(2,(e,t)=>sH(e)?t():e),ag=ic(2,(e,t)=>sH(e)?sV(t()):e),am=e=>null==e?ah():sV(e),ab=ap(im),ay=e=>(...t)=>{try{return sV(e(...t))}catch{return ah()}},av=ic(2,(e,t)=>{if(sW(e))return e.value;throw t()}),aS=av(()=>Error("getOrThrow called on a None")),ax=ic(2,(e,t)=>sH(e)?ah():sV(t(e.value))),a_=ic(2,(e,t)=>sH(e)?ah():t(e.value)),aw=ic(2,(e,t)=>sH(e)?ah():am(t(e.value))),ak=((e,t)=>a_(e,e=>ax(t(e),()=>e)),ic(2,(e,t)=>a_(e,e=>t(e)?sV(e):sK))),aO=e=>iy((t,r)=>sH(t)?sH(r):!sH(r)&&e(t.value,r.value)),aE=ic(2,(e,t)=>!sH(e)&&sr(e.value,t)),aC=ic(2,(e,t)=>!sH(e)&&t(e.value)),aF=e=>(t,r)=>sH(t)?r:sH(r)?t:sV(e(t.value,r.value)),aI=(...e)=>e,aT=((e,t)=>aT(t,e),ic(2,(e,t)=>({[Symbol.iterator](){let r,n=e[Symbol.iterator](),i=!1;return{next(){if(!i){let e=n.next();return e.done?(i=!0,(r=t[Symbol.iterator]()).next()):e}return r.next()}}}}))),aR=ic(2,(e,t)=>{let r=0;for(let n of e){let e=t(n,r);if(iC(e)){if(e)return sV(n)}else if(sW(e))return e;r++}return ah()});(e,t,r)=>({[Symbol.iterator](){let n=e[Symbol.iterator](),i=t[Symbol.iterator]();return{next(){let e=n.next(),t=i.next();return e.done||t.done?{done:!0,value:void 0}:{done:!1,value:r(e.value,t.value)}}}}});let aN=ic(2,(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),n=0;return{next(){let e=r.next();return e.done?{done:!0,value:void 0}:{done:!1,value:t(e.value,n++)}}}}})),aM=ic(2,(e,t)=>aA(aN(e,t))),aA=e=>({[Symbol.iterator](){let t,r=e[Symbol.iterator]();return{next:function e(){if(void 0===t){let e=r.next();if(e.done)return e;t=e.value[Symbol.iterator]()}let n=t.next();return n.done?(t=void 0,e()):n}}}});(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),n=0;return{next(){let e=r.next();for(;!e.done;){let i=t(e.value,n++);if(sW(i))return{done:!1,value:i.value};e=r.next()}return{done:!0,value:void 0}}}}});(e,t,r)=>aM(e,e=>aN(t,t=>r(e,t)));let aj=ic(2,(e,t)=>Object.prototype.hasOwnProperty.call(e,t));(e,t,r)=>aj(e,t)?sV({...e,[t]:r(e[t])}):ah(),(e,t)=>{if(!aj(e,t))return{...e};let r={...e};return delete r[t],r};let aD=(...e)=>e,aP=ic(2,(e,t)=>{let r=Math.max(1,Math.floor(e)),n=Array(r);for(let e=0;e<r;e++)n[e]=t(e);return n}),a$=e=>Array.isArray(e)?e:Array.from(e),az=e=>Array.isArray(e)?e:[e],aL=ic(2,(e,{onEmpty:t,onNonEmpty:r})=>aW(e)?r(e):t()),aU=ic(2,(e,{onEmpty:t,onNonEmpty:r})=>aW(e)?r(aY(e),a1(e)):t()),aB=ic(2,(e,t)=>[t,...e]),aq=ic(2,(e,t)=>[...e,t]),aJ=ic(2,(e,t)=>a$(e).concat(a$(t))),aH=Array.isArray,aW=an,aK=(e,t)=>e<0||e>=t.length,aV=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),aG=ic(2,(e,t)=>{let r=Math.floor(t);return aK(r,e)?ah():sV(e[r])}),aZ=ic(2,(e,t)=>{let r=Math.floor(t);if(aK(r,e))throw Error(`Index ${r} out of bounds`);return e[r]}),aQ=aG(0),aY=aZ(0),aX=e=>aW(e)?sV(a0(e)):ah(),a0=e=>e[e.length-1],a1=e=>e.slice(1),a2=((e,t)=>{let r=a$(e);return r.slice(0,aV(t,r))},ic(2,(e,t)=>or(e,((e,t)=>{let r=0;for(let n of e){if(!t(n,r))break;r++}return r})(e,t)))),a3=ic(2,(e,t)=>{let r=a$(e);return r.slice(aV(t,r),r.length)}),a5=ic(3,(e,t,r)=>{let n=Array.from(e);if(aK(t,n))return n;let i=r(n[t]);return n[t]=i,n}),a4=((e,t,r)=>{let n=a$(e);if(aK(t,n))return ah();let i=Array.isArray(e)?e.slice():n,s=r(n[t]);return i[t]=s,sV(i)},e=>Array.from(e).reverse()),a6=ic(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r}),a8=ic(2,(e,t)=>a7(e,t,aI)),a7=ic(3,(e,t,r)=>{let n=a$(e),i=a$(t);if(aW(n)&&aW(i)){let e=[r(aY(n),aY(i))],t=Math.min(n.length,i.length);for(let s=1;s<t;s++)e[s]=r(n[s],i[s]);return e}return[]}),a9=((e,t)=>[t(aY(e)),...a1(e)],ic(2,(e,t)=>{let r=a$(e);if(aW(r)){let n=r.length,i=Math.round(t)%n;if(aK(Math.abs(i),r)||0===i)return oi(r);if(!(i<0))return a9(e,i-n);{let[e,t]=on(r,-i);return aJ(t,e)}}return[]})),oe=e=>ic(2,(t,r)=>{for(let n of t)if(e(r,n))return!0;return!1}),ot=ic(2,(e,t)=>{let r=a$(e);if(aW(r)){let[e,n]=t(r),i=[e],s=n;for(;an(s);){let[e,r]=t(s);i.push(e),s=r}return i}return[]}),or=ic(2,(e,t)=>{let r=Array.from(e),n=Math.floor(t);return aW(r)?n>=1?on(r,n):[[],r]:[r,[]]}),on=ic(2,(e,t)=>{let r=Math.max(1,Math.floor(t));return r>=e.length?[oi(e),[]]:[aB(e.slice(1,r),aY(e)),e.slice(r)]}),oi=e=>e.slice();(e,t)=>{let r=a$(e);return aW(r)?ot(r,on(t)):[]};let os=ic(3,(e,t,r)=>{let n=a$(e),i=a$(t);return aW(n)?aW(i)?ow(r)(aJ(n,i)):n:i}),oa=ic(2,(e,t)=>os(e,t,sr)),oo=e=>{let t=oe(e);return ic(2,(e,r)=>a$(e).filter(e=>t(r,e)))},ol=oo(sr),ou=(o=oe(sr),ic(2,(e,t)=>a$(e).filter(e=>!o(t,e))),()=>[]),oc=e=>[e],oh=ic(2,(e,t)=>e.map(t)),of=ic(2,(e,t)=>{if(0===e.length)return[];let r=[];for(let n=0;n<e.length;n++){let i=t(e[n],n);for(let e=0;e<i.length;e++)r.push(i[e])}return r}),op=of(ih),od=ic(2,(e,t)=>{let r=a$(e),n=[];for(let e=0;e<r.length;e++){let i=t(r[e],e);sW(i)&&n.push(i.value)}return n}),og=ic(2,(e,t)=>{let r=0,n=[];for(let i of e){let e=t(i,r);if(sW(e))n.push(e.value);else break;r++}return n}),om=ic(2,(e,t)=>{let r=[],n=[],i=a$(e);for(let e=0;e<i.length;e++){let s=t(i[e],e);s0(s)?r.push(s.left):n.push(s.right)}return[r,n]}),ob=od(ih),oy=ic(2,(e,t)=>{let r=a$(e),n=[];for(let e=0;e<r.length;e++)t(r[e],e)&&n.push(r[e]);return n}),ov=((e,t)=>{let r=[],n=[],i=a$(e);for(let e=0;e<i.length;e++)t(i[e],e)?n.push(i[e]):r.push(i[e]);return[r,n]},ic(3,(e,t,r)=>a$(e).reduce((e,t,n)=>r(e,t,n),t))),oS=ic(3,(e,t,r)=>a$(e).reduceRight((e,t,n)=>r(e,t,n),t)),ox=((e,t)=>e.every(t),(e,t)=>{let r,n=[],i=e;for(;sW(r=t(i));){let[e,t]=r.value;n.push(e),i=t}return n}),o_=i_,ow=ic(2,(e,t)=>{let r=a$(e);if(aW(r)){let e=[aY(r)];for(let n of a1(r))e.every(e=>!t(n,e))&&e.push(n);return e}return[]}),ok=e=>ow(e,sr),oO=ic(2,(e,t)=>a$(e).join(t)),oE=ic(3,(e,t,r)=>{let n=0,i=t,s=[];for(let t of e){let e=r(i,t,n);i=e[0],s.push(e[1]),n++}return[i,s]}),oC=((e,t,r)=>of(e,e=>oh(t,t=>r(e,t))),/^[+-]?\d+$/),oF=Symbol.for("effect/BigDecimal"),oI={[oF]:oF,[i0](){let e=oP(this);return ib(i1(e.value),i3(i6(e.scale)),se(this))},[st](e){return oT(e)&&oH(this,e)},toString(){return`BigDecimal(${oW(this)})`},toJSON(){return{_id:"BigDecimal",value:String(this.value),scale:this.scale}},[ss](){return this.toJSON()},pipe(){return sp(this,arguments)}},oT=e=>iD(e,oF),oR=(e,t)=>{let r=Object.create(oI);return r.value=e,r.scale=t,r},oN=(e,t)=>{if(e!==oM&&e%oj===oM)throw RangeError("Value must be normalized");let r=oR(e,t);return r.normalized=r,r},oM=BigInt(0),oA=BigInt(1),oj=BigInt(10),oD=oN(oM,0),oP=e=>{if(void 0===e.normalized)if(e.value===oM)e.normalized=oD;else{let t=`${e.value}`,r=0;for(let e=t.length-1;e>=0;e--)if("0"===t[e])r++;else break;0===r&&(e.normalized=e);let n=BigInt(t.substring(0,t.length-r)),i=e.scale-r;e.normalized=oN(n,i)}return e.normalized},o$=ic(2,(e,t)=>t>e.scale?oR(e.value*oj**BigInt(t-e.scale),t):t<e.scale?oR(e.value/oj**BigInt(e.scale-t),t):e),oz=ic(2,(e,t)=>t.value===oM?e:e.value===oM?t:e.scale>t.scale?oR(o$(t,e.scale).value+e.value,e.scale):e.scale<t.scale?oR(o$(e,t.scale).value+t.value,t.scale):oR(e.value+t.value,e.scale)),oL=ai((e,t)=>{let r=as(oq(e),oq(t));return 0!==r?r:e.scale>t.scale?aa(e.value,o$(t,e.scale).value):e.scale<t.scale?aa(o$(e,t.scale).value,t.value):aa(e.value,t.value)}),oU=(K=oL,ic(2,(e,t)=>-1===K(e,t))),oB=al(oL),oq=e=>e.value===oM?0:e.value<oM?-1:1,oJ=iy((e,t)=>e.scale>t.scale?o$(t,e.scale).value===e.value:e.scale<t.scale?o$(e,t.scale).value===t.value:e.value===t.value),oH=ic(2,(e,t)=>oJ(e,t)),oW=e=>{let t,r,n=oP(e);if(Math.abs(n.scale)>=16)return oK(n);let i=n.value<oM,s=i?`${n.value}`.substring(1):`${n.value}`;if(n.scale>=s.length)t="0",r="0".repeat(n.scale-s.length)+s;else{let e=s.length-n.scale;if(e>s.length){let n=e-s.length;t=`${s}${"0".repeat(n)}`,r=""}else r=s.slice(e),t=s.slice(0,e)}let a=""===r?t:`${t}.${r}`;return i?`-${a}`:a},oK=e=>{if(oV(e))return"0e+0";let t=oP(e),r=`${(t.value<oM?oR(-t.value,t.scale):t).value}`,n=r.slice(0,1),i=r.slice(1),s=`${oG(t)?"-":""}${n}`;""!==i&&(s+=`.${i}`);let a=i.length-t.scale;return`${s}e${a>=0?"+":""}${a}`},oV=e=>e.value===oM,oG=e=>e.value<oM,oZ=e=>oT(e[0]),oQ=((e,t=0)=>{let r=oQ(e,t);return e.value>oM&&oU(r,e)?oz(r,oR(1n,t)):r},ic(oZ,(e,t=0)=>e.scale<=t?e:oR(e.value/10n**BigInt(e.scale-t),t))),oY=((e,t)=>e.scale<t?0n:e.value/10n**BigInt(e.scale-t)%10n,BigInt(0)),oX=((e,t)=>{for(;t!==oY;){let r=t;t=e%t,e=r}return e},e=>{try{return""===e.trim()?ah():sV(BigInt(e))}catch{return ah()}}),o0=e=>!e,o1=((e,t)=>!e&&t||e&&!t,Symbol.for("effect/Chunk")),o2=[],o3=iy((e,t)=>e.length===t.length&&ln(e).every((e,r)=>sr(e,ll(t,r)))),o5={[o1]:{_A:e=>e},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"Chunk",values:ln(this).map(sa)}},[ss](){return this.toJSON()},[st](e){return o6(e)&&o3(this,e)},[i0](){return se(this,i9(ln(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return o2[Symbol.iterator]();default:return ln(this)[Symbol.iterator]()}},pipe(){return sp(this,arguments)}},o4=e=>{let t=Object.create(o5);switch(t.backing=e,e._tag){case"IEmpty":t.length=0,t.depth=0,t.left=t,t.right=t;break;case"IConcat":t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break;case"IArray":t.length=e.array.length,t.depth=0,t.left=o8,t.right=o8;break;case"ISingleton":t.length=1,t.depth=0,t.left=o8,t.right=o8;break;case"ISlice":t.length=e.length,t.depth=e.chunk.depth+1,t.left=o8,t.right=o8}return t},o6=e=>iD(e,o1),o8=o4({_tag:"IEmpty"}),o7=()=>o8,o9=(...e)=>lo(e),le=e=>o4({_tag:"ISingleton",a:e}),lt=e=>o6(e)?e:la(a$(e)),lr=(e,t,r)=>{switch(e.backing._tag){case"IArray":!function(e,t,r,n,i){for(let t=0;t<Math.min(e.length,0+i);t++)r[n+t-0]=e[t]}(e.backing.array,0,t,r,e.length);break;case"IConcat":lr(e.left,t,r),lr(e.right,t,r+e.left.length);break;case"ISingleton":t[r]=e.backing.a;break;case"ISlice":{let n=0,i=r;for(;n<e.length;)t[i]=ll(e,n),n+=1,i+=1}}},ln=e=>{switch(e.backing._tag){case"IEmpty":return o2;case"IArray":return e.backing.array;default:{let t=Array(e.length);return lr(e,t,0),e.backing={_tag:"IArray",array:t},e.left=o8,e.right=o8,e.depth=0,t}}},li=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return o4({_tag:"IArray",array:a4(e.backing.array)});case"IConcat":return o4({_tag:"IConcat",left:li(e.backing.right),right:li(e.backing.left)});case"ISlice":return la(a4(ln(e)))}},ls=ic(2,(e,t)=>t<0||t>=e.length?ah():sV(ll(e,t))),la=e=>0===e.length?o7():1===e.length?le(e[0]):o4({_tag:"IArray",array:e}),lo=e=>la(e),ll=ic(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw Error("Index out of bounds");case"ISingleton":if(0!==t)throw Error("Index out of bounds");return e.backing.a;case"IArray":if(t>=e.length||t<0)throw Error("Index out of bounds");return e.backing.array[t];case"IConcat":return t<e.left.length?ll(e.left,t):ll(e.right,t-e.left.length);case"ISlice":return ll(e.backing.chunk,t+e.backing.offset)}}),lu=ic(2,(e,t)=>ld(e,le(t))),lc=ic(2,(e,t)=>ld(le(t),e)),lh=ic(2,(e,t)=>{if(t<=0)return o8;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return o4({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":if(t>e.left.length)return o4({_tag:"IConcat",left:e.left,right:lh(e.right,t-e.left.length)});return lh(e.left,t);default:return o4({_tag:"ISlice",chunk:e,offset:0,length:t})}}),lf=ic(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return o8;switch(e.backing._tag){case"ISlice":return o4({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":if(t>e.left.length)return lf(e.right,t-e.left.length);return o4({_tag:"IConcat",left:lf(e.left,t),right:e.right});default:return o4({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}}),lp=ic(2,(e,t)=>{let r=ln(e),n=r.length,i=0;for(;i<n&&t(r[i]);)i++;return lf(e,i)}),ld=ic(2,(e,t)=>{if("IEmpty"===e.backing._tag)return t;if("IEmpty"===t.backing._tag)return e;let r=t.depth-e.depth;if(1>=Math.abs(r))return o4({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let r=ld(e.right,t);return o4({_tag:"IConcat",left:e.left,right:r})}else{let r=ld(e.right.right,t);if(r.depth===e.depth-3){let t=o4({_tag:"IConcat",left:e.right.left,right:r});return o4({_tag:"IConcat",left:e.left,right:t})}{let t=o4({_tag:"IConcat",left:e.left,right:e.right.left});return o4({_tag:"IConcat",left:t,right:r})}}if(t.right.depth>=t.left.depth)return o4({_tag:"IConcat",left:ld(e,t.left),right:t.right});{let r=ld(e,t.left.left);if(r.depth===t.depth-3){let e=o4({_tag:"IConcat",left:r,right:t.left.right});return o4({_tag:"IConcat",left:e,right:t.right})}{let e=o4({_tag:"IConcat",left:t.left.right,right:t.right});return o4({_tag:"IConcat",left:r,right:e})}}}),lg=ic(2,(e,t)=>la(od(e,t))),lm=ic(2,(e,t)=>la(oy(e,t))),lb=((e,t)=>la(og(e,t)),ic(2,(e,t)=>{if("ISingleton"===e.backing._tag)return t(e.backing.a,0);let r=o8,n=0;for(let i of e)r=ld(r,t(i,n++));return r})),ly=lb(ih),lv=((e,t)=>{let r=[],n=[];return ln(e).forEach(e=>{n.push(e),n.length>=t&&(r.push(la(n)),n=[])}),n.length>0&&r.push(la(n)),la(r)},e=>0===e.length),lS=e=>e.length>0,lx=ls(0),l_=e=>ll(e,0),lw=e=>ll(e,e.length-1),lk=ic(2,(e,t)=>"ISingleton"===e.backing._tag?le(t(e.backing.a,0)):la(ib(ln(e),oh((e,r)=>t(e,r))))),lO=ic(3,(e,t,r)=>{let[n,i]=oE(e,t,r);return[n,la(i)]}),lE=((e,t)=>la(a6(ln(e),t)),ic(2,(e,t)=>[lh(e,t),lf(e,t)])),lC=ic(2,(e,t)=>{let r=0;for(let n of ln(e))if(t(n))break;else r++;return lE(e,r)}),lF=e=>lf(e,1),lI=ic(2,(e,t)=>lf(e,e.length-t)),lT=ic(2,(e,t)=>{let r=[];for(let n of ln(e))if(t(n))r.push(n);else break;return la(r)}),lR=ic(3,(e,t,r)=>la(a7(e,t,r))),lN=ic(3,(e,t,r)=>t<0||t>=e.length?ah():sV(la(a5(ln(e),t,r)))),lM=((e,t,r)=>ap(lN(e,t,r),()=>e),ic(2,(e,t)=>lt(aP(e,t))));function lA(e,t){var r;return r=e&t-1,r-=r>>1&0x55555555,r=(r=(0x33333333&r)+(r>>2&0x33333333))+(r>>4)&0xf0f0f0f,r+=r>>8,127&(r+=r>>16)}let lj=(e,t)=>({value:e,previous:t});function lD(e,t,r,n){let i=n;if(!e){let e=n.length;i=Array(e);for(let t=0;t<e;++t)i[t]=n[t]}return i[t]=r,i}function lP(e,t,r){let n=r.length-1,i=0,s=0,a=r;if(e)i=s=t;else for(a=Array(n);i<t;)a[s++]=r[i++];for(++i;i<=n;)a[s++]=r[i++];return e&&(a.length=n),a}class l${_tag="EmptyNode";modify(e,t,r,n,i,s){let a=r(ah());return sH(a)?new l$:(++s.value,new lU(e,n,i,a))}}function lz(e){return iP(e,"EmptyNode")}function lL(e,t){return!lz(e)&&t===e.edit}class lU{edit;hash;key;value;_tag="LeafNode";constructor(e,t,r,n){this.edit=e,this.hash=t,this.key=r,this.value=n}modify(e,t,r,n,i,s){if(sr(i,this.key)){let t=r(this.value);return t===this.value?this:sH(t)?(--s.value,new l$):lL(this,e)?(this.value=t,this):new lU(e,n,i,t)}let a=r(ah());return sH(a)?this:(++s.value,lH(e,t,this.hash,this,n,new lU(e,n,i,a)))}}class lB{edit;hash;children;_tag="CollisionNode";constructor(e,t,r){this.edit=e,this.hash=t,this.children=r}modify(e,t,r,n,i,s){if(n===this.hash){let t=lL(this,e),n=this.updateCollisionList(t,e,this.hash,this.children,r,i,s);return n===this.children?this:n.length>1?new lB(e,this.hash,n):n[0]}let a=r(ah());return sH(a)?this:(++s.value,lH(e,t,this.hash,this,n,new lU(e,n,i,a)))}updateCollisionList(e,t,r,n,i,s,a){let o=n.length;for(let l=0;l<o;++l){let o=n[l];if("key"in o&&sr(s,o.key)){let u=o.value,c=i(u);if(c===u)return n;if(sH(c))return--a.value,lP(e,l,n);return lD(e,l,new lU(t,r,s,c),n)}}let l=i(ah());return sH(l)?n:(++a.value,lD(e,o,new lU(t,r,s,l),n))}}class lq{edit;mask;children;_tag="IndexedNode";constructor(e,t,r){this.edit=e,this.mask=t,this.children=r}modify(e,t,r,n,i,s){let a,o=this.mask,l=this.children,u=n>>>t&31,c=1<<u,h=lA(o,c),f=o&c,p=lL(this,e);if(!f){let a=new l$().modify(e,t+5,r,n,i,s);return a?l.length>=16?function(e,t,r,n,i){let s=[],a=n,o=0;for(let e=0;a;++e)1&a&&(s[e]=i[o++]),a>>>=1;return s[t]=r,new lJ(e,o+1,s)}(e,u,a,o,l):new lq(e,o|c,function(e,t,r,n){let i=n.length;if(e){let e=i;for(;e>=t;)n[e--]=n[e];return n[t]=r,n}let s=0,a=0,o=Array(i+1);for(;s<t;)o[a++]=n[s++];for(o[t]=r;s<i;)o[++a]=n[s++];return o}(p,h,a,l)):this}let d=l[h],g=d.modify(e,t+5,r,n,i,s);if(d===g)return this;let m=o;if(lz(g)){var b;if(!(m&=~c))return new l$;if(l.length<=2&&(lz(b=l[1^h])||"LeafNode"===b._tag||"CollisionNode"===b._tag))return l[1^h];a=lP(p,h,l)}else a=lD(p,h,g,l);return p?(this.mask=m,this.children=a,this):new lq(e,m,a)}}class lJ{edit;size;children;_tag="ArrayNode";constructor(e,t,r){this.edit=e,this.size=t,this.children=r}modify(e,t,r,n,i,s){let a,o=this.size,l=this.children,u=n>>>t&31,c=l[u],h=(c||new l$).modify(e,t+5,r,n,i,s);if(c===h)return this;let f=lL(this,e);if(lz(c)&&!lz(h))++o,a=lD(f,u,h,l);else if(!lz(c)&&lz(h)){if(--o<=8)return function(e,t,r,n){let i=Array(t-1),s=0,a=0;for(let e=0,t=n.length;e<t;++e)if(e!==r){let t=n[e];t&&!lz(t)&&(i[s++]=t,a|=1<<e)}return new lq(e,a,i)}(e,o,u,l);a=lD(f,u,new l$,l)}else a=lD(f,u,h,l);return f?(this.size=o,this.children=a,this):new lJ(e,o,a)}}function lH(e,t,r,n,i,s){let a,o=t;for(;;){let t=function(e,t,r,n,i,s){if(r===i)return new lB(e,r,[s,n]);let a=r>>>t&31,o=i>>>t&31;return a===o?t=>new lq(e,1<<a|1<<o,[t]):new lq(e,1<<a|1<<o,a<o?[n,s]:[s,n])}(e,o,r,n,i,s);if("function"==typeof t)a=lj(t,a),o+=5;else{let e=t;for(;null!=a;)e=a.value(e),a=a.previous;return e}}}let lW="effect/HashMap",lK=Symbol.for(lW),lV={[lK]:lK,[Symbol.iterator](){return new lZ(this,(e,t)=>[e,t])},[i0](){let e=i1(lW);for(let t of this)e^=ib(i1(t[0]),i3(i1(t[1])));return se(this,e)},[st](e){if(l1(e)){if(e._size!==this._size)return!1;for(let t of this){let r=ib(e,l3(t[0],i1(t[0])));if(sH(r)||!sr(t[1],r.value))return!1}return!0}return!1},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"HashMap",values:Array.from(this).map(sa)}},[ss](){return this.toJSON()},pipe(){return sp(this,arguments)}},lG=(e,t,r,n)=>{let i=Object.create(lV);return i._editable=e,i._edit=t,i._root=r,i._size=n,i};class lZ{map;f;v;constructor(e,t){this.map=e,this.f=t,this.v=lY(this.map._root,this.f,void 0)}next(){if(sH(this.v))return{done:!0,value:void 0};let e=this.v.value;return this.v=lQ(e.cont),{done:!1,value:e.value}}[Symbol.iterator](){return new lZ(this.map,this.f)}}let lQ=e=>e?lX(e[0],e[1],e[2],e[3],e[4]):ah(),lY=(e,t,r)=>{switch(e._tag){case"LeafNode":if(sW(e.value))return sV({value:t(e.key,e.value.value),cont:r});return lQ(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let n=e.children;return lX(n.length,n,0,t,r)}default:return lQ(r)}},lX=(e,t,r,n,i)=>{for(;r<e;){let s=t[r++];if(s&&!lz(s))return lY(s,n,[e,t,r,n,i])}return lQ(i)},l0=lG(!1,0,new l$,0),l1=e=>iD(e,lK),l2=ic(2,(e,t)=>l3(e,t,i1(t))),l3=ic(3,(e,t,r)=>{let n=e._root,i=0;for(;;)switch(n._tag){case"LeafNode":return sr(t,n.key)?n.value:ah();case"CollisionNode":if(r===n.hash){let e=n.children;for(let r=0,n=e.length;r<n;++r){let n=e[r];if("key"in n&&sr(t,n.key))return n.value}}return ah();case"IndexedNode":{let e=1<<(r>>>i&31);if(n.mask&e){n=n.children[lA(n.mask,e)],i+=5;break}return ah()}case"ArrayNode":if(n=n.children[r>>>i&31]){i+=5;break}return ah();default:return ah()}}),l5=ic(2,(e,t)=>sW(l3(e,t,i1(t)))),l4=ic(3,(e,t,r)=>ue(e,t,()=>sV(r))),l6=ic(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:lG(e._editable,e._edit,t,r)),l8=e=>new lZ(e,e=>e),l7=e=>lG(!0,e._edit+1,e._root,e._size),l9=e=>(e._editable=!1,e),ue=((e,t)=>{let r=l7(e);return t(r),l9(r)},ic(3,(e,t,r)=>ut(e,t,i1(t),r))),ut=ic(4,(e,t,r,n)=>{let i={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,n,r,t,i);return ib(e,l6(s,i.value))}),ur=ic(2,(e,t)=>ue(e,t,ah)),un=ic(2,(e,t)=>us(e,l0,(e,r,n)=>l4(e,n,t(r,n)))),ui=ic(2,(e,t)=>us(e,void 0,(e,r,n)=>t(r,n))),us=ic(3,(e,t,r)=>{let n,i=e._root;if("LeafNode"===i._tag)return sW(i.value)?r(t,i.value.value,i.key):t;if("EmptyNode"===i._tag)return t;let s=[i.children];for(;n=s.pop();)for(let e=0,i=n.length;e<i;){let i=n[e++];i&&!lz(i)&&("LeafNode"===i._tag?sW(i.value)&&(t=r(t,i.value.value,i.key)):s.push(i.children))}return t}),ua=((e,t)=>{for(let r of e)if(t(r[1],r[0]))return sV(r);return ah()},"effect/HashSet"),uo=Symbol.for(ua),ul={[uo]:uo,[Symbol.iterator](){return l8(this._keyMap)},[i0](){return se(this,i3(i1(this._keyMap))(i1(ua)))},[st](e){return!!uc(e)&&this._keyMap._size===e._keyMap._size&&sr(this._keyMap,e._keyMap)},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"HashSet",values:Array.from(this).map(sa)}},[ss](){return this.toJSON()},pipe(){return sp(this,arguments)}},uu=e=>{let t=Object.create(ul);return t._keyMap=e,t},uc=e=>iD(e,uo),uh=uu(l0),uf=()=>uh,up=ic(2,(e,t)=>l5(e._keyMap,t)),ud=ic(2,(e,t)=>{let r=!1;for(let n of e)if(r=t(n))break;return r}),ug=ic(2,(e,t)=>!ud(e,e=>!t(e))),um=e=>uu(l7(e._keyMap)),ub=e=>(e._keyMap._editable=!1,e),uy=ic(2,(e,t)=>{let r=um(e);return t(r),ub(r)}),uv=ic(2,(e,t)=>e._keyMap._editable?(l4(t,!0)(e._keyMap),e):uu(l4(t,!0)(e._keyMap))),uS=ic(2,(e,t)=>e._keyMap._editable?(ur(t)(e._keyMap),e):uu(ur(t)(e._keyMap))),ux=ic(2,(e,t)=>uy(e,e=>{for(let r of t)uS(e,r)})),u_=ic(2,(e,t)=>uy(uf(),r=>{for(let n of(uw(e,e=>uv(r,e)),t))uv(r,n)})),uw=ic(2,(e,t)=>ui(e._keyMap,(e,r)=>t(r))),uk=ic(3,(e,t,r)=>us(e._keyMap,t,(e,t,n)=>r(e,n))),uO=e=>{let t=um(uf());for(let r of e)uv(t,r);return ub(t)},uE=(...e)=>{let t=um(uf());for(let r of e)uv(t,r);return ub(t)},uC=e=>e._keyMap._size,uF="Empty",uI="Fail",uT="Interrupt",uR="Parallel",uN="Sequential",uM="effect/Cause",uA=Symbol.for(uM),uj={[uA]:{_E:e=>e},[i0](){return ib(i1(uM),i3(i1(u0(this))),se(this))},[st](e){return uB(e)&&uX(this,e)},pipe(){return sp(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:sa(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:sa(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:sa(this.left),right:sa(this.right)}}},toString(){return ce(this)},[ss](){return this.toJSON()}},uD=((l=Object.create(uj))._tag=uF,l),uP=e=>{let t=Object.create(uj);return t._tag=uI,t.error=e,t},u$=e=>{let t=Object.create(uj);return t._tag="Die",t.defect=e,t},uz=e=>{let t=Object.create(uj);return t._tag=uT,t.fiberId=e,t},uL=(e,t)=>{let r=Object.create(uj);return r._tag=uR,r.left=e,r.right=t,r},uU=(e,t)=>{let r=Object.create(uj);return r._tag=uN,r.left=e,r.right=t,r},uB=e=>iD(e,uA),uq=e=>e._tag===uF||u7(e,!0,(e,t)=>{switch(t._tag){case uF:return sV(e);case"Die":case uI:case uT:return sV(!1);default:return ah()}}),uJ=e=>u9(void 0,u5)(e),uH=e=>li(u7(e,o7(),(e,t)=>"Die"===t._tag?sV(ib(e,lc(t.defect))):ah())),uW=e=>u7(e,uf(),(e,t)=>t._tag===uT?sV(ib(e,uv(t.fiberId))):ah()),uK=e=>u2(e,e=>e._tag===uI?sV(e.error):ah()),uV=e=>{let t=uK(e);switch(t._tag){case"None":return s3(e);case"Some":return s2(t.value)}},uG=e=>u2(e,e=>e._tag===uT?sV(e.fiberId):ah()),uZ=e=>u8(e,{onEmpty:uD,onFail:()=>uD,onDie:u$,onInterrupt:uz,onSequential:uU,onParallel:uL}),uQ=ic(2,(e,t)=>uY(e,e=>uP(t(e)))),uY=ic(2,(e,t)=>u8(e,{onEmpty:uD,onFail:e=>t(e),onDie:e=>u$(e),onInterrupt:e=>uz(e),onSequential:(e,t)=>uU(e,t),onParallel:(e,t)=>uL(e,t)})),uX=(e,t)=>{let r=le(e),n=le(t);for(;lS(r)&&lS(n);){let[e,t]=ib(l_(r),u7([uf(),o7()],([e,t],r)=>{let[n,i]=u3(r);return sV([ib(e,u_(n)),ib(t,ld(i))])})),[i,s]=ib(l_(n),u7([uf(),o7()],([e,t],r)=>{let[n,i]=u3(r);return sV([ib(e,u_(n)),ib(t,ld(i))])}));if(!sr(e,i))return!1;r=t,n=s}return!0},u0=e=>u1(le(e),o7()),u1=(e,t)=>{for(;;){let[r,n]=ib(e,ov([uf(),o7()],([e,t],r)=>{let[n,i]=u3(r);return[ib(e,u_(n)),ib(t,ld(i))]})),i=uC(r)>0?ib(t,lc(r)):t;if(lv(n))return li(i);e=n,t=i}throw Error(iB("Cause.flattenCauseLoop"))},u2=ic(2,(e,t)=>{let r=[e];for(;r.length>0;){let e=r.pop(),n=t(e);switch(n._tag){case"None":switch(e._tag){case uN:case uR:r.push(e.right),r.push(e.left)}break;case"Some":return n}}return ah()}),u3=e=>{let t=e,r=[],n=uf(),i=o7();for(;void 0!==t;)switch(t._tag){case uF:if(0===r.length)return[n,i];t=r.pop();break;case uI:if(n=uv(n,o9(t._tag,t.error)),0===r.length)return[n,i];t=r.pop();break;case"Die":if(n=uv(n,o9(t._tag,t.defect)),0===r.length)return[n,i];t=r.pop();break;case uT:if(n=uv(n,o9(t._tag,t.fiberId)),0===r.length)return[n,i];t=r.pop();break;case uN:switch(t.left._tag){case uF:t=t.right;break;case uN:t=uU(t.left.left,uU(t.left.right,t.right));break;case uR:t=uL(uU(t.left.left,t.right),uU(t.left.right,t.right));break;default:i=lc(i,t.right),t=t.left}break;case uR:r.push(t.right),t=t.left}throw Error(iB("Cause.evaluateCauseLoop"))},u5={emptyCase:id,failCase:ig,dieCase:ig,interruptCase:id,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r},u4="SequentialCase",u6="ParallelCase",u8=ic(2,(e,{onDie:t,onEmpty:r,onFail:n,onInterrupt:i,onParallel:s,onSequential:a})=>u9(e,void 0,{emptyCase:()=>r,failCase:(e,t)=>n(t),dieCase:(e,r)=>t(r),interruptCase:(e,t)=>i(t),sequentialCase:(e,t,r)=>a(t,r),parallelCase:(e,t,r)=>s(t,r)})),u7=ic(3,(e,t,r)=>{let n=t,i=e,s=[];for(;void 0!==i;){let e=r(n,i);switch(n=sW(e)?e.value:n,i._tag){case uN:case uR:s.push(i.right),i=i.left;break;default:i=void 0}void 0===i&&s.length>0&&(i=s.pop())}return n}),u9=ic(3,(e,t,r)=>{let n=[e],i=[];for(;n.length>0;){let e=n.pop();switch(e._tag){case uF:i.push(s3(r.emptyCase(t)));break;case uI:i.push(s3(r.failCase(t,e.error)));break;case"Die":i.push(s3(r.dieCase(t,e.defect)));break;case uT:i.push(s3(r.interruptCase(t,e.fiberId)));break;case uN:n.push(e.right),n.push(e.left),i.push(s2({_tag:u4}));break;case uR:n.push(e.right),n.push(e.left),i.push(s2({_tag:u6}))}}let s=[];for(;i.length>0;){let e=i.pop();switch(e._tag){case"Left":switch(e.left._tag){case u4:{let e=s.pop(),n=s.pop(),i=r.sequentialCase(t,e,n);s.push(i);break}case u6:{let e=s.pop(),n=s.pop(),i=r.parallelCase(t,e,n);s.push(i)}}break;case"Right":s.push(e.right)}}if(0===s.length)throw Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),ce=(e,t)=>uJ(e)?"All fibers interrupted without errors.":cl(e).map(function(e){return t?.renderErrorCause!==!0||void 0===e.cause?e.stack:`${e.stack} {
${ct(e.cause,"  ")}
}`}).join("\n"),ct=(e,t)=>{let r=e.stack.split("\n"),n=`${t}[cause]: ${r[0]}`;for(let e=1,i=r.length;e<i;e++)n+=`
${t}${r[e]}`;return e.cause&&(n+=` {
${ct(e.cause,`${t}  `)}
${t}}`),n};class cr extends globalThis.Error{span=void 0;constructor(e){const t="object"==typeof e&&null!==e,r=Error.stackTraceLimit;Error.stackTraceLimit=1,super(cn(e),t&&"cause"in e&&void 0!==e.cause?{cause:new cr(e.cause)}:void 0),""===this.message&&(this.message="An error has occurred"),Error.stackTraceLimit=r,this.name=e instanceof Error?e.name:"Error",t&&(co in e&&(this.span=e[co]),Object.keys(e).forEach(t=>{t in this||(this[t]=e[t])})),this.stack=ca(`${this.name}: ${this.message}`,e instanceof Error&&e.stack?e.stack:"",this.span)}}let cn=e=>{if("string"==typeof e)return e;if("object"==typeof e&&null!==e&&e instanceof Error)return e.message;try{let t;if(iD(e,"toString")&&(t=e.toString,"function"==typeof t)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return sl(e)},ci=/\((.*)\)/g,cs=ik("effect/Tracer/spanToTrace",()=>new WeakMap),ca=(e,t,r)=>{let n=[e],i=t.startsWith(e)?t.slice(e.length).split("\n"):t.split("\n");for(let e=1;e<i.length;e++){if(i[e].includes(" at new BaseEffectError")||i[e].includes(" at new YieldableError")){e++;continue}if(i[e].includes("Generator.next")||i[e].includes("effect_internal_function"))break;n.push(i[e].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(r){let e=r,t=0;for(;e&&"Span"===e._tag&&t<10;){let r=cs.get(e);if("function"==typeof r){let t=r();if("string"==typeof t){let r=t.matchAll(ci),i=!1;for(let[,t]of r)i=!0,n.push(`    at ${e.name} (${t})`);i||n.push(`    at ${e.name} (${t.replace(/^at /,"")})`)}else n.push(`    at ${e.name}`)}else n.push(`    at ${e.name}`);e=ab(e.parent),t++}}return n.join("\n")},co=Symbol.for("effect/SpanAnnotation"),cl=e=>u9(e,void 0,{emptyCase:()=>[],dieCase:(e,t)=>[new cr(t)],failCase:(e,t)=>[new cr(t)],interruptCase:()=>[],parallelCase:(e,t,r)=>[...t,...r],sequentialCase:(e,t,r)=>[...t,...r]}),cu=Symbol.for("effect/Context/Tag"),cc=Symbol.for("effect/Context/Reference"),ch=Symbol.for("effect/STM"),cf={...sA,_op:"Tag",[ch]:sM,[cu]:{_Service:e=>e,_Identifier:e=>e},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[ss](){return this.toJSON()},of:e=>e,context(e){return cv(this,e)}},cp={...cf,[cc]:cc},cd=Symbol.for("effect/Context"),cg={[cd]:{_Services:e=>e},[st](e){if(cb(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!sr(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[i0](){return se(this,i6(this.unsafeMap.size))},pipe(){return sp(this,arguments)},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(sa)}},[ss](){return this.toJSON()}},cm=e=>{let t=Object.create(cg);return t.unsafeMap=e,t},cb=e=>iD(e,cd),cy=cm(new Map),cv=(e,t)=>cm(new Map([[e.key,t]])),cS=ic(3,(e,t,r)=>{let n=new Map(e.unsafeMap);return n.set(t.key,r),cm(n)}),cx=ik("effect/Context/defaultValueCache",()=>new Map),c_=e=>{if(cx.has(e.key))return cx.get(e.key);let t=e.defaultValue();return cx.set(e.key,t),t},cw=ic(2,(e,t)=>{if(!e.unsafeMap.has(t.key)){if(cc in t)return c_(t);throw(e=>{let t=Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){let r=e.stack.split("\n");if(r.length>2){let e=r[2].match(/at (.*)/);e&&(t.message=t.message+` (defined at ${e[1]})`)}}if(t.stack){let e=t.stack.split("\n");e.splice(1,3),t.stack=e.join("\n")}return t})(t)}return e.unsafeMap.get(t.key)}),ck=ic(2,(e,t)=>e.unsafeMap.has(t.key)?sV(e.unsafeMap.get(t.key)):iD(t,cc)?sV(c_(t)):sK),cO=ic(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[e,n]of t.unsafeMap)r.set(e,n);return cm(r)}),cE=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=Error();Error.stackTraceLimit=t;let n=Object.create(cf);return Object.defineProperty(n,"stack",{get:()=>r.stack}),n.key=e,n},cC=e=>()=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=Error();function n(){}return Error.stackTraceLimit=t,Object.setPrototypeOf(n,cf),n.key=e,Object.defineProperty(n,"stack",{get:()=>r.stack}),n},cF=()=>(e,t)=>{let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=Error();function i(){}return Error.stackTraceLimit=r,Object.setPrototypeOf(i,cp),i.key=e,i.defaultValue=t.defaultValue,Object.defineProperty(i,"stack",{get:()=>n.stack}),i},cI=Symbol.for("effect/Duration"),cT=BigInt(0),cR=BigInt(24),cN=BigInt(60),cM=BigInt(1e3),cA=BigInt(1e6),cj=BigInt(1e9),cD=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,cP=e=>{if(cB(e))return e;if(iE(e))return cK(e);if(iF(e))return cH(e);if(Array.isArray(e)&&2===e.length&&e.every(iE))return e[0]===-1/0||e[1]===-1/0||Number.isNaN(e[0])||Number.isNaN(e[1])?cq:e[0]===1/0||e[1]===1/0?cJ:cH(BigInt(Math.round(1e9*e[0]))+BigInt(Math.round(e[1])));if(iO(e)){let t=cD.exec(e);if(t){let[e,r,n]=t,i=Number(r);switch(n){case"nano":case"nanos":return cH(BigInt(r));case"micro":case"micros":return cW(BigInt(r));case"milli":case"millis":return cK(i);case"second":case"seconds":return cV(i);case"minute":case"minutes":return cG(i);case"hour":case"hours":return cZ(i);case"day":case"days":return cQ(i);case"week":case"weeks":return cY(i)}}}throw Error("Invalid DurationInput")},c$={_tag:"Millis",millis:0},cz={_tag:"Infinity"},cL={[cI]:cI,[i0](){return se(this,i7(this.value))},[st](e){return cB(e)&&c9(this,e)},toString(){return`Duration(${he(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:c0(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[ss](){return this.toJSON()},pipe(){return sp(this,arguments)}},cU=e=>{let t=Object.create(cL);return iE(e)?isNaN(e)||e<=0?t.value=c$:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(1e6*e))}:t.value=cz:e<=cT?t.value=c$:t.value={_tag:"Nanos",nanos:e},t},cB=e=>iD(e,cI),cq=cU(0),cJ=cU(1/0),cH=e=>cU(e),cW=e=>cU(e*cM),cK=e=>cU(e),cV=e=>cU(1e3*e),cG=e=>cU(6e4*e),cZ=e=>cU(36e5*e),cQ=e=>cU(864e5*e),cY=e=>cU(6048e5*e),cX=e=>c1(e,{onMillis:e=>e,onNanos:e=>Number(e)/1e6}),c0=e=>{let t=cP(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/cj),Number(t.value.nanos%cj)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},c1=ic(2,(e,t)=>{let r=cP(e);switch(r.value._tag){case"Nanos":return t.onNanos(r.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(r.value.millis)}}),c2=ic(3,(e,t,r)=>{let n=cP(e),i=cP(t);if("Infinity"===n.value._tag||"Infinity"===i.value._tag)return r.onMillis(cX(n),cX(i));if("Nanos"===n.value._tag||"Nanos"===i.value._tag){let e="Nanos"===n.value._tag?n.value.nanos:BigInt(Math.round(1e6*n.value.millis)),t="Nanos"===i.value._tag?i.value.nanos:BigInt(Math.round(1e6*i.value.millis));return r.onNanos(e,t)}return r.onMillis(n.value.millis,i.value.millis)}),c3=ai((e,t)=>c2(e,t,{onMillis:(e,t)=>e<t?-1:+(e>t),onNanos:(e,t)=>e<t?-1:+(e>t)})),c5=(e,t)=>c2(e,t,{onMillis:(e,t)=>e===t,onNanos:(e,t)=>e===t}),c4=(ic(2,(e,t)=>au(c3)(t.maximum,ac(c3)(t.minimum,e))),ic(2,(e,t)=>c2(e,t,{onMillis:(e,t)=>cU(e+t),onNanos:(e,t)=>cU(e+t)}))),c6=((e,t)=>c2(e,t,{onMillis:(e,t)=>e<t,onNanos:(e,t)=>e<t}),ic(2,(e,t)=>c2(e,t,{onMillis:(e,t)=>e<=t,onNanos:(e,t)=>e<=t}))),c8=ic(2,(e,t)=>c2(e,t,{onMillis:(e,t)=>e>t,onNanos:(e,t)=>e>t})),c7=ic(2,(e,t)=>c2(e,t,{onMillis:(e,t)=>e>=t,onNanos:(e,t)=>e>=t})),c9=ic(2,(e,t)=>c5(cP(e),cP(t))),he=e=>{let t=cP(e);if("Infinity"===t.value._tag)return"Infinity";if((e=>{switch(e.value._tag){case"Millis":return 0===e.value.millis;case"Nanos":return e.value.nanos===cT;case"Infinity":return!1}})(t))return"0";let r=(e=>{let t=cP(e);if("Infinity"===t.value._tag)return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};let r=(e=>{let t=cP(e);switch(t.value._tag){case"Infinity":throw Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(1e6*t.value.millis))}})(t),n=r/cA,i=n/cM,s=i/cN,a=s/cN;return{days:Number(a/cR),hours:Number(a%cR),minutes:Number(s%cN),seconds:Number(i%cN),millis:Number(n%cM),nanos:Number(r%cA)}})(t),n=[];return 0!==r.days&&n.push(`${r.days}d`),0!==r.hours&&n.push(`${r.hours}h`),0!==r.minutes&&n.push(`${r.minutes}m`),0!==r.seconds&&n.push(`${r.seconds}s`),0!==r.millis&&n.push(`${r.millis}ms`),0!==r.nanos&&n.push(`${r.nanos}ns`),n.join(" ")},ht=Symbol.for("effect/MutableRef"),hr={[ht]:ht,toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"MutableRef",current:sa(this.current)}},[ss](){return this.toJSON()},pipe(){return sp(this,arguments)}},hn=e=>{let t=Object.create(hr);return t.current=e,t},hi=ic(3,(e,t,r)=>!!sr(t,e.current)&&(e.current=r,!0)),hs=((e,t)=>{let r=e.current;return e.current=t,r},ic(2,(e,t)=>(e.current=t,e))),ha=((e,t)=>(e.current=t,e.current),"effect/FiberId"),ho=Symbol.for(ha),hl="None",hu="Runtime",hc="Composite",hh=i8(`${ha}-${hl}`);class hf{id;startTimeMillis;[ho]=ho;_tag=hu;constructor(e,t){this.id=e,this.startTimeMillis=t}[i0](){return se(this,i8(`${ha}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[st](e){return hg(e)&&e._tag===hu&&this.id===e.id&&this.startTimeMillis===e.startTimeMillis}toString(){return JSON.stringify(this.toJSON(),null,2)}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[ss](){return this.toJSON()}}class hp{left;right;[ho]=ho;_tag=hc;constructor(e,t){this.left=e,this.right=t}_hash;[i0](){return ib(i8(`${ha}-${this._tag}`),i3(i1(this.left)),i3(i1(this.right)),se(this))}[st](e){return hg(e)&&e._tag===hc&&sr(this.left,e.left)&&sr(this.right,e.right)}toString(){return JSON.stringify(this.toJSON(),null,2)}toJSON(){return{_id:"FiberId",_tag:this._tag,left:sa(this.left),right:sa(this.right)}}[ss](){return this.toJSON()}}let hd=new class{[ho]=ho;_tag=hl;id=-1;startTimeMillis=-1;[i0](){return hh}[st](e){return hg(e)&&e._tag===hl}toString(){return JSON.stringify(this.toJSON(),null,2)}toJSON(){return{_id:"FiberId",_tag:this._tag}}[ss](){return this.toJSON()}},hg=e=>iD(e,ho),hm=e=>e._tag===hl||ib(h_(e),ug(e=>hm(e))),hb=ic(2,(e,t)=>e._tag===hl?t:t._tag===hl?e:new hp(e,t)),hy=ic(2,(e,t)=>hm(e)?t:e),hv=e=>{switch(e._tag){case hl:return uf();case hu:return uE(e.id);case hc:return ib(hv(e.left),u_(hv(e.right)))}},hS=ik(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>hn(0)),hx=e=>Array.from(hv(e)).map(e=>`#${e}`).join(","),h_=e=>{switch(e._tag){case hl:return uf();case hu:return uE(e);case hc:return ib(h_(e.left),u_(h_(e.right)))}},hw=hd,hk=hg,hO=()=>{let e=hS.current;return ib(hS,hs(e+1)),new hf(e,Date.now())},hE=Symbol.for("effect/List"),hC=e=>a$(e),hF=iS(o_(sr),hC),hI={[hE]:hE,_tag:"Cons",toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"List",_tag:"Cons",values:hC(this).map(sa)}},[ss](){return this.toJSON()},[st](e){return hM(e)&&this._tag===e._tag&&hF(this,e)},[i0](){return se(this,i9(hC(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if("Nil"===t._tag)return e=!0,this.return();let r=t.head;return t=t.tail,{done:e,value:r}},return:t=>(e||(e=!0),{done:!0,value:t})}},pipe(){return sp(this,arguments)}},hT=(e,t)=>{let r=Object.create(hI);return r.head=e,r.tail=t,r},hR=i8("Nil"),hN=Object.create({[hE]:hE,_tag:"Nil",toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON:()=>({_id:"List",_tag:"Nil"}),[ss](){return this.toJSON()},[i0]:()=>hR,[st](e){return hM(e)&&this._tag===e._tag},[Symbol.iterator]:()=>({next:()=>({done:!0,value:void 0})}),pipe(){return sp(this,arguments)}}),hM=e=>iD(e,hE),hA=e=>"Nil"===e._tag,hj=e=>"Cons"===e._tag,hD=e=>{let t=e,r=0;for(;!hA(t);)r+=1,t=t.tail;return r},hP=(e,t)=>hT(e,t),h$=()=>hN,hz=e=>{let t,r=e[Symbol.iterator]();if(!(t=r.next())||t.done)return hN;{let e=hT(t.value,hN),n=e;for(;(t=r.next())&&!t.done;){let e=hT(t.value,hN);n.tail=e,n=e}return e}},hL=ic(2,(e,t)=>hB(t,e)),hU=ic(2,(e,t)=>hP(t,e)),hB=ic(2,(e,t)=>{if(hA(e))return t;{if(hA(t))return e;let r=hT(t.head,e),n=r,i=t.tail;for(;!hA(i);){let t=hT(i.head,e);n.tail=t,n=t,i=i.tail}return r}}),hq=((e,t)=>{if(t<=0)return e;if(t>=hD(e))return hN;let r=e,n=0;for(;!hA(r)&&n<t;)r=r.tail,n+=1;return r},(e,t,r,n)=>{for(;;)if(hA(t))return e;else{if(r(t.head)===n)return hJ(e,t,r,n);t=t.tail}}),hJ=(e,t,r,n)=>{let i=hT(hV(e),hN),s=hG(e),a=i;for(;s!==t;){let e=hT(hV(s),hN);a.tail=e,a=ih(e),s=ih(s.tail)}let o=t.tail,l=ih(o);for(;!hA(o);)if(r(hV(o))!==n)o=o.tail;else{for(;l!==o;){let e=hT(hV(l),hN);a.tail=e,a=e,l=ih(l.tail)}l=ih(o.tail),o=o.tail}return hA(l)||(a.tail=l),i},hH=ic(3,(e,t,r)=>{let n=t,i=e;for(;!hA(i);)n=r(n,i.head),i=i.tail;return n}),hW=e=>{let t=h$(),r=e;for(;!hA(r);)t=hU(t,r.head),r=r.tail;return t},hK=((e,t)=>{if(t<=0)return hN;if(t>=hD(e))return e;let r=((...e)=>hz(e))(hV(e)),n=hG(e);for(let e=1;e<t;e++)r=hT(hV(n),r),n=hG(n);return hW(r)},"Expected List to be non-empty"),hV=e=>{if(hA(e))throw Error(hK);return e.head},hG=e=>{if(hA(e))throw Error(hK);return e.tail},hZ=function(){function e(e){e&&Object.assign(this,e)}return e.prototype=sj,e}(),hQ=e=>Object.assign(Object.create(sj),e),hY=Symbol.for("effect/DifferChunkPatch");function hX(e){return e}let h0=({...hZ.prototype,[hY]:{_Value:hX,_Patch:hX}},Symbol.for("effect/DifferContextPatch"));function h1(e){return e}let h2={...hZ.prototype,[h0]:{_Value:h1,_Patch:h1}},h3=Object.create(Object.assign(Object.create(h2),{_tag:"Empty"})),h5=Object.assign(Object.create(h2),{_tag:"AndThen"}),h4=Object.assign(Object.create(h2),{_tag:"AddService"}),h6=(e,t)=>{let r=Object.create(h4);return r.key=e,r.service=t,r},h8=Object.assign(Object.create(h2),{_tag:"RemoveService"}),h7=e=>{let t=Object.create(h8);return t.key=e,t},h9=Object.assign(Object.create(h2),{_tag:"UpdateService"}),fe=(e,t)=>{let r=Object.create(h9);return r.key=e,r.update=t,r},ft=ic(2,(e,t)=>{let r;return(r=Object.create(h5)).first=e,r.second=t,r}),fr=ic(2,(e,t)=>{if("Empty"===e._tag)return t;let r=!1,n=le(e),i=new Map(t.unsafeMap);for(;lS(n);){let e=l_(n),t=lF(n);switch(e._tag){case"Empty":n=t;break;case"AddService":i.set(e.key,e.service),n=t;break;case"AndThen":n=lc(lc(t,e.second),e.first);break;case"RemoveService":i.delete(e.key),n=t;break;case"UpdateService":i.set(e.key,e.update(i.get(e.key))),r=!0,n=t}}if(!r)return cm(i);let s=new Map;for(let[e]of t.unsafeMap)i.has(e)&&(s.set(e,i.get(e)),i.delete(e));for(let[e,t]of i)s.set(e,t);return cm(s)}),fn=Symbol.for("effect/DifferHashMapPatch");function fi(e){return e}let fs=({...hZ.prototype,[fn]:{_Value:fi,_Key:fi,_Patch:fi}},Symbol.for("effect/DifferHashSetPatch"));function fa(e){return e}let fo={...hZ.prototype,[fs]:{_Value:fa,_Key:fa,_Patch:fa}},fl=Object.create(Object.assign(Object.create(fo),{_tag:"Empty"})),fu=Object.assign(Object.create(fo),{_tag:"AndThen"}),fc=Object.assign(Object.create(fo),{_tag:"Add"}),fh=Object.assign(Object.create(fo),{_tag:"Remove"}),ff=ic(2,(e,t)=>{let r;return(r=Object.create(fu)).first=e,r.second=t,r}),fp=ic(2,(e,t)=>{if("Empty"===e._tag)return t;let r=t,n=le(e);for(;lS(n);){let e=l_(n),t=lF(n);switch(e._tag){case"Empty":n=t;break;case"AndThen":n=lc(e.first)(lc(e.second)(t));break;case"Add":r=uv(e.value)(r),n=t;break;case"Remove":r=uS(e.value)(r),n=t}}return r}),fd=Symbol.for("effect/DifferOrPatch");function fg(e){return e}let fm={...hZ.prototype,[fd]:{_Value:fg,_Key:fg,_Patch:fg}},fb=Object.assign(Object.create(fm),{_tag:"AndThen"}),fy=((e,t)=>{let r;return(r=Object.create(fb)).first=e,r.second=t,r},Symbol.for("effect/DifferReadonlyArrayPatch"));function fv(e){return e}let fS={...hZ.prototype,[fy]:{_Value:fv,_Patch:fv}},fx=Object.create(Object.assign(Object.create(fS),{_tag:"Empty"})),f_=Object.assign(Object.create(fS),{_tag:"AndThen"}),fw=Object.assign(Object.create(fS),{_tag:"Append"}),fk=Object.assign(Object.create(fS),{_tag:"Slice"}),fO=Object.assign(Object.create(fS),{_tag:"Update"}),fE=(e,t)=>{let r=Object.create(fO);return r.index=e,r.patch=t,r},fC=ic(2,(e,t)=>{let r;return(r=Object.create(f_)).first=e,r.second=t,r}),fF=ic(3,(e,t,r)=>{if("Empty"===e._tag)return t;let n=t.slice(),i=oc(e);for(;an(i);){let e=aY(i),t=a1(i);switch(e._tag){case"Empty":i=t;break;case"AndThen":t.unshift(e.first,e.second),i=t;break;case"Append":for(let t of e.values)n.push(t);i=t;break;case"Slice":n=n.slice(e.from,e.until),i=t;break;case"Update":n[e.index]=r.patch(e.patch,n[e.index]),i=t}}return n}),fI={[Symbol.for("effect/Differ")]:{_P:ih,_V:ih},pipe(){return sp(this,arguments)}},fT=e=>{let t=Object.create(fI);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},fR=()=>fN((e,t)=>t),fN=e=>fT({empty:ih,combine:(e,t)=>e===ih?t:t===ih?e:r=>t(e(r)),diff:(e,t)=>sr(e,t)?ih:ip(t),patch:(t,r)=>e(r,t(r))}),fM=(e,t)=>(255&e)+((t&e&255)<<8),fA=fM(0,0),fj=ic(2,(e,t)=>fM(255&e&~t,e>>8&255)),fD=ic(2,(e,t)=>e|t),fP=e=>fB(e,32),f$=ic(2,(e,t)=>e&~t),fz=ic(2,(e,t)=>e|t),fL=e=>fU(e)&&!fH(e),fU=e=>fB(e,1),fB=ic(2,(e,t)=>(e&t)!=0),fq=(...e)=>e.reduce((e,t)=>e|t,0),fJ=fq(0),fH=e=>fB(e,16),fW=ic(2,(e,t)=>fM(e^t,t)),fK=ic(2,(e,t)=>e&(~(255&t)>>>0&255|t>>8&255)|255&t&(t>>8&255)),fV=fT({empty:fA,diff:(e,t)=>fW(e,t),combine:(e,t)=>fD(t)(e),patch:(e,t)=>fK(t,e)}),fG=(e,t)=>({_tag:"Par",left:e,right:t}),fZ=(e,t)=>({_tag:"Seq",left:e,right:t}),fQ=e=>{let t=e,r=f4(),n=h$(),i=h$();for(;;)switch(t._tag){case"Empty":if(hA(n))return[r,i];t=n.head,n=n.tail;break;case"Par":n=hP(t.right,n),t=t.left;break;case"Seq":{let e=t.left,r=t.right;switch(e._tag){case"Empty":t=r;break;case"Par":{let n=e.left,i=e.right;t=fG(fZ(n,r),fZ(i,r));break}case"Seq":t=fZ(e.left,fZ(e.right,r));break;case"Single":t=e,i=hP(r,i)}break}case"Single":if(r=f6(r,t),hA(n))return[r,i];t=n.head,n=n.tail}throw Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},fY=(e,t)=>{if(hA(e))return hT(pe(t),hN);if(f7(t))return e;let r=pa(e.head),n=f9(t);return 1===r.length&&1===n.length&&sr(r[0],n[0])?hP(ps(e.head,pe(t)),e.tail):hP(pe(t),e)},fX=Symbol.for("effect/RequestBlock/Entry");class f0{request;result;listeners;ownerId;state;[fX]=f1;constructor(e,t,r,n,i){this.request=e,this.result=t,this.listeners=r,this.ownerId=n,this.state=i}}let f1={_R:e=>e},f2=Symbol.for("effect/RequestBlock/RequestBlockParallel"),f3={_R:e=>e};class f5{map;[f2]=f3;constructor(e){this.map=e}}let f4=()=>new f5(l0),f6=(e,t)=>new f5(ue(e.map,t.dataSource,e=>ag(ax(e,lu(t.blockedRequest)),()=>le(t.blockedRequest)))),f8=(e,t)=>new f5(us(e.map,t.map,(e,t,r)=>l4(e,r,af(l2(e,r),{onNone:()=>t,onSome:e=>ld(t,e)})))),f7=e=>{let t;return(t=e.map)&&lz(t._root)},f9=e=>Array.from(l8(e.map)),pe=e=>pi(un(e.map,e=>le(e))),pt=Symbol.for("effect/RequestBlock/RequestBlockSequential"),pr={_R:e=>e};class pn{map;[pt]=pr;constructor(e){this.map=e}}let pi=e=>new pn(e),ps=(e,t)=>new pn(us(t.map,e.map,(e,t,r)=>l4(e,r,af(l2(e,r),{onNone:()=>o7(),onSome:e=>ld(e,t)})))),pa=e=>Array.from(l8(e.map)),po="Pending",pl="Done",pu=Symbol.for("effect/Deferred"),pc={_E:e=>e,_A:e=>e},ph=e=>({_tag:pl,effect:e});class pf{self;called=!1;constructor(e){this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(e){return{value:e,done:!0}}throw(e){throw e}[Symbol.iterator](){return new pf(this.self)}}let pp=(e,t)=>{let r=new pm("Blocked");return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r},pd=Symbol.for("effect/Effect");class pg{patch;op;_op=sC;constructor(e,t){this.patch=e,this.op=t}}class pm{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[pd]=sM;constructor(e){this._op=e}[st](e){return this===e}[i0](){return se(this,i2(this))}pipe(){return sp(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:sa(this.effect_instruction_i0),effect_instruction_i1:sa(this.effect_instruction_i1),effect_instruction_i2:sa(this.effect_instruction_i2)}}toString(){return JSON.stringify(this.toJSON(),null,2)}[ss](){return this.toJSON()}[Symbol.iterator](){return new pf(new iV(this))}}class pb{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[pd]=sM;constructor(e){this._op=e,this._tag=e}[st](e){return gS(e)&&"Failure"===e._op&&sr(this.effect_instruction_i0,e.effect_instruction_i0)}[i0](){return ib(i8(this._tag),i3(i1(this.effect_instruction_i0)),se(this))}get cause(){return this.effect_instruction_i0}pipe(){return sp(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return JSON.stringify(this.toJSON(),null,2)}[ss](){return this.toJSON()}[Symbol.iterator](){return new pf(new iV(this))}}class py{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[pd]=sM;constructor(e){this._op=e,this._tag=e}[st](e){return gS(e)&&"Success"===e._op&&sr(this.effect_instruction_i0,e.effect_instruction_i0)}[i0](){return ib(i8(this._tag),i3(i1(this.effect_instruction_i0)),se(this))}get value(){return this.effect_instruction_i0}pipe(){return sp(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:sa(this.value)}}toString(){return JSON.stringify(this.toJSON(),null,2)}[ss](){return this.toJSON()}[Symbol.iterator](){return new pf(new iV(this))}}let pv=e=>iD(e,pd),pS=e=>{let t=new pm(sO);return t.effect_instruction_i0=e,t},px=ic(3,(e,t,r)=>da(n=>pB(e,e=>pB(pD(dt(()=>n(t(e)))),t=>dt(()=>r(e,t)).pipe(pK({onFailure:e=>{switch(t._tag){case sm:return p$(uU(t.effect_instruction_i0,e));case sS:return p$(e)}},onSuccess:()=>t})))))),p_=ic(2,(e,t)=>pB(e,()=>de(t))),pw=e=>p_(e,void 0),pk=function(){let e=new pm(sg);switch(arguments.length){case 2:e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break;case 3:e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break;case 4:e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break;default:throw Error(iB("you're not supposed to end up here"))}return e},pO=(e,t=hw)=>{let r,n=new pm(sd);return n.effect_instruction_i0=t=>{r=e(t)},n.effect_instruction_i1=t,p6(n,e=>pv(r)?r:dl)},pE=(e,t=hw)=>dt(()=>pO(e,t)),pC=(e,t=hw)=>pk(e,function(){let e,r,n,i;function s(t){e?e(t):void 0===r&&(r=t)}let a=new pm(sd);return a.effect_instruction_i0=t=>{e=t,r&&t(r)},a.effect_instruction_i1=t,1!==this.effect_instruction_i0.length?(i=new AbortController,n=iQ(()=>this.effect_instruction_i0(s,i.signal))):n=iQ(()=>this.effect_instruction_i0(s)),n||i?p6(a,e=>(i&&i.abort(),n??dl)):a}),pF=ic(2,(e,t)=>{let r=new pm(sb);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),pI=ic(2,(e,t)=>pV(e,{onFailure:t,onSuccess:de})),pT=ic(3,(e,t,r)=>pF(e,e=>{let n=uV(e);switch(n._tag){case"Left":return t(n.left)?r(n.left):p$(e);case"Right":return p$(n.right)}})),pR=Symbol.for("effect/OriginalAnnotation"),pN=(e,t)=>sW(t)?new Proxy(e,{has:(e,t)=>t===co||t===pR||t in e,get:(r,n)=>n===co?t.value:n===pR?e:r[n]}):e,pM=e=>!ij(e)||co in e?p$(u$(e)):pS(t=>p$(u$(pN(e,g0(t))))),pA=e=>pz(()=>u$(new go(e))),pj=e=>pV(e,{onFailure:e=>de(s2(e)),onSuccess:e=>de(s3(e))}),pD=e=>pW(e,{onFailure:gC,onSuccess:gM}),pP=e=>!ij(e)||co in e?p$(uP(e)):pS(t=>p$(uP(pN(e,g0(t))))),p$=e=>{let t=new pb(sm);return t.effect_instruction_i0=e,t},pz=e=>pB(dr(e),p$),pL=pS(e=>de(e.id())),pU=e=>pS(t=>e(t.id())),pB=ic(2,(e,t)=>{let r=new pm(sy);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),pq=ic(2,(e,t)=>pB(e,e=>{let r="function"==typeof t?t(e):t;return pv(r)?r:iU(r)?pO(e=>{r.then(t=>e(de(t)),t=>e(pP(new gv(t,"An unknown error occurred in Effect.andThen"))))}):de(r)})),pJ=e=>{let t=new pm("OnStep");return t.effect_instruction_i0=e,t},pH=e=>pB(e,ih),pW=ic(2,(e,t)=>pK(e,{onFailure:e=>de(t.onFailure(e)),onSuccess:e=>de(t.onSuccess(e))})),pK=ic(2,(e,t)=>{let r=new pm(sv);return r.effect_instruction_i0=e,r.effect_instruction_i1=t.onFailure,r.effect_instruction_i2=t.onSuccess,r}),pV=ic(2,(e,t)=>pK(e,{onFailure:e=>{if(uH(e).length>0)return p$(u8(e,{onEmpty:uD,onFail:u$,onDie:u$,onInterrupt:uz,onSequential:uU,onParallel:uL}));let r=li(u7(e,o7(),(e,t)=>t._tag===uI?sV(ib(e,lc(t.error))):ah()));return r.length>0?t.onFailure(l_(r)):p$(e)},onSuccess:t.onSuccess})),pG=ic(2,(e,t)=>dt(()=>{let r=a$(e),n=Array(r.length),i=0;return p_(dc({while:()=>i<r.length,body:()=>t(r[i],i),step:e=>{n[i++]=e}}),n)})),pZ=ic(2,(e,t)=>dt(()=>{let r=a$(e),n=0;return dc({while:()=>n<r.length,body:()=>t(r[n],n),step:()=>{n++}})})),pQ=ic(e=>"boolean"==typeof e[0]||pv(e[0]),(e,t)=>pv(e)?pB(e,e=>e?t.onTrue():t.onFalse()):e?t.onTrue():t.onFalse()),pY=pB(pL,e=>pX(e)),pX=e=>p$(uz(e)),p0=e=>{let t=new pm(s_);return t.effect_instruction_i0=fM(1,1),t.effect_instruction_i1=()=>e,t},p1=ic(2,(e,t)=>da(r=>pB(pD(r(e)),e=>gJ(t,e)))),p2=ic(2,(e,t)=>pB(e,e=>dr(()=>t(e)))),p3=ic(2,(e,t)=>pV(e,{onFailure:e=>pB(dr(()=>t.onFailure(e)),pP),onSuccess:e=>dr(()=>t.onSuccess(e))})),p5=ic(2,(e,t)=>pK(e,{onFailure:e=>{let r=uV(e);switch(r._tag){case"Left":return pB(dr(()=>t(r.left)),pP);case"Right":return p$(r.right)}},onSuccess:de})),p4=((e,t)=>p4(e,e=>gx(e)?dl:t(e.effect_instruction_i0)),ic(2,(e,t)=>da(r=>pK(r(e),{onFailure:e=>{let r=gC(e);return pK(t(r),{onFailure:t=>gC(uU(e,t)),onSuccess:()=>r})},onSuccess:e=>{let r=gM(e);return dm(t(r),r)}})))),p6=ic(2,(e,t)=>p4(e,gR({onFailure:e=>uJ(e)?pw(t(uW(e))):dl,onSuccess:()=>dl}))),p8=ic(2,(e,t)=>di(e,t,de)),p7=e=>p9(e,ih),p9=ic(2,(e,t)=>pV(e,{onFailure:e=>pM(t(e)),onSuccess:de})),de=((e,t)=>de(t.runtimeFlags),e=>{let t=new py(sS);return t.effect_instruction_i0=e,t}),dt=e=>{let t=new pm(sg);return t.commit=e,t},dr=e=>{let t=new pm(sx);return t.effect_instruction_i0=e,t},dn=ic(e=>3===e.length||2===e.length&&!(ij(e[1])&&"onlyEffect"in e[1]),(e,t)=>pB(e,e=>{let r="function"==typeof t?t(e):t;return pv(r)?p_(r,e):iU(r)?pO(t=>{r.then(r=>t(de(e)),e=>t(pP(new gv(e,"An unknown error occurred in Effect.tap"))))}):de(e)})),di=ic(3,(e,t,r)=>pK(e,{onFailure:e=>uH(e).length>0?p$(aS(u8(e,{onEmpty:ah(),onFail:e=>sV(u$(e)),onDie:e=>sV(u$(e)),onInterrupt:()=>ah(),onSequential:aF(uU),onParallel:aF(uL)}))):t(),onSuccess:r})),ds=e=>{let t=new pm(s_);return t.effect_instruction_i0=fM(1,0),t.effect_instruction_i1=()=>e,t},da=e=>pk(e,function(){let e=new pm(s_);return e.effect_instruction_i0=fM(1,0),e.effect_instruction_i1=e=>fU(e)?iQ(()=>this.effect_instruction_i0(p0)):iQ(()=>this.effect_instruction_i0(ds)),e}),dl=de(void 0),du=ic(2,(e,t)=>pB(t,t=>t?ib(e,p2(sV)):de(ah()))),dc=e=>{let t=new pm(sw);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},dh=e=>dt(()=>{let t=new pm(sk);return t.effect_instruction_i0=e(),t}),df=ic(2,(e,t)=>{let r=new pm(s_);return r.effect_instruction_i0=t,r.effect_instruction_i1=()=>e,r}),dp=e=>{let t=new pm(sE);return void 0!==e?.priority?dY(t,e.priority):t},dd=ic(2,(e,t)=>pB(e,e=>p2(t,t=>[e,t]))),dg=ic(2,(e,t)=>pB(e,e=>p_(t,e))),dm=ic(2,(e,t)=>pB(e,()=>t)),db=ic(3,(e,t,r)=>pB(e,e=>p2(t,t=>r(e,t)))),dy=pE(()=>{let e=setInterval(()=>{},0x80000000-1);return dr(()=>clearInterval(e))}),dv=e=>pB(pL,t=>ib(e,dS(t))),dS=ic(2,(e,t)=>pB(e.interruptAsFork(t),()=>e.await)),dx={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return sp(this,arguments)}},d_={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return sp(this,arguments)}},dw={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return sp(this,arguments)}},dk={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return sp(this,arguments)}},dO={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return sp(this,arguments)}},dE={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return sp(this,arguments)}},dC={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return sp(this,arguments)}},dF={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return sp(this,arguments)}},dI=[dx,dC,dE,dO,dk,dw,d_,dF],dT=Symbol.for("effect/FiberRef"),dR={_A:e=>e},dN=e=>pS(t=>gM(t.getFiberRef(e))),dM=ic(2,(e,t)=>pB(dN(e),t)),dA=ic(2,(e,t)=>dj(e,()=>[void 0,t])),dj=ic(2,(e,t)=>pS(r=>{let[n,i]=t(r.getFiberRef(e));return r.setFiberRef(e,i),de(n)})),dD=ic(2,(e,t)=>dj(e,e=>[void 0,t(e)])),dP=Symbol.for("effect/RequestResolver"),d$={_A:e=>e,_R:e=>e};class dz{runAll;target;[dP]=d$;constructor(e,t){this.runAll=e,this.target=t}[i0](){return se(this,this.target?i1(this.target):i2(this))}[st](e){return this.target?dL(e)&&sr(this.target,e.target):this===e}identified(...e){return new dz(this.runAll,lt(e))}pipe(){return sp(this,arguments)}}let dL=e=>iD(e,dP),dU=ic(3,(e,t,r)=>px(dg(dN(t),dA(t,r)),()=>e,e=>dA(t,e))),dB=ic(3,(e,t,r)=>dM(t,n=>dU(e,t,r(n)))),dq=(e,t)=>dH(e,{differ:fR(),fork:t?.fork??ih,join:t?.join}),dJ=e=>{let t=fT({empty:h3,combine:(e,t)=>ft(t)(e),diff:(e,t)=>((e,t)=>{let r=new Map(e.unsafeMap),n=h3;for(let[e,i]of t.unsafeMap.entries())if(r.has(e)){let t=r.get(e);r.delete(e),sr(t,i)||(n=ft(fe(e,()=>i))(n))}else r.delete(e),n=ft(h6(e,i))(n);for(let[e]of r.entries())n=ft(h7(e))(n);return n})(e,t),patch:(e,t)=>fr(t)(e)});return dH(e,{differ:t,fork:t.empty})},dH=(e,t)=>({...sD,[dT]:dR,initial:e,commit(){return dN(this)},diff:(e,r)=>t.differ.diff(e,r),combine:(e,r)=>t.differ.combine(e,r),patch:e=>r=>t.differ.patch(e,r),fork:t.fork,join:t.join??((e,t)=>t)}),dW=ik(Symbol.for("effect/FiberRef/currentContext"),()=>dJ(cy)),dK=ik(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>dq(0)),dV=ik(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>dq(2048)),dG=ik(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>dq(l0)),dZ=ik(Symbol.for("effect/FiberRef/currentLogLevel"),()=>dq(dO)),dQ=ik(Symbol.for("effect/FiberRef/currentLogSpan"),()=>dq(h$())),dY=ic(2,(e,t)=>dU(e,dK,t)),dX=ik(Symbol.for("effect/FiberRef/currentConcurrency"),()=>dq("unbounded")),d0=ik(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>dq(!0)),d1=ik(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>dq(sV(dE))),d2=ik(Symbol.for("effect/FiberRef/versionMismatchErrorLogLevel"),()=>dq(sV(dk))),d3=ik(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>{var e;let t,r;return e=ou(),t=fR(),dH(e,{differ:r=fT({empty:fx,combine:(e,t)=>fC(e,t),diff:(e,r)=>(e=>{var t,r;let n,i,s=0,a=fx;for(;s<e.oldValue.length&&s<e.newValue.length;){let t=e.oldValue[s],r=e.newValue[s],n=e.differ.diff(t,r);sr(n,e.differ.empty)||(a=fC(a,fE(s,n))),s+=1}return s<e.oldValue.length&&(a=fC(a,(t=s,(n=Object.create(fk)).from=0,n.until=t,n))),s<e.newValue.length&&(a=fC(a,(r=a3(s)(e.newValue),(i=Object.create(fw)).values=r,i))),a})({oldValue:e,newValue:r,differ:t}),patch:(e,r)=>fF(e,r,t)}),fork:r.empty})}),d5=ik(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>dq(ah(),{fork:()=>ah(),join:(e,t)=>e})),d4=ik(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>dq(uD,{fork:()=>uD,join:(e,t)=>e})),d6=ik(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>dq(!0)),d8=ik(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>dq(!0)),d7=ik(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>dq(l0)),d9=ik(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>dq(o7())),ge=Symbol.for("effect/Scope"),gt=Symbol.for("effect/CloseableScope"),gr=(e,t)=>e.addFinalizer(()=>pw(t)),gn=ic(2,(e,t)=>{let r=ib(e,uK,ax(t));switch(r._tag){case"None":return ib(uH(e),lx,af({onNone:()=>{let t=a$(uW(e)).flatMap(e=>a$(hv(e)).map(e=>`#${e}`));return new gu(t?`Interrupted by fibers: ${t.join(", ")}`:void 0)},onSome:ih}));case"Some":return r.value}}),gi=function(){class e extends globalThis.Error{commit(){return pP(this)}toJSON(){let e={...this};return this.message&&(e.message=this.message),this.cause&&(e.cause=this.cause),e}[ss](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split("\n").slice(1).join("\n")}`:this.toString():"Bun"in globalThis?ce(uP(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,sP),e}(),gs=(e,t)=>{class r extends gi{_tag=t}return Object.assign(r.prototype,e),r.prototype.name=t,r},ga=Symbol.for("effect/Cause/errors/RuntimeException"),go=gs({[ga]:ga},"RuntimeException"),gl=Symbol.for("effect/Cause/errors/InterruptedException"),gu=gs({[gl]:gl},"InterruptedException"),gc=e=>iD(e,gl),gh=Symbol.for("effect/Cause/errors/IllegalArgument"),gf=gs({[gh]:gh},"IllegalArgumentException"),gp=Symbol.for("effect/Cause/errors/NoSuchElement"),gd=gs({[gp]:gp},"NoSuchElementException"),gg=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),gm=gs({[gg]:gg},"InvalidPubSubCapacityException"),gb=Symbol.for("effect/Cause/errors/Timeout"),gy=Symbol.for("effect/Cause/errors/UnknownException"),gv=function(){class e extends gi{_tag="UnknownException";error;constructor(e,t){super(t??"An unknown error occurred",{cause:e}),this.error=e}}return Object.assign(e.prototype,{[gy]:gy,name:"UnknownException"}),e}(),gS=e=>pv(e)&&"_tag"in e&&("Success"===e._tag||"Failure"===e._tag),gx=e=>"Success"===e._tag,g_=ic(2,(e,t)=>{switch(e._tag){case sm:return gC(e.effect_instruction_i0);case sS:return gM(t)}}),gw=e=>g_(e,void 0),gk=(e,t)=>g$(e,t?.parallel?uL:uU),gO=e=>gC(u$(e)),gE=e=>gC(uP(e)),gC=e=>{let t=new pb(sm);return t.effect_instruction_i0=e,t},gF=ic(2,(e,t)=>{switch(e._tag){case sm:return gC(e.effect_instruction_i0);case sS:return t(e.effect_instruction_i0)}}),gI=ic(2,(e,t)=>{switch(e._tag){case sm:return de(gC(e.effect_instruction_i0));case sS:return pD(t(e.effect_instruction_i0))}}),gT=ic(2,(e,t)=>{switch(e._tag){case sm:return gC(e.effect_instruction_i0);case sS:return gM(t(e.effect_instruction_i0))}}),gR=ic(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case sm:return t(e.effect_instruction_i0);case sS:return r(e.effect_instruction_i0)}}),gN=ic(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case sm:return t(e.effect_instruction_i0);case sS:return r(e.effect_instruction_i0)}}),gM=e=>{let t=new py(sS);return t.effect_instruction_i0=e,t},gA=gM(void 0),gj=ic(2,(e,t)=>gP(e,t,{onSuccess:(e,t)=>[e,t],onFailure:uU})),gD=ic(2,(e,t)=>gP(e,t,{onSuccess:(e,t)=>t,onFailure:uU})),gP=ic(3,(e,t,{onFailure:r,onSuccess:n})=>{switch(e._tag){case sm:switch(t._tag){case sS:return gC(e.effect_instruction_i0);case sm:return gC(r(e.effect_instruction_i0,t.effect_instruction_i0))}case sS:switch(t._tag){case sS:return gM(n(e.effect_instruction_i0,t.effect_instruction_i0));case sm:return gC(t.effect_instruction_i0)}}}),g$=(e,t)=>{let r=lt(e);return lS(r)?ib(lF(r),ov(ib(l_(r),gT(le)),(e,r)=>ib(e,gP(r,{onSuccess:(e,t)=>ib(e,lc(t)),onFailure:t}))),gT(li),gT(e=>ln(e)),sV):ah()},gz=e=>({...sD,[pu]:pc,state:hn({_tag:po,joiners:[]}),commit(){return gB(this)},blockingOn:e}),gL=()=>pB(pL,e=>gU(e)),gU=e=>dr(()=>gz(e)),gB=e=>pE(t=>{let r=e.state.current;switch(r._tag){case pl:return t(r.effect);case po:return r.joiners.push(t),gG(e,t)}},e.blockingOn),gq=ic(2,(e,t)=>dr(()=>{let r=e.state.current;switch(r._tag){case pl:return!1;case po:hs(e.state,ph(t));for(let e=0,n=r.joiners.length;e<n;e++)r.joiners[e](t);return!0}})),gJ=ic(2,(e,t)=>gq(e,t)),gH=((e,t)=>gq(e,pP(t)),ic(2,(e,t)=>gq(e,p$(t)))),gW=ic(2,(e,t)=>gq(e,pX(t))),gK=ic(2,(e,t)=>gq(e,de(t))),gV=(e,t)=>{let r=e.state.current;if(r._tag===po){hs(e.state,ph(t));for(let e=0,n=r.joiners.length;e<n;e++)r.joiners[e](t)}},gG=(e,t)=>dr(()=>{let r=e.state.current;if(r._tag===po){let e=r.joiners.indexOf(t);e>=0&&r.joiners.splice(e,1)}}),gZ=pS(e=>gM(e.currentContext)),gQ=ic(2,(e,t)=>dU(dW,t)(e)),gY=ic(2,(e,t)=>dB(dW,e=>cO(e,t))(e)),gX=ic(2,(e,t)=>pB(gZ,r=>gQ(e,t(r)))),g0=((e,t)=>pB(e,e=>pB(t.predicate(e),r=>r?de(e):t.orElse(e))),e=>{let t=e.currentSpan;return void 0!==t&&"Span"===t._tag?sV(t):ah()}),g1={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:gA},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}},g2=e=>u8(e,{onEmpty:sV(uD),onFail:ax(uP),onDie:e=>sV(u$(e)),onInterrupt:e=>sV(uz(e)),onSequential:aF(uU),onParallel:aF(uL)}),g3="InvalidData",g5="MissingData",g4="SourceUnavailable",g6="Unsupported",g8=Symbol.for("effect/ConfigError"),g7={_tag:"ConfigError",[g8]:g8},g9=(e,t)=>{let r=Object.create(g7);return r._op="And",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},me=(e,t)=>{let r=Object.create(g7);return r._op="Or",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},mt=(e,t,r={pathDelim:"."})=>{let n=Object.create(g7);return n._op=g3,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){let e=ib(this.path,oO(r.pathDelim));return`(Invalid data at ${e}: "${this.message}")`}}),n},mr=(e,t,r={pathDelim:"."})=>{let n=Object.create(g7);return n._op=g5,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){let e=ib(this.path,oO(r.pathDelim));return`(Missing data at ${e}: "${this.message}")`}}),n},mn=ic(2,(e,t)=>{switch(e._op){case"And":return g9(mn(e.left,t),mn(e.right,t));case"Or":return me(mn(e.left,t),mn(e.right,t));case g3:return mt([...t,...e.path],e.message);case g5:return mr([...t,...e.path],e.message);case g4:return((e,t,r,n={pathDelim:"."})=>{let i=Object.create(g7);return i._op=g4,i.path=e,i.message=t,i.cause=r,Object.defineProperty(i,"toString",{enumerable:!1,value(){let e=ib(this.path,oO(n.pathDelim));return`(Source unavailable at ${e}: "${this.message}")`}}),i})([...t,...e.path],e.message,e.cause);case g6:return((e,t,r={pathDelim:"."})=>{let n=Object.create(g7);return n._op=g6,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){let e=ib(this.path,oO(r.pathDelim));return`(Unsupported operation at ${e}: "${this.message}")`}}),n})([...t,...e.path],e.message)}}),mi={andCase:(e,t,r)=>t&&r,orCase:(e,t,r)=>t&&r,invalidDataCase:ig,missingDataCase:id,sourceUnavailableCase:ig,unsupportedCase:ig},ms=ic(3,(e,t,r)=>{let n=[e],i=[];for(;n.length>0;){let e=n.pop();switch(e._op){case"And":n.push(e.right),n.push(e.left),i.push(s2({_op:"AndCase"}));break;case"Or":n.push(e.right),n.push(e.left),i.push(s2({_op:"OrCase"}));break;case g3:i.push(s3(r.invalidDataCase(t,e.path,e.message)));break;case g5:i.push(s3(r.missingDataCase(t,e.path,e.message)));break;case g4:i.push(s3(r.sourceUnavailableCase(t,e.path,e.message,e.cause)));break;case g6:i.push(s3(r.unsupportedCase(t,e.path,e.message)))}}let s=[];for(;i.length>0;){let e=i.pop();switch(e._op){case"Left":switch(e.left._op){case"AndCase":{let e=s.pop(),n=s.pop(),i=r.andCase(t,e,n);s.push(i);break}case"OrCase":{let e=s.pop(),n=s.pop(),i=r.orCase(t,e,n);s.push(i)}}break;case"Right":s.push(e.right)}}if(0===s.length)throw Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),ma=e=>ms(e,void 0,mi),mo=Symbol.for("effect/Clock"),ml=cE("effect/Clock"),mu=0x80000000-1,mc={unsafeSchedule(e,t){let r=cX(t);if(r>mu)return ig;let n=!1,i=setTimeout(()=>{n=!0,e()},r);return()=>(clearTimeout(i),!n)}},mh=(c=BigInt(1e6),"undefined"==typeof performance?()=>BigInt(Date.now())*c:()=>(void 0===u&&(u=BigInt(Date.now())*c-BigInt(Math.round(1e6*performance.now()))),u+BigInt(Math.round(1e6*performance.now())))),mf=function(){let e="object"==typeof process&&"hrtime"in process&&"function"==typeof process.hrtime.bigint?process.hrtime:void 0;if(!e)return mh;let t=mh()-e.bigint();return()=>t+e.bigint()}();class mp{[mo]=mo;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return mf()}currentTimeMillis=dr(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=dr(()=>this.unsafeCurrentTimeNanos());scheduler(){return de(mc)}sleep(e){return pC(t=>pw(dr(mc.unsafeSchedule(()=>t(dl),e))))}}ic(2,(e,t)=>-1!==as(e,t));let md=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&"),mg={_tag:"Empty"},mm=ic(2,(e,t)=>({_tag:"AndThen",first:e,second:t})),mb=ic(2,(e,t)=>mm(e,{_tag:"MapName",f:t})),my=ic(2,(e,t)=>mm(e,{_tag:"Nested",name:t})),mv=ic(2,(e,t)=>mm(e,{_tag:"Unnested",name:t})),mS=ic(2,(e,t)=>{let r=hT(t,hN),n=e;for(;hj(r);){let e=r.head;switch(e._tag){case"Empty":r=r.tail;break;case"AndThen":r=hP(e.first,hP(e.second,r.tail));break;case"MapName":n=oh(n,e.f),r=r.tail;break;case"Nested":n=aB(n,e.name),r=r.tail;break;case"Unnested":if(!ib(aQ(n),aE(e.name)))return s2(mr(n,`Expected ${e.name} to be in path in ConfigProvider#unnested`));n=a1(n),r=r.tail}}return s3(n)}),mx="Constant",m_="Fallback",mw="Lazy",mk="MapOrFail",mO="Nested",mE="Primitive",mC="ZipWith",mF=e=>e.toLowerCase(),mI=e=>e.toUpperCase(),mT=(e,t,r)=>t instanceof RegExp?e.replace(t,r):t.reduce((e,t)=>e.replace(t,r),e),mR=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],mN=/[^A-Z0-9]+/gi,mM=(e,t)=>((e,t={})=>{let{delimiter:r=" ",splitRegexp:n=mR,stripRegexp:i=mN,transform:s=mF}=t,a=mT(mT(e,n,"$1\0$2"),i,"\0"),o=0,l=a.length;for(;"\0"===a.charAt(o);)o++;for(;"\0"===a.charAt(l-1);)l--;return a.slice(o,l).split("\0").map(s).join(r)})(e,{delimiter:"_",transform:mI,...t}),mA=(e,t)=>[...e,...t],mj=Symbol.for("effect/ConfigProvider"),mD=cE("effect/ConfigProvider"),mP=Symbol.for("effect/ConfigProviderFlat"),m$=e=>({[mP]:mP,patch:e.patch,load:(t,r,n=!0)=>e.load(t,r,n),enumerateChildren:e.enumerateChildren}),mz=e=>({[mj]:mj,pipe(){return sp(this,arguments)},...{load:t=>pB(mB(e,ou(),t,!1),e=>af(aQ(e),{onNone:()=>pP(mr(ou(),`Expected a single value having structure: ${t}`)),onSome:de})),flattened:e}}),mL=e=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),n=()=>"undefined"!=typeof process&&"env"in process&&"object"==typeof process.env?process.env:{};return mz(m$({load:(e,i,s=!0)=>{let a=ib(e,oO(t)),o=n();return ib(a in o?sV(o[a]):ah(),p5(()=>mr(e,`Expected ${a} to exist in the process context`)),pB(t=>mG(t,e,i,r,s)))},enumerateChildren:e=>dr(()=>uO(Object.keys(n()).map(e=>e.toUpperCase().split(t)).filter(t=>{for(let r=0;r<e.length;r++){let n=ib(e,aZ(r)),i=t[r];if(void 0===i||n!==i)return!1}return!0}).flatMap(t=>t.slice(e.length,e.length+1)))),patch:mg}))},mU=(e,t)=>{let{pathDelim:r,seqDelim:n}=Object.assign({seqDelim:",",pathDelim:"."},t),i=e=>ib(e,oO(r)),s=e=>e.split(r),a=m1(e,e=>s(e),i);return mz(m$({load:(e,t,r=!0)=>{let s=i(e);return ib(a.has(s)?sV(a.get(s)):ah(),p5(()=>mr(e,`Expected ${s} to exist in the provided map`)),pB(i=>mG(i,e,t,n,r)))},enumerateChildren:e=>dr(()=>uO(a$(a.keys()).map(s).filter(t=>{for(let r=0;r<e.length;r++){let n=ib(e,aZ(r)),i=t[r];if(void 0===i||n!==i)return!1}return!0}).flatMap(t=>t.slice(e.length,e.length+1)))),patch:mg}))},mB=(e,t,r,n)=>{switch(r._tag){case mx:return de(oc(r.value));case"Described":return dt(()=>mB(e,t,r.config,n));case"Fail":return pP(mr(t,r.message));case m_:return ib(dt(()=>mB(e,t,r.first,n)),pI(i=>r.condition(i)?ib(mB(e,t,r.second,n),pI(e=>pP(me(i,e)))):pP(i)));case mw:return dt(()=>mB(e,t,r.config(),n));case mk:return dt(()=>ib(mB(e,t,r.original,n),pB(pG(e=>ib(r.mapOrFail(e),p5(mn(((e,t)=>{let r=t;if("Nested"===r._tag){let t=e.slice();for(;"Nested"===r._tag;)t.push(r.name),r=r.config;return t}return e})(t,r.original))))))));case mO:return dt(()=>mB(e,mA(t,oc(r.name)),r.config,n));case mE:return ib(mS(t,e.patch),pB(t=>ib(e.load(t,r,n),pB(e=>{if(0===e.length){let e=ib(aX(t),ap(()=>"<n/a>"));return pP(mr([],`Expected ${r.description} with name ${e}`))}return de(e)}))));case"Sequence":return ib(mS(t,e.patch),pB(n=>ib(e.enumerateChildren(n),pB(mQ),pB(n=>0===n.length?dt(()=>p2(mB(e,t,r.config,!0),oc)):ib(pG(n,n=>mB(e,aq(t,`[${n}]`),r.config,!0)),p2(e=>{let t=op(e);return 0===t.length?oc(ou()):oc(t)}))))));case"HashMap":return dt(()=>ib(mS(t,e.patch),pB(t=>ib(e.enumerateChildren(t),pB(i=>ib(i,pG(i=>mB(e,mA(t,oc(i)),r.valueConfig,n)),p2(e=>0===e.length?oc(l0):ib(mZ(e),oh(e=>(e=>{let t=l7(l0);for(let r of e)l4(t,r[0],r[1]);return l9(t)})(a8(a$(i),e)))))))))));case mC:return dt(()=>ib(mB(e,t,r.left,n),pj,pB(i=>ib(mB(e,t,r.right,n),pj,pB(e=>{if(s0(i)&&s0(e))return pP(g9(i.left,e.left));if(s0(i)&&s1(e))return pP(i.left);if(s1(i)&&s0(e))return pP(e.left);if(s1(i)&&s1(e)){var n,s;let a,o,l=ib(t,oO(".")),u=mq(t,l),[c,h]=(n=ib(i.right,oh(s3)),s=ib(e.right,oh(s3)),a=ox(n.length,e=>e>=s.length?ah():sV([u(e),e+1])),o=ox(s.length,e=>e>=n.length?ah():sV([u(e),e+1])),[mA(n,a),mA(s,o)]);return ib(c,a8(h),pG(([e,t])=>ib(dd(e,t),p2(([e,t])=>r.zip(e,t)))))}throw Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},mq=(e,t)=>r=>s2(mr(e,`The element at index ${r} in a sequence at path "${t}" was missing`)),mJ=ic(2,(e,t)=>mz(mH(e.flattened,t))),mH=(e,t)=>m$({load:(t,r,n=!0)=>e.load(t,r,n),enumerateChildren:t=>e.enumerateChildren(t),patch:mb(e.patch,t)}),mW=ic(2,(e,t)=>mz(m$({load:(t,r)=>e.flattened.load(t,r,!0),enumerateChildren:t=>e.flattened.enumerateChildren(t),patch:my(e.flattened.patch,t)}))),mK=((e,t)=>mz(m$({load:(t,r)=>e.flattened.load(t,r,!0),enumerateChildren:t=>e.flattened.enumerateChildren(t),patch:mv(e.flattened.patch,t)})),ic(2,(e,t)=>mz(mV(e.flattened,()=>t().flattened)))),mV=(e,t)=>m$({load:(r,n,i)=>ib(mS(r,e.patch),pB(t=>e.load(t,n,i)),pI(e=>ib(dr(t),pB(t=>ib(mS(r,t.patch),pB(e=>t.load(e,n,i)),pI(t=>pP(me(e,t)))))))),enumerateChildren:r=>ib(mS(r,e.patch),pB(t=>e.enumerateChildren(t)),pj,pB(e=>ib(dr(t),pB(t=>ib(mS(r,t.patch),pB(e=>t.enumerateChildren(e)),pj,pB(t=>{if(s0(e)&&s0(t))return pP(g9(e.left,t.left));if(s0(e)&&s1(t))return de(t.right);if(s1(e)&&s0(t))return de(e.right);if(s1(e)&&s1(t))return de(ib(e.right,u_(t.right)));throw Error("BUG: ConfigProvider.orElseFlat - please report an issue at https://github.com/Effect-TS/effect/issues")})))))),patch:mg}),mG=(e,t,r,n,i)=>i?ib(e.split(RegExp(`\\s*${md(n)}\\s*`)),pG(e=>r.parse(e.trim())),p5(mn(t))):ib(r.parse(e),p3({onFailure:mn(t),onSuccess:oc})),mZ=e=>Object.keys(e[0]).map(t=>e.map(e=>e[t])),mQ=e=>ib(pG(e,m0),p3({onFailure:()=>ou(),onSuccess:a6(as)}),pj,p2(s9)),mY=/(^.+)(\[(\d+)\])$/,mX=/^(\[(\d+)\])$/,m0=e=>{let t=e.match(mX);if(null!==t){let e=t[2];return ib(void 0!==e&&e.length>0?sV(e):ah(),a_(m3))}return ah()},m1=(e,t,r)=>{let n=new Map;for(let[i,s]of e){let e=ib(t(i),of(e=>af(m2(e),{onNone:()=>oc(e),onSome:([e,t])=>aD(e,`[${t}]`)})));n.set(r(e),s)}return n},m2=e=>{let t=e.match(mY);if(null!==t){let e=t[1],r=t[3];return(e=>{if(Symbol.iterator in e){let t=[];for(let r of e){if(sH(r))return ah();t.push(r.value)}return sV(t)}let t={};for(let r of Object.keys(e)){let n=e[r];if(sH(n))return ah();t[r]=n.value}return sV(t)})([void 0!==e&&e.length>0?sV(e):ah(),ib(void 0!==r&&r.length>0?sV(r):ah(),a_(m3))])}return ah()},m3=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?ah():sV(t)},m5=Symbol.for("effect/Console"),m4=cE("effect/Console"),m6={[m5]:m5,assert:(e,...t)=>dr(()=>{console.assert(e,...t)}),clear:dr(()=>{console.clear()}),count:e=>dr(()=>{console.count(e)}),countReset:e=>dr(()=>{console.countReset(e)}),debug:(...e)=>dr(()=>{console.debug(...e)}),dir:(e,t)=>dr(()=>{console.dir(e,t)}),dirxml:(...e)=>dr(()=>{console.dirxml(...e)}),error:(...e)=>dr(()=>{console.error(...e)}),group:e=>e?.collapsed?dr(()=>console.groupCollapsed(e?.label)):dr(()=>console.group(e?.label)),groupEnd:dr(()=>{console.groupEnd()}),info:(...e)=>dr(()=>{console.info(...e)}),log:(...e)=>dr(()=>{console.log(...e)}),table:(e,t)=>dr(()=>{console.table(e,t)}),time:e=>dr(()=>console.time(e)),timeEnd:e=>dr(()=>console.timeEnd(e)),timeLog:(e,...t)=>dr(()=>{console.timeLog(e,...t)}),trace:(...e)=>dr(()=>{console.trace(...e)}),warn:(...e)=>dr(()=>{console.warn(...e)}),unsafe:console},m8=Symbol.for("effect/Random"),m7=cE("effect/Random"),m9=(e,t)=>dt(()=>ib(dr(()=>Array.from(e)),pB(e=>{let r=[];for(let t=e.length;t>=2;t-=1)r.push(t);return ib(r,pZ(r=>ib(t(r),p2(t=>be(e,r-1,t)))),p_(lt(e)))}))),be=(e,t,r)=>{let n=e[t];return e[t]=e[r],e[r]=n,e},bt=Symbol.for("effect/Tracer"),br=cE("effect/Tracer"),bn=cE("effect/ParentSpan"),bi=(f=(h="abcdef0123456789").length,function(e){let t="";for(let r=0;r<e;r++)t+=h.charAt(Math.floor(Math.random()*f));return t});class bs{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor(e,t,r,n,i,s){this.name=e,this.parent=t,this.context=r,this.startTime=i,this.kind=s,this.status={_tag:"Started",startTime:i},this.attributes=new Map,this.traceId="Some"===t._tag?t.value.traceId:bi(32),this.spanId=bi(16),this.links=Array.from(n)}end(e,t){this.status={_tag:"Ended",endTime:e,exit:t,startTime:this.status.startTime}}attribute(e,t){this.attributes.set(e,t)}event(e,t,r){this.events.push([e,t,r??{}])}addLinks(e){this.links.push(...e)}}let ba={[bt]:bt,...{span:(e,t,r,n,i,s)=>new bs(e,t,r,n,i,s),context:e=>e()}},bo=e=>{if(e?.captureStackTrace===!1||e?.captureStackTrace!==void 0&&"boolean"!=typeof e.captureStackTrace)return e;let t=Error.stackTraceLimit;Error.stackTraceLimit=3;let r=Error();Error.stackTraceLimit=t;let n=!1;return{...e,captureStackTrace:()=>{if(!1!==n)return n;if(void 0!==r.stack){let e=r.stack.split("\n");if(void 0!==e[3])return n=e[3].trim()}}}},bl=cF()("effect/Tracer/DisablePropagation",{defaultValue:ig}),bu=ib(cy,cS(ml,new mp),cS(m4,m6),cS(m7,new class e{seed;[m8]=m8;PRNG;constructor(e){this.seed=e,this.PRNG=new iH(e)}get next(){return dr(()=>this.PRNG.number())}get nextBoolean(){return p2(this.next,e=>e>.5)}get nextInt(){return dr(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(e,t){return p2(this.next,r=>(t-e)*r+e)}nextIntBetween(e,t){return dr(()=>this.PRNG.integer(t-e)+e)}shuffle(e){return m9(e,e=>this.nextIntBetween(0,e))}}(i1(Math.random()))),cS(mD,mL()),cS(br,ba)),bc=ik(Symbol.for("effect/DefaultServices/currentServices"),()=>dJ(bu)),bh=e=>pS(t=>e(t.currentDefaultServices)),bf=e=>bh(t=>e(t.unsafeMap.get(ml.key))),bp=bf(e=>e.currentTimeMillis),bd=(bh(e=>e.unsafeMap.get(m7.key).next),"effect/Redacted"),bg=ik("effect/Redacted/redactedRegistry",()=>new WeakMap),bm=Symbol.for(bd),bb={[bm]:{_A:e=>e},pipe(){return sp(this,arguments)},toString:()=>"<redacted>",toJSON:()=>"<redacted>",[ss]:()=>"<redacted>",[i0](){return ib(i1(bd),i3(i1(bg.get(this))),se(this))},[st](e){return by(e)&&sr(bg.get(this),bg.get(e))}},by=e=>iD(e,bm),bv=Symbol.for("effect/Secret");({...bb,[bv]:bv});let bS=Symbol.for("effect/Config"),bx={...sD,[bS]:{_A:e=>e},commit(){var e;let t;return e=this,t=t=>t.load(e),bh(e=>t(e.unsafeMap.get(mD.key)))}},b_=ic(2,(e,t)=>bk(e,e=>s3(t(e)))),bw=ic(2,(e,t)=>bk(e,e=>{try{return s3(t(e))}catch(e){return s2(mt([],e instanceof Error?e.message:`${e}`))}})),bk=ic(2,(e,t)=>{let r=Object.create(bx);return r._tag=mk,r.original=e,r.mapOrFail=t,r}),bO=ic(2,(e,t)=>{let r=Object.create(bx);return r._tag=mO,r.name=t,r.config=e,r}),bE=ic(2,(e,t)=>{let r=Object.create(bx);return r._tag=m_,r.first=e,r.second=bR(t),r.condition=id,r}),bC=ic(2,(e,t)=>{let r=Object.create(bx);return r._tag=m_,r.first=e,r.second=bR(t.orElse),r.condition=t.if,r}),bF=(e,t)=>{let r=Object.create(bx);return r._tag=mE,r.description=e,r.parse=t,r},bI=e=>{let t=bF("a text property",s3);return void 0===e?t:bO(t,e)},bT=e=>{let t=Object.create(bx);return t._tag=mx,t.value=e,t.parse=()=>s3(e),t},bR=e=>{let t=Object.create(bx);return t._tag=mw,t.config=e,t},bN=ic(2,(e,t)=>bC(e,{orElse:()=>bT(t),if:ma})),bM=((e,t,r)=>{let n=Object.create(bx);return n._tag=mC,n.left=e,n.right=t,n.zip=r,n},(...e)=>t=>{let r=e.map(String).join(", "),n=bF(`one of (${r})`,t=>{let n=e.find(e=>String(e)===t);return void 0===n?s2(mt([],`Expected one of (${r}) but received ${t}`)):s3(n)});return void 0===t?n:bO(n,t)}),bA=(p=Symbol.for("effect/Data/Error/plainArgs"),({BaseEffectError:class extends gi{constructor(e){super(e?.message,e?.cause?{cause:e.cause}:void 0),e&&(Object.assign(this,e),Object.defineProperty(this,p,{value:e,enumerable:!1}))}toJSON(){return{...this[p],...this}}}}).BaseEffectError),bj=e=>{let t=class extends bA{_tag=e};return t.prototype.name=e,t},bD=e=>dr(()=>e.state.current._tag===pl),bP=s$;class b$ extends bP{}let bz="Sequential",bL="Parallel",bU={_tag:bz},bB={_tag:bL},bq=e=>({_tag:"ParallelN",parallelism:e});function bJ(){return new bW(new Map)}let bH=Symbol.for("effect/FiberRefs");class bW{locals;[bH]=bH;constructor(e){this.locals=e}pipe(){return sp(this,arguments)}}let bK=ic(3,(e,t,r)=>{let n=new Map(e.locals);return r.locals.forEach((e,r)=>{let i=e[0][1];if(!e[0][0][st](t)){if(!n.has(r)){if(sr(i,r.initial))return;n.set(r,[[t,r.join(r.initial,i)]]);return}let s=n.get(r),[a,o]=((e,t,r,n=!1)=>{let i,s=t,a=r,o=n;for(;void 0===i;)if(aW(s)&&aW(a)){let e=aY(s)[0],t=a1(s),r=aY(a)[0],n=aY(a)[1],l=a1(a);e.startTimeMillis<r.startTimeMillis?(a=l,o=!0):e.startTimeMillis>r.startTimeMillis?s=t:e.id<r.id?(a=l,o=!0):e.id>r.id?s=t:i=[n,o]}else i=[e.initial,!0];return i})(r,s,e);if(o){let e=r.diff(a,i),o=s[0][1],l=r.join(o,r.patch(e)(o));if(!sr(o,l)){let e,i=s[0][0];e=i[st](t)?[[i,l],...s.slice(1)]:[[t,l],...s],n.set(r,e)}}}}),new bW(n)}),bV=ic(2,(e,t)=>{let r=new Map;return bG(e,r,t),new bW(r)}),bG=(e,t,r)=>{e.locals.forEach((e,n)=>{let i=e[0][1],s=n.patch(n.fork)(i);sr(i,s)?t.set(n,e):t.set(n,[[r,s],...e])})},bZ=ic(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new bW(r)}),bQ=ic(2,(e,t)=>e.locals.has(t)?sV(aY(e.locals.get(t))[1]):ah()),bY=ic(2,(e,t)=>ib(bQ(e,t),ap(()=>t.initial))),bX=ic(2,(e,{fiberId:t,fiberRef:r,value:n})=>{if(0===e.locals.size)return new bW(new Map([[r,[[t,n]]]]));let i=new Map(e.locals);return b0(i,t,r,n),new bW(i)}),b0=(e,t,r,n)=>{let i,s=e.get(r)??[];if(aW(s)){let[e,r]=aY(s);if(e[st](t))if(sr(r,n))return;else i=[[t,n],...s.slice(1)];else i=[[t,n],...s]}else i=[[t,n]];e.set(r,i)},b1=ic(2,(e,{entries:t,forkAs:r})=>{if(0===e.locals.size)return new bW(new Map(t));let n=new Map(e.locals);return void 0!==r&&bG(e,n,r),t.forEach(([e,t])=>{1===t.length?b0(n,t[0][0],e,t[0][1]):t.forEach(([t,r])=>{b0(n,t,e,r)})}),new bW(n)}),b2="Empty",b3="Remove",b5="Update",b4="AndThen",b6={_tag:b2},b8=(e,t)=>{let r=new Map(e.locals),n=b6;for(let[e,i]of t.locals.entries()){let t=aY(i)[1],s=r.get(e);if(void 0!==s){let r=aY(s)[1];sr(r,t)||(n=b7({_tag:b5,fiberRef:e,patch:e.diff(r,t)})(n))}else n=b7({_tag:"Add",fiberRef:e,value:t})(n);r.delete(e)}for(let[e]of r.entries())n=b7({_tag:b3,fiberRef:e})(n);return n},b7=ic(2,(e,t)=>({_tag:b4,first:e,second:t})),b9=ic(3,(e,t,r)=>{let n=r,i=oc(e);for(;aW(i);){let e=aY(i),r=a1(i);switch(e._tag){case b2:i=r;break;case"Add":n=bX(n,{fiberId:t,fiberRef:e.fiberRef,value:e.value}),i=r;break;case b3:n=bZ(n,e.fiberRef),i=r;break;case b5:{let s=bY(n,e.fiberRef);n=bX(n,{fiberId:t,fiberRef:e.fiberRef,value:e.fiberRef.patch(e.patch)(s)}),i=r;break}case b4:i=aB(e.first)(aB(e.second)(r))}}return n}),ye="effect/FiberStatus",yt=Symbol.for(ye),yr="Done",yn="Running",yi="Suspended",ys=i8(`${ye}-${yr}`);class ya{runtimeFlags;[yt]=yt;_tag=yn;constructor(e){this.runtimeFlags=e}[i0](){return ib(i1(ye),i3(i1(this._tag)),i3(i1(this.runtimeFlags)),se(this))}[st](e){return yu(e)&&e._tag===yn&&this.runtimeFlags===e.runtimeFlags}}class yo{runtimeFlags;blockingOn;[yt]=yt;_tag=yi;constructor(e,t){this.runtimeFlags=e,this.blockingOn=t}[i0](){return ib(i1(ye),i3(i1(this._tag)),i3(i1(this.runtimeFlags)),i3(i1(this.blockingOn)),se(this))}[st](e){return yu(e)&&e._tag===yi&&this.runtimeFlags===e.runtimeFlags&&sr(this.blockingOn,e.blockingOn)}}let yl=new class{[yt]=yt;_tag=yr;[i0](){return ys}[st](e){return yu(e)&&e._tag===yr}},yu=e=>iD(e,yt),yc=e=>new ya(e),yh=al(ib(as,ao(e=>e.ordinal))),yf=e=>{switch(e){case"All":return dx;case"Debug":return dE;case"Error":return dw;case"Fatal":return d_;case"Info":return dO;case"Trace":return dC;case"None":return dF;case"Warning":return dk}},yp=Symbol.for("effect/Micro"),yd=Symbol.for("effect/Micro/MicroExit"),yg=e=>"object"==typeof e&&null!==e&&yp in e,ym=Symbol.for("effect/Micro/MicroCause"),yb={_E:ih};class yy extends globalThis.Error{_tag;traces;[ym];constructor(e,t,r){let n,i,s;const a=`MicroCause.${e}`;if(t instanceof globalThis.Error){n=`(${a}) ${t.name}`;const e=(i=t.message).split("\n").length;s=t.stack?`(${a}) ${t.stack.split("\n").slice(0,e+3).join("\n")}`:`${n}: ${i}`}else n=a,i=so(t,0),s=`${n}: ${i}`;r.length>0&&(s+=`
    ${r.join("\n    ")}`),super(i),this._tag=e,this.traces=r,this[ym]=yb,this.name=n,this.stack=s}pipe(){return sp(this,arguments)}toString(){return this.stack}[ss](){return this.stack}}class yv extends yy{error;constructor(e,t=[]){super("Fail",e,t),this.error=e}}class yS extends yy{defect;constructor(e,t=[]){super("Die",e,t),this.defect=e}}class yx extends yy{constructor(e=[]){super("Interrupt","interrupted",e)}}let y_=e=>"Fail"===e._tag,yw=e=>"Interrupt"===e._tag,yk=Symbol.for("effect/Micro/MicroFiber"),yO={_A:ih,_E:ih};class yE{context;interruptible;[yk];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(e,t=!0){this.context=e,this.interruptible=t,this[yk]=yO}getRef(e){let t;return t=this.context,t.unsafeMap.has(e.key)?t.unsafeMap.get(e.key):c_(e)}addObserver(e){return this._exit?(e(this._exit),im):(this._observers.push(e),()=>{let t=this._observers.indexOf(e);t>=0&&this._observers.splice(t,1)})}_interrupted=!1;unsafeInterrupt(){!this._exit&&(this._interrupted=!0,this.interruptible&&this.evaluate(y8))}unsafePoll(){return this._exit}evaluate(e){if(this._exit)return;if(void 0!==this._yielded){let e=this._yielded;this._yielded=void 0,e()}let t=this.runLoop(e);if(t===yj)return;let r=yC.interruptChildren&&yC.interruptChildren(this);if(void 0!==r)return this.evaluate(y1(r,()=>t));this._exit=t;for(let e=0;e<this._observers.length;e++)this._observers[e](t);this._observers.length=0}runLoop(e){let t=!1,r=e;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!t&&this.getRef(vo).shouldYield(this)){t=!0;let e=r;r=y1(yH,()=>e)}if((r=r[yR](this))===yj){let e=this._yielded;if(yd in e)return this._yielded=void 0,e;return yj}}}catch(e){if(!iD(r,yR))return y7(`MicroFiber.runLoop: Not a valid effect: ${String(r)}`);return y7(e)}}getCont(e){for(;;){let t=this._stack.pop();if(!t)return;let r=t[yA]&&t[yA](this);if(r)return{[e]:r};if(t[e])return t}}_yielded=void 0;yieldWith(e){return this._yielded=e,yj}children(){return this._children??=new Set}}let yC=ik("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),yF=e=>yJ(()=>{for(let t of e)t.unsafeInterrupt();let t=e[Symbol.iterator](),r=yJ(()=>{let e=t.next();for(;!e.done;){if(e.value.unsafePoll()){e=t.next();continue}let n=e.value;return yZ(e=>{n.addObserver(t=>{e(r)})})}return y9});return r}),yI=Symbol.for("effect/Micro/identifier"),yT=Symbol.for("effect/Micro/args"),yR=Symbol.for("effect/Micro/evaluate"),yN=Symbol.for("effect/Micro/successCont"),yM=Symbol.for("effect/Micro/failureCont"),yA=Symbol.for("effect/Micro/ensureCont"),yj=Symbol.for("effect/Micro/Yield"),yD={...sA,_op:"Micro",[yp]:{_A:ih,_E:ih,_R:ih},pipe(){return sp(this,arguments)},[Symbol.iterator](){return new iJ(new iV(this))},toJSON(){return{_id:"Micro",op:this[yI],...yT in this?{args:this[yT]}:void 0}},toString(){return JSON.stringify(this,null,2)},[ss](){return JSON.stringify(this,null,2)}};function yP(e){return y7("Micro.evaluate: Not implemented")}let y$=e=>({...yD,[yI]:e.op,[yR]:e.eval??yP,[yN]:e.contA,[yM]:e.contE,[yA]:e.ensure}),yz=e=>{let t=y$(e);return function(){let r=Object.create(t);return r[yT]=!1===e.single?arguments:arguments[0],r}},yL=e=>{let t={...y$(e),[yd]:yd,_tag:e.op,get[e.prop](){return this[yT]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[yT]}},[st](t){return y5(t)&&t._tag===e.op&&sr(this[yT],t[yT])},[i0](){return se(this,i3(i8(e.op))(i1(this[yT])))}};return function(e){let r=Object.create(t);return r[yT]=e,r[yN]=void 0,r[yM]=void 0,r[yA]=void 0,r}},yU=yL({op:"Success",prop:"value",eval(e){let t=e.getCont(yN);return t?t[yN](this[yT],e):e.yieldWith(this)}}),yB=yL({op:"Failure",prop:"cause",eval(e){let t=e.getCont(yM);for(;yw(this[yT])&&t&&e.interruptible;)t=e.getCont(yM);return t?t[yM](this[yT],e):e.yieldWith(this)}}),yq=yz({op:"Sync",eval(e){let t=this[yT](),r=e.getCont(yN);return r?r[yN](t,e):e.yieldWith(y4(t))}}),yJ=yz({op:"Suspend",eval(e){return this[yT]()}}),yH=yz({op:"Yield",eval(e){let t=!1;return e.getRef(vo).scheduleTask(()=>{t||e.evaluate(y9)},this[yT]??0),e.yieldWith(()=>{t=!0})}})(0),yW=yU(void 0),yK=yz({op:"WithMicroFiber",eval(e){return this[yT](e)}}),yV=yz({op:"Async",single:!1,eval(e){let t=this[yT][0],r=!1,n=!1,i=this[yT][1]?new AbortController:void 0,s=t(t=>{r||(r=!0,n?e.evaluate(t):n=t)},i?.signal);return!1!==n?n:(n=!0,e._yielded=()=>{r=!0},void 0===i&&void 0===s||e._stack.push(yG(()=>(r=!0,i?.abort(),s??y9))),yj)}}),yG=yz({op:"AsyncFinalizer",ensure(e){e.interruptible&&(e.interruptible=!1,e._stack.push(vy(!0)))},contE(e,t){return yw(e)?y1(this[yT](),()=>yB(e)):yB(e)}}),yZ=e=>yV(e,e.length>=2),yQ=ic(2,(e,t)=>y3(e,e=>t)),yY=ic(2,(e,t)=>y1(e,e=>{let r=yg(t)?t:"function"==typeof t?t(e):t;return yg(r)?r:yU(r)})),yX=((e,t)=>y1(e,e=>{let r=yg(t)?t:"function"==typeof t?t(e):t;return yg(r)?yQ(r,e):yU(e)}),e=>vp(e,{onFailure:y6,onSuccess:y4})),y0=ic(2,(e,t)=>{let r;return r=[e,t],yK(e=>yZ(t=>{let n=!1,i=new Set,s=e=>{n=!0,t(0===i.size?e:y1(yF(i),()=>e))};for(let t of r){if(n)break;let r=vk(e,vv(t),!0,!0);i.add(r),r.addObserver(e=>{i.delete(r),s(e)})}return yF(i)}))}),y1=ic(2,(e,t)=>{let r=Object.create(y2);return r[yT]=e,r[yN]=t,r}),y2=y$({op:"OnSuccess",eval(e){return e._stack.push(this),this[yT]}}),y3=ic(2,(e,t)=>y1(e,e=>yU(t(e)))),y5=e=>iD(e,yd),y4=yU,y6=yB,y8=y6(((e=[])=>new yx(e))()),y7=e=>y6(((e,t=[])=>new yS(e,t))(e)),y9=y4(void 0),ve=e=>{for(let t of e)if("Failure"===t._tag)return t;return y9},vt="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class vr{tasks=[];running=!1;scheduleTask(e,t){this.tasks.push(e),this.running||(this.running=!0,vt(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let e=this.tasks;this.tasks=[];for(let t=0,r=e.length;t<r;t++)e[t]()}shouldYield(e){return e.currentOpCount>=e.getRef(vs)}flush(){for(;this.tasks.length>0;)this.runTasks()}}let vn=ic(2,(e,t)=>yK(r=>{let n=r.context;return r.context=t(n),vb(e,()=>(r.context=n,yW))})),vi=ic(2,(e,t)=>vn(e,cO(t)));(e,t,r)=>vn(e,cS(t,r));class vs extends cF()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class va extends cF()("effect/Micro/currentConcurrency",{defaultValue:()=>"unbounded"}){}class vo extends cF()("effect/Micro/currentScheduler",{defaultValue:()=>new vr}){}e=>yg(e[1]),(e,t)=>Array.from({length:t},()=>e);let vl=ic(2,(e,t)=>{let r=Object.create(vu);return r[yT]=e,r[yM]=t,r}),vu=y$({op:"OnFailure",eval(e){return e._stack.push(this),this[yT]}}),vc=ic(3,(e,t,r)=>vl(e,e=>t(e)?r(e):yB(e))),vh=((e,t)=>vc(e,y_,e=>t(e.error)),ic(2,(e,t)=>{let r=Object.create(vf);return r[yT]=e,r[yN]=t.onSuccess,r[yM]=t.onFailure,r})),vf=y$({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[yT]}}),vp=ic(2,(e,t)=>vh(e,{onFailure:e=>yq(()=>t.onFailure(e)),onSuccess:e=>yq(()=>t.onSuccess(e))})),vd=((e,t)=>vh(e,{onFailure:e=>"Fail"===e._tag?t.onFailure(e.error):yB(e),onSuccess:t.onSuccess}),e=>yZ(t=>{let r=setTimeout(()=>{t(yW)},e);return yq(()=>{clearTimeout(r)})})),vg=((e,t)=>y0(e,yY(vv(vd(t.duration)),t.onTimeout)),Symbol.for("effect/Micro/MicroScope"));class vm{[vg];state={_tag:"Open",finalizers:new Set};constructor(){this[vg]=vg}unsafeAddFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.add(e)}addFinalizer(e){return yJ(()=>"Open"===this.state._tag?(this.state.finalizers.add(e),yW):e(this.state.exit))}unsafeRemoveFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.delete(e)}close(e){return yJ(()=>{if("Open"===this.state._tag){let t=Array.from(this.state.finalizers).reverse();return this.state={_tag:"Closed",exit:e},y1(vw(t,t=>yX(t(e))),ve)}return yW})}get fork(){return yq(()=>{let e=new vm;if("Closed"===this.state._tag)return e.state=this.state,e;function t(t){return e.close(t)}return this.state.finalizers.add(t),e.unsafeAddFinalizer(e=>yq(()=>this.unsafeRemoveFinalizer(t))),e})}}let vb=ic(2,(e,t)=>vS(r=>vh(r(e),{onFailure:e=>y1(t(y6(e)),()=>yB(e)),onSuccess:e=>y1(t(y4(e)),()=>yU(e))}))),vy=((e,t,r)=>vb(e,e=>t(e)?r(e):y9),yz({op:"SetInterruptible",ensure(e){if(e.interruptible=this[yT],e._interrupted&&e.interruptible)return()=>y8}})),vv=e=>yK(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(vy(!1)),t._interrupted)?y8:e),vS=e=>yK(t=>t.interruptible?(t.interruptible=!1,t._stack.push(vy(!0)),e(vv)):e(ih)),vx=(e,t)=>Array.isArray(e)||iD(e,Symbol.iterator)?vw(e,ih,t):t?.discard?vw(Object.values(e),ih,t):yJ(()=>{let r={};return yQ(vw(Object.entries(e),([e,t])=>y3(t,t=>{r[e]=t}),{discard:!0,concurrency:t?.concurrency}),r)}),v_=yz({op:"While",contA(e,t){return(this[yT].step(e),this[yT].while())?(t._stack.push(this),this[yT].body()):y9},eval(e){return this[yT].while()?(e._stack.push(this),this[yT].body()):y9}}),vw=(e,t,r)=>yK(n=>{let i=r?.concurrency==="inherit"?n.getRef(va):r?.concurrency??1,s="unbounded"===i?1/0:Math.max(1,i),a=a$(e),o=a.length;if(0===o)return r?.discard?yW:yU([]);let l=r?.discard?void 0:Array(o),u=0;return 1===s?yQ(v_({while:()=>u<a.length,body:()=>t(a[u],u),step:l?e=>l[u++]=e:e=>u++}),l):yZ(e=>{let r,i=new Set,c=0,h=0,f=!1,p=!1;return!function d(){for(f=!0;c<s&&u<o;){let g=u,m=a[g];u++,c++;try{let a=vk(n,t(m,g),!0,!0);i.add(a),a.addObserver(t=>{i.delete(a),p||("Failure"===t._tag?void 0===r&&(r=t,o=u,i.forEach(e=>e.unsafeInterrupt())):void 0!==l&&(l[g]=t.value),h++,c--,h===o?e(r??yU(l)):!f&&c<s&&d())})}catch(e){r=y7(e),o=u,i.forEach(e=>e.unsafeInterrupt())}}f=!1}(),yJ(()=>(p=!0,u=o,yF(i)))})}),vk=(e,t,r=!1,n=!1)=>{let i=new yE(e.context,e.interruptible);return n||(e.children().add(i),i.addObserver(()=>e.children().delete(i))),r?i.evaluate(t):e.getRef(vo).scheduleTask(()=>i.evaluate(t),0),i},vO=function(){class e extends globalThis.Error{}return Object.assign(e.prototype,yD,sj,{[yI]:"Failure",[yR](){return yB(((e,t=[])=>new yv(e,t))(this))},toString(){return this.message?`${this.name}: ${this.message}`:this.name},toJSON(){return{...this}},[ss](){let e=this.stack;return e?`${this.toString()}
${e.split("\n").slice(1).join("\n")}`:this.toString()}}),e}(),vE=class extends vO{constructor(e){super(),e&&Object.assign(this,e)}},vC=e=>{class t extends vE{_tag=e}return t.prototype.name=e,t},vF=Symbol.for("effect/Readable"),vI=Symbol.for("effect/Ref"),vT={_A:e=>e};class vR extends b${ref;commit(){return this.get}[vI]=vT;[vF]=vF;constructor(e){super(),this.ref=e,this.get=dr(()=>this.ref.current)}get;modify(e){return dr(()=>{let t=this.ref.current,[r,n]=e(t);return t!==n&&hs(n)(this.ref),r})}}let vN=e=>new vR(hn(e)),vM=e=>dr(()=>vN(e)),vA=ic(2,(e,t)=>e.modify(()=>[void 0,t])),vj=ic(2,(e,t)=>e.modify(e=>[e,t])),vD=ic(2,(e,t)=>e.modify(t)),vP=ic(2,(e,t)=>e.modify(e=>[void 0,t(e)]));class v${buckets=[];scheduleTask(e,t){let r,n=this.buckets.length,i=0;for(;i<n;i++)if(this.buckets[i][0]<=t)r=this.buckets[i];else break;r&&r[0]===t?r[1].push(e):i===n?this.buckets.push([t,[e]]):this.buckets.splice(i,0,[t,[e]])}}class vz{maxNextTickBeforeTimer;running=!1;tasks=new v$;constructor(e){this.maxNextTickBeforeTimer=e}starveInternal(e){let t=this.tasks.buckets;for(let[e,r]of(this.tasks.buckets=[],t))for(let e=0;e<r.length;e++)r[e]();0===this.tasks.buckets.length?this.running=!1:this.starve(e)}starve(e=0){e>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(e+1))}shouldYield(e){return e.currentOpCount>e.getFiberRef(dV)&&e.getFiberRef(dK)}scheduleTask(e,t){this.tasks.scheduleTask(e,t),this.running||(this.running=!0,this.starve())}}let vL=ik(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new vz(2048));class vU{tasks=new v$;deferred=!1;scheduleTask(e,t){this.deferred?vL.scheduleTask(e,t):this.tasks.scheduleTask(e,t)}shouldYield(e){return e.currentOpCount>e.getFiberRef(dV)&&e.getFiberRef(dK)}flush(){for(;this.tasks.buckets.length>0;){let e=this.tasks.buckets;for(let[t,r]of(this.tasks.buckets=[],e))for(let e=0;e<r.length;e++)r[e]()}this.deferred=!0}}let vB=ik(Symbol.for("effect/FiberRef/currentScheduler"),()=>dq(vL)),vq=ik(Symbol.for("effect/FiberRef/currentRequestMap"),()=>dq(new Map)),vJ=(e,t,r,n)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return dM(dX,e=>"unbounded"===e?r():e>1?n(e):t());default:return e>1?n(e):t()}},vH=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return dM(dX,e=>"unbounded"===e||e>1?r():t());default:return e>1?r():t()}},vW=e=>{let t=cP(e);return bf(e=>e.sleep(t))},vK=e=>e.replace(/[\s="]/g,"_"),vV=e=>t=>{let r=vK(t.label);return`${r}=${e-t.startTime}ms`},vG="effect/MetricLabel",vZ=Symbol.for(vG);class vQ{key;value;[vZ]=vZ;_hash;constructor(e,t){this.key=e,this.value=t,this._hash=i8(vG+this.key+this.value)}[i0](){return this._hash}[st](e){return vY(e)&&this.key===e.key&&this.value===e.value}pipe(){return sp(this,arguments)}}let vY=e=>iD(e,vZ),vX=ic(e=>pv(e[0]),function(){let e=arguments;return dB(e[0],dG,"string"==typeof e[1]?l4(e[1],e[2]):t=>Object.entries(e[1]).reduce((e,[t,r])=>l4(e,t,r),t))}),v0=ic(2,(e,t)=>pK(e,{onFailure:e=>{let r=t(e);switch(r._tag){case"None":return p$(e);case"Some":return r.value}},onSuccess:de})),v1=ic(e=>pv(e[0]),(e,...t)=>{let r=t[t.length-1];return pT(e,2===t.length?iP(t[0]):e=>{let r=iD(e,"_tag")?e._tag:void 0;if(!r)return!1;for(let e=0;e<t.length-1;e++)if(t[e]===r)return!0;return!1},r)}),v2=ic(2,(e,t)=>{let r;return pT(e,e=>(r??=Object.keys(t),iD(e,"_tag")&&iO(e._tag)&&r.includes(e._tag)),e=>t[e._tag](e))}),v3=ic(3,(e,t,r)=>pB(e,e=>p2(r(e),r=>({...e,[t]:r})))),v5=ic(2,(e,t)=>p2(e,e=>({[t]:e}))),v4=((e,t)=>dt(()=>{let r,n=e[Symbol.iterator](),i=[],s=de(!1),a=0;for(;(r=n.next())&&!r.done;){let e=r.value,n=a++;s=pB(s,r=>r?(i.push(e),de(!0)):t(e,n))}return p2(s,()=>i)}),(e,t,r,n)=>pB(r(n,t),i=>{if(i)return de(sV(n));let s=e.next();return s.done?de(ah()):v4(e,t+1,r,s.value)})),v6=ic(2,(e,t)=>pV(e,{onFailure:e=>de(t.onFailure(e)),onSuccess:e=>de(t.onSuccess(e))})),v8=e=>{let t=pB(pB(e,()=>dp()),()=>t);return t},v7=pS(e=>de(e.getFiberRefs())),v9=e=>(...t)=>{let r,n=am(e);for(let e=0,n=t.length;e<n;e++){let n=t[e];uB(n)&&(r=void 0!==r?uU(r,n):n,t=[...t.slice(0,e),...t.slice(e+1)],e--)}return void 0===r&&(r=uD),pS(e=>(e.log(t,r,n),dl))},Se=v9(),St=v9(dE),Sr=v9(dO),Sn=v9(dk),Si=v9(dw),Ss=ic(2,(e,t)=>pB(bp,r=>dB(e,dQ,hU({label:t,startTime:r})))),Sa=ic(2,(e,t)=>pK(e,{onFailure:e=>pz(()=>t(e)),onSuccess:de})),So=ic(3,(e,t,r)=>pB(gZ,n=>gQ(e,cS(n,t,r)))),Sl=ic(3,(e,t,r)=>{let n;return n=n=>pB(r,r=>gQ(e,ib(n,cS(t,r)))),pB(gZ,n)}),Su=ic(3,(e,t,r)=>a$(e).reduce((e,t,n)=>pB(e,e=>r(e,t,n)),de(t))),Sc=de(ah()),Sh=ic(3,(e,t,r)=>pB(t,n=>pB(e,e=>p2(t,t=>[r(n,t),e]))));(e,t)=>dt(()=>{let r,n=e[Symbol.iterator](),i=[],s=de(!0),a=0;for(;(r=n.next())&&!r.done;){let e=r.value,n=a++;s=pB(s,r=>ib(r?t(e,n):de(!1),p2(t=>(t&&i.push(e),t))))}return p2(s,()=>i)});let Sf=ic(2,(e,{onFailure:t,onSuccess:r})=>pK(e,{onFailure:e=>{let r=uV(e);switch(r._tag){case"Left":return dm(t(r.left),p$(e));case"Right":return p$(e)}},onSuccess:e=>p_(r(e),e)})),Sp=ic(2,(e,t)=>pF(e,e=>af(u8(e,{onEmpty:ah(),onFail:()=>ah(),onDie:e=>sV(u$(e)),onInterrupt:()=>ah(),onSequential:aF(uU),onParallel:aF(uL)}),{onNone:()=>p$(e),onSome:r=>dm(t(r),p$(e))}))),Sd=ic(2,(e,t)=>pK(e,{onFailure:e=>{let r=uV(e);switch(r._tag){case"Left":return dm(t(r.left),p$(e));case"Right":return p$(e)}},onSuccess:de})),Sg=ic(2,(e,t)=>pK(e,{onFailure:e=>dm(t(e),p$(e)),onSuccess:de})),Sm=e=>{let t,r;"function"==typeof e?t=e:(t=e.try,r=e.catch);let n=e=>r?pB(dr(()=>r(e)),pP):pP(new gv(e,"An unknown error occurred in Effect.tryPromise"));return t.length>=1?pC((e,r)=>{try{t(r).then(t=>e(gM(t)),t=>e(n(t)))}catch(t){e(n(t))}}):pC(e=>{try{t().then(t=>e(gM(t)),t=>e(n(t)))}catch(t){e(n(t))}})},Sb=ic(2,(e,t)=>dt(()=>t()?p2(e,sV):de(ah()))),Sy=BigInt(0),Sv=a_(e=>cw(e.context,bl)?"Span"===e._tag?Sv(e.parent):ah():sV(e)),SS=(e,...t)=>{let r=bo(1===t.length?void 0:t[0]),n=t[t.length-1];return pS(t=>{let i=((e,t,r)=>{let n,i=!e.getFiberRef(d6)||r.context&&cw(r.context,bl),s=e.getFiberRef(dW),a=r.parent?sV(r.parent):r.root?ah():Sv(ck(s,bn));if(i){let e;e={name:t,parent:a,context:cS(r.context??cy,bl,!0)},n=Object.assign(Object.create(g1),e)}else{let i=e.getFiberRef(bc),s=cw(i,br),o=cw(i,ml),l=e.getFiberRef(d8),u=e.getFiberRefs(),c=bQ(u,d7),h=bQ(u,d9),f="Some"===h._tag?void 0!==r.links?[...ln(h.value),...r.links??[]]:ln(h.value):r.links??ou();n=s.span(t,a,r.context??cy,f,l?o.unsafeCurrentTimeNanos():Sy,r.kind??"internal"),"Some"===c._tag&&ui(c.value,(e,t)=>n.attribute(t,e)),void 0!==r.attributes&&Object.entries(r.attributes).forEach(([e,t])=>n.attribute(e,t))}return"function"==typeof r.captureStackTrace&&cs.set(n,r.captureStackTrace),n})(t,e,r),s=t.getFiberRef(d8),a=cw(t.getFiberRef(bc),ml);return p4(n(i),e=>dr(()=>{"Ended"!==i.status._tag&&("Failure"===e._tag&&cs.has(i)&&i.attribute("code.stacktrace",cs.get(i)()),i.end(s?a.unsafeCurrentTimeNanos():Sy,e))}))})},Sx=ic(2,(e,t)=>So(e,bn,t)),S_="InterruptSignal",Sw="Stateful",Sk="Resume",SO="YieldNow",SE=e=>({_tag:S_,cause:e}),SC=e=>({_tag:Sw,onFiber:e}),SF=e=>({_tag:Sk,effect:e}),SI=()=>({_tag:SO}),ST=Symbol.for("effect/FiberScope");class SR{[ST]=ST;fiberId=hw;roots=new Set;add(e,t){this.roots.add(t),t.addObserver(()=>{this.roots.delete(t)})}}class SN{fiberId;parent;[ST]=ST;constructor(e,t){this.fiberId=e,this.parent=t}add(e,t){this.parent.tell(SC(e=>{e.addChild(t),t.addObserver(()=>{e.removeChild(t)})}))}}let SM=ik(Symbol.for("effect/FiberScope/Global"),()=>new SR),SA=Symbol.for("effect/Fiber"),Sj={_E:e=>e,_A:e=>e},SD={[SA]:Sj,pipe(){return sp(this,arguments)}},SP=Symbol.for("effect/Fiber"),S$=((e,t)=>e.interruptAsFork(t),e=>dg(pH(e.await),e.inheritAll)),Sz=((e,t)=>Sz(e,e=>dr(()=>t(e))),ic(2,(e,t)=>({...sD,commit(){return S$(this)},...SD,id:()=>e.id(),await:pB(e.await,gI(t)),children:e.children,inheritAll:e.inheritAll,poll:pB(e.poll,e=>{switch(e._tag){case"None":return de(ah());case"Some":return ib(gI(e.value,t),p2(sV))}}),interruptAsFork:t=>e.interruptAsFork(t)})));({...sD,commit(){return S$(this)},...SD,id:()=>hw,await:dy,children:de([]),inheritAll:dy,poll:de(ah()),interruptAsFork:()=>dy}),(e,t)=>({...sD,commit(){return S$(this)},...SD,id:()=>hy(e.id(),t.id()),await:db(e.await,t.await,(e,t)=>gx(e)?e:t),children:e.children,inheritAll:dm(t.inheritAll,e.inheritAll),poll:db(e.poll,t.poll,(e,t)=>{switch(e._tag){case"None":return ah();case"Some":return gx(e.value)?e:t}}),interruptAsFork:r=>ib(dS(e,r),dm(ib(t,dS(r))),pw)});let SL="effect/FiberCurrent",SU=Symbol.for("effect/Logger"),SB={_Message:e=>e,_Output:e=>e},Sq=e=>({[SU]:SB,log:e,pipe(){return sp(this,arguments)}}),SJ=ic(2,(e,t)=>Sq(r=>e.log({...r,message:t(r.message)}))),SH=ic(2,(e,t)=>Sq(r=>e.log(t(r)))),SW=ic(2,(e,t)=>Sq(r=>t(r.logLevel)?sV(e.log(r)):ah())),SK=ic(2,(e,t)=>Sq(r=>t(e.log(r)))),SV=e=>({[SU]:SB,log:({message:t})=>e(t),pipe(){return sp(this,arguments)}}),SG=ic(2,(e,t)=>Sq(r=>[e.log(r),t.log(r)])),SZ=ic(2,(e,t)=>SK(SG(e,t),e=>e[0])),SQ=ic(2,(e,t)=>SK(SG(e,t),e=>e[1])),SY=/^[^\s"=]*$/,SX=(e,t)=>({annotations:r,cause:n,date:i,fiberId:s,logLevel:a,message:o,spans:l})=>{let u=t=>t.match(SY)?t:e(t),c=(e,t)=>`${vK(e)}=${u(t)}`,h=(e,t)=>" "+c(e,t),f=c("timestamp",i.toISOString());f+=h("level",a.label),f+=h("fiber",hx(s));let p=az(o);for(let e=0;e<p.length;e++)f+=h("message",so(p[e],t));for(let e of(n._tag!==uF&&(f+=h("cause",ce(n,{renderErrorCause:!0}))),l))f+=" "+vV(i.getTime())(e);for(let[e,n]of r)f+=h(e,so(n,t));return f},S0=Sq(SX(e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`)),S1=Sq(SX(JSON.stringify,0)),S2=Sq(({annotations:e,cause:t,date:r,fiberId:n,logLevel:i,message:s,spans:a})=>{let o=r.getTime(),l={},u={};if(e._size>0)for(let[t,r]of e)l[t]=S3(r);if(hj(a))for(let e of a)u[e.label]=o-e.startTime;let c=az(s);return{message:1===c.length?S3(c[0]):c.map(S3),logLevel:i.label,timestamp:r.toISOString(),cause:uq(t)?void 0:ce(t,{renderErrorCause:!0}),annotations:l,spans:u,fiberId:hx(n)}}),S3=e=>{switch(typeof e){case"bigint":case"function":case"symbol":return String(e);default:return sa(e)}},S5=SK(S2,sl),S4=(e,...t)=>{let r="";for(let e=0;e<t.length;e++)r+=`\x1b[${t[e]}m`;return r+e+"\x1b[0m"},S6=(e,...t)=>e,S8={None:[],All:[],Trace:["90"],Debug:["34"],Info:["32"],Warning:["33"],Error:["31"],Fatal:["101","30"]},S7={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},S9=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`,xe="object"==typeof process&&null!==process&&"object"==typeof process.stdout&&null!==process.stdout,xt=xe&&!0===process.stdout.isTTY,xr=xe||"Deno"in globalThis,xn=e=>{let t=e?.mode??"auto",r="browser"===("auto"===t?xr?"tty":"browser":t),n="boolean"==typeof e?.colors?e.colors:xt||r,i=e?.formatDate??S9;return r?xs({colors:n,formatDate:i}):xi({colors:n,formatDate:i,stderr:e?.stderr===!0})},xi=e=>{let t="object"==typeof process&&"isBun"in process&&!0===process.isBun,r=e.colors?S4:S6;return Sq(({annotations:n,cause:i,context:s,date:a,fiberId:o,logLevel:l,message:u,spans:c})=>{let h=cw(bY(s,bc),m4).unsafe,f=!0===e.stderr?h.error:h.log,p=az(u),d=r(`[${e.formatDate(a)}]`,"37")+` ${r(l.label,...S8[l._tag])}`+` (${hx(o)})`;if(hj(c)){let e=vV(a.getTime());for(let t of c)d+=" "+e(t)}d+=":";let g=0;if(p.length>0){let e=S3(p[0]);"string"==typeof e&&(d+=" "+r(e,"1","36"),g++)}if(f(d),t||h.group(),uq(i)||f(ce(i,{renderErrorCause:!0})),g<p.length)for(;g<p.length;g++)f(sf(p[g]));if(n._size>0)for(let[e,t]of n)f(r(`${e}:`,"1","37"),sf(t));t||h.groupEnd()})},xs=e=>{let t=e.colors?"%c":"";return Sq(({annotations:r,cause:n,context:i,date:s,fiberId:a,logLevel:o,message:l,spans:u})=>{let c=cw(bY(i,bc),m4).unsafe,h=az(l),f=`${t}[${e.formatDate(s)}]`,p=[];if(e.colors&&p.push("color:gray"),f+=` ${t}${o.label}${t} (${hx(a)})`,e.colors&&p.push(S7[o._tag],""),hj(u)){let e=vV(s.getTime());for(let t of u)f+=" "+e(t)}f+=":";let d=0;if(h.length>0){let r=S3(h[0]);"string"==typeof r&&(f+=` ${t}${r}`,e.colors&&p.push("color:deepskyblue"),d++)}if(c.groupCollapsed(f,...p),uq(n)||c.error(ce(n,{renderErrorCause:!0})),d<h.length)for(;d<h.length;d++)c.log(sf(h[d]));if(r._size>0)for(let[t,n]of r){let r=sf(n);e.colors?c.log(`%c${t}:`,"color:gray",r):c.log(`${t}:`,r)}c.groupEnd()})},xa=ik("effect/Logger/prettyLoggerDefault",()=>xn()),xo="effect/MetricBoundaries",xl=Symbol.for(xo);class xu{values;[xl]=xl;constructor(e){this.values=e,this._hash=ib(i8(xo),i3(i9(this.values)))}_hash;[i0](){return this._hash}[st](e){return xc(e)&&sr(this.values,e.values)}pipe(){return sp(this,arguments)}}let xc=e=>iD(e,xl),xh=Symbol.for("effect/MetricKeyType"),xf="effect/MetricKeyType/Counter",xp=Symbol.for(xf),xd="effect/MetricKeyType/Frequency",xg=Symbol.for(xd),xm="effect/MetricKeyType/Gauge",xb=Symbol.for(xm),xy="effect/MetricKeyType/Histogram",xv=Symbol.for(xy),xS=Symbol.for("effect/MetricKeyType/Summary"),xx={_In:e=>e,_Out:e=>e};class x_{incremental;bigint;[xh]=xx;[xp]=xp;constructor(e,t){this.incremental=e,this.bigint=t,this._hash=i8(xf)}_hash;[i0](){return this._hash}[st](e){return xw(e)}pipe(){return sp(this,arguments)}}let xw=e=>iD(e,xp),xk=e=>iD(e,xv),xO=Symbol.for("effect/MetricKey"),xE={_Type:e=>e},xC=o_(sr);class xF{name;keyType;description;tags;[xO]=xE;constructor(e,t,r,n=[]){this.name=e,this.keyType=t,this.description=r,this.tags=n,this._hash=ib(i8(this.name+this.description),i3(i1(this.keyType)),i3(i9(this.tags)))}_hash;[i0](){return this._hash}[st](e){return xI(e)&&this.name===e.name&&sr(this.keyType,e.keyType)&&sr(this.description,e.description)&&xC(this.tags,e.tags)}pipe(){return sp(this,arguments)}}let xI=e=>iD(e,xO),xT=ic(2,(e,t)=>0===t.length?e:new xF(e.name,e.keyType,e.description,oa(e.tags,t))),xR=Symbol.for("effect/MutableHashMap"),xN={[xR]:xR,[Symbol.iterator](){return new xM(this)},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(sa)}},[ss](){return this.toJSON()},pipe(){return sp(this,arguments)}};class xM{self;referentialIterator;bucketIterator;constructor(e){this.self=e,this.referentialIterator=e.referential[Symbol.iterator]()}next(){if(void 0!==this.bucketIterator)return this.bucketIterator.next();let e=this.referentialIterator.next();return e.done?(this.bucketIterator=new xA(this.self.buckets.values()),this.next()):e}[Symbol.iterator](){return new xM(this.self)}}class xA{backing;constructor(e){this.backing=e}currentBucket;next(){if(void 0===this.currentBucket){let e=this.backing.next();if(e.done)return e;this.currentBucket=e.value[Symbol.iterator]()}let e=this.currentBucket.next();return e.done?(this.currentBucket=void 0,this.next()):e}}let xj=()=>{let e=Object.create(xN);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e},xD=ic(2,(e,t)=>{if(!1===si(t))return e.referential.has(t)?sV(e.referential.get(t)):ah();let r=t[i0](),n=e.buckets.get(r);return void 0===n?ah():xP(e,n,t)}),xP=(e,t,r,n=!1)=>{for(let i=0,s=t.length;i<s;i++)if(r[st](t[i][0])){let r=t[i][1];return n&&(t.splice(i,1),e.bucketsSize--),sV(r)}return ah()},x$=ic(2,(e,t)=>sW(xD(e,t))),xz=ic(3,(e,t,r)=>{if(!1===si(t))return e.referential.set(t,r),e;let n=t[i0](),i=e.buckets.get(n);return void 0===i?e.buckets.set(n,[[t,r]]):(xL(e,i,t),i.push([t,r])),e.bucketsSize++,e}),xL=(e,t,r)=>{for(let n=0,i=t.length;n<i;n++)if(r[st](t[n][0])){t.splice(n,1),e.bucketsSize--;return}},xU=ic(2,(e,t)=>{if(!1===si(t))return e.referential.delete(t),e;let r=t[i0](),n=e.buckets.get(r);return void 0===n||(xL(e,n,t),0===n.length&&e.buckets.delete(r)),e}),xB=e=>e.referential.size+e.bucketsSize,xq=Symbol.for("effect/MetricState"),xJ="effect/MetricState/Counter",xH=Symbol.for(xJ),xW="effect/MetricState/Frequency",xK=Symbol.for(xW),xV="effect/MetricState/Gauge",xG=Symbol.for(xV),xZ="effect/MetricState/Histogram",xQ=Symbol.for(xZ),xY="effect/MetricState/Summary",xX=Symbol.for(xY),x0={_A:e=>e};class x1{count;[xq]=x0;[xH]=xH;constructor(e){this.count=e}[i0](){return ib(i1(xJ),i3(i1(this.count)),se(this))}[st](e){return x8(e)&&this.count===e.count}pipe(){return sp(this,arguments)}}let x2=o_(sr);class x3{occurrences;[xq]=x0;[xK]=xK;constructor(e){this.occurrences=e}_hash;[i0](){return ib(i8(xW),i3(i9(a$(this.occurrences.entries()))),se(this))}[st](e){return x7(e)&&x2(a$(this.occurrences.entries()),a$(e.occurrences.entries()))}pipe(){return sp(this,arguments)}}class x5{value;[xq]=x0;[xG]=xG;constructor(e){this.value=e}[i0](){return ib(i1(xV),i3(i1(this.value)),se(this))}[st](e){return x9(e)&&this.value===e.value}pipe(){return sp(this,arguments)}}class x4{buckets;count;min;max;sum;[xq]=x0;[xQ]=xQ;constructor(e,t,r,n,i){this.buckets=e,this.count=t,this.min=r,this.max=n,this.sum=i}[i0](){return ib(i1(xZ),i3(i1(this.buckets)),i3(i1(this.count)),i3(i1(this.min)),i3(i1(this.max)),i3(i1(this.sum)),se(this))}[st](e){return _e(e)&&sr(this.buckets,e.buckets)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return sp(this,arguments)}}class x6{error;quantiles;count;min;max;sum;[xq]=x0;[xX]=xX;constructor(e,t,r,n,i,s){this.error=e,this.quantiles=t,this.count=r,this.min=n,this.max=i,this.sum=s}[i0](){return ib(i1(xY),i3(i1(this.error)),i3(i1(this.quantiles)),i3(i1(this.count)),i3(i1(this.min)),i3(i1(this.max)),i3(i1(this.sum)),se(this))}[st](e){return _t(e)&&this.error===e.error&&sr(this.quantiles,e.quantiles)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return sp(this,arguments)}}let x8=e=>iD(e,xH),x7=e=>iD(e,xK),x9=e=>iD(e,xG),_e=e=>iD(e,xQ),_t=e=>iD(e,xX),_r=Symbol.for("effect/MetricHook"),_n={_In:e=>e,_Out:e=>e},_i=e=>({[_r]:_n,pipe(){return sp(this,arguments)},...e}),_s=BigInt(0),_a=(e,t,r,n,i,s)=>{let a=e,o=t,l=r,u=n,c=i,h=s,f=e,p=t,d=r,g=n,m=i,b=s;for(;;){if(!aW(h))return{quantile:c,value:ah(),consumed:u,rest:[]};if(1===c)return{quantile:c,value:sV(a0(h)),consumed:u+h.length,rest:[]};let e=aY(h),t=a2(h,t=>t===e),r=c*o,n=a/2*r,i=u+t[0].length,s=Math.abs(i-r);if(i<r-n){f=a,p=o,d=aQ(h),g=i,m=c,b=t[1],a=f,o=p,l=d,u=g,c=m,h=b;continue}if(i>r+n)return{quantile:c,value:sH(l)?sV(e):l,consumed:u,rest:h};switch(l._tag){case"None":f=a,p=o,d=aQ(h),g=i,m=c,b=t[1],a=f,o=p,l=d,u=g,c=m,h=b;continue;case"Some":if(s<Math.abs(r-l.value)){f=a,p=o,d=aQ(h),g=i,m=c,b=t[1],a=f,o=p,l=d,u=g,c=m,h=b;continue}return{quantile:c,value:sV(l.value),consumed:u,rest:h}}}throw Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},_o=Symbol.for("effect/MetricPair"),_l={_Type:e=>e},_u=(e,t)=>({[_o]:_l,metricKey:e,metricState:t,pipe(){return sp(this,arguments)}}),_c=Symbol.for("effect/MetricRegistry");class _h{[_c]=_c;map=xj();snapshot(){let e=[];for(let[t,r]of this.map)e.push(_u(t,r.get()));return e}get(e){let t=ib(this.map,xD(e),ab);if(null!=t)return t;if(xw(e.keyType))return this.getCounter(e);if(iD(e.keyType,xb))return this.getGauge(e);if(iD(e.keyType,xg))return this.getFrequency(e);if(xk(e.keyType))return this.getHistogram(e);if(iD(e.keyType,xS))return this.getSummary(e);throw Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}getCounter(e){let t=ib(this.map,xD(e),ab);if(null==t){let r,n,i,s=(r=e.keyType.bigint?_s:0,n=e.keyType.incremental?e.keyType.bigint?e=>e>=_s:e=>e>=0:e=>!0,_i({get:()=>new x1(r),update:i=e=>{n(e)&&(r+=e)},modify:i}));ib(this.map,x$(e))||ib(this.map,xz(e,s)),t=s}return t}getFrequency(e){let t=ib(this.map,xD(e),ab);if(null==t){let r=(e=>{let t=new Map;for(let r of e.keyType.preregisteredWords)t.set(r,0);let r=e=>{let r=t.get(e)??0;t.set(e,r+1)};return _i({get:()=>new x3(t),update:r,modify:r})})(e);ib(this.map,x$(e))||ib(this.map,xz(e,r)),t=r}return t}getGauge(e){let t=ib(this.map,xD(e),ab);if(null==t){let r,n=(r=e.keyType.bigint?BigInt(0):0,_i({get:()=>new x5(r),update:e=>{r=e},modify:e=>{r+=e}}));ib(this.map,x$(e))||ib(this.map,xz(e,n)),t=n}return t}getHistogram(e){let t=ib(this.map,xD(e),ab);if(null==t){let r,n,i,s,a,o,l,u,c,h=(i=new Uint32Array((n=(r=e.keyType.boundaries.values).length)+1),s=new Float32Array(n),a=0,o=0,l=Number.MAX_VALUE,u=5e-324,ib(r,a6(as),oh((e,t)=>{s[t]=e})),_i({get:()=>{let e;return new x4((e={buckets:(()=>{let e=Array(n),t=0;for(let r=0;r<n;r++){let n=s[r];t+=i[r],e[r]=[n,t]}return e})(),count:a,min:l,max:u,sum:o}).buckets,e.count,e.min,e.max,e.sum)},update:c=e=>{let t=0,r=n;for(;t!==r;){let n=Math.floor(t+(r-t)/2);e<=s[n]?r=n:t=n,r===t+1&&(e<=s[t]?r=t:t=r)}i[t]=i[t]+1,a+=1,o+=e,e<l&&(l=e),e>u&&(u=e)},modify:c}));ib(this.map,x$(e))||ib(this.map,xz(e,h)),t=h}return t}getSummary(e){let t=ib(this.map,xD(e),ab);if(null==t){let r=(e=>{let{error:t,maxAge:r,maxSize:n,quantiles:i}=e.keyType,s=ib(i,a6(as)),a=Array(n),o=0,l=0,u=0,c=0,h=0,f=(e,t)=>{n>0&&(a[(o+=1)%n]=[t,e]),c=0===l?e:Math.min(c,e),h=0===l?e:Math.max(h,e),l+=1,u+=e};return _i({get:()=>{let e;return e={error:t,quantiles:(e=>{let i=[],o=0;for(;o!==n-1;){let t=a[o];if(null!=t){let[n,s]=t,a=cK(e-n);c7(a,cq)&&c6(a,r)&&i.push(s)}o+=1}return((e,t,r)=>{let n=r.length;if(!aW(t))return ou();let i=t[0],s=t.slice(1),a=_a(e,n,ah(),0,i,r),o=oc(a);return s.forEach(t=>{o.push(_a(e,n,a.value,a.consumed,t,a.rest))}),oh(o,e=>[e.quantile,e.value])})(t,s,a6(i,as))})(Date.now()),count:l,min:c,max:h,sum:u},new x6(e.error,e.quantiles,e.count,e.min,e.max,e.sum)},update:([e,t])=>f(e,t),modify:([e,t])=>f(e,t)})})(e);ib(this.map,x$(e))||ib(this.map,xz(e,r)),t=r}return t}}let _f=Symbol.for("effect/Metric"),_p={_Type:e=>e,_In:e=>e,_Out:e=>e},_d=ik(Symbol.for("effect/Metric/globalMetricRegistry"),()=>new _h),_g=function(e,t,r,n){let i=Object.assign(e=>dn(e,e=>_S(i,e)),{[_f]:_p,keyType:e,unsafeUpdate:t,unsafeValue:r,unsafeModify:n,register(){return this.unsafeValue([]),this},pipe(){return sp(this,arguments)}});return i},_m=((e,t)=>_g(e.keyType,(r,n)=>e.unsafeUpdate(t(r),n),e.unsafeValue,(r,n)=>e.unsafeModify(t(r),n)),(e,t)=>_b(new xF(e,new x_(t?.incremental??!1,t?.bigint??!1),am(t?.description)))),_b=e=>{let t,r=new WeakMap,n=n=>{if(0===n.length)return void 0!==t?t:t=_d.get(e);let i=r.get(n);return void 0!==i||(i=_d.get(xT(e,n)),r.set(n,i)),i};return _g(e.keyType,(e,t)=>n(t).update(e),e=>n(e).get(),(e,t)=>n(t).modify(e))},_y=((e,t)=>_g(e.keyType,e.unsafeUpdate,r=>t(e.unsafeValue(r)),e.unsafeModify),ic(3,(e,t,r)=>_v(e,[new vQ(t,r)]))),_v=ic(2,(e,t)=>_g(e.keyType,(r,n)=>e.unsafeUpdate(r,oa(t,n)),r=>e.unsafeValue(oa(t,r)),(r,n)=>e.unsafeModify(r,oa(t,n)))),_S=((e,t,r)=>{let n=e=>_S(t,r(e));return Sp(e,e=>pZ(uH(e),n))},ic(2,(e,t)=>dM(d3,r=>dr(()=>e.unsafeUpdate(t,r))))),_x=ic(2,(e,t)=>dM(vq,r=>dr(()=>{if(r.has(e)){let n=r.get(e);n.state.completed||(n.state.completed=!0,gV(n.result,t))}})));class __{count=0;observers=new Set;interrupted=!1;addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}increment(){this.count++,this.observers.forEach(e=>e(this.count))}decrement(){this.count--,this.observers.forEach(e=>e(this.count))}}let _w=0;class _k{self;stack;direction;count=0;constructor(e,t,r){this.self=e,this.stack=t,this.direction=r}clone(){return new _k(this.self,this.stack.slice(),this.direction)}reversed(){return new _k(this.self,this.stack.slice(),this.direction===_w?1:_w)}next(){let e=this.entry;switch(this.count++,this.direction===_w?this.moveNext():this.movePrev(),e._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:e.value}}}get key(){return this.stack.length>0?sV(this.stack[this.stack.length-1].key):ah()}get value(){return this.stack.length>0?sV(this.stack[this.stack.length-1].value):ah()}get entry(){return ax(aX(this.stack),e=>[e.key,e.value])}get index(){let e=0,t=this.stack;if(0===t.length){let e=this.self._root;return null!=e?e.count:0}null!=t[t.length-1].left&&(e=t[t.length-1].left.count);for(let r=t.length-2;r>=0;--r)t[r+1]===t[r].right&&(++e,null!=t[r].left&&(e+=t[r].left.count));return e}moveNext(){let e=this.stack;if(0===e.length)return;let t=e[e.length-1];if(null!=t.right)for(t=t.right;null!=t;)e.push(t),t=t.left;else for(e.pop();e.length>0&&e[e.length-1].right===t;)t=e[e.length-1],e.pop()}get hasNext(){let e=this.stack;if(0===e.length)return!1;if(null!=e[e.length-1].right)return!0;for(let t=e.length-1;t>0;--t)if(e[t-1].left===e[t])return!0;return!1}movePrev(){let e=this.stack;if(0===e.length)return;let t=e[e.length-1];if(null!=t&&null!=t.left)for(t=t.left;null!=t;)e.push(t),t=t.right;else for(e.pop();e.length>0&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}get hasPrev(){let e=this.stack;if(0===e.length)return!1;if(null!=e[e.length-1].left)return!0;for(let t=e.length-1;t>0;--t)if(e[t-1].right===e[t])return!0;return!1}}let _O=({color:e,count:t,key:r,left:n,right:i,value:s})=>({color:e,key:r,value:s,left:n,right:i,count:t});function _E(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e.color=t.color,e.count=t.count}let _C=({count:e,key:t,left:r,right:n,value:i},s)=>({color:s,key:t,value:i,left:r,right:n,count:e}),_F=e=>{e.count=1+(e.left?.count??0)+(e.right?.count??0)},_I="effect/RedBlackTree",_T=Symbol.for(_I),_R={[_T]:{_Key:e=>e,_Value:e=>e},[i0](){let e=i1(_I);for(let t of this)e^=ib(i1(t[0]),i3(i1(t[1])));return se(this,e)},[st](e){if(_M(e)){if((this._root?.count??0)!==(e._root?.count??0))return!1;let t=Array.from(e);return Array.from(this).every((e,r)=>{let n=t[r];return sr(e[0],n[0])&&sr(e[1],n[1])})}return!1},[Symbol.iterator](){let e=[],t=this._root;for(;null!=t;)e.push(t),t=t.left;return new _k(this,e,_w)},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(sa)}},[ss](){return this.toJSON()},pipe(){return sp(this,arguments)}},_N=(e,t)=>{let r=Object.create(_R);return r._ord=e,r._root=t,r},_M=e=>iD(e,_T),_A=((e,t)=>{let r=_N(t,void 0);for(let[t,n]of e)r=_D(r,t,n);return r},ic(2,(e,t)=>{let r=e._ord,n=e._root;for(;void 0!==n;){let e=r(t,n.key);if(sr(t,n.key))return sV(n.value);n=e<=0?n.left:n.right}return ah()})),_j=ic(2,(e,t)=>sW(_A(e,t))),_D=ic(3,(e,t,r)=>{let n=e._ord,i=e._root,s=[],a=[];for(;null!=i;){let e=n(t,i.key);s.push(i),a.push(e),i=e<=0?i.left:i.right}s.push({color:0,key:t,value:r,left:void 0,right:void 0,count:1});for(let e=s.length-2;e>=0;--e){let t=s[e];a[e]<=0?s[e]={color:t.color,key:t.key,value:t.value,left:s[e+1],right:t.right,count:t.count+1}:s[e]={color:t.color,key:t.key,value:t.value,left:t.left,right:s[e+1],count:t.count+1}}for(let e=s.length-1;e>1;--e){let t=s[e-1],r=s[e];if(1===t.color||1===r.color)break;let n=s[e-2];if(n.left===t)if(t.left===r){let i=n.right;if(i&&0===i.color)t.color=1,n.right=_C(i,1),n.color=0,e-=1;else{if(n.color=0,n.left=t.right,t.color=1,t.right=n,s[e-2]=t,s[e-1]=r,_F(n),_F(t),e>=3){let r=s[e-3];r.left===n?r.left=t:r.right=t}break}}else{let i=n.right;if(i&&0===i.color)t.color=1,n.right=_C(i,1),n.color=0,e-=1;else{if(t.right=r.left,n.color=0,n.left=r.right,r.color=1,r.left=t,r.right=n,s[e-2]=r,s[e-1]=t,_F(n),_F(t),_F(r),e>=3){let t=s[e-3];t.left===n?t.left=r:t.right=r}break}}else if(t.right===r){let i=n.left;if(i&&0===i.color)t.color=1,n.left=_C(i,1),n.color=0,e-=1;else{if(n.color=0,n.right=t.left,t.color=1,t.left=n,s[e-2]=t,s[e-1]=r,_F(n),_F(t),e>=3){let r=s[e-3];r.right===n?r.right=t:r.left=t}break}}else{let i=n.left;if(i&&0===i.color)t.color=1,n.left=_C(i,1),n.color=0,e-=1;else{if(t.left=r.right,n.color=0,n.right=r.left,r.color=1,r.right=t,r.left=n,s[e-2]=r,s[e-1]=t,_F(n),_F(t),_F(r),e>=3){let t=s[e-3];t.right===n?t.right=r:t.left=r}break}}}return s[0].color=1,_N(e._ord,s[0])}),_P=(e,t)=>{let r=e[Symbol.iterator](),n=0;return{[Symbol.iterator]:()=>_P(e,t),next:()=>{n++;let e=r.key;switch(t===_w?r.moveNext():r.movePrev(),e._tag){case"None":return{done:!0,value:n};case"Some":return{done:!1,value:e.value}}}}},_$=ic(2,(e,t)=>{let r=e._root;void 0!==r&&_L(r,(e,r)=>(t(e,r),ah()))}),_z=ic(2,(e,t)=>{if(!_j(e,t))return e;let r=e._ord,n=e._root,i=[];for(;void 0!==n;){let e=r(t,n.key);i.push(n),n=sr(t,n.key)?void 0:e<=0?n.left:n.right}if(0===i.length)return e;let s=Array(i.length),a=i[i.length-1];s[s.length-1]={color:a.color,key:a.key,value:a.value,left:a.left,right:a.right,count:a.count};for(let e=i.length-2;e>=0;--e)(a=i[e]).left===i[e+1]?s[e]={color:a.color,key:a.key,value:a.value,left:s[e+1],right:a.right,count:a.count}:s[e]={color:a.color,key:a.key,value:a.value,left:a.left,right:s[e+1],count:a.count};if(void 0!==(a=s[s.length-1]).left&&void 0!==a.right){let e=s.length;for(a=a.left;null!=a.right;)s.push(a),a=a.right;let t=s[e-1];s.push({color:a.color,key:t.key,value:t.value,left:a.left,right:a.right,count:a.count}),s[e-1].key=a.key,s[e-1].value=a.value;for(let t=s.length-2;t>=e;--t)a=s[t],s[t]={color:a.color,key:a.key,value:a.value,left:a.left,right:s[t+1],count:a.count};s[e-1].left=s[e]}if(0===(a=s[s.length-1]).color){let e=s[s.length-2];e.left===a?e.left=void 0:e.right===a&&(e.right=void 0),s.pop();for(let e=0;e<s.length;++e)s[e].count--}else if(void 0!==a.left||void 0!==a.right){void 0!==a.left?_E(a,a.left):void 0!==a.right&&_E(a,a.right),a.color=1;for(let e=0;e<s.length-1;++e)s[e].count--}else{if(1===s.length)return _N(r,void 0);for(let e=0;e<s.length;++e)s[e].count--;let e=s[s.length-2];_U(s),e.left===a?e.left=void 0:e.right=void 0}return _N(r,s[0])}),_L=(e,t)=>{let r,n=e,i=!1;for(;!i;)if(null!=n)r=lj(n,r),n=n.left;else if(null!=r){let e=t(r.value.key,r.value.value);if(sW(e))return e;n=r.value.right,r=r.previous}else i=!0;return ah()},_U=e=>{let t,r,n,i;for(let s=e.length-1;s>=0;--s){if(t=e[s],0===s){t.color=1;return}if((r=e[s-1]).left===t){if(void 0!==(n=r.right)&&void 0!==n.right&&0===n.right.color){if(i=(n=r.right=_O(n)).right=_O(n.right),r.right=n.left,n.left=r,n.right=i,n.color=r.color,t.color=1,r.color=1,i.color=1,_F(r),_F(n),s>1){let t=e[s-2];t.left===r?t.left=n:t.right=n}e[s-1]=n;return}if(void 0!==n&&void 0!==n.left&&0===n.left.color){if(i=(n=r.right=_O(n)).left=_O(n.left),r.right=i.left,n.left=i.right,i.left=r,i.right=n,i.color=r.color,r.color=1,n.color=1,t.color=1,_F(r),_F(n),_F(i),s>1){let t=e[s-2];t.left===r?t.left=i:t.right=i}e[s-1]=i;return}if(void 0!==n&&1===n.color)if(0===r.color){r.color=1,r.right=_C(n,0);return}else{r.right=_C(n,0);continue}if(void 0!==n){if(r.right=(n=_O(n)).left,n.left=r,n.color=r.color,r.color=0,_F(r),_F(n),s>1){let t=e[s-2];t.left===r?t.left=n:t.right=n}e[s-1]=n,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s+=2}}else{if(void 0!==(n=r.left)&&void 0!==n.left&&0===n.left.color){if(i=(n=r.left=_O(n)).left=_O(n.left),r.left=n.right,n.right=r,n.left=i,n.color=r.color,t.color=1,r.color=1,i.color=1,_F(r),_F(n),s>1){let t=e[s-2];t.right===r?t.right=n:t.left=n}e[s-1]=n;return}if(void 0!==n&&void 0!==n.right&&0===n.right.color){if(i=(n=r.left=_O(n)).right=_O(n.right),r.left=i.right,n.right=i.left,i.right=r,i.left=n,i.color=r.color,r.color=1,n.color=1,t.color=1,_F(r),_F(n),_F(i),s>1){let t=e[s-2];t.right===r?t.right=i:t.left=i}e[s-1]=i;return}if(void 0!==n&&1===n.color)if(0===r.color){r.color=1,r.left=_C(n,0);return}else{r.left=_C(n,0);continue}if(void 0!==n){if(r.left=(n=_O(n)).right,n.right=r,n.color=r.color,r.color=0,_F(r),_F(n),s>1){let t=e[s-2];t.right===r?t.right=n:t.left=n}e[s-1]=n,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s+=2}}}},_B=Symbol.for("effect/SortedSet"),_q={[_B]:{_A:e=>e},[i0](){return ib(i1(this.keyTree),i3(i1(_B)),se(this))},[st](e){return _H(e)&&sr(this.keyTree,e.keyTree)},[Symbol.iterator](){return _P(this.keyTree,_w)},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(sa)}},[ss](){return this.toJSON()},pipe(){return sp(this,arguments)}},_J=e=>{let t=Object.create(_q);return t.keyTree=e,t},_H=e=>iD(e,_B),_W=((e,t)=>_j(e.keyTree,t)?e:_J(_D(e.keyTree,t,!0)),Symbol.for("effect/Supervisor")),_K={_T:e=>e};class _V{underlying;value0;[_W]=_K;constructor(e,t){this.underlying=e,this.value0=t}get value(){return this.value0}onStart(e,t,r,n){this.underlying.onStart(e,t,r,n)}onEnd(e,t){this.underlying.onEnd(e,t)}onEffect(e,t){this.underlying.onEffect(e,t)}onSuspend(e){this.underlying.onSuspend(e)}onResume(e){this.underlying.onResume(e)}map(e){return new _V(this,ib(this.value,p2(e)))}zip(e){return new _G(this,e)}}class _G{left;right;_tag="Zip";[_W]=_K;constructor(e,t){this.left=e,this.right=t}get value(){return dd(this.left.value,this.right.value)}onStart(e,t,r,n){this.left.onStart(e,t,r,n),this.right.onStart(e,t,r,n)}onEnd(e,t){this.left.onEnd(e,t),this.right.onEnd(e,t)}onEffect(e,t){this.left.onEffect(e,t),this.right.onEffect(e,t)}onSuspend(e){this.left.onSuspend(e),this.right.onSuspend(e)}onResume(e){this.left.onResume(e),this.right.onResume(e)}map(e){return new _V(this,ib(this.value,p2(e)))}zip(e){return new _G(this,e)}}let _Z=e=>iD(e,_W)&&iP(e,"Zip");class _Q{[_W]=_K;fibers=new Set;get value(){return dr(()=>Array.from(this.fibers))}onStart(e,t,r,n){this.fibers.add(n)}onEnd(e,t){this.fibers.delete(t)}onEffect(e,t){}onSuspend(e){}onResume(e){}map(e){return new _V(this,ib(this.value,p2(e)))}zip(e){return new _G(this,e)}onRun(e,t){return e()}}class _Y{effect;[_W]=_K;constructor(e){this.effect=e}get value(){return this.effect}onStart(e,t,r,n){}onEnd(e,t){}onEffect(e,t){}onSuspend(e){}onResume(e){}map(e){return new _V(this,ib(this.value,p2(e)))}zip(e){return new _G(this,e)}onRun(e,t){return e()}}let _X=dr(()=>new _Q),_0=ik("effect/Supervisor/none",()=>new _Y(dl)),_1="Empty",_2="AddSupervisor",_3="RemoveSupervisor",_5="AndThen",_4={_tag:_1},_6=(e,t)=>({_tag:_5,first:e,second:t}),_8=(e,t)=>sr(e,t)?_0:_Z(e)?_8(e.left,t).zip(_8(e.right,t)):e,_7=e=>sr(e,_0)?uf():_Z(e)?ib(_7(e.left),u_(_7(e.right))):uE(e),_9=fT({empty:_4,patch:(e,t)=>((e,t)=>{let r=e,n=t;for(;lS(n);){let e=l_(n);switch(e._tag){case _1:n=lF(n);break;case _2:r=r.zip(e.supervisor),n=lF(n);break;case _3:r=_8(r,e.supervisor),n=lF(n);break;case _5:n=lc(e.first)(lc(e.second)(lF(n)))}}return r})(t,le(e)),combine:_6,diff:(e,t)=>{if(sr(e,t))return _4;let r=_7(e),n=_7(t),i=ib(n,ux(r),uk(_4,(e,t)=>_6(e,{_tag:_2,supervisor:t}))),s=ib(r,ux(n),uk(_4,(e,t)=>_6(e,{_tag:_3,supervisor:t})));return _6(i,s)}}),we=_m("effect_fiber_started",{incremental:!0}),wt=_m("effect_fiber_active"),wr=_m("effect_fiber_successes",{incremental:!0}),wn=_m("effect_fiber_failures",{incremental:!0}),wi=_y(_b((g=ib(aP((d={start:.5,factor:2,count:35}).count-1,e=>d.start*Math.pow(d.factor,e)),la,e=>new xu(ib(e,aJ(le(1/0)),ok))),new xF("effect_fiber_lifetimes",new class e{boundaries;[xh]=xx;[xv]=xv;constructor(e){this.boundaries=e,this._hash=ib(i8(xy),i3(i1(this.boundaries)))}_hash;[i0](){return this._hash}[st](e){return xk(e)&&sr(this.boundaries,e.boundaries)}pipe(){return sp(this,arguments)}}(g),am(m)))),"time_unit","milliseconds"),ws="Continue",wa="Yield",wo={_E:e=>e,_A:e=>e},wl=e=>{throw Error(`BUG: FiberRuntime - ${so(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},wu=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),wc=ik("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),wh={[sy]:(e,t,r)=>iQ(()=>t.effect_instruction_i1(r)),OnStep:(e,t,r)=>gM(gM(r)),[sv]:(e,t,r)=>iQ(()=>t.effect_instruction_i2(r)),[sC]:(e,t,r)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),fL(e.currentRuntimeFlags)&&e.isInterrupted())?gC(e.getInterruptedCause()):gM(r),[sw]:(e,t,r)=>(iQ(()=>t.effect_instruction_i2(r)),iQ(()=>t.effect_instruction_i0()))?(e.pushStack(t),iQ(()=>t.effect_instruction_i1())):dl,[sk]:(e,t,r)=>{let n=iQ(()=>t.effect_instruction_i0.next(r));if(n.done)return gM(n.value);e.pushStack(t);var i=n.value;if("object"==typeof i&&null!==i&&iK in i)return i[iK]();throw Error(iB("yieldWrapGet"))}},wf={[S_]:(e,t,r,n)=>(e.processNewInterruptSignal(n.cause),fL(t)?gC(n.cause):r),[Sk]:(e,t,r,n)=>{throw Error("It is illegal to have multiple concurrent run loops in a single fiber")},[Sw]:(e,t,r,n)=>(n.onFiber(e,yc(t)),r),[SO]:(e,t,r,n)=>pB(dp(),()=>r)},wp=sF();class wd extends b${[SA]=Sj;[SP]=wo;_fiberRefs;_fiberId;_queue=[];_children=null;_observers=[];_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(e,t,r){if(super(),this.currentRuntimeFlags=r,this._fiberId=e,this._fiberRefs=t,fB(r,4)){const e=this.getFiberRef(d3);we.unsafeUpdate(1,e),wt.unsafeUpdate(1,e)}this.refreshRefCache()}commit(){return S$(this)}id(){return this._fiberId}resume(e){this.tell(SF(e))}get status(){return this.ask((e,t)=>t)}get runtimeFlags(){return this.ask((e,t)=>t._tag===yr?e.currentRuntimeFlags:t.runtimeFlags)}scope(){return new SN(this.id(),this)}get children(){return this.ask(e=>Array.from(e.getChildren()))}getChildren(){return null===this._children&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(d4)}fiberRefs(){return this.ask(e=>e.getFiberRefs())}ask(e){return dt(()=>{let t=gz(this._fiberId);return this.tell(SC((r,n)=>{gV(t,dr(()=>e(r,n)))})),gB(t)})}tell(e){this._queue.push(e),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return pC(e=>{let t=t=>e(de(t));return this.tell(SC((e,r)=>{null!==e._exitValue?t(this._exitValue):e.addObserver(t)})),dr(()=>this.tell(SC((e,r)=>{e.removeObserver(t)})))},this.id())}get inheritAll(){return pS((e,t)=>{var r;let n,i=e.id(),s=e.getFiberRefs(),a=t.runtimeFlags,o=bK(s,i,this.getFiberRefs());return e.setFiberRefs(o),r=ib(fW(a,e.getFiberRef(w1)),fj(1),fj(16)),(n=new pm(s_)).effect_instruction_i0=r,n.effect_instruction_i1=void 0,n})}get poll(){return dr(()=>am(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(e){return dr(()=>this.tell(SE(uz(e))))}unsafeInterruptAsFork(e){this.tell(SE(uz(e)))}addObserver(e){null!==this._exitValue?e(this._exitValue):this._observers.push(e)}removeObserver(e){this._observers=this._observers.filter(t=>t!==e)}getFiberRefs(){return this.setFiberRef(w1,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(e){this._fiberRefs=bZ(this._fiberRefs,e)}getFiberRef(e){return this._fiberRefs.locals.has(e)?this._fiberRefs.locals.get(e)[0][1]:e.initial}setFiberRef(e,t){this._fiberRefs=bX(this._fiberRefs,{fiberId:this._fiberId,fiberRef:e,value:t}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(bc),this.currentTracer=this.currentDefaultServices.unsafeMap.get(br.key),this.currentSupervisor=this.getFiberRef(w2),this.currentScheduler=this.getFiberRef(vB),this.currentContext=this.getFiberRef(dW),this.currentSpan=this.currentContext.unsafeMap.get(bn.key)}setFiberRefs(e){this._fiberRefs=e,this.refreshRefCache()}addChild(e){this.getChildren().add(e)}removeChild(e){this.getChildren().delete(e)}transferChildren(e){let t=this._children;if(this._children=null,null!==t&&t.size>0)for(let r of t)null===r._exitValue&&e.add(this.currentRuntimeFlags,r)}drainQueueOnCurrentThread(){let e=!0;for(;e;){let t=ws,r=globalThis[SL];globalThis[SL]=this;try{for(;t===ws;)t=0===this._queue.length?"Done":this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[SL]=r}this._queue.length>0&&!this._running?(this._running=!0,t===wa?(this.drainQueueLaterOnExecutor(),e=!1):e=!0):e=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(dK))}drainQueueWhileRunning(e,t){let r=t;for(;this._queue.length>0;){let t=this._queue.splice(0,1)[0];r=wf[t._tag](this,e,r,t)}return r}isInterrupted(){return!uq(this.getFiberRef(d4))}addInterruptedCause(e){let t=this.getFiberRef(d4);this.setFiberRef(d4,uU(t,e))}processNewInterruptSignal(e){this.addInterruptedCause(e),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(null===this._children||0===this._children.size)return!1;let e=!1;for(let t of this._children)t.tell(SE(uz(this.id()))),e=!0;return e}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let e=this._children.values();this._children=null;let t=!1;return dc({while:()=>!t,body:()=>{let r=e.next();return r.done?dr(()=>{t=!0}):pw(r.value.await)},step:()=>{}})}return null}reportExitValue(e){if(fB(this.currentRuntimeFlags,4)){let t=this.getFiberRef(d3),r=this.id().startTimeMillis,n=Date.now();switch(wi.unsafeUpdate(n-r,t),wt.unsafeUpdate(-1,t),e._tag){case sS:wr.unsafeUpdate(1,t);break;case sm:wn.unsafeUpdate(1,t)}}if("Failure"===e._tag){let t=this.getFiberRef(d1);uJ(e.cause)||"Some"!==t._tag||this.log("Fiber terminated with an unhandled error",e.cause,t)}}setExitValue(e){this._exitValue=e,this.reportExitValue(e);for(let t=this._observers.length-1;t>=0;t--)this._observers[t](e);this._observers=[]}getLoggers(){return this.getFiberRef(ww)}log(e,t,r){let n=sW(r)?r.value:this.getFiberRef(dZ);if(yh(this.getFiberRef(wg),n))return;let i=this.getFiberRef(dQ),s=this.getFiberRef(dG),a=this.getLoggers(),o=this.getFiberRefs();if(uC(a)>0){let r=new Date(cw(this.getFiberRef(bc),ml).unsafeCurrentTimeMillis());((e,t)=>{let r=sh.fiberRefs;sh.fiberRefs=e;try{return t()}finally{sh.fiberRefs=r}})(o,()=>{for(let l of a)l.log({fiberId:this.id(),logLevel:n,message:e,cause:t,context:o,spans:i,annotations:s,date:r})})}}evaluateMessageWhileSuspended(e){switch(e._tag){case SO:return wa;case S_:return this.processNewInterruptSignal(e.cause),null!==this._asyncInterruptor&&(this._asyncInterruptor(gC(e.cause)),this._asyncInterruptor=null),ws;case Sk:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(e.effect),ws;case Sw:return e.onFiber(this,null!==this._exitValue?yl:new yo(this.currentRuntimeFlags,this._asyncBlockingOn)),ws;default:return wl(e)}}evaluateEffect(e){this.currentSupervisor.onResume(this);try{let t=fL(this.currentRuntimeFlags)&&this.isInterrupted()?gC(this.getInterruptedCause()):e;for(;null!==t;){let e=t,r=this.runLoop(e);if(r===wu){let e=wc.currentOp;wc.currentOp=null,e._op===sE?fP(this.currentRuntimeFlags)?(this.tell(SI()),this.tell(SF(gA)),t=null):t=gA:e._op===sd&&(t=null)}else{this.currentRuntimeFlags=ib(this.currentRuntimeFlags,fz(16));let e=this.interruptAllChildren();null!==e?t=pB(e,()=>r):(0===this._queue.length?this.setExitValue(r):this.tell(SF(r)),t=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(e){if(this._running)this.tell(SF(e));else{this._running=!0;let t=globalThis[SL];globalThis[SL]=this;try{this.evaluateEffect(e)}finally{this._running=!1,globalThis[SL]=t,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(e){this.tell(SF(e))}patchRuntimeFlags(e,t){let r=fK(e,t);return globalThis[SL]=this,this.currentRuntimeFlags=r,r}initiateAsync(e,t){let r=!1,n=e=>{r||(r=!0,this.tell(SF(e)))};fL(e)&&(this._asyncInterruptor=n);try{t(n)}catch(e){n(p$(u$(e)))}}pushStack(e){this._stack.push(e),"OnStep"===e._op&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let e=this._stack.pop();if(e)return"OnStep"===e._op&&this._steps.pop(),e}getNextSuccessCont(){let e=this.popStack();for(;e;){if(e._op!==sb)return e;e=this.popStack()}}getNextFailCont(){let e=this.popStack();for(;e;){if(e._op!==sy&&e._op!==sw&&e._op!==sk)return e;e=this.popStack()}}Tag(e){return dr(()=>cw(this.currentContext,e))}Left(e){return pP(e.left)}None(e){return pP(new gd)}Right(e){return gM(e.right)}Some(e){return gM(e.value)}Micro(e){return pO(t=>{let r=t,n=((e,t)=>{let r=new yE(vo.context(t?.scheduler??new vr));if(r.evaluate(e),t?.signal)if(t.signal.aborted)r.unsafeInterrupt();else{let e=()=>r.unsafeInterrupt();t.signal.addEventListener("abort",e,{once:!0}),r.addObserver(()=>t.signal.removeEventListener("abort",e))}return r})(vi(e,this.currentContext));return n.addObserver(e=>{if("Success"===e._tag)return r(gM(e.value));switch(e.cause._tag){case"Interrupt":return r(gC(uz(hw)));case"Fail":return r(pP(e.cause.error));case"Die":return r(pM(e.cause.defect))}}),pO(e=>{r=t=>{e(dl)},n.unsafeInterrupt()})})}[sx](e){let t=iQ(()=>e.effect_instruction_i0()),r=this.getNextSuccessCont();return void 0!==r?(r._op in wh||wl(r),wh[r._op](this,r,t)):(wc.currentOp=gM(t),wu)}[sS](e){let t=this.getNextSuccessCont();return void 0!==t?(t._op in wh||wl(t),wh[t._op](this,t,e.effect_instruction_i0)):(wc.currentOp=e,wu)}[sm](e){let t=e.effect_instruction_i0,r=this.getNextFailCont();if(void 0===r)return wc.currentOp=gC(t),wu;switch(r._op){case sb:case sv:if(!(fL(this.currentRuntimeFlags)&&this.isInterrupted()))return iQ(()=>r.effect_instruction_i1(t));return gC(uZ(t));case"OnStep":if(!(fL(this.currentRuntimeFlags)&&this.isInterrupted()))return gM(gC(t));return gC(uZ(t));case sC:if(this.patchRuntimeFlags(this.currentRuntimeFlags,r.patch),fL(this.currentRuntimeFlags)&&this.isInterrupted())return gC(uU(t,this.getInterruptedCause()));return gC(t);default:wl(r)}}[sO](e){return iQ(()=>e.effect_instruction_i0(this,yc(this.currentRuntimeFlags)))}Blocked(e){let t=this.getFiberRefs(),r=this.currentRuntimeFlags;if(this._steps.length>0){let n=[],i=this._steps[this._steps.length-1],s=this.popStack();for(;s&&"OnStep"!==s._op;)n.push(s),s=this.popStack();this.setFiberRefs(i.refs),this.currentRuntimeFlags=i.flags;let a=b8(i.refs,t),o=fW(i.flags,r);return gM(pp(e.effect_instruction_i0,pS(t=>{for(;n.length>0;)t.pushStack(n.pop());return t.setFiberRefs(b9(t.id(),t.getFiberRefs())(a)),t.currentRuntimeFlags=fK(o)(t.currentRuntimeFlags),e.effect_instruction_i1})))}return da(t=>{var r;let n;return pB(wN((r=e.effect_instruction_i0,(n=new pm("RunBlocked")).effect_instruction_i0=r,n)),()=>t(e.effect_instruction_i1))})}RunBlocked(e){return pZ((e=>{let t=hT(e,hN),r=h$();for(;;){let[e,n]=hH(t,[f4(),h$()],([e,t],r)=>{let[n,i]=fQ(r);return[f8(e,n),hL(t,i)]});if(r=fY(r,e),hA(n))return hW(r);t=n}throw Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")})(e.effect_instruction_i0),e=>wT(Array.from(e.map),([e,t])=>{let r=new Map,n=[];for(let e of t)for(let t of(n.push(ln(e)),e))r.set(t.request,t);let i=n.flat();return dU(w7(e.runAll(n),i,()=>i.forEach(e=>{e.listeners.interrupted=!0})),vq,r)},!1,!1))}[s_](e){let t=e.effect_instruction_i0,r=this.currentRuntimeFlags,n=fK(r,t);if(fL(n)&&this.isInterrupted())return gC(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,t),!e.effect_instruction_i1)return gA;{let t=fW(n,r);return this.pushStack(new pg(t,e)),iQ(()=>e.effect_instruction_i1(r))}}[sy](e){return this.pushStack(e),e.effect_instruction_i0}OnStep(e){return this.pushStack(e),e.effect_instruction_i0}[sb](e){return this.pushStack(e),e.effect_instruction_i0}[sv](e){return this.pushStack(e),e.effect_instruction_i0}[sd](e){return this._asyncBlockingOn=e.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,e.effect_instruction_i0),wc.currentOp=e,wu}[sE](e){return this._isYielding=!1,wc.currentOp=e,wu}[sw](e){let t=e.effect_instruction_i0,r=e.effect_instruction_i1;return t()?(this.pushStack(e),r()):gA}[sk](e){return wh[sk](this,e,void 0)}[sg](e){return iQ(()=>e.commit())}runLoop(e){let t=e;for(this.currentOpCount=0;;){if((2&this.currentRuntimeFlags)!=0&&this.currentSupervisor.onEffect(this,t),this._queue.length>0&&(t=this.drainQueueWhileRunning(this.currentRuntimeFlags,t)),!this._isYielding){this.currentOpCount+=1;let e=this.currentScheduler.shouldYield(this);if(!1!==e){this._isYielding=!0,this.currentOpCount=0;let r=t;t=pB(dp({priority:e}),()=>r)}}try{if((t=this.currentTracer.context(()=>{if(wp!==t[pd]._V){let e=this.getFiberRef(d2);if("Some"===e._tag){let r=t[pd]._V;this.log(`Executing an Effect versioned ${r} with a Runtime of version ${sF()}, you may want to dedupe the effect dependencies, you can use the language service plugin to detect this at compile time: https://github.com/Effect-TS/language-service`,uD,e)}}return this[t._op](t)},this))===wu){let e=wc.currentOp;if(e._op===sE||e._op===sd)return wu;return wc.currentOp=null,e._op===sS||e._op===sm?e:gC(u$(e))}}catch(e){t=(t===wu||iD(t,"_op"))&&t._op in this?gc(e)?gC(uU(u$(e),uz(hw))):pM(e):pA(`Not a valid effect: ${so(t)}`)}}}run=()=>{this.drainQueueOnCurrentThread()}}let wg=ik("effect/FiberRef/currentMinimumLogLevel",()=>dq(yf("Info"))),wm=e=>Sq(t=>{cw(bY(t.context,bc),m4).unsafe.log(e.log(t))}),wb=ik(Symbol.for("effect/Logger/defaultLogger"),()=>wm(S0)),wy=ik(Symbol.for("effect/Logger/jsonLogger"),()=>wm(S5)),wv=ik(Symbol.for("effect/Logger/logFmtLogger"),()=>wm(S1)),wS=ik(Symbol.for("effect/Logger/prettyLogger"),()=>xa),wx=ik(Symbol.for("effect/Logger/structuredLogger"),()=>wm(S2)),w_=ik(Symbol.for("effect/Logger/tracerLogger"),()=>Sq(({annotations:e,cause:t,context:r,fiberId:n,logLevel:i,message:s})=>{let a=ck(bY(r,dW),bn);if("None"===a._tag||"ExternalSpan"===a.value._tag)return;let o=cw(bY(r,bc),ml),l={};for(let[t,r]of e)l[t]=r;l["effect.fiberId"]=hx(n),l["effect.logLevel"]=i.label,null!==t&&"Empty"!==t._tag&&(l["effect.cause"]=ce(t,{renderErrorCause:!0})),a.value.event(so(Array.isArray(s)?s[0]:s),o.unsafeCurrentTimeNanos(),l)})),ww=ik(Symbol.for("effect/FiberRef/currentLoggers"),()=>{var e;let t;return e=uE(wb,w_),dH(e,{differ:t=fT({empty:fl,combine:(e,t)=>ff(t)(e),diff:(e,t)=>((e,t)=>{let[r,n]=uk([e,fl],([e,t],r)=>{let n;return up(r)(e)?[uS(r)(e),t]:[e,ff(((n=Object.create(fc)).value=r,n))(t)]})(t);return uk(n,(e,t)=>{let r;return ff(((r=Object.create(fh)).value=t,r))(e)})(r)})(e,t),patch:(e,t)=>fp(t)(e)}),fork:t.empty})}),wk=ic(3,(e,t,r)=>pB(wK,n=>{let i=[],s=dt(()=>{if(0===i.length)return dl;let e=i;return i=[],r(e)});return da(r=>ib(vW(t),dm(s),v8,r,wN,pB(e=>gr(n,dv(e))),dm(wE(()=>s)),p_(Sq(t=>{i.push(e.log(t))}))))})),wO=ic(e=>pv(e[0]),(e,t)=>ds(dn(e,e=>wE(r=>t(e,r))))),wE=e=>pS(t=>{let r=t.getFiberRefs(),n=f$(t.currentRuntimeFlags,1);return pB(wK,t=>{let i,s;return i=t,s=t=>pS(i=>{let s=i.getFiberRefs(),a=i.currentRuntimeFlags,o=b8(s,r),l=fW(a,n),u=b8(r,s);return i.setFiberRefs(b9(o,i.id(),r)),w8(df(e(t),l),dr(()=>{i.setFiberRefs(b9(u,i.id(),i.getFiberRefs()))}))}),i.addFinalizer(s)})}),wC=((e=>iD(e[0],Symbol.iterator)&&!pv(e[0]),(e,t,r)=>{let n=r?.negate?(e,r)=>p2(t(e,r),o0):t;return vH(r?.concurrency,()=>dt(()=>a$(e).reduceRight((e,t,r)=>db(e,dt(()=>n(t,r)),(e,r)=>r?[t,...e]:e),dr(()=>[]))),()=>p2(wF(e,(e,t)=>p2(n(e,t),t=>t?sV(e):ah()),r),ob))}),(e,t)=>{let[r,n]=(e=>{if(Array.isArray(e)||iD(e,Symbol.iterator))return[e,ah()];let t=Object.keys(e),r=t.length;return[t.map(t=>e[t]),sV(e=>{let n={};for(let i=0;i<r;i++)n[t[i]]=e[i];return n})]})(e);if(t?.mode==="validate"){let e=[];for(let t of r)e.push(pj(t));return pB(wF(e,ih,{concurrency:t?.concurrency,batching:t?.batching,concurrentFinalizers:t?.concurrentFinalizers}),e=>{let r=ah(),i=e.length,s=Array(i),a=Array(i),o=!1;for(let t=0;t<i;t++){let n=e[t];"Left"===n._tag?(s[t]=sV(n.left),o=!0):(a[t]=n.right,s[t]=r)}return o?"Some"===n._tag?pP(n.value(s)):pP(s):t?.discard?dl:"Some"===n._tag?de(n.value(a)):de(a)})}if(t?.mode==="either"){let e=[];for(let t of r)e.push(pj(t));return t?.discard?wF(e,ih,{concurrency:t?.concurrency,batching:t?.batching,discard:!0,concurrentFinalizers:t?.concurrentFinalizers}):p2(wF(e,ih,{concurrency:t?.concurrency,batching:t?.batching,concurrentFinalizers:t?.concurrentFinalizers}),e=>"Some"===n._tag?n.value(e):e)}return t?.discard!==!0&&"Some"===n._tag?p2(wF(r,ih,t),n.value):wF(r,ih,t)}),wF=((e,t)=>Array.from({length:t},()=>e),ic(e=>iD(e[0],Symbol.iterator),(e,t,r)=>pS(n=>{let i=r?.batching===!0||r?.batching==="inherit"&&n.getFiberRef(d0);return r?.discard?vJ(r.concurrency,()=>wz(bU,r?.concurrentFinalizers)(r=>i?wT(e,(e,n)=>r(t(e,n)),!0,!1,1):pZ(e,(e,n)=>r(t(e,n)))),()=>wz(bB,r?.concurrentFinalizers)(r=>wT(e,(e,n)=>r(t(e,n)),i,!1)),n=>wz(bq(n),r?.concurrentFinalizers)(r=>wT(e,(e,n)=>r(t(e,n)),i,!1,n))):vJ(r?.concurrency,()=>wz(bU,r?.concurrentFinalizers)(r=>i?wR(e,1,(e,n)=>r(t(e,n)),!0):pG(e,(e,n)=>r(t(e,n)))),()=>wz(bB,r?.concurrentFinalizers)(r=>wI(e,(e,n)=>r(t(e,n)),i)),n=>wz(bq(n),r?.concurrentFinalizers)(r=>wR(e,n,(e,n)=>r(t(e,n)),i)))}))),wI=(e,t,r)=>dt(()=>{let n=a$(e),i=Array(n.length);return dm(wT(n,(e,r)=>pB(t(e,r),e=>dr(()=>i[r]=e)),r,!1),de(i))}),wT=(e,t,r,n,i)=>da(s=>{let a;return a=a=>pS(o=>{let l=Array.from(e).reverse(),u=l.length;if(0===u)return dl;let c=0,h=!1,f=i?Math.min(l.length,i):l.length,p=new Set,d=[],g=[],m=[],b=[],y=()=>{let e=d.filter(({exit:e})=>"Failure"===e._tag).sort((e,t)=>e.index<t.index?-1:+(e.index!==t.index)).map(({exit:e})=>e);return 0===e.length&&e.push(gA),e},v=(e,t=!1)=>{let r=ds(a(e)),n=wA(r,o,o.currentRuntimeFlags,SM);return o.currentScheduler.scheduleTask(()=>{t&&n.unsafeInterruptAsFork(o.id()),n.resume(r)},0),n},S=()=>{n||(u-=l.length,l=[]),h=!0,p.forEach(e=>{e.currentScheduler.scheduleTask(()=>{e.unsafeInterruptAsFork(o.id())},0)})},x=r?pJ:pD,_=v(pC(e=>{let n=(e,t)=>{"Blocked"===e._op?b.push(e):(d.push({index:t,exit:e}),"Failure"!==e._op||h||S())},a=()=>{if(l.length>0){let f=l.pop(),S=c++,_=e=>{if(l.length>0&&(n(e,S),l.length>0)){let e;return e=l.pop(),S=c++,pB(dp(),()=>pB(x(s(t(e,S))),_))}return de(e)},w=v(pB(x(s(t(f,S))),_));g.push(w),p.add(w),h&&w.currentScheduler.scheduleTask(()=>{w.unsafeInterruptAsFork(o.id())},0),w.addObserver(t=>{let s;if(s="Failure"===t._op?t:t.effect_instruction_i0,m.push(w),p.delete(w),n(s,S),d.length===u)e(de(ap(gk(y(),{parallel:!0}),()=>gA)));else if(b.length+d.length===u){let t=y();e(de(pp(b.map(e=>e.effect_instruction_i0).reduce(fG),wT([ap(gk(t,{parallel:!0}),()=>gA),...b.map(e=>e.effect_instruction_i1)],e=>e,r,!0,i))))}else a()})}};for(let e=0;e<f;e++)a()}));return pw(p4(pH(s(S$(_))),gR({onFailure:e=>{S();let t=b.length+1,r=Math.min("number"==typeof i?i:b.length,b.length),n=Array.from(b);return pC(i=>{let s=[],a=0,o=0,l=(r,o)=>l=>{s[r]=l,++a===t&&i(gM(gC(e))),n.length>0&&o&&u()},u=()=>{v(n.pop(),!0).addObserver(l(o,!0)),o++};_.addObserver(l(o,!1)),o++;for(let e=0;e<r;e++)u()})},onSuccess:()=>pG(m,e=>e.inheritAll)})))}),pS(e=>{let t=ib(e.getFiberRef(d5),ap(()=>e.scope()));return a(dU(d5,sV(t)))})}),wR=(e,t,r,n)=>dt(()=>{let i=a$(e),s=Array(i.length);return dm(wT(i,(e,t)=>p2(r(e,t),e=>s[t]=e),n,!1,t),de(s))}),wN=e=>wD(e,SM),wM=(e,t,r,n=null)=>{let i=wj(e,t,r,n);return i.resume(e),i},wA=(e,t,r,n=null)=>wj(e,t,r,n),wj=(e,t,r,n=null)=>{let i=hO(),s=bV(t.getFiberRefs(),i),a=new wd(i,s,r),o=bY(s,dW),l=a.currentSupervisor;return l.onStart(o,e,sV(t),a),a.addObserver(e=>l.onEnd(e,a)),(null!==n?n:ib(t.getFiberRef(d5),ap(()=>t.scope()))).add(r,a),a},wD=(e,t)=>pS((r,n)=>de(wM(e,r,n.runtimeFlags,t))),wP=((e=>"function"==typeof e[2],(e,t,r,n)=>vH(n?.concurrency,()=>a$(e).reduce((e,t,n)=>db(e,t,(e,t)=>r(e,t,n)),de(t)),()=>pB(vM(t),t=>pB(wF(e,(e,n)=>pB(e,e=>vP(t,t=>r(t,e,n))),n),()=>t.get)))),e=>{let t;return t=t=>af(ck(t,wW),{onNone:()=>e,onSome:t=>{switch(t.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":let r,n;return pB((r=t,n=bB,r.fork(n)),t=>wQ(e,t))}}}),pB(gZ,t)}),w$=e=>t=>{let r;return r=r=>af(ck(r,wW),{onNone:()=>t,onSome:r=>{let n,i;return"ParallelN"===r.strategy._tag&&r.strategy.parallelism===e?t:pB((n=r,i=bq(e),n.fork(i)),e=>wQ(t,e))}}),pB(gZ,r)},wz=(e,t)=>r=>pB(gZ,n=>af(ck(n,wW),{onNone:()=>r(ih),onSome:n=>{if(!0!==t)return r(ih);{let t="Parallel"===e._tag?wP:"Sequential"===e._tag?wU:w$(e.parallelism);switch(n.strategy._tag){case"Parallel":return t(r(wP));case"Sequential":return t(r(wU));case"ParallelN":return t(r(w$(n.strategy.parallelism)))}}}})),wL=e=>pB(wZ(),t=>p4(e(t),e=>t.close(e))),wU=e=>{let t;return t=t=>af(ck(t,wW),{onNone:()=>e,onSome:t=>{switch(t.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":let r,n;return pB((r=t,n=bU,r.fork(n)),t=>wQ(e,t))}}}),pB(gZ,t)},wB=((e=>pv(e[1]),(e,t,r,n)=>pH(wH(pD(e),pD(t),(e,t)=>gP(e,t,{onSuccess:r,onFailure:(e,t)=>n?.concurrent?uL(e,t):uU(e,t)}),n))),ic(e=>pv(e[1]),(e,t,r)=>wH(e,t,(e,t)=>[e,t],r))),wq=ic(e=>pv(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||!1===r.batching)?dg(e,t):wH(e,t,(e,t)=>e,r)),wJ=ic(e=>pv(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||!1===r.batching)?dm(e,t):wH(e,t,(e,t)=>t,r)),wH=ic(e=>pv(e[1]),(e,t,r,n)=>p2(wC([e,t],{concurrency:n?.concurrent?2:1,batching:n?.batching,concurrentFinalizers:n?.concurrentFinalizers}),([e,t])=>r(e,t))),wW=cE("effect/Scope"),wK=wW,wV={[ge]:ge,[gt]:gt,pipe(){return sp(this,arguments)},fork(e){return dr(()=>{var t;let r=wG(e);if("Closed"===this.state._tag)return r.state=this.state,r;let n={};return this.state.finalizers.set(n,e=>r.close(e)),t=e=>dr(()=>{"Open"===this.state._tag&&this.state.finalizers.delete(n)}),"Open"===r.state._tag&&r.state.finalizers.set({},t),r})},close(e){return dt(()=>{if("Closed"===this.state._tag)return dl;let t=Array.from(this.state.finalizers.values()).reverse();return(this.state={_tag:"Closed",exit:e},0===t.length)?dl:this.strategy._tag===bz?ib(pG(t,t=>pD(t(e))),pB(e=>ib(gk(e),ax(gw),ap(()=>gA)))):this.strategy._tag===bL?ib(wI(t,t=>pD(t(e)),!1),pB(e=>ib(gk(e,{parallel:!0}),ax(gw),ap(()=>gA)))):ib(wR(t,this.strategy.parallelism,t=>pD(t(e)),!1),pB(e=>ib(gk(e,{parallel:!0}),ax(gw),ap(()=>gA))))})},addFinalizer(e){return dt(()=>"Closed"===this.state._tag?e(this.state.exit):(this.state.finalizers.set({},e),dl))}},wG=(e=bU)=>{let t=Object.create(wV);return t.strategy=e,t.state={_tag:"Open",finalizers:new Map},t},wZ=(e=bU)=>dr(()=>wG(e)),wQ=ic(2,(e,t)=>gX(e,cO(cv(wW,t)))),wY=ic(2,(e,t)=>ib(e,wQ(t),p4(e=>t.close(e)))),wX=ic(2,(e,t)=>pw(wO(pB(dN(e),r=>p_(dA(e,t),r)),t=>dA(e,t)))),w0=ic(2,(e,t)=>dM(e,r=>wX(e,t(r)))),w1=dH(fJ,{differ:fV,fork:fV.empty}),w2=dH(_0,{differ:_9,fork:_4}),w3=ic(3,(e,t,r)=>w4(e,t,{onSelfWin:(e,t)=>pB(e.await,n=>{switch(n._tag){case sS:return pB(e.inheritAll,()=>r.onSelfDone(n,t));case sm:return r.onSelfDone(n,t)}}),onOtherWin:(e,t)=>pB(e.await,n=>{switch(n._tag){case sS:return pB(e.inheritAll,()=>r.onOtherDone(n,t));case sm:return r.onOtherDone(n,t)}})})),w5=ic(2,(e,t)=>pU(r=>w3(e,t,{onSelfDone:(e,t)=>gN(e,{onFailure:e=>ib(S$(t),Sa(t=>uL(e,t))),onSuccess:e=>ib(t,dS(r),p_(e))}),onOtherDone:(e,t)=>gN(e,{onFailure:e=>ib(S$(t),Sa(t=>uL(t,e))),onSuccess:e=>ib(t,dS(r),p_(e))})}))),w4=ic(3,(e,t,r)=>pS((n,i)=>{let s=i.runtimeFlags,a=hn(!0),o=wj(e,n,s,r.selfScope),l=wj(t,n,s,r.otherScope);return pC(n=>{o.addObserver(()=>w6(o,l,r.onSelfWin,a,n)),l.addObserver(()=>w6(l,o,r.onOtherWin,a,n)),o.startFork(e),l.startFork(t)},hb(o.id(),l.id()))})),w6=(e,t,r,n,i)=>{hi(!0,!1)(n)&&i(r(e,t))},w8=ic(2,(e,t)=>da(r=>pK(r(e),{onFailure:e=>pK(t,{onFailure:t=>p$(uU(e,t)),onSuccess:()=>p$(e)}),onSuccess:e=>p_(t,e)}))),w7=(e,t,r)=>pU(n=>pB(pB(wN(p0(e)),e=>pC(n=>{let i=t.map(e=>e.listeners.count),s=()=>{i.every(e=>0===e)&&t.every(e=>"Pending"===e.result.state.current._tag||!!("Done"===e.result.state.current._tag&&gS(e.result.state.current.effect)&&"Failure"===e.result.state.current.effect._tag&&sW(uG(e.result.state.current.effect.cause))))&&(a.forEach(e=>e()),r?.(),n(dv(e)))};e.addObserver(e=>{a.forEach(e=>e()),n(e)});let a=t.map((e,t)=>{let r=e=>{i[t]=e,s()};return e.listeners.addObserver(r),()=>e.listeners.removeObserver(r)});return s(),dr(()=>{a.forEach(e=>e())})})),()=>dt(()=>pZ(t.flatMap(e=>e.state.completed?[]:[e]),e=>_x(e.request,gC(uz(n))))))),w9=Symbol.for("effect/ScheduleInterval"),ke={[w9]:w9,startMillis:0,endMillis:0},kt=(e,t)=>e>t?ke:{[w9]:w9,startMillis:e,endMillis:t},kr=ic(2,(e,t)=>kn(e,t)===e),kn=ic(2,(e,t)=>e.endMillis<=t.startMillis?e:t.endMillis<=e.startMillis?t:e.startMillis<t.startMillis?e:t.startMillis<e.startMillis?t:e.endMillis<=t.endMillis?e:t),ki=ic(2,(e,t)=>kt(Math.max(e.startMillis,t.startMillis),Math.min(e.endMillis,t.endMillis))),ks=e=>e.startMillis>=e.endMillis,ka=Symbol.for("effect/ScheduleIntervals"),ko=e=>({[ka]:ka,intervals:e}),kl=ic(2,(e,t)=>lS(t.intervals)?lS(e.intervals)?l_(e.intervals).startMillis<l_(t.intervals).startMillis?ku(lF(e.intervals),t.intervals,l_(e.intervals),o7()):ku(e.intervals,lF(t.intervals),l_(t.intervals),o7()):t:e),ku=(e,t,r,n)=>{let i=e,s=t,a=r,o=n;for(;lS(i)||lS(s);)if(!lS(i)&&lS(s))a.endMillis<l_(s).startMillis?(o=ib(o,lc(a)),a=l_(s)):a=kt(a.startMillis,l_(s).endMillis),s=lF(s),i=o7();else if(lS(i)&&lv(s))a.endMillis<l_(i).startMillis?(o=ib(o,lc(a)),a=l_(i)):a=kt(a.startMillis,l_(i).endMillis),s=o7(),i=lF(i);else if(lS(i)&&lS(s))l_(i).startMillis<l_(s).startMillis?(a.endMillis<l_(i).startMillis?(o=ib(o,lc(a)),a=l_(i)):a=kt(a.startMillis,l_(i).endMillis),i=lF(i)):(a.endMillis<l_(s).startMillis?(o=ib(o,lc(a)),a=l_(s)):a=kt(a.startMillis,l_(s).endMillis),s=lF(s));else throw Error(iB("Intervals.unionLoop"));return ko(ib(o,lc(a),li))},kc=ic(2,(e,t)=>kh(e.intervals,t.intervals,o7())),kh=(e,t,r)=>{let n=e,i=t,s=r;for(;lS(n)&&lS(i);){let e=ib(l_(n),ki(l_(i))),t=ks(e)?s:ib(s,lc(e));ib(l_(n),kr(l_(i)))?n=lF(n):i=lF(i),s=t}return ko(li(s))},kf=e=>ib(e.intervals,lx,ap(()=>ke)).startMillis,kp=ic(2,(e,t)=>kf(e)<kf(t)),kd=((e,t)=>kp(e,t)?t:e,e=>ib(e.intervals,lx,ap(()=>ke)).endMillis),kg="Continue",km="Done",kb=e=>({_tag:kg,intervals:e}),ky=e=>({_tag:kg,intervals:ko(le(e))}),kv={_tag:km};class kS{permits;waiters=new Set;taken=0;constructor(e){this.permits=e}get free(){return this.permits-this.taken}take=e=>pE(t=>{if(this.free<e){let r=()=>{this.free<e||(this.waiters.delete(r),this.taken+=e,t(de(e)))};return this.waiters.add(r),dr(()=>{this.waiters.delete(r)})}return this.taken+=e,t(de(e))});updateTaken=e=>pS(t=>(this.taken=e(this.taken),this.waiters.size>0&&t.getFiberRef(vB).scheduleTask(()=>{let e=this.waiters.values(),t=e.next();for(;!1===t.done&&this.free>0;)t.value(),t=e.next()},t.getFiberRef(dK)),de(this.free)));release=e=>this.updateTaken(t=>t-e);releaseAll=this.updateTaken(e=>0);withPermits=e=>t=>da(r=>pB(r(this.take(e)),e=>w8(r(t),this.release(e))));withPermitsIfAvailable=e=>t=>da(r=>dt(()=>this.free<e?Sc:(this.taken+=e,w8(r(p2(t,sV)),this.release(e)))))}let kx=e=>new kS(e);class k_ extends b${isOpen;waiters=[];scheduled=!1;constructor(e){super(),this.isOpen=e}commit(){return this.await}unsafeSchedule(e){return this.scheduled||0===this.waiters.length||(this.scheduled=!0,e.currentScheduler.scheduleTask(this.flushWaiters,e.getFiberRef(dK))),dl}flushWaiters=()=>{this.scheduled=!1;let e=this.waiters;this.waiters=[];for(let t=0;t<e.length;t++)e[t](gA)};open=pS(e=>this.isOpen?dl:(this.isOpen=!0,this.unsafeSchedule(e)));unsafeOpen(){this.isOpen||(this.isOpen=!0,this.flushWaiters())}release=pS(e=>this.isOpen?dl:this.unsafeSchedule(e));await=pE(e=>this.isOpen?e(dl):(this.waiters.push(e),dr(()=>{let t=this.waiters.indexOf(e);-1!==t&&this.waiters.splice(t,1)})));unsafeClose(){this.isOpen=!1}close=dr(()=>{this.isOpen=!1});whenOpen=e=>dm(this.await,e)}(e,t)=>{let r=cP(t);return pB(gZ,t=>p2(kj(ah()),n=>[gQ(kk(e,r,n),t),kO(n)]))};let kw=(e,t,r)=>{let n=cX(cP(t));return ib(gL(),dn(t=>p1(e,t)),p2(e=>sV([r+n,e])))},kk=(e,t,r)=>da(n=>ib(bf(e=>e.currentTimeMillis),pB(n=>kP(r,r=>{switch(r._tag){case"None":return sV(kw(e,t,n));case"Some":{let[i]=r.value;return i-n<=0?sV(kw(e,t,n)):ah()}}})),pB(e=>sH(e)?pA("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):n(gB(e.value[1]))))),kO=e=>vA(e,ah()),kE=((e,t)=>pB(_X,r=>ib(kI(e,r),w8(pB(r.value,t)))),ic(2,(e,t)=>pS((r,n)=>{let i=wM(e,r,n.runtimeFlags,SM);if("Open"===t.state._tag){let e={};t.state.finalizers.set(e,()=>pU(e=>sr(e,i.id())?dl:pw(dv(i)))),i.addObserver(()=>{"Closed"!==t.state._tag&&t.state.finalizers.delete(e)})}else i.unsafeInterruptAsFork(r.id());return de(i)}))),kC=e=>pB(wW,t=>kE(e,t)),kF=ic(2,(e,t)=>ib(pD(e),w5(pD(t)),e=>pH(e))),kI=ic(2,(e,t)=>dB(w2,e=>e.zip(t))(e)),kT=((e,{duration:t,onTimeout:r})=>pH(kR(e,{onTimeout:()=>pB(dr(r),pP),onSuccess:de,duration:t})),ic(2,(e,{duration:t,onTimeout:r})=>pH(kR(e,{onTimeout:()=>pz(r),onSuccess:de,duration:t})))),kR=ic(2,(e,{duration:t,onSuccess:r,onTimeout:n})=>pU(i=>da(s=>w4(s(e),p0(vW(t)),{onSelfWin:(e,t)=>pB(e.await,n=>"Success"===n._tag?pB(e.inheritAll,()=>p_(dS(t,i),r(n.value))):pB(dS(t,i),()=>gC(n.cause))),onOtherWin:(e,t)=>pB(e.await,r=>"Success"===r._tag?pB(e.inheritAll,()=>p_(dS(t,i),n())):pB(dS(t,i),()=>gC(r.cause))),otherScope:SM})))),kN=Symbol.for("effect/Ref/SynchronizedRef"),kM={_A:e=>e};class kA extends b${ref;withLock;[kN]=kM;[vI]=vT;[vF]=vF;constructor(e,t){super(),this.ref=e,this.withLock=t,this.get=this.ref.get}get;commit(){return this.get}modify(e){return this.modifyEffect(t=>de(e(t)))}modifyEffect(e){return this.withLock(ib(pB(this.ref.get,e),pB(([e,t])=>p_(vA(this.ref,t),e))))}}let kj=e=>dr(()=>kD(e)),kD=e=>new kA(vN(e),kx(1).withPermits(1)),kP=ic(2,(e,t)=>e.modifyEffect(e=>{let r=t(e);switch(r._tag){case"None":return de([e,e]);case"Some":return p2(r.value,e=>[e,e])}})),k$=((e,t,r)=>({...sD,commit(){return S$(this)},[SA]:Sj,id:()=>ib(e.id(),hy(t.id())),await:ib(e.await,pH,wH(pH(t.await),r,{concurrent:!0}),pD),children:e.children,inheritAll:dm(t.inheritAll,e.inheritAll),poll:db(e.poll,t.poll,(e,t)=>ib(e,a_(e=>ib(t,ax(t=>gP(e,t,{onSuccess:r,onFailure:uL})))))),interruptAsFork:r=>dm(e.interruptAsFork(r),t.interruptAsFork(r)),pipe(){return sp(this,arguments)}}),Symbol.for("effect/ManagedRuntime")),kz="Fresh",kL="ProvideMerge",kU=e=>function(){if(1==arguments.length){let t=arguments[0];return(r,...n)=>e(t,r,...n)}return e.apply(this,arguments)},kB=kU((e,t,r)=>{let n,i,s=hO(),a=[[dW,[[s,e.context]]]];r?.scheduler&&a.push([vB,[[s,r.scheduler]]]);let o=b1(e.fiberRefs,{entries:a,forkAs:s});r?.updateRefs&&(o=r.updateRefs(o,s));let l=new wd(s,o,e.runtimeFlags),u=t;r?.scope&&(u=pB((n=r.scope,i=bU,n.fork(i)),e=>dm(gr(e,pU(e=>sr(e,l.id())?dl:dS(l,e))),p4(t,t=>{let r,n;return r=e,n=t,r.close(n)}))));let c=l.currentSupervisor;return c!==_0&&(c.onStart(e.context,u,ah(),l),l.addObserver(e=>c.onEnd(e,l))),SM.add(e.runtimeFlags,l),r?.immediate===!1?l.resume(u):l.start(u),l}),kq=kU((e,t,r={})=>{let n=kB(e,t,r);return r.onExit&&n.addObserver(e=>{r.onExit(e)}),(t,r)=>kq(e)(ib(n,dS(t??hw)),{...r,onExit:r?.onExit?e=>r.onExit(ib(e,gF(ih))):void 0})}),kJ=kU((e,t)=>{let r=kQ(e)(t);if("Failure"===r._tag)throw kG(r.effect_instruction_i0);return r.effect_instruction_i0});class kH extends Error{fiber;_tag="AsyncFiberException";constructor(e){super(`Fiber #${e.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=e,this.name=this._tag,this.stack=this.message}}let kW=Symbol.for("effect/Runtime/FiberFailure"),kK=Symbol.for("effect/Runtime/FiberFailure/Cause");class kV extends Error{[kW];[kK];constructor(e){const t=cl(e)[0];super(t?.message||"An error has occurred"),this[kW]=kW,this[kK]=e,this.name=t?`(FiberFailure) ${t.name}`:"FiberFailure",t?.stack&&(this.stack=t.stack)}toJSON(){return{_id:"FiberFailure",cause:this[kK].toJSON()}}toString(){return"(FiberFailure) "+ce(this[kK],{renderErrorCause:!0})}[ss](){return this.toString()}}let kG=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new kV(e);return Error.stackTraceLimit=t,r},kZ=e=>{switch(e._op){case"Failure":case"Success":return e;case"Left":return gE(e.left);case"Right":return gM(e.right);case"Some":return gM(e.value);case"None":return gE(gd())}},kQ=kU((e,t)=>{let r,n,i=kZ(t);if(i)return i;let s=new vU,a=kB(e)(t,{scheduler:s});s.flush();let o=a.unsafePoll();return o?o:gO(pN((r=Error.stackTraceLimit,Error.stackTraceLimit=0,n=new kH(a),Error.stackTraceLimit=r,n),g0(a)))}),kY=kU((e,t,r)=>kX(e,t,r).then(e=>{switch(e._tag){case sS:return e.effect_instruction_i0;case sm:throw kG(e.effect_instruction_i0)}})),kX=kU((e,t,r)=>new Promise(n=>{let i=kZ(t);i&&n(i);let s=kB(e)(t);s.addObserver(e=>{n(e)}),r?.signal!==void 0&&(r.signal.aborted?s.unsafeInterruptAsFork(s.id()):r.signal.addEventListener("abort",()=>{s.unsafeInterruptAsFork(s.id())},{once:!0}))}));class k0{context;runtimeFlags;fiberRefs;constructor(e,t,r){this.context=e,this.runtimeFlags=t,this.fiberRefs=r}pipe(){return sp(this,arguments)}}let k1=e=>new k0(e.context,e.runtimeFlags,e.fiberRefs),k2=()=>pS((e,t)=>de(new k0(e.getFiberRef(dW),t.runtimeFlags,e.getFiberRefs()))),k3=k1({context:cy,runtimeFlags:fq(1,32,4),fiberRefs:bJ()}),k5=((e,t)=>k1({context:e.context,runtimeFlags:t(e.runtimeFlags),fiberRefs:e.fiberRefs}),kB(k3)),k4=kY(k3),k6=kX(k3),k8=kJ(k3),k7=kQ(k3),k9=ic(2,(e,t)=>e.modifyEffect(t)),Oe=Symbol.for("effect/Layer"),Ot={[Oe]:{_RIn:e=>e,_E:e=>e,_ROut:e=>e},pipe(){return sp(this,arguments)}},Or=Symbol.for("effect/Layer/MemoMap"),On=cF()("effect/Layer/CurrentMemoMap",{defaultValue:()=>Oa()});class Oi{ref;[Or];constructor(e){this.ref=e,this[Or]=Or}getOrElseMemoize(e,t){return ib(k9(this.ref,r=>{let n=r.get(e);if(void 0!==n){let[e,i]=n;return de([ib(e,pB(([e,t])=>{let r;return ib((r=(t,r)=>ib(e,b9(t,r)),pS(e=>(e.setFiberRefs(r(e.id(),e.getFiberRefs())),dl))),p_(t))}),p4(gR({onFailure:()=>dl,onSuccess:()=>{let e,r;return e=t,r=i,e.addFinalizer(r)}}))),r])}return ib(vM(0),pB(n=>ib(gL(),pB(i=>ib(vM(()=>dl),p2(s=>{let a=da(a=>ib(wZ(),pB(o=>ib(a(pB(Ou(e,o,!0),e=>Sh(e(this),v7,b8))),pD,pB(a=>{switch(a._tag){case sm:let l,u;return ib(gH(i,a.effect_instruction_i0),dm((l=o,u=a,l.close(u))),dm(p$(a.effect_instruction_i0)));case sS:let c,h;return ib(vA(s,e=>{let t,r;return ib((t=o,r=e,t.close(r)),du(vD(n,e=>[1===e,e-1])),pw)}),dm(vP(n,e=>e+1)),dm((c=t,h=t=>ib(dr(()=>r.delete(e)),dm(s.get),pB(e=>e(t))),c.addFinalizer(h))),dm(gK(i,a.effect_instruction_i0)),p_(a.effect_instruction_i0[1]))}}))))),o=[ib(gB(i),p4(gN({onFailure:()=>dl,onSuccess:()=>vP(n,e=>e+1)}))),e=>ib(s.get,pB(t=>t(e)))];return[a,e._op_layer===kz?r:r.set(e,o)]}))))))}),pH)}}let Os=dt(()=>p2(kj(new Map),e=>new Oi(e))),Oa=()=>new Oi(kD(new Map)),Oo=ic(2,(e,t)=>pB(Os,r=>Ol(e,r,t))),Ol=ic(3,(e,t,r)=>pB(Ou(e,r),e=>So(e(t),On,t))),Ou=(e,t,r=!1)=>{switch(e._op_layer){case"Locally":return dr(()=>r=>e.f(r.getOrElseMemoize(e.self,t)));case"ExtendScope":return dr(()=>t=>pB(wW,r=>t.getOrElseMemoize(e.layer,r)));case"Fold":return dr(()=>r=>ib(r.getOrElseMemoize(e.layer,t),pK({onFailure:n=>r.getOrElseMemoize(e.failureK(n),t),onSuccess:n=>r.getOrElseMemoize(e.successK(n),t)})));case"Fresh":return dr(()=>r=>ib(e.layer,Oo(t)));case"FromEffect":return r?dr(()=>t=>e.effect):dr(()=>r=>r.getOrElseMemoize(e,t));case"Provide":return dr(()=>r=>ib(r.getOrElseMemoize(e.first,t),pB(n=>ib(r.getOrElseMemoize(e.second,t),gQ(n)))));case"Scoped":return r?dr(()=>r=>wQ(e.effect,t)):dr(()=>r=>r.getOrElseMemoize(e,t));case"Suspend":return dr(()=>r=>r.getOrElseMemoize(e.evaluate(),t));case"ProvideMerge":return dr(()=>r=>ib(r.getOrElseMemoize(e.first,t),db(r.getOrElseMemoize(e.second,t),e.zipK)));case"ZipWith":return dr(()=>r=>ib(r.getOrElseMemoize(e.first,t),wH(r.getOrElseMemoize(e.second,t),e.zipK,{concurrent:!0})))}},Oc=ic(2,(e,t)=>Oy(e,{onFailure:t,onSuccess:OO})),Oh=((e,t)=>Ob(e,{onFailure:t,onSuccess:OO}),()=>Om(gZ)),Of=e=>Op(uP(e)),Op=e=>Om(p$(e)),Od=ic(2,(e,t)=>Oy(e,{onFailure:Of,onSuccess:t})),Og=ic(2,(e,t)=>{let r=iD(e,cu),n=r?e:t;return Om(p2(r?t:e,e=>cv(n,e)))});function Om(e){let t=Object.create(Ot);return t._op_layer="FromEffect",t.effect=e,t}(e,t)=>{let r=Object.create(Ot);return r._op_layer="Locally",r.self=e,r.f=t,r};(e,t)=>Od(e,e=>OO(t(e)));let Ob=ic(2,(e,{onFailure:t,onSuccess:r})=>{let n=Object.create(Ot);return n._op_layer="Fold",n.layer=e,n.failureK=t,n.successK=r,n}),Oy=ic(2,(e,{onFailure:t,onSuccess:r})=>Ob(e,{onFailure:e=>{let r=uV(e);switch(r._tag){case"Left":return t(r.left);case"Right":return Op(r.right)}},onSuccess:r})),Ov=ic(2,(e,t)=>OT(e,t,(e,t)=>cO(e,t))),OS=(...e)=>{let t=e[0];for(let r=1;r<e.length;r++)t=Ov(t,e[r]);return t},Ox=ic(2,(e,t)=>{let r=iD(e,cu),n=r?e:t;return Ow(p2(r?t:e,e=>cv(n,e)))}),O_=e=>Ow(ib(e,p_(cy))),Ow=e=>{let t=Object.create(Ot);return t._op_layer="Scoped",t.effect=e,t},Ok=ic(2,(e,t)=>{let r=iD(e,cu);return Om(de(cv(r?e:t,r?t:e)))}),OO=e=>Om(de(e)),OE=e=>{let t=Object.create(Ot);return t._op_layer="Suspend",t.evaluate=e,t},OC=((e,t)=>{let r=iD(e,cu),n=r?e:t,i=r?t:e;return Om(dr(()=>cv(n,i())))},ic(2,(e,t)=>pB(pB(wW,r=>Ol(e,t,r)),e=>ib(k2(),gQ(e))))),OF=ic(2,(e,t)=>OE(()=>{let r=Object.create(Ot);return r._op_layer="Provide",r.first=Object.create(Ot,{_op_layer:{value:kL,enumerable:!0},first:{value:Oh(),enumerable:!0},second:{value:Array.isArray(t)?OS(...t):t},zipK:{value:(e,t)=>ib(e,cO(t))}}),r.second=e,r})),OI=ic(2,(e,t)=>{let r=Object.create(Ot);return r._op_layer=kL,r.first=t,r.second=OF(e,t),r.zipK=(e,t)=>ib(e,cO(t)),r}),OT=ic(3,(e,t,r)=>OE(()=>{let n=Object.create(Ot);return n._op_layer="ZipWith",n.first=e,n.second=t,n.zipK=r,n})),OR=e=>{let t=cE("effect/Layer/unwrapEffect/Layer.Layer<R1, E1, A>");return Od(Og(t,e),e=>cw(e,t))},ON=ic(2,(e,t)=>wL(r=>pB(Oo(t,r),t=>gY(e,t)))),OM=ic(2,(e,t)=>{let r=b8(k3.fiberRefs,t.fiberRefs),n=fW(k3.runtimeFlags,t.runtimeFlags);return da(i=>pS(s=>{let a=s.getFiberRef(dW),o=s.getFiberRefs(),l=b9(s.id(),o)(r),u=s.currentRuntimeFlags,c=fK(n)(u),h=b8(l,o),f=fW(c,u);return s.setFiberRefs(l),s.currentRuntimeFlags=c,w8(gY(i(e),cO(a,t.context)),pS(e=>(e.setFiberRefs(b9(e.id(),e.getFiberRefs())(h)),e.currentRuntimeFlags=fK(f)(e.currentRuntimeFlags),dl)))}))}),OA=ic(2,(e,t)=>{if(Array.isArray(t))return ON(e,OS(...t));if(iD(t,Oe))return ON(e,t);if(cb(t))return gY(e,t);if(k$ in t)return pB(t.runtimeEffect,t=>OM(e,t));else return OM(e,t)}),Oj=Symbol.for("effect/DateTime"),OD=Symbol.for("effect/DateTime/TimeZone"),OP={[Oj]:Oj,pipe(){return sp(this,arguments)},[ss](){return this.toString()},toJSON(){return O7(this).toJSON()}},O$={...OP,_tag:"Utc",[i0](){return se(this,i6(this.epochMillis))},[st](e){return OJ(e)&&"Utc"===e._tag&&this.epochMillis===e.epochMillis},toString(){return`DateTime.Utc(${O7(this).toJSON()})`}},Oz={...OP,_tag:"Zoned",[i0](){return ib(i6(this.epochMillis),i3(i1(this.zone)),se(this))},[st](e){return OJ(e)&&"Zoned"===e._tag&&this.epochMillis===e.epochMillis&&sr(this.zone,e.zone)},toString(){return`DateTime.Zoned(${Ep(this)})`}},OL={[OD]:OD,[ss](){return this.toString()}},OU={...OL,_tag:"Named",[i0](){return se(this,i8(`Named:${this.id}`))},[st](e){return OW(e)&&"Named"===e._tag&&this.id===e.id},toString(){return`TimeZone.Named(${this.id})`},toJSON(){return{_id:"TimeZone",_tag:"Named",id:this.id}}},OB={...OL,_tag:"Offset",[i0](){return se(this,i8(`Offset:${this.offset}`))},[st](e){return OW(e)&&"Offset"===e._tag&&this.offset===e.offset},toString(){return`TimeZone.Offset(${Et(this.offset)})`},toJSON(){return{_id:"TimeZone",_tag:"Offset",offset:this.offset}}},Oq=(e,t,r)=>{let n=Object.create(Oz);return n.epochMillis=e,n.zone=t,Object.defineProperty(n,"partsUtc",{value:r,enumerable:!1,writable:!0}),Object.defineProperty(n,"adjustedEpochMillis",{value:void 0,enumerable:!1,writable:!0}),Object.defineProperty(n,"partsAdjusted",{value:void 0,enumerable:!1,writable:!0}),n},OJ=e=>iD(e,Oj),OH=e=>OJ(e[0]),OW=e=>iD(e,OD),OK=e=>"Zoned"===e._tag,OV=iy((e,t)=>e.epochMillis===t.epochMillis),OG=e=>{let t=Object.create(O$);return t.epochMillis=e,Object.defineProperty(t,"partsUtc",{value:void 0,enumerable:!1,writable:!0}),t},OZ=e=>{let t=e.getTime();if(Number.isNaN(t))throw new gf("Invalid date");return OG(t)},OQ=e=>{if(OJ(e))return e;if(e instanceof Date)return OZ(e);if("object"==typeof e){let t=new Date(0);return En(t,e),OZ(t)}return"string"!=typeof e||OY(e)?OZ(new Date(e)):OZ(new Date(e+"Z"))},OY=e=>/Z|[+-]\d{2}$|[+-]\d{2}:?\d{2}$|\]$/.test(e),OX=(e,t)=>{let r;if(t?.timeZone===void 0&&OJ(e)&&OK(e))return e;let n=OQ(e);if(n.epochMillis<-86399999568e5||n.epochMillis>86399999496e5)throw RangeError(`Epoch millis out of range: ${n.epochMillis}`);if(t?.timeZone===void 0)r=O5(-60*new Date(n.epochMillis).getTimezoneOffset()*1e3);else if(OW(t?.timeZone))r=t.timeZone;else if("number"==typeof t?.timeZone)r=O5(t.timeZone);else{let e=O8(t.timeZone);if(sH(e))throw new gf(`Invalid time zone: ${t.timeZone}`);r=e.value}return t?.adjustForTimeZone!==!0?Oq(n.epochMillis,r,n.partsUtc):Ei(n.epochMillis,r,t?.disambiguation??"compatible")},O0=ay(OX),O1=((e,t,r)=>r?.adjustForTimeZone===!0?Ei(e.epochMillis,t,r?.disambiguation??"compatible"):Oq(e.epochMillis,t,e.partsUtc),ik("effect/DateTime/validZoneCache",()=>new Map)),O2={day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"longOffset",fractionalSecondDigits:3,hourCycle:"h23"},O3=e=>{if(O1.has(e))return O1.get(e);try{var t=new Intl.DateTimeFormat("en-US",{...O2,timeZone:e});let r=t.resolvedOptions().timeZone;if(O1.has(r))return O1.get(r);let n=Object.create(OU);return n.id=r,n.format=t,O1.set(r,n),n}catch{throw new gf(`Invalid time zone: ${e}`)}},O5=e=>{let t=Object.create(OB);return t.offset=e,t},O4=ay(O3),O6=/^(?:GMT|[+-])/,O8=e=>{if(O6.test(e)){let t=Ea(e);return null===t?ah():sV(O5(t))}return O4(e)},O7=((e,t)=>Er(t)-Er(e),e=>new Date(e.epochMillis)),O9=e=>{if("Utc"===e._tag)return new Date(e.epochMillis);if("Offset"===e.zone._tag)return new Date(e.epochMillis+e.zone.offset);if(void 0!==e.adjustedEpochMillis)return new Date(e.adjustedEpochMillis);let t=e.zone.format.formatToParts(e.epochMillis).filter(e=>"literal"!==e.type),r=new Date(0);return r.setUTCFullYear(Number(t[2].value),Number(t[0].value)-1,Number(t[1].value)),r.setUTCHours(Number(t[3].value),Number(t[4].value),Number(t[5].value),Number(t[6].value)),e.adjustedEpochMillis=r.getTime(),r},Ee=e=>O9(e).getTime()-Er(e),Et=e=>{let t=Math.abs(e),r=Math.floor(t/36e5),n=Math.round(t%36e5/6e4);return 60===n&&(r+=1,n=0),`${e<0?"-":"+"}${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}`},Er=e=>e.epochMillis,En=(e,t)=>{if(void 0!==t.year&&e.setUTCFullYear(t.year),void 0!==t.month&&e.setUTCMonth(t.month-1),void 0!==t.day&&e.setUTCDate(t.day),void 0!==t.weekDay){let r=t.weekDay-e.getUTCDay();e.setUTCDate(e.getUTCDate()+r)}void 0!==t.hours&&e.setUTCHours(t.hours),void 0!==t.minutes&&e.setUTCMinutes(t.minutes),void 0!==t.seconds&&e.setUTCSeconds(t.seconds),void 0!==t.millis&&e.setUTCMilliseconds(t.millis)},Ei=(e,t,r)=>{if("Offset"===t._tag)return Oq(e-t.offset,t);let n=Eo(e-864e5,e,t),i=Eo(e+864e5,e,t);if(n===i)return Oq(e-n,t);let s=n-i;if(n<i){if(Eo(e-i,e,t)===i)return Oq(e-i,t);let s=Oq(e-n,t);if(e!==O9(s).getTime())switch(r){case"reject":{let r=new Date(e).toISOString();throw RangeError(`Gap time: ${r} does not exist in time zone ${t.id}`)}case"earlier":return Oq(e-i,t)}return s}if(Eo(e-n,e,t)===n){if("earlier"===r||"compatible"===r||Eo(e-n+s,e+s,t)===n)return Oq(e-n,t);if("reject"===r){let r=new Date(e).toISOString();throw RangeError(`Ambiguous time: ${r} occurs twice in time zone ${t.id}`)}}return Oq(e-i,t)},Es=/([+-])(\d{2}):(\d{2})$/,Ea=e=>{let t=Es.exec(e);if(null===t)return null;let[,r,n,i]=t;return("+"===r?1:-1)*(60*Number(n)+Number(i))*6e4},Eo=(e,t,r)=>{let n=r.format.formatToParts(e).find(e=>"timeZoneName"===e.type)?.value??"";if("GMT"===n)return 0;let i=Ea(n);return null===i?Ee(Oq(t,r)):i},El=ic(OH,(e,t,r)=>{if("Utc"===e._tag){let r=O7(e);return t(r),OG(r.getTime())}let n=new Date(O9(e).getTime());return t(n),Ei(n.getTime(),e.zone,r?.disambiguation??"compatible")}),Eu=((e,t)=>Eu(e,e=>{let r=new Date(e);return t(r),r.getTime()}),ic(2,(e,t)=>{let r=t(Er(e));return"Utc"===e._tag?OG(r):Oq(r,e.zone)})),Ec=((e,t)=>t(O9(e)),ic(2,(e,t)=>t(O7(e)))),Eh=(e,t)=>{e.setTime(e.getTime()+t)},Ef=((e,t)=>El(e,e=>{if(t.millis&&Eh(e,t.millis),t.seconds&&Eh(e,1e3*t.seconds),t.minutes&&Eh(e,60*t.minutes*1e3),t.hours&&Eh(e,60*t.hours*6e4),t.days&&e.setUTCDate(e.getUTCDate()+t.days),t.weeks&&e.setUTCDate(e.getUTCDate()+7*t.weeks),t.months){let r=e.getUTCDate();e.setUTCMonth(e.getUTCMonth()+t.months+1,0),r<e.getUTCDate()&&e.setUTCDate(r)}if(t.years){let r=e.getUTCDate(),n=e.getUTCMonth();e.setUTCFullYear(e.getUTCFullYear()+t.years,n+1,0),r<e.getUTCDate()&&e.setUTCDate(r)}}),e=>{let t=O9(e);return"Utc"===e._tag?t.toISOString():`${t.toISOString().slice(0,-1)}${Et(Ee(e))}`}),Ep=e=>"Offset"===e.zone._tag?Ef(e):`${Ef(e)}[${e.zone.id}]`;class Ed{s;stripped;index;length;constructor(e,t=!1){this.s=e,this.stripped=t,this.index=0,this.length=e.length}next(){if(this.done)return{done:!0,value:void 0};let e=this.index;for(;!this.done&&!Eg(this.s[this.index]);)this.index=this.index+1;let t=this.index;if(!this.done){let e=this.s[this.index];this.index=this.index+1,!this.done&&Em(e,this.s[this.index])&&(this.index=this.index+1),this.stripped||(t=this.index)}return{done:!1,value:this.s.substring(e,t)}}[Symbol.iterator](){return new Ed(this.s,this.stripped)}get done(){return this.index>=this.length}}let Eg=e=>{let t=e.charCodeAt(0);return 13===t||10===t},Em=(e,t)=>13===e.charCodeAt(0)&&10===t.charCodeAt(0),Eb=((e,t)=>Ey(e.seconds,t.seconds)&&Ey(e.minutes,t.minutes)&&Ey(e.hours,t.hours)&&Ey(e.days,t.days)&&Ey(e.months,t.months)&&Ey(e.weekdays,t.weekdays),i_(iv)),Ey=(e,t)=>Eb(a$(e),a$(t)),Ev=Symbol.for("effect/Schedule"),ES=Symbol.for("effect/ScheduleDriver"),Ex={start:0,now:0,input:void 0,output:void 0,elapsed:cq,elapsedSincePrevious:cq,recurrence:0},E_=cF()("effect/Schedule/CurrentIterationMetadata",{defaultValue:()=>Ex}),Ew={_Out:e=>e,_In:e=>e,_R:e=>e},Ek={_Out:e=>e,_In:e=>e,_R:e=>e};class EO{initial;step;[Ev]=Ew;constructor(e,t){this.initial=e,this.step=t}pipe(){return sp(this,arguments)}}let EE=(e,t,r,n)=>vP(e,e=>0===e.recurrence?{now:t,input:r,output:n,recurrence:e.recurrence+1,elapsed:cq,elapsedSincePrevious:cq,start:t}:{now:t,input:r,output:n,recurrence:e.recurrence+1,elapsed:cK(t-e.start),elapsedSincePrevious:cK(t-e.now),start:e.start});class EC{schedule;ref;[ES]=Ek;constructor(e,t){this.schedule=e,this.ref=t}get state(){return p2(this.ref.get,e=>e[1])}get last(){return pB(this.ref.get,([e,t])=>{switch(e._tag){case"None":return pB(dr(()=>new gd),pP);case"Some":return de(e.value)}})}iterationMeta=vN(Ex);get reset(){return vA(this.ref,[ah(),this.schedule.initial]).pipe(dg(vA(this.iterationMeta,Ex)))}next(e){return ib(p2(this.ref.get,e=>e[1]),pB(t=>ib(bp,pB(r=>ib(dt(()=>this.schedule.step(r,e,t)),pB(([t,n,i])=>{let s=vA(this.ref,[sV(n),t]);if(i._tag===km)return s.pipe(dm(pP(ah())));let a=kf(i.intervals)-r;if(a<=0)return s.pipe(dm(EE(this.iterationMeta,r,e,n)),p_(n));let o=cK(a);return ib(s,dm(EE(this.iterationMeta,r,e,n)),dm(vW(o)),p_(n))}))))))}}let EF=(e,t)=>new EO(e,t),EI=((e,t)=>EI(e,e=>dr(()=>t(e))),ic(2,(e,t)=>Ez(e,(e,r)=>p2(t(e),e=>c4(r,cP(e)))))),ET=((e,t)=>EF([e.initial,t.initial,!0],(r,n,i)=>i[2]?pB(e.step(r,n,i[0]),([e,s,a])=>a._tag===km?p2(t.step(r,n,i[1]),([t,r,n])=>[[e,t,!1],s3(r),n]):de([[e,i[1],!0],s2(s),a])):p2(t.step(r,n,i[1]),([e,t,r])=>[[i[0],e,!1],s3(t),r])),ic(2,(e,t)=>ER(e,(e,r)=>dr(()=>t(e,r))))),ER=ic(2,(e,t)=>EF(e.initial,(r,n,i)=>pB(e.step(r,n,i),([e,r,i])=>i._tag===km?de([e,r,kv]):p2(t(n,r),t=>t?[e,r,i]:[e,r,kv])))),EN=((e,t)=>EN(e,e=>dr(()=>t(e))),ic(2,(e,t)=>EF(e.initial,(r,n,i)=>pB(t(n),t=>e.step(r,t,i))))),EM=((e,t)=>Ez(e,(e,r)=>t(r)),e=>ib(vM([ah(),e.initial]),p2(t=>new EC(e,t)))),EA=ic(2,(e,t)=>Ej(e,t,kc)),Ej=ic(3,(e,t,r)=>EF([e.initial,t.initial],(n,i,s)=>ib(db(e.step(n,i,s[0]),t.step(n,i,s[1]),(e,t)=>[e,t]),pB(([[n,s,a],[o,l,u]])=>a._tag===kg&&u._tag===kg?ED(e,t,i,n,s,a.intervals,o,l,u.intervals,r):de([[n,o],[s,l],kv]))))),ED=(e,t,r,n,i,s,a,o,l,u)=>{let c=u(s,l);return lS(c.intervals)?de([[n,a],[i,o],kb(c)]):ib(s,kp(l))?pB(e.step(kd(s),r,n),([n,i,s])=>s._tag===km?de([[n,a],[i,o],kv]):ED(e,t,r,n,i,s.intervals,a,o,l,u)):pB(t.step(kd(l),r,a),([a,o,l])=>l._tag===km?de([[n,a],[i,o],kv]):ED(e,t,r,n,i,s,a,o,l.intervals,u))},EP=ic(2,(e,t)=>E$(e,e=>dr(()=>t(e)))),E$=ic(2,(e,t)=>EF(e.initial,(r,n,i)=>pB(e.step(r,n,i),([e,r,n])=>p2(t(r),t=>[e,t,n])))),Ez=ic(2,(e,t)=>EF(e.initial,(r,n,i)=>pB(e.step(r,n,i),([e,n,i])=>{let s;if(i._tag===km)return de([e,n,i]);let a=i.intervals;return p2(t(n,cK((s=kt(r,kf(a))).endMillis-s.startMillis)),t=>{let i=cP(t),s=kf(a),o=r+cX(i),l=o-s;return[e,n,ky(kt(o,Math.max(0,kd(a)+l)))]})}))),EL=e=>EJ(E5,t=>t<e),EU=((e,t,r)=>EF([e.initial,t],(t,n,[i,s])=>pB(e.step(t,n,i),([e,t,n])=>n._tag===km?de([[e,s],s,n]):p2(r(s,t),t=>[[e,t],s,n]))),ic(3,(e,t,r)=>EF([e.initial,t.initial],(n,i,s)=>db(e.step(n,i,s[0]),t.step(n,i,s[1]),([e,t,n],[i,s,a])=>{if(n._tag===km&&a._tag===km)return[[e,i],[t,s],kv];if(n._tag===km&&a._tag===kg)return[[e,i],[t,s],kb(a.intervals)];if(n._tag===kg&&a._tag===km)return[[e,i],[t,s],kb(n.intervals)];if(n._tag===kg&&a._tag===kg)return[[e,i],[t,s],kb(r(n.intervals,a.intervals))];throw Error("BUG: Schedule.unionWith - please report an issue at https://github.com/Effect-TS/effect/issues")})))),EB=ic(2,(e,t)=>ER(e,(e,r)=>p2(t(e),e=>!e))),Eq=ic(2,(e,t)=>ER(e,(e,r)=>t(e))),EJ=ic(2,(e,t)=>ET(e,(e,r)=>t(r))),EH=((e,t)=>EP(EA(e,t),e=>e[0]),Symbol.for("effect/Schedule/ScheduleDefect"));class EW{error;[EH];constructor(e){this.error=e,this[EH]=EH}}let EK=e=>pI(e,e=>pM(new EW(e))),EV=e=>af(u2(e,e=>"Die"===e._tag&&iD(e.defect,EH)?sV(e.defect):ah()),{onNone:()=>e,onSome:e=>uP(e.error)}),EG=ic(2,(e,t)=>EQ(e,t,(e,t)=>pP(e))),EZ=ic(2,(e,t)=>{if(iD(t,Ev))return EG(e,t);let r=t.schedule??EF(E5.initial,(e,t,r)=>ib(E5.step(e,t,r),p2(([e,r,n])=>[e,t,n]))),n=t.while?Eq(r,e=>{let r=t.while(e);return"boolean"==typeof r?de(r):EK(r)}):r,i=t.until?EB(n,e=>{let r=t.until(e);return"boolean"==typeof r?de(r):EK(r)}):n;return pF(EG(e,t.times?EA(i,EL(t.times)).pipe(EP(e=>e[0])):i),e=>p$(EV(e)))}),EQ=ic(3,(e,t,r)=>pB(EM(t),t=>pV(e,{onFailure:e=>r(e,ah()),onSuccess:n=>EY(Sl(e,E_,t.iterationMeta.get),t,(e,n)=>Sl(r(e,n),E_,t.iterationMeta.get),n)}))),EY=(e,t,r,n)=>pV(t.next(n),{onFailure:()=>p7(t.last),onSuccess:n=>pV(e,{onFailure:e=>r(e,sV(n)),onSuccess:n=>EY(e,t,r,n)})}),EX=((e,t)=>E0(e,t,(e,t)=>pP(e)),e=>{let t=e.schedule??E5,r=e.while?Eq(t,t=>{let r=e.while(t);return"boolean"==typeof r?de(r):EK(r)}):t,n=e.until?EB(r,t=>{let r=e.until(t);return"boolean"==typeof r?de(r):EK(r)}):r;return e.times?EA(n,EL(e.times)):n}),E0=ic(3,(e,t,r)=>pB(EM(t),t=>E1(Sl(e,E_,t.iterationMeta.get),t,(e,n)=>Sl(r(e,n),E_,t.iterationMeta.get)))),E1=(e,t,r)=>pI(e,n=>pV(t.next(n),{onFailure:()=>ib(t.last,p7,pB(e=>r(n,e))),onSuccess:()=>E1(e,t,r)})),E2=((e,t)=>E2(e,void 0,t),ic(3,(e,t,r)=>pB(EM(r),r=>E3(Sl(e,E_,r.iterationMeta.get),t,r)))),E3=(e,t,r)=>pV(r.next(t),{onFailure:()=>p7(r.last),onSuccess:()=>pB(e,t=>E3(e,t,r))}),E5=(b=e=>e+1,EF(0,(e,t,r)=>dr(()=>[b(r),r,ky(kt(e,1/0))]))),E4=EP(EL(1),im),E6=Symbol.for("effect/MutableList"),E8={[E6]:E6,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(null==t)return e=!0,this.return();let r=t.value;return t=t.next,{done:e,value:r}},return:t=>(e||(e=!0),{done:!0,value:t})}},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"MutableList",values:Array.from(this).map(sa)}},[ss](){return this.toJSON()},pipe(){return sp(this,arguments)}},E7=ic(2,(e,t)=>{let r={value:t,removed:!1,prev:void 0,next:void 0};return void 0===e.head&&(e.head=r),void 0===e.tail||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),E9=Symbol.for("effect/MutableQueue"),Ce=Symbol.for("effect/mutable/MutableQueue/Empty"),Ct={[E9]:E9,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(sa)}},[ss](){return this.toJSON()},pipe(){return sp(this,arguments)}},Cr=e=>{let t,r=Object.create(Ct);return(t=Object.create(E8)).head=void 0,t.tail=void 0,t._length=0,r.queue=t,r.capacity=e,r},Cn=e=>0===e.queue._length,Ci=ic(2,(e,t)=>{let r=e.queue._length;return(void 0===e.capacity||r!==e.capacity)&&(E7(t)(e.queue),!0)}),Cs=ic(2,(e,t)=>{let r,n=t[Symbol.iterator](),i=o7(),s=!0;for(;s&&(r=n.next())&&!r.done;)s=Ci(r.value)(e);for(;null!=r&&!r.done;)i=lc(r.value)(i),r=n.next();return li(i)}),Ca=ic(2,(e,t)=>{if(0===e.queue._length)return t;var r,n,i=e.queue;let s=i.head;return void 0!==s?(r=i,!(n=s).removed&&(n.removed=!0,void 0!==n.prev&&void 0!==n.next?(n.prev.next=n.next,n.next.prev=n.prev):void 0!==n.prev?(r.tail=n.prev,n.prev.next=void 0):void 0!==n.next?(r.head=n.next,n.next.prev=void 0):(r.tail=void 0,r.head=void 0),r._length>0&&(r._length-=1)),s.value):void 0}),Co=ic(2,(e,t)=>{let r=o7(),n=0;for(;n<t;){let t=Ca(Ce)(e);if(t===Ce)break;r=lc(t)(r),n+=1}return li(r)}),Cl=(e,t,r,n)=>hQ({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:n}),Cu=(e,t)=>hQ({_tag:"Pending",key:e,deferred:t}),Cc=Symbol.for("effect/Cache/MapKey");class Ch{current;[Cc]=Cc;previous=void 0;next=void 0;constructor(e){this.current=e}[i0](){return ib(i1(this.current),i3(i1(this.previous)),i3(i1(this.next)),se(this))}[st](e){return this===e||Cp(e)&&sr(this.current,e.current)&&sr(this.previous,e.previous)&&sr(this.next,e.next)}}let Cf=e=>new Ch(e),Cp=e=>iD(e,Cc);class Cd{head=void 0;tail=void 0;add(e){if(e!==this.tail)if(void 0===this.tail)this.head=e,this.tail=e;else{let t=e.previous,r=e.next;void 0!==r&&(e.next=void 0,void 0!==t?(t.next=r,r.previous=t):(this.head=r,this.head.previous=void 0)),this.tail.next=e,e.previous=this.tail,this.tail=e}}remove(){let e=this.head;if(void 0!==e){let t=e.next;void 0!==t?(e.next=void 0,this.head=t,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return e}}let Cg=Symbol.for("effect/Cache"),Cm={_Key:e=>e,_Error:e=>e,_Value:e=>e},Cb=Symbol.for("effect/ConsumerCache"),Cy={_Key:e=>e,_Error:e=>e,_Value:e=>e},Cv=e=>({loadedMillis:e});class CS{capacity;context;fiberId;lookup;timeToLive;[Cg]=Cm;[Cb]=Cy;cacheState;constructor(e,t,r,n,i){this.capacity=e,this.context=t,this.fiberId=r,this.lookup=n,this.timeToLive=i,this.cacheState=(()=>{let e,t;return e=xj(),t=new Cd,{map:e,keys:t,accesses:Cr(void 0),updating:hn(!1),hits:0,misses:0}})()}get(e){return p2(this.getEither(e),s9)}get cacheStats(){return dr(()=>({hits:this.cacheState.hits,misses:this.cacheState.misses,size:xB(this.cacheState.map)}))}getOption(e){return dt(()=>af(xD(this.cacheState.map,e),{onNone:()=>{let t=Cf(e);return this.trackAccess(t),this.trackMiss(),de(ah())},onSome:e=>this.resolveMapValue(e)}))}getOptionComplete(e){return dt(()=>af(xD(this.cacheState.map,e),{onNone:()=>{let t=Cf(e);return this.trackAccess(t),this.trackMiss(),de(ah())},onSome:e=>this.resolveMapValue(e,!0)}))}contains(e){return dr(()=>x$(this.cacheState.map,e))}entryStats(e){return dr(()=>{let t=xD(this.cacheState.map,e);if(sW(t))switch(t.value._tag){case"Complete":return sV(Cv(t.value.entryStats.loadedMillis));case"Pending":break;case"Refreshing":return sV(Cv(t.value.complete.entryStats.loadedMillis))}return ah()})}getEither(e){return dt(()=>{let t,r,n=ab(xD(this.cacheState.map,e));return(void 0===n&&(r=gz(this.fiberId),t=Cf(e),x$(this.cacheState.map,e)?n=ab(xD(this.cacheState.map,e)):xz(this.cacheState.map,e,Cu(t,r))),void 0===n)?(this.trackAccess(t),this.trackMiss(),p2(this.lookupValueOf(e,r),s3)):pB(this.resolveMapValue(n),af({onNone:()=>this.getEither(e),onSome:e=>de(s2(e))}))})}invalidate(e){return dr(()=>{xU(this.cacheState.map,e)})}invalidateWhen(e,t){return dr(()=>{let r=xD(this.cacheState.map,e);sW(r)&&"Complete"===r.value._tag&&"Success"===r.value.exit._tag&&t(r.value.exit.value)&&xU(this.cacheState.map,e)})}get invalidateAll(){return dr(()=>{this.cacheState.map=xj()})}refresh(e){return bf(t=>dt(()=>{let r=gz(this.fiberId),n=ab(xD(this.cacheState.map,e));if(void 0===n&&(x$(this.cacheState.map,e)?n=ab(xD(this.cacheState.map,e)):xz(this.cacheState.map,e,Cu(Cf(e),r))),void 0===n)return pw(this.lookupValueOf(e,r));switch(n._tag){case"Complete":if(this.hasExpired(t,n.timeToLiveMillis))return sr(ab(xD(this.cacheState.map,e)),n)&&xU(this.cacheState.map,e),pw(this.get(e));return ib(this.lookupValueOf(e,r),Sb(()=>{if(sr(ab(xD(this.cacheState.map,e)),n)){let t=hQ({_tag:"Refreshing",deferred:r,complete:n});return xz(this.cacheState.map,e,t),!0}return!1}),pw);case"Pending":case"Refreshing":return gB(n.deferred)}}))}set(e,t){return bf(r=>dr(()=>{let n=r.unsafeCurrentTimeMillis(),i=gM(t),s=Cl(Cf(e),i,Cv(n),n+cX(cP(this.timeToLive(i))));xz(this.cacheState.map,e,s)}))}get size(){return dr(()=>xB(this.cacheState.map))}get values(){return dr(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push(t[1].exit.value);return e})}get entries(){return dr(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push([t[0],t[1].exit.value]);return e})}get keys(){return dr(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push(t[0]);return e})}resolveMapValue(e,t=!1){return bf(r=>{switch(e._tag){case"Complete":if(this.trackAccess(e.key),this.hasExpired(r,e.timeToLiveMillis))return xU(this.cacheState.map,e.key.current),de(ah());return this.trackHit(),p2(e.exit,sV);case"Pending":if(this.trackAccess(e.key),this.trackHit(),t)return de(ah());return p2(gB(e.deferred),sV);case"Refreshing":if(this.trackAccess(e.complete.key),this.trackHit(),this.hasExpired(r,e.complete.timeToLiveMillis)){if(t)return de(ah());return p2(gB(e.deferred),sV)}return p2(e.complete.exit,sV)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(e){if(Ci(this.cacheState.accesses,e),hi(this.cacheState.updating,!1,!0)){let e=!0;for(;e;){let t=Ca(this.cacheState.accesses,Ce);t===Ce?e=!1:this.cacheState.keys.add(t)}let t=xB(this.cacheState.map);for(e=t>this.capacity;e;){let r=this.cacheState.keys.remove();void 0!==r?x$(this.cacheState.map,r.current)&&(xU(this.cacheState.map,r.current),t-=1,e=t>this.capacity):e=!1}hs(this.cacheState.updating,!1)}}hasExpired(e,t){return e.unsafeCurrentTimeMillis()>t}lookupValueOf(e,t){return bf(r=>dt(()=>ib(this.lookup(e),gQ(this.context),pD,pB(n=>{let i=r.unsafeCurrentTimeMillis(),s=Cv(i),a=Cl(Cf(e),n,s,i+cX(cP(this.timeToLive(n))));return xz(this.cacheState.map,e,a),dm(gJ(t,n),n)}),p6(()=>dm(pB(pL,e=>gq(t,pX(e))),dr(()=>{xU(this.cacheState.map,e)}))))))}}()=>{let e,t;return dq((e=()=>p2(gL(),e=>({listeners:new __,handle:e})),t=()=>cV(60),new CS(65536,cy,hd,e,e=>cP(t(e)))))},()=>dq(!1);let Cx=function(){let e=1==arguments.length?arguments[0]:arguments[1].bind(arguments[0]);return dh(()=>e(ib))},C_=e=>e.length>=1?pC((t,r)=>{try{e(r).then(e=>t(gM(e)),e=>t(gO(e)))}catch(e){t(gO(e))}}):pC(t=>{try{e().then(e=>t(gM(e)),e=>t(gO(e)))}catch(e){t(gO(e))}}),Cw=e=>pK(e,{onFailure:e=>St(e,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>dl}),Ck=e=>pB(wZ(),t=>wY(e,t)),CO=e=>dr(()=>kx(e)),CE=ic(2,(e,t)=>wH(e,t,(e,t)=>e(t))),CC=function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=bo(e?arguments[2]:arguments[1]);if(e){let e=arguments[0];return SS(t,r,t=>Sx(e,t))}return e=>SS(t,r,t=>Sx(e,t))},CF=function(e,...t){let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=Error();if(Error.stackTraceLimit=r,"string"!=typeof e)return CI(e.length,function(...r){let i=Error.stackTraceLimit;Error.stackTraceLimit=2;let s=Error();return Error.stackTraceLimit=i,CT({self:this,body:e,args:r,pipeables:t,spanName:"<anonymous>",spanOptions:{context:bl.context(!0)},errorDef:n,errorCall:s})});let i=t[0];return(t,...r)=>CI(t.length,{[e](...s){let a=Error.stackTraceLimit;Error.stackTraceLimit=2;let o=Error();return Error.stackTraceLimit=a,CT({self:this,body:t,args:s,pipeables:r,spanName:e,spanOptions:i,errorDef:n,errorCall:o})}}[e])};function CI(e,t){return Object.defineProperty(t,"length",{value:e,configurable:!0})}function CT(e){let t,r,n;if(ij(n=e.body)&&n.constructor===iY)t=dh(()=>e.body.apply(e.self,e.args));else try{t=e.body.apply(e.self,e.args)}catch(e){r=e,t=pM(e)}if(e.pipeables.length>0)try{for(let r of e.pipeables)t=r(t,...e.args)}catch(e){t=r?p$(uU(u$(r),u$(e))):pM(e)}let i=!1,s=e.spanOptions&&"captureStackTrace"in e.spanOptions?e.spanOptions:{captureStackTrace:()=>{if(!1!==i)return i;if(e.errorCall.stack){let t=e.errorDef.stack.trim().split("\n"),r=e.errorCall.stack.trim().split("\n"),n=t.slice(2).join("\n").trim();n.includes("(")||(n=n.replace(/at (.*)/,"at ($1)"));let s=r.slice(2).join("\n").trim();return s.includes("(")||(s=s.replace(/at (.*)/,"at ($1)")),i=`${n}
${s}`}},...e.spanOptions};return CC(t,e.spanName,s)}let CR=ic(2,(e,t)=>dU(wg,t)(e)),CN=e=>O_(w0(ww,uv(e))),CM=e=>OR(p2(e,CN)),CA=e=>{var t;let r;return t=p2(e,CN),Od(Ox(r=cE("effect/Layer/unwrapScoped/Layer.Layer<R1, E1, A>"),t),e=>cw(e,r))},Cj=e=>O_(w0(ww,uS(e))),CD=ic(2,(e,t)=>Od(Cj(e),()=>CN(t))),CP=ic(2,(e,t)=>Od(Cj(e),()=>CM(t))),C$=ic(2,(e,t)=>Od(Cj(e),()=>CA(t))),Cz=OJ,CL=e=>OW(e)&&"Offset"===e._tag,CU=e=>OW(e)&&"Named"===e._tag,CB=e=>"Utc"===e._tag,Cq=OK,CJ=OV,CH=OZ,CW=OX,CK=Symbol.for("effect/Encoding/errors/Decode"),CV=(e,t)=>{let r={_tag:"DecodeException",[CK]:CK,input:e};return iO(t)&&(r.message=t),r},CG=Symbol.for("effect/Encoding/errors/Encode"),CZ=new TextEncoder,CQ=e=>{let t,r=e.length,n="";for(t=2;t<r;t+=3)n+=C0[e[t-2]>>2],n+=C0[(3&e[t-2])<<4|e[t-1]>>4],n+=C0[(15&e[t-1])<<2|e[t]>>6],n+=C0[63&e[t]];return t===r+1&&(n+=C0[e[t-2]>>2],n+=C0[(3&e[t-2])<<4],n+="=="),t===r&&(n+=C0[e[t-2]>>2],n+=C0[(3&e[t-2])<<4|e[t-1]>>4],n+=C0[(15&e[t-1])<<2],n+="="),n},CY=e=>e.replace(/[\n\r]/g,"");function CX(e){if(e>=C1.length)throw TypeError(`Invalid character ${String.fromCharCode(e)}`);let t=C1[e];if(255===t)throw TypeError(`Invalid character ${String.fromCharCode(e)}`);return t}let C0=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],C1=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];class C2 extends Error{constructor(e=!1){super(),this.interruptExecution=e,this.footprint=C2.SharedFootPrint}static isFailure(e){return null!=e&&e.footprint===C2.SharedFootPrint}}C2.SharedFootPrint=Symbol.for("fast-check/PreconditionFailure");class C3{[Symbol.iterator](){return this}next(e){return{value:e,done:!0}}}C3.nil=new C3;let C5=Symbol.iterator;class C4{static nil(){return new C4(C3.nil)}static of(...e){return new C4(e[C5]())}constructor(e){this.g=e}next(){return this.g.next()}[Symbol.iterator](){return this.g}map(e){return new C4(function*(e,t){for(let r of e)yield t(r)}(this.g,e))}flatMap(e){return new C4(function*(e,t){for(let r of e)yield*t(r)}(this.g,e))}dropWhile(e){let t=!1;return this.flatMap(function*(r){(t||!e(r))&&(t=!0,yield r)})}drop(e){if(e<=0)return this;let t=0;return this.dropWhile(function(){return t++<e})}takeWhile(e){return new C4(function*(e,t){let r=e.next();for(;!r.done&&t(r.value);)yield r.value,r=e.next()}(this.g,e))}take(e){return new C4(function*(e,t){for(let r=0;r<t;++r){let t=e.next();if(t.done)break;yield t.value}}(this.g,e))}filter(e){return new C4(function*(e,t){for(let r of e)t(r)&&(yield r)}(this.g,e))}every(e){for(let t of this.g)if(!e(t))return!1;return!0}has(e){for(let t of this.g)if(e(t))return[!0,t];return[!1,null]}join(...e){return new C4(function*(e,t){for(let t=e.next();!t.done;t=e.next())yield t.value;for(let e of t)for(let t=e.next();!t.done;t=e.next())yield t.value}(this.g,e))}getNthOrLast(e){let t=e,r=null;for(let e of this.g){if(0==t--)return e;r=e}return r}}let C6=Symbol.for("fast-check/cloneMethod");function C8(e){return null!==e&&("object"==typeof e||"function"==typeof e)&&C6 in e&&"function"==typeof e[C6]}let C7=Object.defineProperty;class C9{constructor(e,t,r){this.value_=e,this.context=t,this.hasToBeCloned=void 0!==r||C8(e),this.readOnce=!1,this.hasToBeCloned?C7(this,"value",{get:void 0!==r?r:this.getValue}):this.value=e}getValue(){return this.hasToBeCloned?this.readOnce?this.value_[C6]():(this.readOnce=!0,this.value_):this.value_}}let Fe=Object.assign;class Ft{filter(e){return new Fi(this,e)}map(e,t){return new Fn(this,e,t)}chain(e){return new Fr(this,e)}noShrink(){return new Fs(this)}noBias(){return new Fa(this)}}class Fr extends Ft{constructor(e,t){super(),this.arb=e,this.chainer=t}generate(e,t){let r=e.clone(),n=this.arb.generate(e,t);return this.valueChainer(n,e,r,t)}canShrinkWithoutContext(e){return!1}shrink(e,t){return this.isSafeContext(t)?(!t.stoppedForOriginal?this.arb.shrink(t.originalValue,t.originalContext).map(e=>this.valueChainer(e,t.clonedMrng.clone(),t.clonedMrng,t.originalBias)):C4.nil()).join(t.chainedArbitrary.shrink(e,t.chainedContext).map(e=>{let r=Fe(Fe({},t),{chainedContext:e.context,stoppedForOriginal:!0});return new C9(e.value_,r)})):C4.nil()}valueChainer(e,t,r,n){let i=this.chainer(e.value_),s=i.generate(t,n),a={originalBias:n,originalValue:e.value_,originalContext:e.context,stoppedForOriginal:!1,chainedArbitrary:i,chainedContext:s.context,clonedMrng:r};return new C9(s.value_,a)}isSafeContext(e){return null!=e&&"object"==typeof e&&"originalBias"in e&&"originalValue"in e&&"originalContext"in e&&"stoppedForOriginal"in e&&"chainedArbitrary"in e&&"chainedContext"in e&&"clonedMrng"in e}}class Fn extends Ft{constructor(e,t,r){super(),this.arb=e,this.mapper=t,this.unmapper=r,this.bindValueMapper=e=>this.valueMapper(e)}generate(e,t){let r=this.arb.generate(e,t);return this.valueMapper(r)}canShrinkWithoutContext(e){if(void 0!==this.unmapper)try{let t=this.unmapper(e);return this.arb.canShrinkWithoutContext(t)}catch(e){}return!1}shrink(e,t){if(this.isSafeContext(t))return this.arb.shrink(t.originalValue,t.originalContext).map(this.bindValueMapper);if(void 0!==this.unmapper){let t=this.unmapper(e);return this.arb.shrink(t,void 0).map(this.bindValueMapper)}return C4.nil()}mapperWithCloneIfNeeded(e){let t=e.value,r=this.mapper(t);return e.hasToBeCloned&&("object"==typeof r&&null!==r||"function"==typeof r)&&Object.isExtensible(r)&&!C8(r)&&Object.defineProperty(r,C6,{get:()=>()=>this.mapperWithCloneIfNeeded(e)[0]}),[r,t]}valueMapper(e){let[t,r]=this.mapperWithCloneIfNeeded(e);return new C9(t,{originalValue:r,originalContext:e.context})}isSafeContext(e){return null!=e&&"object"==typeof e&&"originalValue"in e&&"originalContext"in e}}class Fi extends Ft{constructor(e,t){super(),this.arb=e,this.refinement=t,this.bindRefinementOnValue=e=>this.refinementOnValue(e)}generate(e,t){for(;;){let r=this.arb.generate(e,t);if(this.refinementOnValue(r))return r}}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)&&this.refinement(e)}shrink(e,t){return this.arb.shrink(e,t).filter(this.bindRefinementOnValue)}refinementOnValue(e){return this.refinement(e.value)}}class Fs extends Ft{constructor(e){super(),this.arb=e}generate(e,t){return this.arb.generate(e,t)}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)}shrink(e,t){return C4.nil()}noShrink(){return this}}class Fa extends Ft{constructor(e){super(),this.arb=e}generate(e,t){return this.arb.generate(e,void 0)}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)}shrink(e,t){return this.arb.shrink(e,t)}noBias(){return this}}let Fo=Function.prototype.apply,Fl=Symbol("apply");function Fu(e,t,r){let n;return function(e){try{return e.apply}catch(e){return}}(e)===Fo?e.apply(t,r):(e[Fl]=Fo,n=e[Fl](t,r),delete e[Fl],n)}let Fc="undefined"!=typeof Array?Array:void 0;"undefined"!=typeof BigInt64Array&&BigInt64Array,"undefined"!=typeof BigUint64Array&&BigUint64Array;let Fh="undefined"!=typeof Error?Error:void 0;"undefined"!=typeof Float32Array&&Float32Array,"undefined"!=typeof Float64Array&&Float64Array,"undefined"!=typeof Int8Array&&Int8Array,"undefined"!=typeof Int16Array&&Int16Array,"undefined"!=typeof Int32Array&&Int32Array;let Ff="undefined"!=typeof String?String:void 0;"undefined"!=typeof Uint8Array&&Uint8Array,"undefined"!=typeof Uint8ClampedArray&&Uint8ClampedArray,"undefined"!=typeof Uint16Array&&Uint16Array,"undefined"!=typeof Uint32Array&&Uint32Array;let Fp="undefined"!=typeof encodeURIComponent?encodeURIComponent:void 0,Fd=Symbol;Array.prototype.forEach;let Fg=Array.prototype.indexOf,Fm=Array.prototype.join,Fb=Array.prototype.map,Fy=Array.prototype.filter,Fv=Array.prototype.push;function FS(e,...t){return function(e){try{return e.join}catch(e){return}}(e)===Fm?e.join(...t):Fu(Fm,e,t)}function Fx(e,t){return function(e){try{return e.map}catch(e){return}}(e)===Fb?e.map(t):Fu(Fb,e,[t])}Array.prototype.pop,Array.prototype.splice,Array.prototype.slice,Array.prototype.sort,Array.prototype.every;let F_=Date.prototype.getTime,Fw=Date.prototype.toISOString;Set.prototype.add,Set.prototype.has,WeakMap.prototype.set,WeakMap.prototype.get,Map.prototype.set,Map.prototype.get;let Fk=String.prototype.split;String.prototype.startsWith,String.prototype.endsWith,String.prototype.substring,String.prototype.toLowerCase,String.prototype.toUpperCase,String.prototype.padStart;let FO=String.prototype.charCodeAt;function FE(e,...t){return function(e){try{return e.split}catch(e){return}}(e)===Fk?e.split(...t):Fu(Fk,e,t)}function FC(e,t){return function(e){try{return e.charCodeAt}catch(e){return}}(e)===FO?e.charCodeAt(t):Fu(FO,e,[t])}String.prototype.normalize,String.prototype.replace;let FF=Number.prototype.toString;Object.prototype.hasOwnProperty;let FI=Object.prototype.toString,FT=Math.log;function FR(e){return 2+~~(.4342944819032518*FT(e+1))}let FN={},FM=Symbol("UndefinedContextPlaceholder");function FA(e){return void 0!==e.context?e:e.hasToBeCloned?new C9(e.value_,FM,()=>e.value):new C9(e.value_,FM)}class Fj{constructor(e,t){this.arb=e,this.predicate=t;const{asyncBeforeEach:r,asyncAfterEach:n,beforeEach:i,afterEach:s}=FN||{};if(void 0!==r&&void 0!==i)throw Fh('Global "asyncBeforeEach" and "beforeEach" parameters can\'t be set at the same time when running async properties');if(void 0!==n&&void 0!==s)throw Fh('Global "asyncAfterEach" and "afterEach" parameters can\'t be set at the same time when running async properties');this.beforeEachHook=r||i||Fj.dummyHook,this.afterEachHook=n||s||Fj.dummyHook}isAsync(){return!0}generate(e,t){return FA(this.arb.generate(e,null!=t?FR(t):void 0))}shrink(e){if(void 0===e.context&&!this.arb.canShrinkWithoutContext(e.value_))return C4.nil();let t=e.context!==FM?e.context:void 0;return this.arb.shrink(e.value_,t).map(FA)}async runBeforeEach(){await this.beforeEachHook()}async runAfterEach(){await this.afterEachHook()}async run(e,t){t||await this.beforeEachHook();try{let t=await this.predicate(e);return null==t||!0===t?null:{error:new Fh("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(e){if(C2.isFailure(e))return e;if(e instanceof Fh&&e.stack)return{error:e,errorMessage:e.stack};return{error:e,errorMessage:Ff(e)}}finally{t||await this.afterEachHook()}}beforeEach(e){let t=this.beforeEachHook;return this.beforeEachHook=()=>e(t),this}afterEach(e){let t=this.afterEachHook;return this.afterEachHook=()=>e(t),this}}Fj.dummyHook=()=>{};class FD{constructor(e,t){this.arb=e,this.predicate=t;const{beforeEach:r=FD.dummyHook,afterEach:n=FD.dummyHook,asyncBeforeEach:i,asyncAfterEach:s}=FN||{};if(void 0!==i)throw Fh('"asyncBeforeEach" can\'t be set when running synchronous properties');if(void 0!==s)throw Fh('"asyncAfterEach" can\'t be set when running synchronous properties');this.beforeEachHook=r,this.afterEachHook=n}isAsync(){return!1}generate(e,t){return FA(this.arb.generate(e,null!=t?FR(t):void 0))}shrink(e){if(void 0===e.context&&!this.arb.canShrinkWithoutContext(e.value_))return C4.nil();let t=e.context!==FM?e.context:void 0;return this.arb.shrink(e.value_,t).map(FA)}runBeforeEach(){this.beforeEachHook()}runAfterEach(){this.afterEachHook()}run(e,t){t||this.beforeEachHook();try{let t=this.predicate(e);return null==t||!0===t?null:{error:new Fh("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(e){if(C2.isFailure(e))return e;if(e instanceof Fh&&e.stack)return{error:e,errorMessage:e.stack};return{error:e,errorMessage:Ff(e)}}finally{t||this.afterEachHook()}}beforeEach(e){let t=this.beforeEachHook;return this.beforeEachHook=()=>e(t),this}afterEach(e){let t=this.afterEachHook;return this.afterEachHook=()=>e(t),this}}function FP(e,t){for(var r=[],n=0;n!=t;++n)r.push(e.unsafeNext());return r}function F$(e,t){var r=e.clone();return[FP(r,t),r]}function Fz(e,t){for(var r=0;r!=t;++r)e.unsafeNext()}function FL(e,t){var r=e.clone();return Fz(r,t),r}FD.dummyHook=()=>{};var FU=-0x80000000-1,FB=function(e){return 214013*e+2531011|0},Fq=function(e){return(e&FU)>>16},FJ=function(){function e(e){this.seed=e}return e.prototype.clone=function(){return new e(this.seed)},e.prototype.next=function(){var t=new e(this.seed);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=FB(this.seed),t=Fq(e),r=FB(e),n=Fq(r);return this.seed=FB(r),0|Fq(this.seed)+(n+(t<<15)<<15)},e.prototype.getState=function(){return[this.seed]},e}(),FH=Object.assign(function(e){return new FJ(e)},{fromState:function(e){if(1!==e.length)throw Error("The state must have been produced by a congruential32 RandomGenerator");return new FJ(e[0])}}),FW=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a},FK=function(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},FV=function(){function e(e,t){this.states=e,this.index=t}return e.twist=function(t){for(var r=t.slice(),n=0;n!==e.N-e.M;++n){var i=(r[n]&e.MASK_UPPER)+(r[n+1]&e.MASK_LOWER);r[n]=r[n+e.M]^i>>>1^-(1&i)&e.A}for(var n=e.N-e.M;n!==e.N-1;++n){var s=(r[n]&e.MASK_UPPER)+(r[n+1]&e.MASK_LOWER);r[n]=r[n+e.M-e.N]^s>>>1^-(1&s)&e.A}var a=(r[e.N-1]&e.MASK_UPPER)+(r[0]&e.MASK_LOWER);return r[e.N-1]=r[e.M-1]^a>>>1^-(1&a)&e.A,r},e.seeded=function(t){var r=Array(e.N);r[0]=t;for(var n=1;n!==e.N;++n){var i=r[n-1]^r[n-1]>>>30;r[n]=Math.imul(e.F,i)+n|0}return r},e.from=function(t){return new e(e.twist(e.seeded(t)),0)},e.prototype.clone=function(){return new e(this.states,this.index)},e.prototype.next=function(){var t=new e(this.states,this.index);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var t=this.states[this.index];return t^=this.states[this.index]>>>e.U,t^=t<<e.S&e.B,t^=t<<e.T&e.C,t^=t>>>e.L,++this.index>=e.N&&(this.states=e.twist(this.states),this.index=0),t},e.prototype.getState=function(){return FK([this.index],FW(this.states),!1)},e.fromState=function(t){if(!(t.length===e.N+1&&t[0]>=0&&t[0]<e.N))throw Error("The state must have been produced by a mersenne RandomGenerator");return new e(t.slice(1),t[0])},e.N=624,e.M=397,e.R=31,e.A=0x9908b0df,e.F=0x6c078965,e.U=11,e.S=7,e.B=0x9d2c5680,e.T=15,e.C=0xefc60000,e.L=18,e.MASK_LOWER=Math.pow(2,e.R)-1,e.MASK_UPPER=Math.pow(2,e.R),e}();let FG=Object.assign(function(e){return FV.from(e)},{fromState:function(e){return FV.fromState(e)}});var FZ=function(){function e(e,t,r,n){this.s01=e,this.s00=t,this.s11=r,this.s10=n}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=this.s00^this.s00<<23,t=this.s01^(this.s01<<23|this.s00>>>9),r=e^this.s10^(e>>>18|t<<14)^(this.s10>>>5|this.s11<<27),n=t^this.s11^t>>>18^this.s11>>>5,i=this.s00+this.s10|0;return this.s01=this.s11,this.s00=this.s10,this.s11=n,this.s10=r,i},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var e=0,t=0,r=0,n=0,i=[0x635d2dff,0x8a5cd789,0x5c472f96,0x121fd215],s=0;4!==s;++s)for(var a=1;a;a<<=1)i[s]&a&&(e^=this.s01,t^=this.s00,r^=this.s11,n^=this.s10),this.unsafeNext();this.s01=e,this.s00=t,this.s11=r,this.s10=n},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e}(),FQ=Object.assign(function(e){return new FZ(-1,~e,0|e,0)},{fromState:function(e){if(4!==e.length)throw Error("The state must have been produced by a xorshift128plus RandomGenerator");return new FZ(e[0],e[1],e[2],e[3])}}),FY=function(){function e(e,t,r,n){this.s01=e,this.s00=t,this.s11=r,this.s10=n}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=this.s00+this.s10|0,t=this.s10^this.s00,r=this.s11^this.s01,n=this.s00,i=this.s01;return this.s00=n<<24^i>>>8^t^t<<16,this.s01=i<<24^n>>>8^r^(r<<16|t>>>16),this.s10=r<<5^t>>>27,this.s11=t<<5^r>>>27,e},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var e=0,t=0,r=0,n=0,i=[0xd8f554a5,0xdf900294,0x4b3201fc,0x170865df],s=0;4!==s;++s)for(var a=1;a;a<<=1)i[s]&a&&(e^=this.s01,t^=this.s00,r^=this.s11,n^=this.s10),this.unsafeNext();this.s01=e,this.s00=t,this.s11=r,this.s10=n},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e}(),FX=Object.assign(function(e){return new FY(-1,~e,0|e,0)},{fromState:function(e){if(4!==e.length)throw Error("The state must have been produced by a xoroshiro128plus RandomGenerator");return new FY(e[0],e[1],e[2],e[3])}});function F0(e,t){if(e.sign!==t.sign)return F1(e,{sign:-t.sign,data:t.data});for(var r=[],n=0,i=e.data,s=t.data,a=i.length-1,o=s.length-1;a>=0||o>=0;--a,--o){var l=(a>=0?i[a]:0)+(o>=0?s[o]:0)+n;r.push(l>>>0),n=~~(l/0x100000000)}return 0!==n&&r.push(n),{sign:e.sign,data:r.reverse()}}function F1(e,t){if(e.sign!==t.sign)return F0(e,{sign:-t.sign,data:t.data});var r=e.data,n=t.data;if(function(e,t){for(var r=Math.max(e.length,t.length),n=0;n<r;++n){var i=n+e.length-r,s=n+t.length-r,a=i>=0?e[i]:0,o=s>=0?t[s]:0;if(a<o)return!0;if(a>o)break}return!1}(r,n)){var i=F1(t,e);return i.sign=-i.sign,i}for(var s=[],a=0,o=r.length-1,l=n.length-1;o>=0||l>=0;--o,--l){var u=(o>=0?r[o]:0)-(l>=0?n[l]:0)-a;s.push(u>>>0),a=+(u<0)}return{sign:e.sign,data:s.reverse()}}function F2(e){for(var t=e.data,r=0;r!==t.length&&0===t[r];++r);return r===t.length?(e.sign=1,e.data=[0]):t.splice(0,r),e}function F3(e,t){if(t<0){var r=-t;e.sign=-1,e.data[0]=~~(r/0x100000000),e.data[1]=r>>>0}else e.sign=1,e.data[0]=~~(t/0x100000000),e.data[1]=t>>>0;return e}function F5(e,t){for(var r=e>2?~~(0x100000000/e)*e:0x100000000,n=t.unsafeNext()+0x80000000;n>=r;)n=t.unsafeNext()+0x80000000;return n%e}function F4(e,t,r){for(var n=t.length;;){for(var i=0;i!==n;++i){var s=F5(0===i?t[0]+1:0x100000000,r);e[i]=s}for(var i=0;i!==n;++i){var a=e[i],o=t[i];if(a<o)return e;if(a>o)break}}}function F6(e,t,r){var n=F2(function(e){e.sign=1;for(var t=e.data,r=t.length-1;r>=0;--r)if(0xffffffff!==t[r])return t[r]+=1,e;else t[r]=0;return t.unshift(1),e}(F1(t,e)));return F2(F0({sign:1,data:F4(n.data.slice(0),n.data,r)},e))}function F8(e,t,r){if(null!=r){var n=r.clone();return[F6(e,t,n),n]}return function(r){var n=r.clone();return[F6(e,t,n),n]}}var F7="undefined"!=typeof BigInt?BigInt:void 0;function F9(e,t,r){for(var n=t-e+F7(1),i=F7(-0x80000000),s=F7(0x100000000),a=s,o=1;a<n;)a*=s,++o;for(var l=a-a%n;;){for(var u=F7(0),c=0;c!==o;++c)u=s*u+(F7(r.unsafeNext())-i);if(u<l)return u%n+e}}function Ie(e,t,r){if(null!=r){var n=r.clone();return[F9(e,t,n),n]}return function(r){var n=r.clone();return[F9(e,t,n),n]}}var It=Number.MAX_SAFE_INTEGER,Ir={sign:1,data:[0,0]},In={sign:1,data:[0,0]},Ii={sign:1,data:[0,0]},Is=[0,0];function Ia(e,t,r){var n,i=t-e;return i<=0xffffffff?F5(i+1,r)+e:(0xffffffff===(n=i<=It?F3(Ii,i):function(e,t,r){var n=t.data[1],i=t.data[0],s=t.sign,a=r.data[1],o=r.data[0],l=r.sign;if(e.sign=1,1===s&&-1===l){var u=n+a;return e.data[0]=i+o+ +(u>0xffffffff)>>>0,e.data[1]=u>>>0,e}var c=n,h=i,f=a,p=o;-1===s&&(c=a,h=o,f=n,p=i);var d=0,g=c-f;return g<0&&(d=1,g>>>=0),e.data[0]=h-p-d,e.data[1]=g,e}(Ii,F3(Ir,t),F3(In,e))).data[1]?(n.data[0]+=1,n.data[1]=0):n.data[1]+=1,F4(Is,n.data,r),0x100000000*Is[0]+Is[1]+e)}function Io(e,t,r){if(null!=r){var n=r.clone();return[Ia(e,t,n),n]}return function(r){var n=r.clone();return[Ia(e,t,n),n]}}var Il="module",Iu="6.1.0",Ic="a413dd2b721516be2ef29adffb515c5ae67bfbad";e.s(["__commitHash",()=>Ic,"__type",()=>Il,"__version",()=>Iu],77080),e.i(77080),e.s(["__commitHash",()=>Ic,"__type",()=>Il,"__version",()=>Iu,"congruential32",()=>FH,"generateN",()=>F$,"mersenne",0,FG,"skipN",()=>FL,"uniformArrayIntDistribution",()=>F8,"uniformBigIntDistribution",()=>Ie,"uniformIntDistribution",()=>Io,"unsafeGenerateN",()=>FP,"unsafeSkipN",()=>Fz,"unsafeUniformArrayIntDistribution",()=>F6,"unsafeUniformBigIntDistribution",()=>F9,"unsafeUniformIntDistribution",()=>Ia,"xoroshiro128plus",()=>FX,"xorshift128plus",()=>FQ],16169);var Ih=e.i(16169);(el=ev||(ev={}))[el.None=0]="None",el[el.Verbose=1]="Verbose",el[el.VeryVerbose=2]="VeryVerbose";let If=Date.now,Ip=Math.min,Id=Math.random;class Ig{constructor(e){const t=e||{};this.seed=Ig.readSeed(t),this.randomType=Ig.readRandomType(t),this.numRuns=Ig.readNumRuns(t),this.verbose=Ig.readVerbose(t),this.maxSkipsPerRun=Ig.readOrDefault(t,"maxSkipsPerRun",100),this.timeout=Ig.safeTimeout(Ig.readOrDefault(t,"timeout",null)),this.skipAllAfterTimeLimit=Ig.safeTimeout(Ig.readOrDefault(t,"skipAllAfterTimeLimit",null)),this.interruptAfterTimeLimit=Ig.safeTimeout(Ig.readOrDefault(t,"interruptAfterTimeLimit",null)),this.markInterruptAsFailure=Ig.readBoolean(t,"markInterruptAsFailure"),this.skipEqualValues=Ig.readBoolean(t,"skipEqualValues"),this.ignoreEqualValues=Ig.readBoolean(t,"ignoreEqualValues"),this.logger=Ig.readOrDefault(t,"logger",e=>{console.log(e)}),this.path=Ig.readOrDefault(t,"path",""),this.unbiased=Ig.readBoolean(t,"unbiased"),this.examples=Ig.readOrDefault(t,"examples",[]),this.endOnFailure=Ig.readBoolean(t,"endOnFailure"),this.reporter=Ig.readOrDefault(t,"reporter",null),this.asyncReporter=Ig.readOrDefault(t,"asyncReporter",null),this.errorWithCause=Ig.readBoolean(t,"errorWithCause")}toParameters(){let e=e=>null!==e?e:void 0;return{seed:this.seed,randomType:this.randomType,numRuns:this.numRuns,maxSkipsPerRun:this.maxSkipsPerRun,timeout:e(this.timeout),skipAllAfterTimeLimit:e(this.skipAllAfterTimeLimit),interruptAfterTimeLimit:e(this.interruptAfterTimeLimit),markInterruptAsFailure:this.markInterruptAsFailure,skipEqualValues:this.skipEqualValues,ignoreEqualValues:this.ignoreEqualValues,path:this.path,logger:this.logger,unbiased:this.unbiased,verbose:this.verbose,examples:this.examples,endOnFailure:this.endOnFailure,reporter:e(this.reporter),asyncReporter:e(this.asyncReporter),errorWithCause:this.errorWithCause}}static read(e){return new Ig(e)}}Ig.createQualifiedRandomGenerator=e=>t=>{let r=e(t);return void 0===r.unsafeJump&&(r.unsafeJump=()=>Fz(r,42)),r},Ig.readSeed=e=>{if(null==e.seed)return If()^0x100000000*Id();let t=0|e.seed;if(e.seed===t)return t;let r=e.seed-t;return t^0x100000000*r},Ig.readRandomType=e=>{if(null==e.randomType)return Ih.xorshift128plus;if("string"==typeof e.randomType)switch(e.randomType){case"mersenne":return Ig.createQualifiedRandomGenerator(Ih.mersenne);case"congruential":case"congruential32":return Ig.createQualifiedRandomGenerator(Ih.congruential32);case"xorshift128plus":return Ih.xorshift128plus;case"xoroshiro128plus":return Ih.xoroshiro128plus;default:throw Error(`Invalid random specified: '${e.randomType}'`)}let t=e.randomType(0);if("min"in t&&-0x80000000!==t.min)throw Error(`Invalid random number generator: min must equal -0x80000000, got ${String(t.min)}`);if("max"in t&&0x7fffffff!==t.max)throw Error(`Invalid random number generator: max must equal 0x7fffffff, got ${String(t.max)}`);return"unsafeJump"in t?e.randomType:Ig.createQualifiedRandomGenerator(e.randomType)},Ig.readNumRuns=e=>null!=e.numRuns?e.numRuns:null!=e.num_runs?e.num_runs:100,Ig.readVerbose=e=>null==e.verbose?ev.None:"boolean"==typeof e.verbose?!0===e.verbose?ev.Verbose:ev.None:e.verbose<=ev.None?ev.None:e.verbose>=ev.VeryVerbose?ev.VeryVerbose:0|e.verbose,Ig.readBoolean=(e,t)=>!0===e[t],Ig.readOrDefault=(e,t,r)=>{let n=e[t];return null!=n?n:r},Ig.safeTimeout=e=>null===e?null:Ip(e,0x7fffffff);let Im=Array.from,Ib="undefined"!=typeof Buffer?Buffer.isBuffer:void 0,Iy=JSON.stringify,Iv=Number.isNaN,IS=Object.keys,Ix=Object.getOwnPropertySymbols,I_=Object.getOwnPropertyDescriptor,Iw=Object.getPrototypeOf,Ik=-1/0,IO=1/0,IE=Symbol.for("fast-check/toStringMethod"),IC=Symbol.for("fast-check/asyncToStringMethod"),IF=/^Symbol\((.*)\)$/;function II(e){switch(e){case 0:return 1/e===Ik?"-0":"0";case Ik:return"Number.NEGATIVE_INFINITY";case IO:return"Number.POSITIVE_INFINITY";default:return e==e?Ff(e):"Number.NaN"}}function IT(e){return function e(t,r,n){var i,s;let a=[...r,t];if("object"==typeof t&&-1!==function(e,...t){return function(e){try{return e.indexOf}catch(e){return}}(e)===Fg?e.indexOf(...t):Fu(Fg,e,t)}(r,t))return"[cyclic]";if(null!==t&&("object"==typeof t||"function"==typeof t)&&IC in t&&"function"==typeof t[IC]){let e=n(t);if("fulfilled"===e.state)return e.value}if(null!==t&&("object"==typeof t||"function"==typeof t)&&IE in t&&"function"==typeof t[IE])try{return t[IE]()}catch(e){}switch(Fu(FI,t,[])){case"[object Array]":{if(t.length>=50&&function(e){let t=-1;for(let r in e){let e=Number(r);if(e!==t+1)return!0;t=e}return t+1!==e.length}(t)){let r=[];for(let i in t)Iv(Number(i))||function(e,...t){(function(e){try{return e.push}catch(e){return}})(e)===Fv?e.push(...t):Fu(Fv,e,t)}(r,`${i}:${e(t[i],a,n)}`);return 0!==r.length?`Object.assign(Array(${t.length}),{${FS(r,",")}})`:`Array(${t.length})`}let r=FS(Fx(t,t=>e(t,a,n)),",");return 0===t.length||t.length-1 in t?`[${r}]`:`[${r},]`}case"[object BigInt]":return`${t}n`;case"[object Boolean]":{let e=!0==t?"true":"false";return"boolean"==typeof t?e:`new Boolean(${e})`}case"[object Date]":return Iv(function(e){try{return e.getTime}catch(e){return}}(t)===F_?t.getTime():Fu(F_,t,[]))?"new Date(NaN)":`new Date(${Iy(function(e){try{return e.toISOString}catch(e){return}}(t)===Fw?t.toISOString():Fu(Fw,t,[]))})`;case"[object Map]":return`new Map(${e(Array.from(t),a,n)})`;case"[object Null]":return"null";case"[object Number]":return"number"==typeof t?II(t):`new Number(${II(Number(t))})`;case"[object Object]":{try{let e=t.toString;if("function"==typeof e&&e!==Object.prototype.toString)return t.toString()}catch(e){return"[object Object]"}let r=r=>`${"__proto__"===r?'["__proto__"]':"symbol"==typeof r?`[${e(r,a,n)}]`:Iy(r)}:${e(t[r],a,n)}`,o="{"+FS([...Fx(IS(t),r),...Fx((i=Ix(t),s=e=>{let r=I_(t,e);return r&&r.enumerable},function(e){try{return e.filter}catch(e){return}}(i)===Fy?i.filter(s):Fu(Fy,i,[s])),r)],",")+"}";if(null===Iw(t))return"{}"===o?"Object.create(null)":`Object.assign(Object.create(null),${o})`;return o}case"[object Set]":return`new Set(${e(Array.from(t),a,n)})`;case"[object String]":return"string"==typeof t?Iy(t):`new String(${Iy(t)})`;case"[object Symbol]":{if(void 0!==Fd.keyFor(t))return`Symbol.for(${Iy(Fd.keyFor(t))})`;let e=function(e){if(void 0!==e.description)return e.description;let t=IF.exec(Ff(e));return t&&t[1].length?t[1]:null}(t);if(null===e)return"Symbol()";return t===(e.startsWith("Symbol.")&&Fd[e.substring(7)])?e:`Symbol(${Iy(e)})`}case"[object Promise]":{let r=n(t);switch(r.state){case"fulfilled":return`Promise.resolve(${e(r.value,a,n)})`;case"rejected":return`Promise.reject(${e(r.value,a,n)})`;case"pending":return"new Promise(() => {/*pending*/})";default:return"new Promise(() => {/*unknown*/})"}}case"[object Error]":if(t instanceof Error)return`new Error(${e(t.message,a,n)})`;break;case"[object Undefined]":return"undefined";case"[object Int8Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Int16Array]":case"[object Uint16Array]":case"[object Int32Array]":case"[object Uint32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object BigInt64Array]":case"[object BigUint64Array]":{if("function"==typeof Ib&&Ib(t))return`Buffer.from(${e(Im(t.values()),a,n)})`;let r=Iw(t),i=r&&r.constructor&&r.constructor.name;if("string"==typeof i){let r=t.values();return`${i}.from(${e(Im(r),a,n)})`}}}try{return t.toString()}catch(e){return Fu(FI,t,[])}}(e,[],()=>({state:"unknown",value:void 0}))}(eu=eS||(eS={}))[eu.Success=0]="Success",eu[eu.Skipped=-1]="Skipped",eu[eu.Failure=1]="Failure";class IR{constructor(e,t){this.verbosity=e,this.interruptedAsFailure=t,this.isSuccess=()=>null==this.pathToFailure,this.firstFailure=()=>this.pathToFailure?+FE(this.pathToFailure,":")[0]:-1,this.numShrinks=()=>this.pathToFailure?FE(this.pathToFailure,":").length-1:0,this.rootExecutionTrees=[],this.currentLevelExecutionTrees=this.rootExecutionTrees,this.failure=null,this.numSkips=0,this.numSuccesses=0,this.interrupted=!1}appendExecutionTree(e,t){let r={status:e,value:t,children:[]};return this.currentLevelExecutionTrees.push(r),r}fail(e,t,r){if(this.verbosity>=ev.Verbose){let t=this.appendExecutionTree(eS.Failure,e);this.currentLevelExecutionTrees=t.children}null==this.pathToFailure?this.pathToFailure=`${t}`:this.pathToFailure+=`:${t}`,this.value=e,this.failure=r}skip(e){this.verbosity>=ev.VeryVerbose&&this.appendExecutionTree(eS.Skipped,e),null==this.pathToFailure&&++this.numSkips}success(e){this.verbosity>=ev.VeryVerbose&&this.appendExecutionTree(eS.Success,e),null==this.pathToFailure&&++this.numSuccesses}interrupt(){this.interrupted=!0}extractFailures(){if(this.isSuccess())return[];let e=[],t=this.rootExecutionTrees;for(;t.length>0&&t[t.length-1].status===eS.Failure;){let r=t[t.length-1];e.push(r.value),t=r.children}return e}toRunDetails(e,t,r,n){if(!this.isSuccess())return{failed:!0,interrupted:this.interrupted,numRuns:this.firstFailure()+1-this.numSkips,numSkips:this.numSkips,numShrinks:this.numShrinks(),seed:e,counterexample:this.value,counterexamplePath:IR.mergePaths(t,this.pathToFailure),error:this.failure.errorMessage,errorInstance:this.failure.error,failures:this.extractFailures(),executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:n.toParameters()};let i=this.interruptedAsFailure||0===this.numSuccesses;return{failed:this.numSkips>r||this.interrupted&&i,interrupted:this.interrupted,numRuns:this.numSuccesses,numSkips:this.numSkips,numShrinks:0,seed:e,counterexample:null,counterexamplePath:null,error:null,errorInstance:null,failures:[],executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:n.toParameters()}}}IR.mergePaths=(e,t)=>{if(0===e.length)return t;let r=e.split(":"),n=t.split(":"),i=+r[r.length-1]+ +n[0];return[...r.slice(0,r.length-1),`${i}`,...n.slice(1)].join(":")};class IN{constructor(e){this.internalRng=e.clone()}clone(){return new IN(this.internalRng)}next(e){return Ia(0,(1<<e)-1,this.internalRng)}nextBoolean(){return 1==Ia(0,1,this.internalRng)}nextInt(e,t){return Ia(null==e?IN.MIN_INT:e,null==t?IN.MAX_INT:t,this.internalRng)}nextBigInt(e,t){return F9(e,t,this.internalRng)}nextArrayInt(e,t){return F6(e,t,this.internalRng)}nextDouble(){let e=this.next(26),t=this.next(27);return(e*IN.DBL_FACTOR+t)*IN.DBL_DIVISOR}getState(){if("getState"in this.internalRng&&"function"==typeof this.internalRng.getState)return this.internalRng.getState()}}IN.MIN_INT=-0x80000000,IN.MAX_INT=0x7fffffff,IN.DBL_FACTOR=0x8000000,IN.DBL_DIVISOR=11102230246251565e-32;let IM=Math.floor,IA=Math.log;function Ij(e){return IM(IA(e)/IA(2))}let ID=Math.ceil,IP=Math.floor;function I$(e,t,r){let n=e-t;return new C4(n>0?function*(){let i=r?void 0:t,s=r?n:IP(n/2);for(let r=s;r>0;r=IP(r/2)){let s=r===n?t:e-r;yield new C9(s,i),i=s}}():function*(){let i=r?void 0:t,s=r?n:ID(n/2);for(let r=s;r<0;r=ID(r/2)){let s=r===n?t:e-r;yield new C9(s,i),i=s}}())}let Iz=Math.sign,IL=Number.isInteger,IU=Object.is;class IB extends Ft{constructor(e,t){super(),this.min=e,this.max=t}generate(e,t){let r=this.computeGenerateRange(e,t);return new C9(e.nextInt(r.min,r.max),void 0)}canShrinkWithoutContext(e){return"number"==typeof e&&IL(e)&&!IU(e,-0)&&this.min<=e&&e<=this.max}shrink(e,t){return IB.isValidContext(e,t)?this.isLastChanceTry(e,t)?C4.of(new C9(t,void 0)):I$(e,t,!1):I$(e,this.defaultTarget(),!0)}defaultTarget(){return this.min<=0&&this.max>=0?0:this.min<0?this.max:this.min}computeGenerateRange(e,t){if(void 0===t||1!==e.nextInt(1,t))return{min:this.min,max:this.max};let r=function(e,t,r){if(e===t)return[{min:e,max:t}];if(e<0&&t>0){let n=r(-e),i=r(t);return[{min:-n,max:i},{min:t-i,max:t},{min:e,max:e+n}]}let n=r(t-e),i={min:e,max:e+n},s={min:t-n,max:t};return e<0?[s,i]:[i,s]}(this.min,this.max,Ij);if(1===r.length)return r[0];let n=e.nextInt(-2*(r.length-1),r.length-2);return n<0?r[0]:r[n+1]}isLastChanceTry(e,t){return e>0?e===t+1&&e>this.min:e<0&&e===t-1&&e<this.max}static isValidContext(e,t){if(void 0===t)return!1;if("number"!=typeof t)throw Error("Invalid context type passed to IntegerArbitrary (#1)");if(0!==t&&Iz(e)!==Iz(t))throw Error("Invalid context value passed to IntegerArbitrary (#2)");return!0}}let Iq=Number.isInteger,IJ=String.fromCodePoint;function IH(e,t,r,n){return(function(e={}){let t={min:void 0!==e.min?e.min:-0x80000000,max:void 0!==e.max?e.max:0x7fffffff};if(t.min>t.max)throw Error("fc.integer maximum value should be equal or greater than the minimum one");if(!Iq(t.min))throw Error("fc.integer minimum value should be an integer");if(!Iq(t.max))throw Error("fc.integer maximum value should be an integer");return new IB(t.min,t.max)})({min:e,max:t}).map(e=>IJ(r(e)),e=>n(function(e){if("string"!=typeof e)throw Error("Cannot unmap non-string");if(0===e.length||e.length>2)throw Error("Cannot unmap string with more or less than one character");let t=FC(e,0);if(1===e.length)return t;let r=FC(e,1);if(t<55296||t>56319||r<56320||r>57343)throw Error("Cannot unmap invalid surrogate pairs");return e.codePointAt(0)}(e)))}function IW(e){return e}class IK{constructor(){this.receivedLogs=[]}log(e){this.receivedLogs.push(e)}size(){return this.receivedLogs.length}toString(){return JSON.stringify({logs:this.receivedLogs})}[C6](){return new IK}}IH(0,1112063,function(e){if(e<55296)return e<95?e+32:e<=126?e-95:e;return e+2048},function(e){if(e<55296)return e>=32&&e<=126?e-32:e>=0&&e<=31?e+95:e;return e<=57343?-1:e-2048}).map(function(e){let t=Fp(e);return e!==t?t:`%${function(e,...t){return function(e){try{return e.toString}catch(e){return}}(e)===FF?e.toString(...t):Fu(FF,e,t)}(FC(e,0),16)}`},function(e){if("string"!=typeof e)throw Error("Unsupported");return decodeURIComponent(e)}),new WeakMap,Object.create(null),Symbol("adapted-value");let IV=new Float64Array(1);new Uint32Array(IV.buffer,IV.byteOffset);let IG=new Float32Array(1);new Uint32Array(IG.buffer,IG.byteOffset),Fc.isArray,Symbol("no-key");let IZ={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F",16:"G",17:"H",18:"J",19:"K",20:"M",21:"N",22:"P",23:"Q",24:"R",25:"S",26:"T",27:"V",28:"W",29:"X",30:"Y",31:"Z"};function IQ(e,t){let r="";for(;e.length+r.length<t;)r+="0";return r+e}function IY(e){let t="";for(let n=e;0!==n;){var r;let e=n>>5;t=((r=n-(e<<5))<10?Ff(r):IZ[r])+t,n=e}return t}function IX(e){return function(t){return IQ(IY(~~(t/0x40000000)),e-6)+IQ(IY(0x3fffffff&t),6)}}IX(10),IX(8);class I0{constructor(e,t){this.commands=e,this.metadataForReplay=t}[Symbol.iterator](){return this.commands[Symbol.iterator]()}[C6](){return new I0(this.commands.map(e=>e.clone()),this.metadataForReplay)}toString(){let e=this.commands.filter(e=>e.hasRan).map(e=>e.toString()).join(","),t=this.metadataForReplay();return 0!==t.length?`${e} /*${t}*/`:e}}let I1=e=>e();class I2{constructor(e,t){this.act=e,this.taskSelector=t,this.lastTaskId=0,this.sourceTaskSelector=t.clone(),this.scheduledTasks=[],this.triggeredTasks=[],this.scheduledWatchers=[]}static buildLog(e){return`[task\${${e.taskId}}] ${0!==e.label.length?`${e.schedulingType}::${e.label}`:e.schedulingType} ${e.status}${void 0!==e.outputValue?` with value ${e.outputValue.replace(/([$`\\])/g,"\\$1").replace(/\r/g,"\\r")}`:""}`}log(e,t,r,n,i,s){this.triggeredTasks.push({status:i,schedulingType:e,taskId:t,label:r,metadata:n,outputValue:void 0!==s?IT(s):void 0})}scheduleInternal(e,t,r,n,i,s){let a=null,o=++this.lastTaskId,l=new Promise((i,l)=>{a=()=>{(s?r.then(()=>s()):r).then(r=>(this.log(e,o,t,n,"resolved",r),i(r)),r=>(this.log(e,o,t,n,"rejected",r),l(r)))}});return this.scheduledTasks.push({original:r,scheduled:l,trigger:a,schedulingType:e,taskId:o,label:t,metadata:n,customAct:i}),0!==this.scheduledWatchers.length&&this.scheduledWatchers[0](),l}schedule(e,t,r,n){return this.scheduleInternal("promise",t||"",e,r,n||I1)}scheduleFunction(e,t){return(...r)=>this.scheduleInternal("function",`${e.name}(${r.map(IT).join(",")})`,e(...r),void 0,t||I1)}scheduleSequence(e,t){let r={done:!1,faulty:!1},n={then:e=>e()},i=()=>{},s=new Promise(e=>i=e);return e.reduce((e,s)=>{let[a,o,l]="function"==typeof s?[s,s.name,void 0]:[s.builder,s.label,s.metadata];return e.then(()=>{let e=this.scheduleInternal("sequence",o,n,l,t||I1,()=>a());return e.catch(()=>{r.faulty=!0,i()}),e})},n).then(()=>{r.done=!0,i()},()=>{}),Object.assign(r,{task:Promise.resolve(s).then(()=>({done:r.done,faulty:r.faulty}))})}count(){return this.scheduledTasks.length}internalWaitOne(){if(0===this.scheduledTasks.length)throw Error("No task scheduled");let e=this.taskSelector.nextTaskIndex(this.scheduledTasks),[t]=this.scheduledTasks.splice(e,1);return t.customAct(async()=>{t.trigger();try{await t.scheduled}catch(e){}})}async waitOne(e){let t=e||I1;await this.act(()=>t(async()=>await this.internalWaitOne()))}async waitAll(e){for(;this.scheduledTasks.length>0;)await this.waitOne(e)}async waitFor(e,t){let r=!1,n=null,i=async()=>{for(;!r&&this.scheduledTasks.length>0;)await this.waitOne(t);n=null},s=()=>{null===n&&(n=Promise.resolve().then(i))},a=()=>{let e=this.scheduledWatchers.indexOf(s);-1!==e&&this.scheduledWatchers.splice(e,1),0===e&&0!==this.scheduledWatchers.length&&this.scheduledWatchers[0]()},o=e.then(e=>(r=!0,null===n)?(a(),e):n.then(()=>(a(),e)),e=>{if(r=!0,null===n)throw a(),e;return n.then(()=>{throw a(),e})});return this.scheduledTasks.length>0&&0===this.scheduledWatchers.length&&s(),this.scheduledWatchers.push(s),o}report(){return[...this.triggeredTasks,...this.scheduledTasks.map(e=>({status:"pending",schedulingType:e.schedulingType,taskId:e.taskId,label:e.label,metadata:e.metadata}))]}toString(){return"schedulerFor()`\n"+this.report().map(I2.buildLog).map(e=>`-> ${e}`).join("\n")+"`"}[C6](){return new I2(this.act,this.sourceTaskSelector)}}(ec=ex||(ex={}))[ec.Full=0]="Full",ec[ec.Character=1]="Character",[..."abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_"],[..."0123456789"],[..." 	\r\n\v\f"],[..."\r\n",..."\x1e\x15"],IH(32,126,IW,IW),e.s(["__commitHash",()=>"a4a600eaa08c833707067a877db144289a724b91","__type",()=>"module","__version",()=>"3.23.2"],35300),e.i(35300);let I3=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return I3(e,t.from)}},I5=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),I4=e=>{let t,r=!1;return()=>(r||(t=e(),r=!0),t)},I6=e=>{try{return e.toISOString()}catch{return String(e)}},I8=(e,t=!0)=>{if(Array.isArray(e))return`[${e.map(e=>I8(e,t)).join(",")}]`;if(iL(e))return I6(e);if(iD(e,"toString")&&"function"==typeof e.toString&&e.toString!==Object.prototype.toString)return e.toString();if(iO(e))return JSON.stringify(e);if(iE(e)||null==e||iC(e)||iI(e))return String(e);if(iF(e))return String(e)+"n";if(iD(e,Symbol.iterator))return`${e.constructor.name}(${I8(Array.from(e),t)})`;try{t&&JSON.stringify(e);let r=`{${I5(e).map(t=>`${iO(t)?JSON.stringify(t):String(t)}:${I8(e[t],!1)}`).join(",")}}`,n=e.constructor.name;return e.constructor!==Object.prototype.constructor?`${n}(${r})`:r}catch{return"<circular structure>"}},I7=e=>"string"==typeof e?JSON.stringify(e):String(e),I9=e=>`[${I7(e)}]`,Te=e=>Array.isArray(e)?e.map(I9).join(""):I9(e),Tt=(e,t,r,n)=>{let i=e;return r&&aW(r)&&(i+=`
at path: ${Te(r)}`),void 0!==t&&(i+=`
details: ${t}`),n&&(i+=`
schema (${n._tag}): ${n}`),i},Tr=(e,t,r)=>Tt("Unsupported schema or overlapping types",`cannot extend ${e} with ${t}`,r),Tn=e=>Tt("Unsupported schema",void 0,void 0,e),Ti=e=>Tt("Duplicate index signature",`${e} index signature`),Ts=Tt("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),Ta=Tt("Invalid element","A required element cannot follow an optional element. ts(1257)"),To=e=>Tt("Duplicate property signature transformation",`Duplicate key ${I8(e)}`),Tl=e=>Tt("Duplicate property signature",`Duplicate key ${I8(e)}`),Tu=Symbol.for("effect/SchemaId/DateFromSelf"),Tc=Symbol.for("effect/SchemaId/GreaterThan"),Th=Symbol.for("effect/SchemaId/GreaterThanOrEqualTo"),Tf=Symbol.for("effect/SchemaId/LessThan"),Tp=Symbol.for("effect/SchemaId/LessThanOrEqualTo"),Td=Symbol.for("effect/SchemaId/Int"),Tg=Symbol.for("effect/SchemaId/NonNaN"),Tm=Symbol.for("effect/SchemaId/Finite"),Tb=Symbol.for("effect/SchemaId/JsonNumber"),Ty=Symbol.for("effect/SchemaId/Between"),Tv=Symbol.for("effect/SchemaId/GreaterThanOrEqualToBigint"),TS=Symbol.for("effect/SchemaId/BetweenBigint"),Tx=Symbol.for("effect/SchemaId/MinLength"),T_=Symbol.for("effect/SchemaId/Length"),Tw=Symbol.for("effect/annotation/Brand"),Tk=Symbol.for("effect/annotation/SchemaId"),TO=Symbol.for("effect/annotation/Message"),TE=Symbol.for("effect/annotation/MissingMessage"),TC=Symbol.for("effect/annotation/Identifier"),TF=Symbol.for("effect/annotation/Title"),TI=Symbol.for("effect/annotation/AutoTitle"),TT=Symbol.for("effect/annotation/Description"),TR=Symbol.for("effect/annotation/Examples"),TN=Symbol.for("effect/annotation/Default"),TM=Symbol.for("effect/annotation/JSONSchema"),TA=Symbol.for("effect/annotation/Arbitrary"),Tj=Symbol.for("effect/annotation/Pretty"),TD=Symbol.for("effect/annotation/Equivalence"),TP=Symbol.for("effect/annotation/Documentation"),T$=Symbol.for("effect/annotation/Concurrency"),Tz=Symbol.for("effect/annotation/Batching"),TL=Symbol.for("effect/annotation/ParseIssueTitle"),TU=Symbol.for("effect/annotation/ParseOptions"),TB=Symbol.for("effect/annotation/DecodingFallback"),Tq=Symbol.for("effect/annotation/Surrogate"),TJ=Symbol.for("effect/annotation/StableFilter"),TH=ic(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?sV(e.annotations[t]):ah()),TW=TH(Tw),TK=TH(TO),TV=TH(TE),TG=TH(TF),TZ=TH(TI),TQ=TH(TC),TY=TH(TT),TX=TH(T$),T0=TH(Tz),T1=TH(TL),T2=TH(TU),T3=TH(TB),T5=TH(Tq),T4=TH(TJ),T6=e=>aC(T4(e),e=>!0===e),T8=Symbol.for("effect/annotation/JSONIdentifier"),T7=TH(T8),T9=Symbol.for("effect/schema/ParseJson");class Re{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(e,t,r,n={}){this.typeParameters=e,this.decodeUnknown=t,this.encodeUnknown=r,this.annotations=n}toString(){return ap(Nb(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(e=>e.toJSON()),annotations:Nl(this.annotations)}}}let Rt=e=>t=>t._tag===e;class Rr{literal;annotations;_tag="Literal";constructor(e,t={}){this.literal=e,this.annotations=t}toString(){return ap(Nb(this),()=>I8(this.literal))}toJSON(){return{_tag:this._tag,literal:iF(this.literal)?String(this.literal):this.literal,annotations:Nl(this.annotations)}}}let Rn=Rt("Literal"),Ri=new Rr(null);class Rs{symbol;annotations;_tag="UniqueSymbol";constructor(e,t={}){this.symbol=e,this.annotations=t}toString(){return ap(Nb(this),()=>I8(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:Nl(this.annotations)}}}let Ra=Rt("UniqueSymbol"),Ro=new class{annotations;_tag="UndefinedKeyword";constructor(e={}){this.annotations=e}toString(){return Ng(this)}toJSON(){return{_tag:this._tag,annotations:Nl(this.annotations)}}}({[TF]:"undefined"}),Rl=new class{annotations;_tag="NeverKeyword";constructor(e={}){this.annotations=e}toString(){return Ng(this)}toJSON(){return{_tag:this._tag,annotations:Nl(this.annotations)}}}({[TF]:"never"}),Ru=Rt("NeverKeyword"),Rc=new class{annotations;_tag="UnknownKeyword";constructor(e={}){this.annotations=e}toString(){return Ng(this)}toJSON(){return{_tag:this._tag,annotations:Nl(this.annotations)}}}({[TF]:"unknown"}),Rh=new class{annotations;_tag="AnyKeyword";constructor(e={}){this.annotations=e}toString(){return Ng(this)}toJSON(){return{_tag:this._tag,annotations:Nl(this.annotations)}}}({[TF]:"any"}),Rf=new class{annotations;_tag="StringKeyword";constructor(e={}){this.annotations=e}toString(){return Ng(this)}toJSON(){return{_tag:this._tag,annotations:Nl(this.annotations)}}}({[TF]:"string",[TT]:"a string"}),Rp=Rt("StringKeyword"),Rd=new class{annotations;_tag="NumberKeyword";constructor(e={}){this.annotations=e}toString(){return Ng(this)}toJSON(){return{_tag:this._tag,annotations:Nl(this.annotations)}}}({[TF]:"number",[TT]:"a number"}),Rg=Rt("NumberKeyword"),Rm=new class{annotations;_tag="BooleanKeyword";constructor(e={}){this.annotations=e}toString(){return Ng(this)}toJSON(){return{_tag:this._tag,annotations:Nl(this.annotations)}}}({[TF]:"boolean",[TT]:"a boolean"}),Rb=Rt("BooleanKeyword"),Ry=new class{annotations;_tag="BigIntKeyword";constructor(e={}){this.annotations=e}toString(){return Ng(this)}toJSON(){return{_tag:this._tag,annotations:Nl(this.annotations)}}}({[TF]:"bigint",[TT]:"a bigint"}),Rv=new class{annotations;_tag="SymbolKeyword";constructor(e={}){this.annotations=e}toString(){return Ng(this)}toJSON(){return{_tag:this._tag,annotations:Nl(this.annotations)}}}({[TF]:"symbol",[TT]:"a symbol"}),RS=Rt("SymbolKeyword"),Rx=Rt("Enums"),R_=e=>{switch(e._tag){case"Literal":case"NumberKeyword":case"StringKeyword":case"TemplateLiteral":return!0;case"Union":return e.types.every(R_)}return!1},Rw=e=>{switch(e._tag){case"Literal":return JSON.stringify(String(e.literal));case"StringKeyword":return"string";case"NumberKeyword":return"number";case"TemplateLiteral":return String(e);case"Union":return e.types.map(Rw).join(" | ")}},Rk=Rt("TemplateLiteral");class RO{type;annotations;constructor(e,t={}){this.type=e,this.annotations=t}toJSON(){return{type:this.type.toJSON(),annotations:Nl(this.annotations)}}toString(){return String(this.type)}}class RE extends RO{isOptional;constructor(e,t,r={}){super(e,r),this.isOptional=t}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:Nl(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}let RC=e=>e.map(e=>e.type);class RF{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(e,t,r,n={}){this.elements=e,this.rest=t,this.isReadonly=r,this.annotations=n;let i=!1,s=!1;for(const t of e)if(t.isOptional)i=!0;else if(i){s=!0;break}if(s||i&&t.length>1)throw Error(Ta)}toString(){return ap(Nb(this),()=>RI(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(e=>e.toJSON()),rest:this.rest.map(e=>e.toJSON()),isReadonly:this.isReadonly,annotations:Nl(this.annotations)}}}let RI=e=>{let t=e.elements.map(String).join(", ");return aU(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(r,n)=>{let i=String(r),s=i.includes(" | ")?`(${i})`:i;if(n.length>0){let r=n.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${s}[], ${r}]`:`readonly [...${s}[], ${r}]`}return e.elements.length>0?`readonly [${t}, ...${s}[]]`:`ReadonlyArray<${i}>`}})};class RT extends RE{name;isReadonly;constructor(e,t,r,n,i){super(t,r,i),this.name=e,this.isReadonly=n}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:Nl(this.annotations)}}}let RR=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return RR(e.from)}return!1};class RN{type;isReadonly;parameter;constructor(e,t,r){if(this.type=t,this.isReadonly=r,RR(e))this.parameter=e;else throw Error(Ts)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class RM{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(e,t,r={}){this.annotations=r;const n={};for(let t=0;t<e.length;t++){const r=e[t].name;if(Object.prototype.hasOwnProperty.call(n,r))throw Error(Tl(r));n[r]=null}const i={string:!1,symbol:!1};for(let e=0;e<t.length;e++){const r=Nu(t[e].parameter);if(Rp(r)){if(i.string)throw Error(Ti("string"));i.string=!0}else if(RS(r)){if(i.symbol)throw Error(Ti("symbol"));i.symbol=!0}}this.propertySignatures=e,this.indexSignatures=t}toString(){return ap(Nb(this),()=>Rj(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(e=>e.toJSON()),indexSignatures:this.indexSignatures.map(e=>e.toJSON()),annotations:Nl(this.annotations)}}}let RA=e=>e.map(String).join("; "),Rj=e=>{if(e.propertySignatures.length>0){let t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${RA(e.indexSignatures)} }`:`{ ${t} }`}return e.indexSignatures.length>0?`{ ${RA(e.indexSignatures)} }`:"{}"},RD=Rt("TypeLiteral"),RP=a6(ao(as,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),R$={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},Rz=e=>of(e,e=>RB(e)?Rz(e.types):[e]);class RL{types;annotations;static make=(e,t)=>RU(e)?new RL(e,t):1===e.length?e[0]:Rl;static unify=(e,t)=>RL.make((e=>{let t=RP(e),r=[],n={},i=[];for(let e of t)switch(e._tag){case"NeverKeyword":break;case"AnyKeyword":return[Rh];case"UnknownKeyword":return[Rc];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":n[e._tag]||(n[e._tag]=e,r.push(e));break;case"Literal":{let t=typeof e.literal;switch(t){case"string":case"number":case"bigint":case"boolean":n[R$[t]]||i.includes(e.literal)||(i.push(e.literal),r.push(e));break;case"object":i.includes(e.literal)||(i.push(e.literal),r.push(e))}break}case"UniqueSymbol":n.SymbolKeyword||i.includes(e.symbol)||(i.push(e.symbol),r.push(e));break;case"TupleType":n.ObjectKeyword||r.push(e);break;case"TypeLiteral":0===e.propertySignatures.length&&0===e.indexSignatures.length?n["{}"]||(n["{}"]=e,r.push(e)):n.ObjectKeyword||r.push(e);break;default:r.push(e)}return r})(Rz(e)),t);_tag="Union";constructor(e,t={}){this.types=e,this.annotations=t}toString(){return ap(Nb(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(e=>e.toJSON()),annotations:Nl(this.annotations)}}}let RU=e=>e.length>1,RB=Rt("Union"),Rq=ik(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class RJ{f;annotations;_tag="Suspend";constructor(e,t={}){this.f=e,this.annotations=t,this.f=I4(e)}toString(){return Nb(this).pipe(ad(()=>a_(ay(this.f)(),e=>Nb(e))),ap(()=>"<suspended schema>"))}toJSON(){let e=this.f(),t=Rq.get(e);return t||(Rq.set(e,{_tag:this._tag}),t={_tag:this._tag,ast:e.toJSON(),annotations:Nl(this.annotations)},Rq.set(e,t)),t}}class RH{from;filter;annotations;_tag="Refinement";constructor(e,t,r={}){this.from=e,this.filter=t,this.annotations=r}toString(){return TQ(this).pipe(ap(()=>af(Nm(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:e=>RW(this.from)?String(this.from)+" & "+e:e})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:Nl(this.annotations)}}}let RW=Rt("Refinement"),RK={};class RV{from;to;transformation;annotations;_tag="Transformation";constructor(e,t,r,n={}){this.from=e,this.to=t,this.transformation=r,this.annotations=n}toString(){return ap(Nb(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:Nl(this.annotations)}}}let RG=Rt("Transformation");class RZ{decode;encode;_tag="FinalTransformation";constructor(e,t){this.decode=e,this.encode=t}}let RQ=new class{_tag="ComposeTransformation"};class RY{from;to;decode;encode;constructor(e,t,r,n){this.from=e,this.to=t,this.decode=r,this.encode=n}}class RX{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(e){this.propertySignatureTransformations=e;const t={},r={};for(const n of e){const e=n.from;if(t[e])throw Error(To(e));t[e]=!0;const i=n.to;if(r[i])throw Error(To(i));r[i]=!0}}}let R0=(e,t)=>{let r=Object.getOwnPropertyDescriptors(e),n={...e.annotations,...t},i=T5(e);return sW(i)&&(n[Tq]=R0(i.value,t)),r.annotations.value=n,Object.create(Object.getPrototypeOf(e),r)},R1=(e,t)=>{switch(e._tag){case"Literal":return md(String(e.literal));case"StringKeyword":return"[\\s\\S]*?";case"NumberKeyword":return"[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?";case"TemplateLiteral":return R3(e,t,!1);case"Union":return e.types.map(e=>R1(e,t)).join("|")}},R2=(e,t,r,n)=>{if(RB(e)){if(r&&!n)return`(?:${t})`}else if(!r||!n)return t;return`(${t})`},R3=(e,t,r)=>{let n="";if(""!==e.head){let i=md(e.head);n+=t&&r?`(${i})`:i}for(let i of e.spans){let e=R1(i.type,t);if(n+=R2(i.type,e,t,r),""!==i.literal){let e=md(i.literal);n+=t&&r?`(${e})`:e}}return n},R5=e=>RegExp(`^${R3(e,!1,!0)}$`),R4=e=>{switch(e._tag){case"TupleType":{let t=!1,r=[];for(let n of e.elements)n.isOptional&&(t=!0),r.push(n.type);return t&&r.push(Ro),r=r.concat(RC(e.rest)),RL.make(r)}case"Refinement":return R4(e.from);case"Union":return RL.make(e.types.map(R4));case"Suspend":return R4(e.f())}throw Error(Tn(e))},R6=(e,t)=>{let r=aR(e.propertySignatures,e=>e.name===t);if(sW(r))return r.value;if(iO(t)){let r;for(let n of e.indexSignatures){let e=Nu(n.parameter);switch(e._tag){case"TemplateLiteral":if(R5(e).test(t))return new RT(t,n.type,!1,!0);break;case"StringKeyword":void 0===r&&(r=new RT(t,n.type,!1,!0))}}if(r)return r}else if(iI(t)){for(let r of e.indexSignatures)if(RS(Nu(r.parameter)))return new RT(t,r.type,!1,!0)}},R8=(e,t)=>{let r=T5(e);if(sW(r))return R8(r.value,t);switch(e._tag){case"TypeLiteral":{let r=R6(e,t);if(r)return r;break}case"Union":return new RT(t,RL.make(e.types.map(e=>R8(e,t).type)),!1,!0);case"Suspend":return R8(e.f(),t);case"Refinement":return R8(e.from,t)}throw Error(Tn(e))},R7=(e,t)=>{let r=[],n=[],i=e=>{switch(e._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":n.push(new RN(e,t,!0));break;case"Literal":if(iO(e.literal)||iE(e.literal))r.push(new RT(e.literal,t,!1,!0));else{let t;throw Error((t=e.literal,Tt("Unsupported literal",`literal value: ${I8(t)}`)))}break;case"Enums":for(let[n,i]of e.enums)r.push(new RT(i,t,!1,!0));break;case"UniqueSymbol":r.push(new RT(e.symbol,t,!1,!0));break;case"Union":e.types.forEach(i);break;default:throw Error(Tt("Unsupported key schema",void 0,void 0,e))}};return i(e),{propertySignatures:r,indexSignatures:n}},R9=e=>{switch(e._tag){case"TupleType":return!1===e.isReadonly?e:new RF(e.elements,e.rest,!1,e.annotations);case"TypeLiteral":{let t=Ni(e.propertySignatures,e=>!1===e.isReadonly?e:new RT(e.name,e.type,e.isOptional,!1,e.annotations)),r=Ni(e.indexSignatures,e=>!1===e.isReadonly?e:new RN(e.parameter,e.type,!1));return t===e.propertySignatures&&r===e.indexSignatures?e:new RM(t,r,e.annotations)}case"Union":{let t=Ni(e.types,R9);return t===e.types?e:RL.make(t,e.annotations)}case"Suspend":return new RJ(()=>R9(e.f()),e.annotations);case"Refinement":{let t=R9(e.from);return t===e.from?e:new RH(t,e.filter,e.annotations)}case"Transformation":{let t=R9(e.from),r=R9(e.to);return t===e.from&&r===e.to?e:new RV(t,r,e.transformation,e.annotations)}}return e},Ne=e=>t=>{let r;for(let n of e)Object.prototype.hasOwnProperty.call(t.annotations,n)&&(void 0===r&&(r={}),r[n]=t.annotations[n]);return r},Nt=Ne([TR,TN,TM,TA,Tj,TD]),Nr=e=>{switch(e._tag){case"Declaration":{let t=Ni(e.typeParameters,Nr);return t===e.typeParameters?e:new Re(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{let t=Ni(e.elements,e=>{let t=Nr(e.type);return t===e.type?e:new RE(t,e.isOptional)}),r=RC(e.rest),n=Ni(r,Nr);return t===e.elements&&n===r?e:new RF(t,n.map(e=>new RO(e)),e.isReadonly,e.annotations)}case"TypeLiteral":{let t=Ni(e.propertySignatures,e=>{let t=Nr(e.type);return t===e.type?e:new RT(e.name,t,e.isOptional,e.isReadonly)}),r=Ni(e.indexSignatures,e=>{let t=Nr(e.type);return t===e.type?e:new RN(e.parameter,t,e.isReadonly)});return t===e.propertySignatures&&r===e.indexSignatures?e:new RM(t,r,e.annotations)}case"Union":{let t=Ni(e.types,Nr);return t===e.types?e:RL.make(t,e.annotations)}case"Suspend":return new RJ(()=>Nr(e.f()),e.annotations);case"Refinement":{let t=Nr(e.from);return t===e.from?e:new RH(t,e.filter,e.annotations)}case"Transformation":{let t=Nt(e);return Nr(void 0!==t?R0(e.to,t):e.to)}}return e},Nn=e=>af(ad(T7(e),()=>TQ(e)),{onNone:()=>void 0,onSome:e=>({[T8]:e})});function Ni(e,t){let r=!1,n=Array(e.length);for(let i=0;i<e.length;i++){let s=e[i],a=t(s);a!==s&&(r=!0),n[i]=a}return r?n:e}let Ns=e=>{switch(e._tag){case"Transformation":return e.from;case"Refinement":return Ns(e.from);case"Suspend":return Ns(e.f())}},Na=(e,t)=>{switch(e._tag){case"Declaration":{let r=Ni(e.typeParameters,e=>Na(e,t));return r===e.typeParameters?e:new Re(r,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{let r=Ni(e.elements,e=>{let r=Na(e.type,t);return r===e.type?e:new RE(r,e.isOptional)}),n=RC(e.rest),i=Ni(n,e=>Na(e,t));return r===e.elements&&i===n?e:new RF(r,i.map(e=>new RO(e)),e.isReadonly,Nn(e))}case"TypeLiteral":{let r=Ni(e.propertySignatures,e=>{let r=Na(e.type,t);return r===e.type?e:new RT(e.name,r,e.isOptional,e.isReadonly)}),n=Ni(e.indexSignatures,e=>{let r=Na(e.type,t);return r===e.type?e:new RN(e.parameter,r,e.isReadonly)});return r===e.propertySignatures&&n===e.indexSignatures?e:new RM(r,n,Nn(e))}case"Union":{let r=Ni(e.types,e=>Na(e,t));return r===e.types?e:RL.make(r,Nn(e))}case"Suspend":return new RJ(()=>Na(e.f(),t),Nn(e));case"Refinement":{let r=Na(e.from,t);if(t){if(r===e.from)return e;if(void 0===Ns(e.from)&&T6(e))return new RH(r,e.filter,e.annotations)}let n=Nn(e);return n?R0(r,n):r}case"Transformation":{let r=Nn(e);return Na(r?R0(e.from,r):e.from,t)}}return e},No=e=>Na(e,!1),Nl=e=>{let t={};for(let r of Object.getOwnPropertySymbols(e))t[String(r)]=e[r];return t},Nu=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return Nu(e.from)}},Nc=(e,t)=>{switch(e._tag){case"Literal":return Rn(t)&&t.literal===e.literal;case"UniqueSymbol":return Ra(t)&&t.symbol===e.symbol;case"UndefinedKeyword":case"VoidKeyword":case"NeverKeyword":case"UnknownKeyword":case"AnyKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":case"ObjectKeyword":return t._tag===e._tag;case"TemplateLiteral":return Rk(t)&&t.head===e.head&&Nh(t.spans,e.spans);case"Enums":return Rx(t)&&Nf(t.enums,e.enums);case"Union":return RB(t)&&Np(e.types,t.types);case"Refinement":case"TupleType":case"TypeLiteral":case"Suspend":case"Transformation":case"Declaration":return e===t}},Nh=o_((e,t)=>e.literal===t.literal&&Nc(e.type,t.type)),Nf=o_((e,t)=>t[0]===e[0]&&t[1]===e[1]),Np=o_(Nc),Nd=(e,t)=>new RV(e,t,RQ),Ng=e=>ap(Nb(e),()=>e._tag),Nm=e=>TG(e).pipe(ad(()=>TY(e)),ad(()=>TZ(e)),ax(t=>t+af(TW(e),{onNone:()=>"",onSome:e=>e.map(e=>` & Brand<${I8(e)}>`).join("")}))),Nb=e=>ad(TQ(e),()=>Nm(e));class Ny{path;actual;issue;_tag="Pointer";constructor(e,t,r){this.path=e,this.actual=t,this.issue=r}}class Nv{actual;message;_tag="Unexpected";constructor(e,t){this.actual=e,this.message=t}}class NS{ast;message;_tag="Missing";actual=void 0;constructor(e,t){this.ast=e,this.message=t}}class Nx{ast;actual;issues;output;_tag="Composite";constructor(e,t,r,n){this.ast=e,this.actual=t,this.issues=r,this.output=n}}class N_{ast;actual;kind;issue;_tag="Refinement";constructor(e,t,r,n){this.ast=e,this.actual=t,this.kind=r,this.issue=n}}class Nw{ast;actual;kind;issue;_tag="Transformation";constructor(e,t,r,n){this.ast=e,this.actual=t,this.kind=r,this.issue=n}}class Nk{ast;actual;message;_tag="Type";constructor(e,t,r){this.ast=e,this.actual=t,this.message=r}}class NO{ast;actual;message;_tag="Forbidden";constructor(e,t,r){this.ast=e,this.actual=t,this.message=r}}let NE=Symbol.for("effect/Schema/ParseErrorTypeId");class NC extends bj("ParseError"){[NE]=NE;get message(){return this.toString()}toString(){return N2.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[ss](){return this.toJSON()}}let NF=e=>new NC({issue:e}),NI=s3,NT=e=>{if("function"==typeof e)try{return s3(e())}catch(e){return s2(e)}try{return s3(e.try())}catch(t){return s2(e.catch(t))}},NR=s5,NN=ic(2,(e,t)=>sX(e)?s7(e,{onLeft:s2,onRight:t}):pB(e,t)),NM=ic(2,(e,t)=>sX(e)?s8(e,t):p2(e,t)),NA=ic(2,(e,t)=>sX(e)?s6(e,t):p5(e,t)),Nj=ic(2,(e,t)=>sX(e)?s4(e,{onLeft:t.onFailure,onRight:t.onSuccess}):p3(e,t)),ND=ic(2,(e,t)=>sX(e)?s7(e,{onLeft:t,onRight:s3}):pI(e,t)),NP=(e,t)=>void 0===t||iE(t)?e:void 0===e?t:{...e,...t},N$=(e,t,r)=>{let n=NH(e,t);return(e,t)=>n(e,NP(r,t))},Nz=(e,t,r)=>{let n=NH(e,t);return(e,t)=>n(e,{...NP(r,t),isEffectAllowed:!0})},NL=(e,t)=>Nz(e.ast,!0,t),NU=(e,t)=>Nz(e.ast,!1,t),NB=(e,t)=>{let r;return r=N$(Nr(e.ast),!0,t),(e,t)=>ae(r(e,t),NF)},Nq=ik(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),NJ=ik(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),NH=(e,t)=>{let r=t?Nq:NJ,n=r.get(e);if(n)return n;let i=NW(e,t),s=T2(e),a=sW(s)?(e,t)=>i(e,NP(t,s.value)):i,o=T3(e),l=t&&sW(o)?(t,r)=>NQ(ND(a(t,r),o.value),e,t,r):a;return r.set(e,l),l},NW=(e,t)=>{switch(e._tag){case"Refinement":if(t){let t=NH(e.from,!0);return(r,n)=>{n=n??RK;let i=n?.errors==="all";return NQ(NN(ND(t(r,n),t=>{let s=new N_(e,r,"From",t);return i&&T6(e)&&N7(t)?af(e.filter(r,n,e),{onNone:()=>s2(s),onSome:t=>s2(new Nx(e,r,[s,new N_(e,r,"Predicate",t)]))}):s2(s)}),t=>af(e.filter(t,n,e),{onNone:()=>s3(t),onSome:t=>s2(new N_(e,r,"Predicate",t))})),e,r,n)}}{let t=NH(Nr(e),!0),r=NH(NZ(e.from),!1);return(n,i)=>NQ(NN(t(n,i),e=>r(e,i)),e,n,i)}case"Transformation":{let r=N0(e.transformation,t),n=t?NH(e.from,!0):NH(e.to,!1),i=t?NH(e.to,!0):NH(e.from,!1);return(s,a)=>NQ(NN(NA(n(s,a),r=>new Nw(e,s,t?"Encoded":"Type",r)),n=>NN(NA(r(n,a??RK,e,s),t=>new Nw(e,s,"Transformation",t)),r=>NA(i(r,a),r=>new Nw(e,s,t?"Type":"Encoded",r)))),e,s,a)}case"Declaration":{let r=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(t,n)=>NQ(r(t,n??RK,e),e,t,n)}case"Literal":return NK(e,t=>t===e.literal);case"UniqueSymbol":return NK(e,t=>t===e.symbol);case"UndefinedKeyword":return NK(e,iT);case"NeverKeyword":return NK(e,iM);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return s3;case"StringKeyword":return NK(e,iO);case"NumberKeyword":return NK(e,iE);case"BooleanKeyword":return NK(e,iC);case"BigIntKeyword":return NK(e,iF);case"SymbolKeyword":return NK(e,iI);case"ObjectKeyword":return NK(e,ij);case"Enums":return NK(e,t=>e.enums.some(([e,r])=>r===t));case"TemplateLiteral":{let t=R5(e);return NK(e,e=>iO(e)&&t.test(e))}case"TupleType":{let r=e.elements.map(e=>NH(e.type,t)),n=e.rest.map(e=>NH(e.type,t)),i=e.elements.filter(e=>!e.isOptional);e.rest.length>0&&(i=i.concat(e.rest.slice(1)));let s=i.length,a=e.elements.length>0?e.elements.map((e,t)=>t).join(" | "):"never",o=ab(TX(e)),l=ab(T0(e));return(t,u)=>{let c;if(!aH(t))return s2(new Nk(e,t));let h=u?.errors==="all",f=[],p=0,d=[],g=t.length;for(let r=g;r<=s-1;r++){let n=new Ny(r,t,new NS(i[r-g]));if(!h)return s2(new Nx(e,t,n,d));f.push([p++,n])}if(0===e.rest.length)for(let r=e.elements.length;r<=g-1;r++){let n=new Ny(r,t,new Nv(t[r],`is unexpected, expected: ${a}`));if(!h)return s2(new Nx(e,t,n,d));f.push([p++,n])}let m=0;for(;m<r.length;m++)if(g<m+1){if(e.elements[m].isOptional)continue}else{let n=(0,r[m])(t[m],u);if(sX(n)){if(s0(n)){let r=new Ny(m,t,n.left);if(!h)return s2(new Nx(e,t,r,NX(d)));f.push([p++,r]);continue}d.push([p++,n.right])}else{let r=p++,i=m;c||(c=[]),c.push(({es:s,output:a})=>pB(pj(n),n=>{if(s0(n)){let o=new Ny(i,t,n.left);return h?(s.push([r,o]),dl):s2(new Nx(e,t,o,NX(a)))}return a.push([r,n.right]),dl}))}}if(aW(n)){let[r,...i]=n;for(;m<g-i.length;m++){let n=r(t[m],u);if(sX(n))if(s0(n)){let r=new Ny(m,t,n.left);if(!h)return s2(new Nx(e,t,r,NX(d)));f.push([p++,r]);continue}else d.push([p++,n.right]);else{let r=p++,i=m;c||(c=[]),c.push(({es:s,output:a})=>pB(pj(n),n=>{if(!s0(n))return a.push([r,n.right]),dl;{let o=new Ny(i,t,n.left);return h?(s.push([r,o]),dl):s2(new Nx(e,t,o,NX(a)))}}))}}for(let r=0;r<i.length;r++)if(!(g<(m+=r)+1)){let n=i[r](t[m],u);if(sX(n)){if(s0(n)){let r=new Ny(m,t,n.left);if(!h)return s2(new Nx(e,t,r,NX(d)));f.push([p++,r]);continue}d.push([p++,n.right])}else{let r=p++,i=m;c||(c=[]),c.push(({es:s,output:a})=>pB(pj(n),n=>{if(s0(n)){let o=new Ny(i,t,n.left);return h?(s.push([r,o]),dl):s2(new Nx(e,t,o,NX(a)))}return a.push([r,n.right]),dl}))}}}let b=({es:r,output:n})=>an(r)?s2(new Nx(e,t,NX(r),NX(n))):s3(NX(n));if(c&&c.length>0){let e=c;return dt(()=>{let t={es:oi(f),output:oi(d)};return pB(wF(e,e=>e(t),{concurrency:o,batching:l,discard:!0}),()=>b(t))})}return b({output:d,es:f})}}case"TypeLiteral":{if(0===e.propertySignatures.length&&0===e.indexSignatures.length)return NK(e,i$);let r=[],n={},i=[];for(let s of e.propertySignatures)r.push([NH(s.type,t),s]),n[s.name]=null,i.push(s.name);let s=e.indexSignatures.map(e=>[NH(e.parameter,t),NH(e.type,t),e.parameter]),a=RL.make(e.indexSignatures.map(e=>e.parameter).concat(i.map(e=>iI(e)?new Rs(e):new Rr(e)))),o=NH(a,t),l=ab(TX(e)),u=ab(T0(e));return(t,c)=>{let h,f,p;if(!(iA(p=t)&&!Array.isArray(p)))return s2(new Nk(e,t));let d=c?.errors==="all",g=[],m=0,b=c?.onExcessProperty==="error",y=c?.onExcessProperty==="preserve",v={};if(b||y)for(let r of h=I5(t)){let n=o(r,c);if(sX(n)&&s0(n))if(b){let n=new Ny(r,t,new Nv(t[r],`is unexpected, expected: ${String(a)}`));if(!d)return s2(new Nx(e,t,n,v));g.push([m++,n]);continue}else v[r]=t[r]}let S=c?.exact===!0;for(let n=0;n<r.length;n++){let i=r[n][1],s=i.name,a=Object.prototype.hasOwnProperty.call(t,s);if(!a){if(i.isOptional)continue;else if(S){let r=new Ny(s,t,new NS(i));if(!d)return s2(new Nx(e,t,r,v));g.push([m++,r]);continue}}let o=(0,r[n][0])(t[s],c);if(sX(o)){if(s0(o)){let r=new Ny(s,t,a?o.left:new NS(i));if(!d)return s2(new Nx(e,t,r,v));g.push([m++,r]);continue}v[s]=o.right}else{let r=m++;f||(f=[]),f.push(({es:n,output:l})=>pB(pj(o),o=>{if(s0(o)){let u=new Ny(s,t,a?o.left:new NS(i));return d?(n.push([r,u]),dl):s2(new Nx(e,t,u,l))}return l[s]=o.right,dl}))}}for(let r=0;r<s.length;r++){let i=s[r],a=i[0],o=i[1];for(let r of I3(t,i[2])){let i=a(r,c);if(sX(i)&&s1(i)){let i=o(t[r],c);if(sX(i))if(s0(i)){let n=new Ny(r,t,i.left);if(!d)return s2(new Nx(e,t,n,v));g.push([m++,n]);continue}else Object.prototype.hasOwnProperty.call(n,r)||(v[r]=i.right);else{let s=m++,a=r;f||(f=[]),f.push(({es:o,output:l})=>pB(pj(i),i=>{if(!s0(i))return Object.prototype.hasOwnProperty.call(n,r)||(l[r]=i.right),dl;{let r=new Ny(a,t,i.left);return d?(o.push([s,r]),dl):s2(new Nx(e,t,r,l))}}))}}}}let x=({es:r,output:n})=>{if(an(r))return s2(new Nx(e,t,NX(r),n));if(c?.propertyOrder==="original"){let e=h||I5(t);for(let t of i)-1===e.indexOf(t)&&e.push(t);let r={};for(let t of e)Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t]);return s3(r)}return s3(n)};if(f&&f.length>0){let e=f;return dt(()=>{let t={es:oi(g),output:Object.assign({},v)};return pB(wF(e,e=>e(t),{concurrency:l,batching:u,discard:!0}),()=>x(t))})}return x({es:g,output:v})}}case"Union":{let r=NG(e.types,t),n=I5(r.keys),i=n.length,s=e.types.length,a=new Map;for(let r=0;r<s;r++)a.set(e.types[r],NH(e.types[r],t));let o=ab(TX(e))??1,l=ab(T0(e));return(t,u)=>{let c,h=[],f=0,p=[];if(i>0)if(iA(t))for(let e=0;e<i;e++){let i=n[e],a=r.keys[i].buckets;if(Object.prototype.hasOwnProperty.call(t,i)){let e=String(t[i]);if(Object.prototype.hasOwnProperty.call(a,e))p=p.concat(a[e]);else{let{candidates:e,literals:n}=r.keys[i],a=RL.make(n),o=e.length===s?new RM([new RT(i,a,!1,!0)],[]):RL.make(e);h.push([f++,new Nx(o,t,new Ny(i,t,new Nk(a,t[i])))])}}else{let{candidates:e,literals:n}=r.keys[i],a=new RT(i,RL.make(n),!1,!0),o=e.length===s?new RM([a],[]):RL.make(e);h.push([f++,new Nx(o,t,new Ny(i,t,new NS(a)))])}}else{let n=r.candidates.length===s?e:RL.make(r.candidates);h.push([f++,new Nk(n,t)])}r.otherwise.length>0&&(p=p.concat(r.otherwise));for(let e=0;e<p.length;e++){let r=p[e],n=a.get(r)(t,u);if(sX(n)&&(!c||0===c.length))if(s1(n))return n;else h.push([f++,n.left]);else{let e=f++;c||(c=[]),c.push(t=>dt(()=>"finalResult"in t?dl:pB(pj(n),r=>(s1(r)?t.finalResult=r:t.es.push([e,r.left]),dl))))}}let d=r=>an(r)?1===r.length&&"Type"===r[0][1]._tag?s2(r[0][1]):s2(new Nx(e,t,NX(r))):s2(new Nk(e,t));if(c&&c.length>0){let e=c;return dt(()=>{let t={es:oi(h)};return pB(wF(e,e=>e(t),{concurrency:o,batching:l,discard:!0}),()=>"finalResult"in t?t.finalResult:d(t.es))})}return d(h)}}case"Suspend":{let r=I4(()=>NH(R0(e.f(),e.annotations),t));return(e,t)=>r()(e,t)}}},NK=(e,t)=>r=>t(r)?s3(r):s2(new Nk(e,r)),NV=(e,t)=>{switch(e._tag){case"Declaration":{let r=T5(e);if(sW(r))return NV(r.value,t);break}case"TypeLiteral":{let r=[];for(let n=0;n<e.propertySignatures.length;n++){let i=e.propertySignatures[n],s=t?No(i.type):Nr(i.type);Rn(s)&&!i.isOptional&&r.push([i.name,s])}return r}case"TupleType":{let r=[];for(let n=0;n<e.elements.length;n++){let i=e.elements[n],s=t?No(i.type):Nr(i.type);Rn(s)&&!i.isOptional&&r.push([n,s])}return r}case"Refinement":return NV(e.from,t);case"Suspend":return NV(e.f(),t);case"Transformation":return NV(t?e.from:e.to,t)}return[]},NG=(e,t)=>{let r={},n=[],i=[];for(let s=0;s<e.length;s++){let a=e[s],o=NV(a,t);if(o.length>0){i.push(a);for(let e=0;e<o.length;e++){let[t,n]=o[e],i=String(n.literal);r[t]=r[t]||{buckets:{},literals:[],candidates:[]};let s=r[t].buckets;if(Object.prototype.hasOwnProperty.call(s,i)){if(e<o.length-1)continue;s[i].push(a),r[t].literals.push(n),r[t].candidates.push(a)}else{s[i]=[a],r[t].literals.push(n),r[t].candidates.push(a);break}}}else n.push(a)}return{keys:r,otherwise:n,candidates:i}},NZ=e=>RW(e)?NZ(e.from):e,NQ=(e,t,r,n)=>{if(n?.isEffectAllowed===!0||sX(e))return e;let i=new vU,s=k5(e,{scheduler:i});i.flush();let a=s.unsafePoll();if(a){if(gx(a))return s3(a.value);let e=a.cause;return e._tag===uI?s2(e.error):s2(new NO(t,r,ce(e)))}return s2(new NO(t,r,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},NY=([e],[t])=>e>t?1:e<t?-1:0;function NX(e){return e.sort(NY).map(e=>e[1])}let N0=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return s3;case"TypeLiteralTransformation":return r=>{let n=s3(r);for(let r of e.propertySignatureTransformations){let[e,i]=t?[r.from,r.to]:[r.to,r.from],s=t?r.decode:r.encode;n=NM(n,t=>{let r=s(Object.prototype.hasOwnProperty.call(t,e)?sV(t[e]):ah());return delete t[e],sW(r)&&(t[i]=r.value),t})}return n}}},N1=(e,t=[])=>({value:e,forest:t}),N2={formatIssue:e=>NM(Ma(e),N3),formatIssueSync:e=>{let t=N2.formatIssue(e);return sX(t)?at(t):k8(t)},formatError:e=>N2.formatIssue(e.issue),formatErrorSync:e=>N2.formatIssueSync(e.issue)},N3=e=>e.value+N5("\n",e.forest),N5=(e,t)=>{let r,n="",i=t.length;for(let s=0;s<i;s++){r=t[s];let a=s===i-1;n+=e+(a?"└":"├")+"─ "+r.value,n+=N5(e+(i>1&&!a?"│  ":"   "),r.forest)}return n},N4=e=>"ast"in e?sV(e.ast):ah(),N6=s3(void 0),N8=e=>t=>t._tag===e,N7=N8("Composite"),N9=N8("Refinement"),Me=N8("Transformation"),Mt=e=>NN(N4(e).pipe(a_(TK),af({onNone:()=>N6,onSome:t=>{let r=t(e);return iO(r)?s3({message:r,override:!1}):pv(r)?p2(r,e=>({message:e,override:!1})):iO(r.message)?s3({message:r.message,override:r.override}):p2(r.message,e=>({message:e,override:r.override}))}})),t=>void 0!==t?!t.override&&(N7(e)||N9(e)&&"From"===e.kind||Me(e)&&"Transformation"!==e.kind)?Me(e)||N9(e)?Mt(e.issue):N6:s3(t.message):N6),Mr=e=>N4(e).pipe(a_(T1),aw(t=>t(e)),ab),Mn=e=>NM(Mt(e),t=>t??Mr(e)??function(e){var t;if(void 0!==e.message)return e.message;let r=RW(e.ast)?TY(t=e.ast).pipe(ad(()=>TG(t)),ad(()=>TZ(t)),ad(()=>TQ(t)),ap(()=>`{ ${t.from} | filter }`)):String(e.ast);return`Expected ${r}, actual ${I8(e.actual)}`}(e)),Mi=e=>Mr(e)??String(e.ast),Ms=e=>{let t=TV(e.ast);if(sW(t)){let e=t.value();return iO(e)?s3(e):e}return s3(e.message??"is missing")},Ma=e=>{switch(e._tag){case"Type":return NM(Mn(e),N1);case"Forbidden":return s3(N1(Mi(e),[N1(e.message??"is forbidden")]));case"Unexpected":return s3(N1(e.message??"is unexpected"));case"Missing":return NM(Ms(e),N1);case"Transformation":return NN(Mt(e),t=>void 0!==t?s3(N1(t)):NM(Ma(e.issue),t=>N1(Mi(e),[N1((e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}})(e.kind),[t])])));case"Refinement":return NN(Mt(e),t=>void 0!==t?s3(N1(t)):NM(Ma(e.issue),t=>N1(Mi(e),[N1((e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}})(e.kind),[t])])));case"Pointer":return NM(Ma(e.issue),t=>N1(Te(e.path),[t]));case"Composite":return NN(Mt(e),t=>{if(void 0!==t)return s3(N1(t));let r=Mi(e);return Array.isArray(e.issues)?NM(wF(e.issues,Ma),e=>N1(r,e)):NM(Ma(e.issues),e=>N1(r,[e]))})}},Mo=e=>{let t=Object.create(bb);return bg.set(t,e),t},Ml=e=>{if(bg.has(e))return bg.get(e);throw Error("Unable to get redacted value")},Mu=e=>iy((t,r)=>e(Ml(t),Ml(r))),Mc=ic(e=>ij(e[0]),(e,...t)=>{let r={};for(let n of t)n in e&&(r[n]=e[n]);return r}),Mh=ic(e=>ij(e[0]),(e,...t)=>{let r={...e};for(let e of t)delete r[e];return r}),Mf=Symbol.for("effect/Schema");function Mp(e){return class{[Mf]=Md;static ast=e;static annotations(e){return Mp(Mb(this.ast,e))}static pipe(){return sp(this,arguments)}static toString(){return String(e)}static Type;static Encoded;static Context;static [Mf]=Md}}let Md={_A:e=>e,_I:e=>e,_R:e=>e},Mg={schemaId:Tk,message:TO,missingMessage:TE,identifier:TC,title:TF,description:TT,examples:TR,default:TN,documentation:TP,jsonSchema:TM,arbitrary:TA,pretty:Tj,equivalence:TD,concurrency:T$,batching:Tz,parseIssueTitle:TL,parseOptions:TU,decodingFallback:TB},Mm=e=>{if(!e)return{};let t={...e};for(let r in Mg)r in e&&(t[Mg[r]]=e[r],delete t[r]);return t},Mb=(e,t)=>R0(e,Mm(t)),My=e=>Mp(Nr(e.ast)),Mv=(e,t)=>{let r=NL(e,t);return(e,t)=>NA(r(e,t),NF)},MS=e=>iD(e,Mf)&&ij(e[Mf]);function Mx(...e){return aW(e)?function e(t,r=function(e){let t;return RU(e)?RL.make((t=e=>new Rr(e),e.map(t))):new Rr(e[0])}(t)){return class extends Mp(r){static annotations(t){return e(this.literals,Mb(this.ast,t))}static literals=[...t]}}(e):MF}function M_(e,t){return class extends Mp(t){static annotations(e){return M_(this.typeParameters,Mb(this.ast,e))}static typeParameters=[...e]}}let Mw=function(){let e;if(Array.isArray(arguments[0])){let e=arguments[0],t=arguments[1],r=arguments[2];return M_(e,new Re(e.map(e=>e.ast),(...e)=>t.decode(...e.map(Mp)),(...e)=>t.encode(...e.map(Mp)),Mm(r)))}let t=arguments[0],r=arguments[1];return M_([],new Re([],e=()=>(e,r,n)=>t(e)?NI(e):s2(new Nk(n,e)),e,Mm(r)))},Mk=Symbol.for("effect/SchemaId/InstanceOf"),MO=(e,t)=>Mw(t=>t instanceof e,{title:e.name,description:`an instance of ${e.name}`,pretty:()=>String,schemaId:Mk,[Mk]:{constructor:e},...t});class ME extends Mp(Ro){}class MC extends Mp(Ri){}class MF extends Mp(Rl){}class MI extends Mp(Rc){}class MT extends Mp(Ry){}class MR extends Mp(Rv){}class MN extends Mp(Rf){}class MM extends Mp(Rd){}class MA extends Mp(Rm){}function Mj(...e){return RU(e)?function e(t,r=(e=>RL.make(e.map(e=>e.ast)))(t)){return class extends Mp(r){static annotations(t){return e(this.members,Mb(this.ast,t))}static members=[...t]}}(e):aW(e)?e[0]:MF}let MD=e=>Mj(e,MC),MP=e=>new M$(new RE(e.ast,!1),e);class M${ast;from;[Mf];_Token;constructor(e,t){this.ast=e,this.from=t}annotations(e){return new M$(new RE(this.ast.type,this.ast.isOptional,{...this.ast.annotations,...Mm(e)}),this.from)}toString(){return`${this.ast.type}${this.ast.isOptional?"?":""}`}}function Mz(e,t,r=((e,t)=>new RF(e.map(e=>MS(e)?new RE(e.ast,!1):e.ast),t.map(e=>MS(e)?new RO(e.ast):e.ast),!0))(e,t)){return class extends Mp(r){static annotations(e){return Mz(this.elements,this.rest,Mb(this.ast,e))}static elements=[...e];static rest=[...t]}}function ML(...e){return Array.isArray(e[0])?Mz(e[0],e.slice(1)):Mz(e,[])}let MU=e=>(function e(t,r){return class extends Mz([],[t],r){static annotations(t){return e(this.value,Mb(this.ast,t))}static value=t}})(e),MB=e=>e?'"?:"':'":"';class Mq extends RE{isReadonly;defaultValue;_tag="PropertySignatureDeclaration";constructor(e,t,r,n,i){super(e,t,n),this.isReadonly=r,this.defaultValue=i}toString(){let e=MB(this.isOptional),t=String(this.type);return`PropertySignature<${e}, ${t}, never, ${e}, ${t}>`}}class MJ extends RE{isReadonly;fromKey;constructor(e,t,r,n,i){super(e,t,n),this.isReadonly=r,this.fromKey=i}}class MH extends RE{isReadonly;defaultValue;constructor(e,t,r,n,i){super(e,t,n),this.isReadonly=r,this.defaultValue=i}}class MW{from;to;decode;encode;_tag="PropertySignatureTransformation";constructor(e,t,r,n){this.from=e,this.to=t,this.decode=r,this.encode=n}toString(){var e;return`PropertySignature<${MB(this.to.isOptional)}, ${this.to.type}, ${void 0===(e=this.from.fromKey)?"never":iO(e)?JSON.stringify(e):String(e)}, ${MB(this.from.isOptional)}, ${this.from.type}>`}}let MK=(e,t)=>{switch(e._tag){case"PropertySignatureDeclaration":return new Mq(e.type,e.isOptional,e.isReadonly,{...e.annotations,...t},e.defaultValue);case"PropertySignatureTransformation":return new MW(e.from,new MH(e.to.type,e.to.isOptional,e.to.isReadonly,{...e.to.annotations,...t},e.to.defaultValue),e.decode,e.encode)}},MV=Symbol.for("effect/PropertySignature"),MG=e=>iD(e,MV);class MZ{ast;[Mf];[MV]=null;_TypeToken;_Key;_EncodedToken;_HasDefault;constructor(e){this.ast=e}pipe(){return sp(this,arguments)}annotations(e){return new MZ(MK(this.ast,Mm(e)))}toString(){return String(this.ast)}}let MQ=e=>new MZ(e);class MY extends MZ{from;constructor(e,t){super(e),this.from=t}annotations(e){return new MY(MK(this.ast,Mm(e)),this.from)}}let MX=e=>new MY(new Mq(e.ast,!1,!0,{},void 0),e),M0=ic(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":return MQ(new Mq(r.type,r.isOptional,r.isReadonly,r.annotations,t));case"PropertySignatureTransformation":return MQ(new MW(r.from,new MH(r.to.type,r.to.isOptional,r.to.isReadonly,r.to.annotations,t),r.decode,r.encode))}}),M1=(e,t)=>af(e,{onNone:()=>sV(t()),onSome:e=>sV(void 0===e?t():e)}),M2=e=>((e,t,r)=>{switch(e._tag){case"UndefinedKeyword":return Rl;case"Union":{let r=[],n=!1;for(let i of e.types){let e=t(i);e?(n=!0,Ru(e)||r.push(e)):r.push(i)}if(n)return RL.make(r);break}case"Suspend":return t(e.f());case"Transformation":return r(e)}})(e,M2,e=>{let t=M2(e.to);if(t)return new RV(e.from,t,e.transformation)}),M3=((e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":{let e=Nr(r.type);return MQ(new MW(new MJ(r.type,r.isOptional,r.isReadonly,r.annotations),new MH(M2(e)??e,!1,!0,{},r.defaultValue),e=>M1(e,t),ih))}case"PropertySignatureTransformation":{let e=r.to.type;return MQ(new MW(r.from,new MH(M2(e)??e,!1,r.to.isReadonly,r.to.annotations,r.to.defaultValue),e=>M1(r.decode(e),t),r.encode))}}},(e,t,r)=>MQ(new MW(new MJ(e.ast,!0,!0,{},void 0),new MH(t.ast,!1,!0,{},void 0),e=>sV(r.decode(e)),a_(r.encode)))),M5=(e,t,r)=>MQ(new MW(new MJ(e.ast,!0,!0,{},void 0),new MH(t.ast,!0,!0,{},void 0),r.decode,r.encode)),M4=e=>new MY(new Mq(e.ast===Ro||e.ast===Rl?Ro:Mj(e,ME).ast,!0,!0,{},void 0),e),M6=ic(e=>MS(e[0]),(e,t)=>new MY(((e,t)=>{let r=t?.exact,n=t?.default,i=t?.nullable,s=t?.as=="Option",a=t?.onNoneEncoding?ad(t.onNoneEncoding):ih;if(r)if(n)if(i)return M0(M3(MD(e),My(e),{decode:af({onNone:n,onSome:e=>null===e?n():e}),encode:sV}),n).ast;else return M0(M3(e,My(e),{decode:af({onNone:n,onSome:ih}),encode:sV}),n).ast;else if(s)if(i)return M3(MD(e),A8(My(e)),{decode:ak(iN),encode:a}).ast;else return M3(e,A8(My(e)),{decode:ih,encode:ih}).ast;else if(i)return M5(MD(e),My(e),{decode:ak(iN),encode:ih}).ast;else return new Mq(e.ast,!0,!0,{},void 0);if(n)if(i)return M0(M3(Mj(e,MC,ME),My(e),{decode:af({onNone:n,onSome:e=>null==e?n():e}),encode:sV}),n).ast;else return M0(M3(Mj(e,ME),My(e),{decode:af({onNone:n,onSome:e=>void 0===e?n():e}),encode:sV}),n).ast;if(s)if(i)return M3(Mj(e,MC,ME),A8(My(e)),{decode:ak(e=>null!=e),encode:a}).ast;else return M3(Mj(e,ME),A8(My(e)),{decode:ak(iR),encode:a}).ast;if(i)return M5(Mj(e,MC,ME),Mj(My(e),ME),{decode:ak(iN),encode:ih}).ast;return new Mq(Mj(e,ME).ast,!0,!0,{},void 0)})(e,t),e)),M8=Ne([TE]),M7=(e,t)=>{for(let r of I5(e)){let n=e[r];if(void 0===t[r]&&MG(n)){let e=n.ast,i="PropertySignatureDeclaration"===e._tag?e.defaultValue:e.to.defaultValue;void 0!==i&&(t[r]=i())}}return t};function M9(e,t,r=((e,t)=>{let r=I5(e),n=[];if(r.length>0){let i=[],s=[],a=[];for(let t=0;t<r.length;t++){let o=r[t],l=e[o];if(MG(l)){let e=l.ast;switch(e._tag){case"PropertySignatureDeclaration":{let t=e.type,r=e.isOptional,a=e.annotations;i.push(new RT(o,t,r,!0,M8(e))),s.push(new RT(o,Nr(t),r,!0,a)),n.push(new RT(o,t,r,!0,a));break}case"PropertySignatureTransformation":{let t=e.from.fromKey??o;i.push(new RT(t,e.from.type,e.from.isOptional,!0,e.from.annotations)),s.push(new RT(o,e.to.type,e.to.isOptional,!0,e.to.annotations)),a.push(new RY(t,o,e.decode,e.encode))}}}else i.push(new RT(o,l.ast,!1,!0)),s.push(new RT(o,Nr(l.ast),!1,!0)),n.push(new RT(o,l.ast,!1,!0))}if(aW(a)){let e=[],r=[];for(let n of t){let{indexSignatures:t,propertySignatures:a}=R7(n.key.ast,n.value.ast);a.forEach(e=>{i.push(e),s.push(new RT(e.name,Nr(e.type),e.isOptional,e.isReadonly,e.annotations))}),t.forEach(t=>{e.push(t),r.push(new RN(t.parameter,Nr(t.type),t.isReadonly))})}return new RV(new RM(i,e,{[TI]:"Struct (Encoded side)"}),new RM(s,r,{[TI]:"Struct (Type side)"}),new RX(a))}}let i=[];for(let e of t){let{indexSignatures:t,propertySignatures:r}=R7(e.key.ast,e.value.ast);r.forEach(e=>n.push(e)),t.forEach(e=>i.push(e))}return new RM(n,i)})(e,t)){return class extends Mp(r){static annotations(e){return M9(this.fields,this.records,Mb(this.ast,e))}static fields={...e};static records=[...t];static make=(t,r)=>{let n=M7(e,{...t});return ja(r)?n:NB(this)(n)};static pick(...t){return Ae(Mc(e,...t))}static omit(...t){return Ae(Mh(e,...t))}}}function Ae(e,...t){return M9(e,t)}let At=(e,t)=>Ae({_tag:Mx(e).pipe(MX,M0(()=>e)),...t}),Ar=(e,t,r)=>{if(RD(e)&&RD(t)){let n=[...e.propertySignatures];for(let e of t.propertySignatures){let t=e.name,i=n.findIndex(e=>e.name===t);if(-1===i)n.push(e);else{let{isOptional:s,type:a}=n[i];n[i]=new RT(t,As(a,e.type,r.concat(t)),s,!0)}}return new RM(n,e.indexSignatures.concat(t.indexSignatures))}throw Error(Tr(e,t,r))},An=(y=[TC],e=>{let t={...e.annotations};for(let e of y)delete t[e];return t}),Ai=(e,t)=>t.map(t=>new RH(t,e.filter,An(e))),As=(e,t,r)=>RL.make(Ao([e],[t],r)),Aa=e=>RB(e)?e.types:[e],Ao=(e,t,r)=>of(e,e=>of(t,t=>{switch(t._tag){case"Literal":if(iO(t.literal)&&Rp(e)||iE(t.literal)&&Rg(e)||iC(t.literal)&&Rb(e))return[t];break;case"StringKeyword":if(t===Rf){if(Rp(e)||Rn(e)&&iO(e.literal))return[e];else if(RW(e))return Ai(e,Ao(Aa(e.from),[t],r))}else if(e===Rf)return[t];break;case"NumberKeyword":if(t===Rd){if(Rg(e)||Rn(e)&&iE(e.literal))return[e];else if(RW(e))return Ai(e,Ao(Aa(e.from),[t],r))}else if(e===Rd)return[t];break;case"BooleanKeyword":if(t===Rm){if(Rb(e)||Rn(e)&&iC(e.literal))return[e];else if(RW(e))return Ai(e,Ao(Aa(e.from),[t],r))}else if(e===Rm)return[t];break;case"Union":return Ao(Aa(e),t.types,r);case"Suspend":return[new RJ(()=>As(e,t.f(),r))];case"Refinement":return Ai(t,Ao(Aa(e),Aa(t.from),r));case"TypeLiteral":switch(e._tag){case"Union":return Ao(e.types,[t],r);case"Suspend":return[new RJ(()=>As(e.f(),t,r))];case"Refinement":return Ai(e,Ao(Aa(e.from),[t],r));case"TypeLiteral":return[Ar(e,t,r)];case"Transformation":{let n=e.transformation,i=Ar(e.from,t,r),s=Ar(e.to,Nr(t),r);switch(n._tag){case"TypeLiteralTransformation":return[new RV(i,s,new RX(n.propertySignatureTransformations))];case"ComposeTransformation":return[new RV(i,s,RQ)];case"FinalTransformation":return[new RV(i,s,new RZ((e,t,r,i)=>NM(n.decode(e,t,r,i),t=>({...e,...t})),(e,t,r,i)=>NM(n.encode(e,t,r,i),t=>({...e,...t}))))]}}}break;case"Transformation":if(!RG(e))return Ao([t],[e],r);if("TypeLiteralTransformation"===t.transformation._tag&&"TypeLiteralTransformation"===e.transformation._tag)return[new RV(Ar(e.from,t.from,r),Ar(e.to,t.to,r),new RX(t.transformation.propertySignatureTransformations.concat(e.transformation.propertySignatureTransformations)))]}throw Error(Tr(e,t,r))})),Al=ic(2,(e,t)=>Mp(As(e.ast,t.ast,[]))),Au=ic(e=>MS(e[1]),(e,t)=>Ad(e,t,Nd(e.ast,t.ast))),Ac=e=>Mp(new RJ(()=>e().ast)),Ah=Symbol.for("effect/SchemaId/Refine"),Af=(e,t,r)=>{if(iC(e))return e?ah():sV(new Nk(t,r));if(iO(e))return sV(new Nk(t,r,e));if(void 0!==e){if("_tag"in e)return sV(e);let n=new Nk(t,r,e.message);return sV(aW(e.path)?new Ny(e.path,r,n):n)}return ah()};function Ap(e,t){return r=>{function n(t,r,n){var i=e(t,r,n),s=n,a=t;if(!Array.isArray(i))return Af(i,s,a);if(aW(i)){let e=od(i,e=>Af(e,s,a));if(aW(e))return sV(1===e.length?e[0]:new Nx(s,a,e))}return ah()}let i=new RH(r.ast,n,Mm(t));return function e(t,r,n){return class extends Mp(n){static annotations(t){return e(this.from,this.filter,Mb(this.ast,t))}static [Ah]=t;static from=t;static filter=r;static make=(e,t)=>ja(t)?e:NB(this)(e)}}(r,n,i)}}function Ad(e,t,r){return class extends Mp(r){static annotations(e){return Ad(this.from,this.to,Mb(this.ast,e))}static from=e;static to=t}}let Ag=ic(e=>MS(e[0])&&MS(e[1]),(e,t,r)=>Ad(e,t,new RV(e.ast,t.ast,new RZ(r.decode,r.encode)))),Am=ic(e=>MS(e[0])&&MS(e[1]),(e,t,r)=>Ag(e,t,{strict:!0,decode:(e,t,n,i)=>NI(r.decode(e,i)),encode:(e,t,n,i)=>NI(r.encode(e,i))})),Ab=Symbol.for("effect/SchemaId/Trimmed"),Ay=e=>t=>t.pipe(Ap(e=>e===e.trim(),{schemaId:Ab,title:"trimmed",description:"a string with no leading or trailing whitespace",jsonSchema:{pattern:"^\\S[\\s\\S]*\\S$|^\\S$|^$"},...e})),Av=Symbol.for("effect/SchemaId/Pattern"),AS=Symbol.for("effect/SchemaId/StartsWith"),Ax=Symbol.for("effect/SchemaId/Lowercased"),A_=e=>t=>t.pipe(Ap(e=>e===e.toLowerCase(),{schemaId:Ax,title:"lowercased",description:"a lowercase string",jsonSchema:{pattern:"^[^A-Z]*$"},...e})),Aw=Symbol.for("effect/SchemaId/Uppercased"),Ak=e=>t=>t.pipe(Ap(e=>e===e.toUpperCase(),{schemaId:Aw,title:"uppercased",description:"an uppercase string",jsonSchema:{pattern:"^[^a-z]*$"},...e})),AO=Symbol.for("effect/SchemaId/Capitalized"),AE=e=>t=>t.pipe(Ap(e=>e[0]?.toUpperCase()===e[0],{schemaId:AO,title:"capitalized",description:"a capitalized string",jsonSchema:{pattern:"^[^a-z]?.*$"},...e})),AC=Symbol.for("effect/SchemaId/Uncapitalized"),AF=e=>t=>t.pipe(Ap(e=>e[0]?.toLowerCase()===e[0],{schemaId:AC,title:"uncapitalized",description:"a uncapitalized string",jsonSchema:{pattern:"^[^A-Z]?.*$"},...e})),AI=e=>{let t;return t={title:"nonEmptyString",description:"a non empty string",...e},e=>e.pipe(Ap(e=>e.length>=1,{schemaId:Tx,title:"minLength(1)",description:"a string at least 1 character(s) long",jsonSchema:{minLength:1},...t}))};class AT extends MN.pipe(Ay({identifier:"Trimmed"})){}let AR=e=>e instanceof Error?e.message:String(e),AN=(e,t)=>MS(e)?Au(AN(t),e):Ag(MN.annotations({description:"a string to be decoded into JSON"}),MI,{strict:!0,decode:(t,r,n)=>NT({try:()=>JSON.parse(t,e?.reviver),catch:e=>new Nk(n,t,AR(e))}),encode:(t,r,n)=>NT({try:()=>JSON.stringify(t,e?.replacer,e?.space),catch:e=>new Nk(n,t,AR(e))})}).annotations({title:"parseJson",schemaId:T9});/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.source,URL;let AM=e=>t=>t.pipe(Ap(e=>Number.isSafeInteger(e),{schemaId:Td,title:"int",description:"an integer",jsonSchema:{type:"integer"},...e})),AA=(e,t,r)=>n=>n.pipe(Ap(r=>r>=e&&r<=t,{schemaId:Ty,title:`between(${e}, ${t})`,description:`a number between ${e} and ${t}`,jsonSchema:{minimum:e,maximum:t},...r})),Aj=e=>{let t;return t={title:"nonNegative",...e},e=>e.pipe(Ap(e=>e>=0,{schemaId:Th,title:"greaterThanOrEqualTo(0)",description:"a non-negative number",jsonSchema:{minimum:0},...t}))};class AD extends MM.pipe(AM({identifier:"Int"})){}class AP extends MM.pipe(Aj({identifier:"NonNegative"})){}class A$ extends Ag(MN.annotations({description:"a string to be decoded into a bigint"}),MT,{strict:!0,decode:(e,t,r)=>NR(oX(e),()=>new Nk(r,e,`Unable to decode ${JSON.stringify(e)} into a bigint`)),encode:e=>NI(String(e))}).annotations({identifier:"BigInt"}){}v={title:"nonNegativeBigInt",identifier:"NonNegativeBigintFromSelf"},e=>e.pipe(Ap(e=>e>=0n,{schemaId:Tv,[Tv]:{min:0n},title:`greaterThanOrEqualToBigInt(${0n})`,description:0n===0n?"a non-negative bigint":`a bigint greater than or equal to ${0n}n`,...v}));let Az=e=>t=>e(t).map(Mo),AL=(e,t,r,n)=>Nj(e,{onFailure:e=>new Nx(r,n,e),onSuccess:t}),AU=e=>(t,r,n)=>by(t)?AL(e(Ml(t),r),Mo,n,t):s2(new Nk(n,t)),AB=AP.pipe(AM()).annotations({identifier:"NonNegativeInt"}),Aq=At("Millis",{millis:AB}),AJ=At("Nanos",{nanos:A$}),AH=At("Infinity",{}),AW=ML(MP(AB).annotations({title:"seconds"}),MP(AB).annotations({title:"nanos"})).annotations({identifier:"FiniteHRTime"});class AK extends Mw(iz,{identifier:"Uint8ArrayFromSelf",pretty:()=>e=>`new Uint8Array(${JSON.stringify(Array.from(e))})`,arbitrary:()=>e=>e.uint8Array(),equivalence:()=>o_(sr)}){}let AV=(S=e=>(e=>{let t=CY(e),r=t.length;if(r%4!=0)return s2(CV(t,`Length must be a multiple of 4, but is ${r}`));let n=t.indexOf("=");if(-1!==n&&(n<r-2||n===r-2&&"="!==t[r-1]))return s2(CV(t,"Found a '=' character, but it is not at the end"));try{let e=t.endsWith("==")?2:+!!t.endsWith("="),n=new Uint8Array(r/4*3-e);for(let e=0,i=0;e<r;e+=4,i+=3){let r=CX(t.charCodeAt(e))<<18|CX(t.charCodeAt(e+1))<<12|CX(t.charCodeAt(e+2))<<6|CX(t.charCodeAt(e+3));n[i]=r>>16,n[i+1]=r>>8&255,n[i+2]=255&r}return s3(n)}catch(e){return s2(CV(t,e instanceof Error?e.message:"Invalid input"))}})(e),x=e=>"string"==typeof e?CQ(CZ.encode(e)):CQ(e),Ag(MN.annotations({description:"a string to be decoded into a Uint8Array"}),AK,{strict:!0,decode:(e,t,r)=>s6(S(e),t=>new Nk(r,e,t.message)),encode:e=>NI(x(e))}).annotations({identifier:"Uint8ArrayFromBase64"})),AG=Symbol.for("effect/SchemaId/ValidDate"),AZ=Tu;class AQ extends Mw(iL,{identifier:"DateFromSelf",schemaId:AZ,[AZ]:{noInvalidDate:!1},description:"a potentially invalid Date instance",pretty:()=>e=>`new Date(${JSON.stringify(e)})`,arbitrary:()=>e=>e.date({noInvalidDate:!1}),equivalence:()=>ix}){}e=>Cz(e)&&CB(e);let AY=()=>e=>e.integer({min:-432e5,max:504e5}).map(O5);class AX extends Mw(CL,{identifier:"TimeZoneOffsetFromSelf",description:"a TimeZone.Offset instance",pretty:()=>e=>e.toString(),arbitrary:AY}){}let A0=()=>e=>e.constantFrom(...Intl.supportedValuesOf("timeZone")).map(O3);class A1 extends Mw(CU,{identifier:"TimeZoneNamedFromSelf",description:"a TimeZone.Named instance",pretty:()=>e=>e.toString(),arbitrary:A0}){}let A2=e=>e.oneof(AY()(e),A0()(e));e=>Cz(e)&&Cq(e);let A3=e=>"None"===e._tag?ah():sV(e.value),A5=(e,t)=>r=>r.oneof(t,r.record({_tag:r.constant("None")}),r.record({_tag:r.constant("Some"),value:e(r)})).map(A3),A4=e=>af({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),A6=e=>(t,r,n)=>sJ(t)?sH(t)?NI(ah()):AL(e(t.value,r),sV,n,t):s2(new Nk(n,t)),A8=e=>Mw([e],{decode:e=>A6(NL(e)),encode:e=>A6(NU(e))},{description:`Option<${String(e.ast)}>`,pretty:A4,arbitrary:A5,equivalence:aO}),A7=()=>e=>`BigDecimal(${oW(oP(e))})`,A9=()=>e=>e.tuple(e.bigInt(),e.integer({min:0,max:18})).map(([e,t])=>oR(e,t)),je=e=>I5(e).every(t=>{let r;return MS(r=e[t])||MG(r)}),jt=e=>"fields"in e?e.fields:jt(e[Ah]),jr=e=>je(e)?Ae(e):MS(e)?e:Ae(jt(e)),jn=e=>je(e)?e:jt(e),ji=e=>(t,r)=>jl({kind:"Class",identifier:e,schema:jr(t),fields:jn(t),Base:hZ,annotations:r}),js=(e,t)=>{let r={...e};for(let n of I5(t)){if(n in e)throw Error(Tl(n));r[n]=t[n]}return r};function ja(e){return iC(e)?e:e?.disableValidation??!1}let jo=ik("effect/Schema/astCache",()=>new WeakMap),jl=({Base:e,annotations:t,disableToString:r,fields:n,identifier:i,kind:s,schema:a})=>{let o=Symbol.for(`effect/Schema/${s}/${i}`),[l,u,c]=void 0===t?[]:Array.isArray(t)?t:[t],h=My(a),f=h.annotations({identifier:i,...l}),p=h.annotations({[TI]:`${i} (Type side)`,...l}),d=a.annotations({[TI]:`${i} (Constructor)`,...l}),g=a.annotations({[TI]:`${i} (Encoded side)`,...c}),m=a.annotations({[T8]:i,...c,...l,...u}),b=class extends e{constructor(e={},t=!1){e={...e},"Class"!==s&&delete e._tag,e=M7(n,e),ja(t)||(e=NB(d)(e)),super(e,!0)}static [Mf]=Md;static get ast(){let e=jo.get(this);return e||(e=Am(g,Mw([a],{decode:()=>(e,t,r)=>{var n;let i;return e instanceof this||iD(e,o)&&(i=NH(Nr(p.ast),!0),(e,t)=>s1(i(e,{exact:!0,...NP(n,t)})))(e)?NI(e):s2(new Nk(r,e))},encode:()=>(e,t)=>e instanceof this?NI(e):NM(NU(p)(e,t),e=>new this(e,!0))},{identifier:i,pretty:e=>t=>`${i}(${e(t)})`,arbitrary:e=>t=>e(t).map(e=>new this(e)),equivalence:ih,[Tq]:f.ast,...l}),{strict:!0,decode:e=>new this(e,!0),encode:ih}).annotations({[Tq]:m.ast,...u}).ast,jo.set(this,e)),e}static pipe(){return sp(this,arguments)}static annotations(e){return Mp(this.ast).annotations(e)}static toString(){return`(${String(g)} <-> ${i})`}static make(...e){return new this(...e)}static fields={...n};static identifier=i;static extend(e){return(t,r)=>{let i=jn(t),o=jr(t),l=js(n,i);return jl({kind:s,identifier:e,schema:Al(a,o),fields:l,Base:this,annotations:r})}}static transformOrFail(e){return(t,r,i)=>{let o=js(n,t);return jl({kind:s,identifier:e,schema:Ag(a,My(Ae(o)),r),fields:o,Base:this,annotations:i})}}static transformOrFailFrom(e){return(t,r,i)=>{let o=js(n,t);return jl({kind:s,identifier:e,schema:Ag(Mp(No(a.ast)),Ae(o),r),fields:o,Base:this,annotations:i})}}get[o](){return o}};return!0!==r&&Object.defineProperty(b.prototype,"toString",{value(){return`${i}({ ${I5(n).map(e=>`${I7(e)}: ${I8(this[e])}`).join(", ")} })`},configurable:!0,writable:!0}),b},ju=Mj(Ae({_tag:Mx("None")}).annotations({identifier:"FiberIdNoneEncoded"}),Ae({_tag:Mx("Runtime"),id:AD,startTimeMillis:AD}).annotations({identifier:"FiberIdRuntimeEncoded"}),Ae({_tag:Mx("Composite"),left:Ac(()=>ju),right:Ac(()=>ju)}).annotations({identifier:"FiberIdCompositeEncoded"})).annotations({identifier:"FiberIdEncoded"}),jc=e=>e.letrec(t=>({None:e.record({_tag:e.constant("None")}),Runtime:e.record({_tag:e.constant("Runtime"),id:e.integer(),startTimeMillis:e.integer()}),Composite:e.record({_tag:e.constant("Composite"),left:t("FiberId"),right:t("FiberId")}),FiberId:e.oneof(t("None"),t("Runtime"),t("Composite"))})).FiberId.map(jf),jh=e=>{switch(e._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${e.id}, ${e.startTimeMillis})`;case"Composite":return`FiberId.composite(${jh(e.right)}, ${jh(e.left)})`}},jf=e=>{switch(e._tag){case"None":return hw;case"Runtime":return new hf(e.id,e.startTimeMillis);case"Composite":return new hp(jf(e.left),jf(e.right))}},jp=Ae({_tag:Mx("Empty")}),jd=Ae({_tag:Mx("Interrupt"),fiberId:ju});class jg extends Am(MI,MI,{strict:!0,decode:e=>{if(ij(e)&&"message"in e&&"string"==typeof e.message){let t=Error(e.message,{cause:e});return"name"in e&&"string"==typeof e.name&&(t.name=e.name),t.stack="stack"in e&&"string"==typeof e.stack?e.stack:"",t}return String(e)},encode:e=>e instanceof Error?{name:e.name,message:e.message}:cn(e)}).annotations({identifier:"Defect"}){}let jm=Symbol.for("effect/Schema/Serializable/symbolResult"),jb=ik("effect/Schema/Serializable/exitSchemaCache",()=>new WeakMap),jy=At("symbol",{key:MN}).annotations({description:"an object to be decoded into a globally shared symbol"}),jv=Ag(jy,MR,{strict:!0,decode:e=>NI(Symbol.for(e.key)),encode:(e,t,r)=>{var n,i;let s;return NM((n=e,i=r,void 0===(s=Symbol.keyFor(n))?s2(new Nk(i,n,`Unable to encode a unique symbol ${String(n)} into a string`)):NI(s)),e=>jy.make({key:e}))}});Mx("inline","attachment"),Mx("public-read","private");let jS=Mx("upload"),jx=Mx("callback","error"),j_=Am(AK,MN,{decode:e=>new TextDecoder().decode(e),encode:e=>new TextEncoder().encode(e)}),jw=Ae({apiKey:Am(er=MN.pipe(e=>{let t=JSON.stringify("sk_");return e.pipe(Ap(e=>e.startsWith("sk_"),{schemaId:AS,[AS]:{startsWith:"sk_"},title:`startsWith(${t})`,description:`a string starting with ${t}`,jsonSchema:{pattern:"^sk_"},..._}))}),Mw([My(er)],{decode:e=>AU(NL(e)),encode:e=>AU(NU(e))},{description:"Redacted(<redacted>)",pretty:()=>()=>"Redacted(<redacted>)",arbitrary:Az,equivalence:Mu}),{strict:!0,decode:e=>Mo(e),encode:e=>Ml(e)}),appId:MN,regions:function e(t,r){return class extends Mz([t],[t],r){static annotations(t){return e(this.value,Mb(this.ast,t))}static value=t}}(MN),ingestHost:MN.pipe(M6({default:()=>"ingest.uploadthing.com"}))}),jk=AV.pipe(Au(j_),Au(AN(jw)));var jO=class extends ji("FileUploadData")({name:MN,size:MM,type:MN,lastModified:MM.pipe(M4)}){},jE=class extends jO.extend("FileUploadDataWithCustomId")({customId:MD(MN)}){},jC=class extends jE.extend("UploadedFileData")({key:MN,url:MN,appUrl:MN,ufsUrl:MN,fileHash:MN}){},jF=class extends ji("MetadataFetchStreamPart")({payload:MN,signature:MN,hook:jx}){},jI=class extends ji("MetadataFetchResponse")({ok:MA}){},jT=class extends ji("CallbackResultResponse")({ok:MA}){},jR=class extends ji("UploadActionPayload")({files:MU(jO),input:MI}){};let jN=function(e,t){if("function"==typeof e)return function(){return e(arguments)?t.apply(this,arguments):e=>t(e,...arguments)};switch(e){case 0:case 1:throw RangeError(`Invalid arity ${e}`);case 2:return function(e,r){return arguments.length>=2?t(e,r):function(r){return t(r,e)}};case 3:return function(e,r,n){return arguments.length>=3?t(e,r,n):function(n){return t(n,e,r)}};case 4:return function(e,r,n,i){return arguments.length>=4?t(e,r,n,i):function(i){return t(i,e,r,n)}};case 5:return function(e,r,n,i,s){return arguments.length>=5?t(e,r,n,i,s):function(s){return t(s,e,r,n,i)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(e){return t(e,...r)}}}},jM=e=>e,jA=e=>()=>e,jj=jA(!0),jD=jA(!1),jP=jA(void 0);function j$(e,t,r,n,i,s,a,o,l){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return n(r(t(e)));case 5:return i(n(r(t(e))));case 6:return s(i(n(r(t(e)))));case 7:return a(s(i(n(r(t(e))))));case 8:return o(a(s(i(n(r(t(e)))))));case 9:return l(o(a(s(i(n(r(t(e))))))));default:{let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return e}}}let jz="effect/GlobalValue",jL=(e,t)=>(n||(globalThis[jz]??=new Map,n=globalThis[jz]),n.has(e)||n.set(e,t()),n.get(e)),jU=e=>"string"==typeof e,jB=e=>"number"==typeof e,jq=e=>"boolean"==typeof e,jJ=e=>"bigint"==typeof e,jH=e=>"symbol"==typeof e,jW=e=>void 0===e,jK=e=>!1,jV=e=>"object"==typeof e&&null!==e,jG=e=>jV(e)||"function"==typeof e,jZ=jN(2,(e,t)=>jG(e)&&t in e),jQ=jN(2,(e,t)=>jZ(e,"_tag")&&e._tag===t),jY=e=>null!=e,jX=e=>e instanceof Uint8Array,j0=e=>e instanceof Date,j1=e=>"string"==typeof e||jZ(e,Symbol.iterator),j2=((e,t)=>r=>e(r)||t(r),e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`),j3=Symbol.for("effect/Gen/GenKind");Symbol.iterator;class j5{self;called=!1;constructor(e){this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(e){return{value:e,done:!0}}throw(e){throw e}[Symbol.iterator](){return new j5(this.self)}}class j4{_state;constructor(e,t,r,n){return null==t&&null==e?(t=0xffffffff*Math.random()>>>0,e=0):null==t&&(t=e,e=0),null==n&&null==r?(n=this._state?this._state[3]:0xf767814f,r=this._state?this._state[2]:0x14057b7e):null==n&&(n=r,r=0),this._state=new Int32Array([0,0,r>>>0,(1|(n||0))>>>0]),this._next(),j6(this._state,this._state[0],this._state[1],e>>>0,t>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(e){this._state[0]=e[0],this._state[1]=e[1],this._state[2]=e[2],this._state[3]=1|e[3]}integer(e){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%e}number(){return(0x8000000*((0x3ffffff&this._next())*1)+(0x7ffffff&this._next())*1)/0x20000000000000}_next(){var e,t,r;let n,i,s,a,o=this._state[0]>>>0,l=this._state[1]>>>0;e=this._state,t=o,n=((r=l)>>>16)*32557>>>0,i=(65535&r)*19605>>>0,s=(65535&r)*32557>>>0,a=(r>>>16)*19605+((i>>>16)+(n>>>16))>>>0,(s=s+(i=i<<16>>>0)>>>0)>>>0<i>>>0&&(a=a+1>>>0),(s=s+(n=n<<16>>>0)>>>0)>>>0<n>>>0&&(a=a+1>>>0),a=(a=a+Math.imul(r,0x5851f42d)>>>0)+Math.imul(t,0x4c957f2d)>>>0,e[0]=a,e[1]=s,j6(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let u=o>>>18,c=(l>>>18|o<<14)>>>0;u=(u^o)>>>0;let h=((c=(c^l)>>>0)>>>27|u<<5)>>>0,f=o>>>27;return(h>>>f|h<<((-f>>>0&31)>>>0))>>>0}}function j6(e,t,r,n,i){let s=t+n>>>0,a=r+i>>>0;a>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=a}let j8=Symbol.for("effect/Utils/YieldWrap");class j7{#e;constructor(e){this.#e=e}[j8](){return this.#e}}let j9=jL("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),De=e=>e(),Dt=De(()=>Error().stack)?.includes("effect_internal_function")===!0?De:e=>e(),Dr=jL(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),Dn=Symbol.for("effect/Hash"),Di=e=>{if(!0===j9.enabled)return 0;switch(typeof e){case"number":return Du(e);case"bigint":return Dc(e.toString(10));case"boolean":case"symbol":return Dc(String(e));case"string":return Dc(e);case"undefined":return Dc("undefined");case"function":case"object":if(null===e)return Dc("null");if(e instanceof Date)return Di(e.toISOString());if(e instanceof URL)return Di(e.href);else if(Dl(e))return e[Dn]();else return Ds(e);default:throw Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},Ds=e=>(Dr.has(e)||Dr.set(e,Du(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),Dr.get(e)),Da=e=>t=>53*t^e,Do=e=>0xbfffffff&e|e>>>1&0x40000000,Dl=e=>jZ(e,Dn),Du=e=>{if(e!=e||e===1/0)return 0;let t=0|e;for(t!==e&&(t^=0xffffffff*e);e>0xffffffff;)t^=e/=0xffffffff;return Do(t)},Dc=e=>{let t=5381,r=e.length;for(;r;)t=33*t^e.charCodeAt(--r);return Do(t)},Dh=e=>((e,t)=>{let r=12289;for(let n=0;n<t.length;n++)r^=j$(Dc(t[n]),Da(Di(e[t[n]])));return Do(r)})(e,Object.keys(e)),Df=e=>{let t=6151;for(let r=0;r<e.length;r++)t=j$(t,Da(Di(e[r])));return Do(t)},Dp=function(){if(1==arguments.length){let e=arguments[0];return function(t){return Object.defineProperty(e,Dn,{value:()=>t,enumerable:!1}),t}}let e=arguments[0],t=arguments[1];return Object.defineProperty(e,Dn,{value:()=>t,enumerable:!1}),t},Dd=Symbol.for("effect/Equal");function Dg(){return 1==arguments.length?e=>Dm(e,arguments[0]):Dm(arguments[0],arguments[1])}function Dm(e,t){if(e===t)return!0;let r=typeof e;if(r!==typeof t)return!1;if("object"===r||"function"===r){if(null!==e&&null!==t){if(Db(e)&&Db(t))if(Di(e)===Di(t)&&e[Dd](t))return!0;else return!!j9.enabled&&!!j9.tester&&j9.tester(e,t);else if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString();else if(e instanceof URL&&t instanceof URL)return e.href===t.href}if(j9.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((e,r)=>Dm(e,t[r]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){let r=Object.keys(e),n=Object.keys(t);if(r.length===n.length){for(let n of r)if(!(n in t&&Dm(e[n],t[n])))return!!j9.tester&&j9.tester(e,t);return!0}}return!!j9.tester&&j9.tester(e,t)}}return!!j9.enabled&&!!j9.tester&&j9.tester(e,t)}let Db=e=>jZ(e,Dd),Dy=Symbol.for("nodejs.util.inspect.custom"),Dv=e=>{try{let t;if(jZ(e,"toJSON")&&(t=e.toJSON,"function"==typeof t)&&0===e.toJSON.length)return e.toJSON();if(Array.isArray(e))return e.map(Dv)}catch{return{}}return DC(e)},DS={toJSON(){return Dv(this)},[Dy](){return this.toJSON()},toString(){return JSON.stringify(this.toJSON(),null,2)}};class Dx{[Dy](){return this.toJSON()}toString(){return JSON.stringify(this.toJSON(),null,2)}}let D_=(e,t=2)=>{if("string"==typeof e)return e;try{return"object"==typeof e?Dw(e,t):String(e)}catch{return String(e)}},Dw=(e,t)=>{let r=[],n=JSON.stringify(e,(e,t)=>"object"==typeof t&&null!==t?r.includes(t)?void 0:r.push(t)&&(void 0!==DE.fiberRefs&&DO(t)?t[Dk](DE.fiberRefs):t):t,t);return r=void 0,n},Dk=Symbol.for("effect/Inspectable/Redactable"),DO=e=>"object"==typeof e&&null!==e&&Dk in e,DE=jL("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),DC=e=>DO(e)&&void 0!==DE.fiberRefs?e[Dk](DE.fiberRefs):e,DF=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let e=0,n=t.length;e<n;e++)r=t[e](r);return r}}},DI="Async",DT="Commit",DR="Failure",DN="OnFailure",DM="OnSuccess",DA="OnSuccessAndFailure",Dj="Success",DD="Sync",DP="UpdateRuntimeFlags",D$="While",Dz="Iterator",DL="WithRuntime",DU="Yield",DB="RevertFlags",Dq=()=>"3.18.4",DJ=Symbol.for("effect/Effect"),DH=Symbol.for("effect/Stream"),DW=Symbol.for("effect/Sink"),DK=Symbol.for("effect/Channel"),DV={_R:e=>e,_E:e=>e,_A:e=>e,_V:Dq()},DG={[DJ]:DV,[DH]:DV,[DW]:{_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},[DK]:{_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},[Dd](e){return this===e},[Dn](){return Dp(this,Ds(this))},[Symbol.iterator](){return new j5(new j7(this))},pipe(){return DF(this,arguments)}},DZ={[Dn](){return Dp(this,Dh(this))},[Dd](e){let t=Object.keys(this),r=Object.keys(e);if(t.length!==r.length)return!1;for(let r of t)if(!(r in e&&Dg(this[r],e[r])))return!1;return!0}},DQ={...DG,_op:DT},DY={...DQ,...DZ},DX=function(){function e(){}return e.prototype=DQ,e}(),D0=function(){function e(){}return e.prototype=DY,e}(),D1=Symbol.for("effect/Option"),D2={...DG,[D1]:{_A:e=>e},[Dy](){return this.toJSON()},toString(){return JSON.stringify(this.toJSON(),null,2)}},D3=Object.assign(Object.create(D2),{_tag:"Some",_op:"Some",[Dd](e){return D6(e)&&D7(e)&&Dg(this.value,e.value)},[Dn](){return Dp(this,Da(Di(this._tag))(Di(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:Dv(this.value)}}}),D5=Di("None"),D4=Object.assign(Object.create(D2),{_tag:"None",_op:"None",[Dd]:e=>D6(e)&&D8(e),[Dn]:()=>D5,toJSON(){return{_id:"Option",_tag:this._tag}}}),D6=e=>jZ(e,D1),D8=e=>"None"===e._tag,D7=e=>"Some"===e._tag,D9=Object.create(D4),Pe=e=>{let t=Object.create(D3);return t.value=e,t},Pt=Symbol.for("effect/Context/Tag"),Pr=Symbol.for("effect/Context/Reference"),Pn=Symbol.for("effect/STM"),Pi={...DG,_op:"Tag",[Pn]:DV,[Pt]:{_Service:e=>e,_Identifier:e=>e},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[Dy](){return this.toJSON()},of:e=>e,context(e){return Ph(this,e)}},Ps={...Pi,[Pr]:Pr},Pa=Symbol.for("effect/Context"),Po={[Pa]:{_Services:e=>e},[Dd](e){if(Pu(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!Dg(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[Dn](){return Dp(this,Du(this.unsafeMap.size))},pipe(){return DF(this,arguments)},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(Dv)}},[Dy](){return this.toJSON()}},Pl=e=>{let t=Object.create(Po);return t.unsafeMap=e,t},Pu=e=>jZ(e,Pa),Pc=Pl(new Map),Ph=(e,t)=>Pl(new Map([[e.key,t]])),Pf=jN(3,(e,t,r)=>{let n=new Map(e.unsafeMap);return n.set(t.key,r),Pl(n)}),Pp=jL("effect/Context/defaultValueCache",()=>new Map),Pd=e=>{if(Pp.has(e.key))return Pp.get(e.key);let t=e.defaultValue();return Pp.set(e.key,t),t},Pg=jN(2,(e,t)=>{if(!e.unsafeMap.has(t.key)){if(Pr in t)return Pd(t);throw(e=>{let t=Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){let r=e.stack.split("\n");if(r.length>2){let e=r[2].match(/at (.*)/);e&&(t.message=t.message+` (defined at ${e[1]})`)}}if(t.stack){let e=t.stack.split("\n");e.splice(1,3),t.stack=e.join("\n")}return t})(t)}return e.unsafeMap.get(t.key)}),Pm=jN(2,(e,t)=>e.unsafeMap.has(t.key)?Pe(e.unsafeMap.get(t.key)):jZ(t,Pr)?Pe(Pd(t)):D9),Pb=jN(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[e,n]of t.unsafeMap)r.set(e,n);return Pl(r)}),Py=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=Error();Error.stackTraceLimit=t;let n=Object.create(Pi);return Object.defineProperty(n,"stack",{get:()=>r.stack}),n.key=e,n},Pv=e=>()=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=Error();function n(){}return Error.stackTraceLimit=t,Object.setPrototypeOf(n,Pi),n.key=e,Object.defineProperty(n,"stack",{get:()=>r.stack}),n},PS=()=>(e,t)=>{let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=Error();function i(){}return Error.stackTraceLimit=r,Object.setPrototypeOf(i,Ps),i.key=e,i.defaultValue=t.defaultValue,Object.defineProperty(i,"stack",{get:()=>n.stack}),i},Px=e=>(t,r)=>t===r||e(t,r),P_=(e,t)=>e===t,Pw=jN(2,(e,t)=>Px((r,n)=>e(t(r),t(n)))),Pk=Pw(P_,e=>e.getTime()),PO=e=>Px((t,r)=>{if(t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}),PE=Symbol.for("effect/Either"),PC={...DG,[PE]:{_R:e=>e},[Dy](){return this.toJSON()},toString(){return JSON.stringify(this.toJSON(),null,2)}},PF=Object.assign(Object.create(PC),{_tag:"Right",_op:"Right",[Dd](e){return PT(e)&&PN(e)&&Dg(this.right,e.right)},[Dn](){return Da(Di(this._tag))(Di(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:Dv(this.right)}}}),PI=Object.assign(Object.create(PC),{_tag:"Left",_op:"Left",[Dd](e){return PT(e)&&PR(e)&&Dg(this.left,e.left)},[Dn](){return Da(Di(this._tag))(Di(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:Dv(this.left)}}}),PT=e=>jZ(e,PE),PR=e=>"Left"===e._tag,PN=e=>"Right"===e._tag,PM=e=>{let t=Object.create(PI);return t.left=e,t},PA=e=>{let t=Object.create(PF);return t.right=e,t},Pj=jN(2,(e,t)=>D8(e)?PM(t()):PA(e.value)),PD=jN(2,(e,{onLeft:t,onRight:r})=>PR(e)?PM(t(e.left)):PA(r(e.right))),PP=jN(2,(e,t)=>PR(e)?PM(t(e.left)):PA(e.right)),P$=jN(2,(e,t)=>PN(e)?PA(t(e.right)):PM(e.left)),Pz=jN(2,(e,{onLeft:t,onRight:r})=>PR(e)?t(e.left):r(e.right)),PL=Pz({onLeft:jM,onRight:jM}),PU=jN(2,(e,t)=>{if(PN(e))return e.right;throw t(e.left)}),PB=PU(()=>Error("getOrThrow called on a Left")),Pq=jN(2,(e,t)=>PR(e)?PM(e.left):t(e.right)),PJ=((e,t,r)=>Pq(e,e=>P$(t,t=>r(e,t))),e=>e.length>0),PH=e=>(t,r)=>t===r?0:e(t,r),PW=PH((e,t)=>e<t?-1:1),PK=PH((e,t)=>e<t?-1:1),PV=jN(2,(e,t)=>PH((r,n)=>e(t(r),t(n)))),PG=e=>jN(2,(t,r)=>1===e(t,r)),PZ=e=>jN(2,(t,r)=>t===r||1>e(t,r)?t:r),PQ=e=>jN(2,(t,r)=>t===r||e(t,r)>-1?t:r),PY=()=>D9,PX=jN(2,(e,{onNone:t,onSome:r})=>D8(e)?t():r(e.value)),P0=jN(2,(e,t)=>D8(e)?t():e.value),P1=jN(2,(e,t)=>D8(e)?t():e),P2=jN(2,(e,t)=>D8(e)?Pe(t()):e),P3=e=>null==e?PY():Pe(e),P5=P0(jP),P4=e=>(...t)=>{try{return Pe(e(...t))}catch{return PY()}},P6=jN(2,(e,t)=>{if(D7(e))return e.value;throw t()}),P8=P6(()=>Error("getOrThrow called on a None")),P7=jN(2,(e,t)=>D8(e)?PY():Pe(t(e.value))),P9=jN(2,(e,t)=>D8(e)?PY():t(e.value)),$e=jN(2,(e,t)=>D8(e)?PY():P3(t(e.value))),$t=((e,t)=>P9(e,e=>P7(t(e),()=>e)),e=>Px((t,r)=>D8(t)?D8(r):!D8(r)&&e(t.value,r.value))),$r=jN(2,(e,t)=>!D8(e)&&Dg(e.value,t)),$n=jN(2,(e,t)=>!D8(e)&&t(e.value)),$i=e=>(t,r)=>D8(t)?r:D8(r)?t:Pe(e(t.value,r.value)),$s=(...e)=>e,$a=((e,t)=>$a(t,e),jN(2,(e,t)=>({[Symbol.iterator](){let r,n=e[Symbol.iterator](),i=!1;return{next(){if(!i){let e=n.next();return e.done?(i=!0,(r=t[Symbol.iterator]()).next()):e}return r.next()}}}}))),$o=jN(2,(e,t)=>{let r=0;for(let n of e){let e=t(n,r);if(jq(e)){if(e)return Pe(n)}else if(D7(e))return e;r++}return PY()});(e,t,r)=>({[Symbol.iterator](){let n=e[Symbol.iterator](),i=t[Symbol.iterator]();return{next(){let e=n.next(),t=i.next();return e.done||t.done?{done:!0,value:void 0}:{done:!1,value:r(e.value,t.value)}}}}});()=>$l;let $l={next:()=>({done:!0,value:void 0})},$u=jN(2,(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),n=0;return{next(){let e=r.next();return e.done?{done:!0,value:void 0}:{done:!1,value:t(e.value,n++)}}}}})),$c=jN(2,(e,t)=>$h($u(e,t))),$h=e=>({[Symbol.iterator](){let t,r=e[Symbol.iterator]();return{next:function e(){if(void 0===t){let e=r.next();if(e.done)return e;t=e.value[Symbol.iterator]()}let n=t.next();return n.done?(t=void 0,e()):n}}}});(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),n=0;return{next(){let e=r.next();for(;!e.done;){let i=t(e.value,n++);if(D7(i))return{done:!1,value:i.value};e=r.next()}return{done:!0,value:void 0}}}}});(e,t,r)=>$c(e,e=>$u(t,t=>r(e,t)));let $f=jN(2,(e,t)=>Object.prototype.hasOwnProperty.call(e,t)),$p=((e,t)=>$f(e,t)?Pe(e[t]):PY(),jN(2,(e,t)=>{if(!$f(e,t))return{...e};let r={...e};return delete r[t],r})),$d=jN(2,(e,t)=>{let r={...e};for(let n of $g(e))r[n]=t(e[n],n);return r}),$g=e=>Object.keys(e),$m=jN(3,(e,t,r)=>({...e,[t]:r})),$b=jN(2,(e,t)=>{let r=Math.max(1,Math.floor(e)),n=Array(r);for(let e=0;e<r;e++)n[e]=t(e);return n}),$y=e=>Array.isArray(e)?e:Array.from(e),$v=e=>Array.isArray(e)?e:[e],$S=jN(2,(e,{onEmpty:t,onNonEmpty:r})=>$E(e)?r(e):t()),$x=jN(2,(e,{onEmpty:t,onNonEmpty:r})=>$E(e)?r($N(e),$j(e)):t()),$_=jN(2,(e,t)=>[t,...e]),$w=jN(2,(e,t)=>[...e,t]),$k=jN(2,(e,t)=>$y(e).concat($y(t))),$O=Array.isArray,$E=PJ,$C=(e,t)=>e<0||e>=t.length,$F=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),$I=jN(2,(e,t)=>{let r=Math.floor(t);return $C(r,e)?PY():Pe(e[r])}),$T=jN(2,(e,t)=>{let r=Math.floor(t);if($C(r,e))throw Error(`Index ${r} out of bounds`);return e[r]}),$R=$I(0),$N=$T(0),$M=e=>$E(e)?Pe($A(e)):PY(),$A=e=>e[e.length-1],$j=e=>e.slice(1),$D=((e,t)=>{let r=$y(e);return r.slice(0,$F(t,r))},jN(2,(e,t)=>$W(e,((e,t)=>{let r=0;for(let n of e){if(!t(n,r))break;r++}return r})(e,t)))),$P=jN(2,(e,t)=>{let r=$y(e);return r.slice($F(t,r),r.length)}),$$=((e,t)=>{let r=$y(e);for(let e=r.length-1;e>=0;e--){let n=r[e],i=t(n,e);if(jq(i)){if(i)return Pe(n)}else if(D7(i))return i}return PY()},jN(3,(e,t,r)=>{let n=Array.from(e);if($C(t,n))return n;let i=r(n[t]);return n[t]=i,n})),$z=((e,t,r)=>{let n=$y(e);if($C(t,n))return PY();let i=Array.isArray(e)?e.slice():n,s=r(n[t]);return i[t]=s,Pe(i)},e=>Array.from(e).reverse()),$L=jN(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r}),$U=jN(2,(e,t)=>$B(e,t,$s)),$B=jN(3,(e,t,r)=>{let n=$y(e),i=$y(t);if($E(n)&&$E(i)){let e=[r($N(n),$N(i))],t=Math.min(n.length,i.length);for(let s=1;s<t;s++)e[s]=r(n[s],i[s]);return e}return[]}),$q=((e,t)=>[t($N(e)),...$j(e)],jN(2,(e,t)=>{let r=$y(e);if($E(r)){let n=r.length,i=Math.round(t)%n;if($C(Math.abs(i),r)||0===i)return $V(r);if(!(i<0))return $q(e,i-n);{let[e,t]=$K(r,-i);return $k(t,e)}}return[]})),$J=e=>jN(2,(t,r)=>{for(let n of t)if(e(r,n))return!0;return!1}),$H=jN(2,(e,t)=>{let r=$y(e);if($E(r)){let[e,n]=t(r),i=[e],s=n;for(;PJ(s);){let[e,r]=t(s);i.push(e),s=r}return i}return[]}),$W=jN(2,(e,t)=>{let r=Array.from(e),n=Math.floor(t);return $E(r)?n>=1?$K(r,n):[[],r]:[r,[]]}),$K=jN(2,(e,t)=>{let r=Math.max(1,Math.floor(t));return r>=e.length?[$V(e),[]]:[$_(e.slice(1,r),$N(e)),e.slice(r)]}),$V=e=>e.slice();(e,t)=>{let r=$y(e);return $E(r)?$H(r,$K(t)):[]};let $G=jN(3,(e,t,r)=>{let n=$y(e),i=$y(t);return $E(n)?$E(i)?zn(r)($k(n,i)):n:i}),$Z=jN(2,(e,t)=>$G(e,t,Dg)),$Q=e=>{let t=$J(e);return jN(2,(e,r)=>$y(e).filter(e=>t(r,e)))},$Y=$Q(Dg),$X=(w=$J(Dg),jN(2,(e,t)=>$y(e).filter(e=>!w(t,e))),()=>[]),$0=e=>[e],$1=jN(2,(e,t)=>e.map(t)),$2=jN(2,(e,t)=>{if(0===e.length)return[];let r=[];for(let n=0;n<e.length;n++){let i=t(e[n],n);for(let e=0;e<i.length;e++)r.push(i[e])}return r}),$3=$2(jM),$5=jN(2,(e,t)=>{let r=$y(e),n=[];for(let e=0;e<r.length;e++){let i=t(r[e],e);D7(i)&&n.push(i.value)}return n}),$4=jN(2,(e,t)=>{let r=0,n=[];for(let i of e){let e=t(i,r);if(D7(e))n.push(e.value);else break;r++}return n}),$6=jN(2,(e,t)=>{let r=[],n=[],i=$y(e);for(let e=0;e<i.length;e++){let s=t(i[e],e);PR(s)?r.push(s.left):n.push(s.right)}return[r,n]}),$8=$5(jM),$7=jN(2,(e,t)=>{let r=$y(e),n=[];for(let e=0;e<r.length;e++)t(r[e],e)&&n.push(r[e]);return n}),$9=((e,t)=>{let r=[],n=[],i=$y(e);for(let e=0;e<i.length;e++)t(i[e],e)?n.push(i[e]):r.push(i[e]);return[r,n]},jN(3,(e,t,r)=>$y(e).reduce((e,t,n)=>r(e,t,n),t))),ze=jN(3,(e,t,r)=>$y(e).reduceRight((e,t,n)=>r(e,t,n),t)),zt=((e,t)=>e.every(t),(e,t)=>{let r,n=[],i=e;for(;D7(r=t(i));){let[e,t]=r.value;n.push(e),i=t}return n}),zr=PO,zn=jN(2,(e,t)=>{let r=$y(e);if($E(r)){let e=[$N(r)];for(let n of $j(r))e.every(e=>!t(n,e))&&e.push(n);return e}return[]}),zi=e=>zn(e,Dg),zs=jN(2,(e,t)=>$y(e).join(t)),za=jN(3,(e,t,r)=>{let n=0,i=t,s=[];for(let t of e){let e=r(i,t,n);i=e[0],s.push(e[1]),n++}return[i,s]}),zo=((e,t,r)=>$2(e,e=>$1(t,t=>r(e,t))),Symbol.for("effect/Chunk")),zl=[],zu=Px((e,t)=>e.length===t.length&&zv(e).every((e,r)=>Dg(e,zk(t,r)))),zc={[zo]:{_A:e=>e},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"Chunk",values:zv(this).map(Dv)}},[Dy](){return this.toJSON()},[Dd](e){return zf(e)&&zu(this,e)},[Dn](){return Dp(this,Df(zv(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return zl[Symbol.iterator]();default:return zv(this)[Symbol.iterator]()}},pipe(){return DF(this,arguments)}},zh=e=>{let t=Object.create(zc);switch(t.backing=e,e._tag){case"IEmpty":t.length=0,t.depth=0,t.left=t,t.right=t;break;case"IConcat":t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break;case"IArray":t.length=e.array.length,t.depth=0,t.left=zp,t.right=zp;break;case"ISingleton":t.length=1,t.depth=0,t.left=zp,t.right=zp;break;case"ISlice":t.length=e.length,t.depth=e.chunk.depth+1,t.left=zp,t.right=zp}return t},zf=e=>jZ(e,zo),zp=zh({_tag:"IEmpty"}),zd=()=>zp,zg=(...e)=>zw(e),zm=e=>zh({_tag:"ISingleton",a:e}),zb=e=>zf(e)?e:z_($y(e)),zy=(e,t,r)=>{switch(e.backing._tag){case"IArray":!function(e,t,r,n,i){for(let t=0;t<Math.min(e.length,0+i);t++)r[n+t-0]=e[t]}(e.backing.array,0,t,r,e.length);break;case"IConcat":zy(e.left,t,r),zy(e.right,t,r+e.left.length);break;case"ISingleton":t[r]=e.backing.a;break;case"ISlice":{let n=0,i=r;for(;n<e.length;)t[i]=zk(e,n),n+=1,i+=1}}},zv=e=>{switch(e.backing._tag){case"IEmpty":return zl;case"IArray":return e.backing.array;default:{let t=Array(e.length);return zy(e,t,0),e.backing={_tag:"IArray",array:t},e.left=zp,e.right=zp,e.depth=0,t}}},zS=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return zh({_tag:"IArray",array:$z(e.backing.array)});case"IConcat":return zh({_tag:"IConcat",left:zS(e.backing.right),right:zS(e.backing.left)});case"ISlice":return z_($z(zv(e)))}},zx=jN(2,(e,t)=>t<0||t>=e.length?PY():Pe(zk(e,t))),z_=e=>0===e.length?zd():1===e.length?zm(e[0]):zh({_tag:"IArray",array:e}),zw=e=>z_(e),zk=jN(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw Error("Index out of bounds");case"ISingleton":if(0!==t)throw Error("Index out of bounds");return e.backing.a;case"IArray":if(t>=e.length||t<0)throw Error("Index out of bounds");return e.backing.array[t];case"IConcat":return t<e.left.length?zk(e.left,t):zk(e.right,t-e.left.length);case"ISlice":return zk(e.backing.chunk,t+e.backing.offset)}}),zO=jN(2,(e,t)=>zT(e,zm(t))),zE=jN(2,(e,t)=>zT(zm(t),e)),zC=jN(2,(e,t)=>{if(t<=0)return zp;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return zh({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":if(t>e.left.length)return zh({_tag:"IConcat",left:e.left,right:zC(e.right,t-e.left.length)});return zC(e.left,t);default:return zh({_tag:"ISlice",chunk:e,offset:0,length:t})}}),zF=jN(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return zp;switch(e.backing._tag){case"ISlice":return zh({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":if(t>e.left.length)return zF(e.right,t-e.left.length);return zh({_tag:"IConcat",left:zF(e.left,t),right:e.right});default:return zh({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}}),zI=jN(2,(e,t)=>{let r=zv(e),n=r.length,i=0;for(;i<n&&t(r[i]);)i++;return zF(e,i)}),zT=jN(2,(e,t)=>{if("IEmpty"===e.backing._tag)return t;if("IEmpty"===t.backing._tag)return e;let r=t.depth-e.depth;if(1>=Math.abs(r))return zh({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let r=zT(e.right,t);return zh({_tag:"IConcat",left:e.left,right:r})}else{let r=zT(e.right.right,t);if(r.depth===e.depth-3){let t=zh({_tag:"IConcat",left:e.right.left,right:r});return zh({_tag:"IConcat",left:e.left,right:t})}{let t=zh({_tag:"IConcat",left:e.left,right:e.right.left});return zh({_tag:"IConcat",left:t,right:r})}}if(t.right.depth>=t.left.depth)return zh({_tag:"IConcat",left:zT(e,t.left),right:t.right});{let r=zT(e,t.left.left);if(r.depth===t.depth-3){let e=zh({_tag:"IConcat",left:r,right:t.left.right});return zh({_tag:"IConcat",left:e,right:t.right})}{let e=zh({_tag:"IConcat",left:t.left.right,right:t.right});return zh({_tag:"IConcat",left:r,right:e})}}}),zR=jN(2,(e,t)=>z_($5(e,t))),zN=jN(2,(e,t)=>z_($7(e,t))),zM=((e,t)=>z_($4(e,t)),jN(2,(e,t)=>{if("ISingleton"===e.backing._tag)return t(e.backing.a,0);let r=zp,n=0;for(let i of e)r=zT(r,t(i,n++));return r})),zA=jN(2,(e,t)=>zv(e).forEach(t)),zj=zM(jM),zD=((e,t)=>{let r=[],n=[];return zv(e).forEach(e=>{n.push(e),n.length>=t&&(r.push(z_(n)),n=[])}),n.length>0&&r.push(z_(n)),z_(r)},e=>0===e.length),zP=e=>e.length>0,z$=zx(0),zz=e=>zk(e,0),zL=e=>zk(e,e.length-1),zU=jN(2,(e,t)=>"ISingleton"===e.backing._tag?zm(t(e.backing.a,0)):z_(j$(zv(e),$1((e,r)=>t(e,r))))),zB=jN(3,(e,t,r)=>{let[n,i]=za(e,t,r);return[n,z_(i)]}),zq=((e,t)=>z_($L(zv(e),t)),jN(2,(e,t)=>[zC(e,t),zF(e,t)])),zJ=jN(2,(e,t)=>{let r=0;for(let n of zv(e))if(t(n))break;else r++;return zq(e,r)}),zH=e=>zF(e,1),zW=jN(2,(e,t)=>zF(e,e.length-t)),zK=jN(2,(e,t)=>{let r=[];for(let n of zv(e))if(t(n))r.push(n);else break;return z_(r)}),zV=jN(3,(e,t,r)=>z_($B(e,t,r))),zG=jN(3,(e,t,r)=>t<0||t>=e.length?PY():Pe(z_($$(zv(e),t,r)))),zZ=((e,t,r)=>P0(zG(e,t,r),()=>e),jN(2,(e,t)=>zb($b(e,t)))),zQ=jN(2,(e,t)=>$y(e).some(t));function zY(e,t){var r;return r=e&t-1,r-=r>>1&0x55555555,r=(r=(0x33333333&r)+(r>>2&0x33333333))+(r>>4)&0xf0f0f0f,r+=r>>8,127&(r+=r>>16)}let zX=(e,t)=>({value:e,previous:t});function z0(e,t,r,n){let i=n;if(!e){let e=n.length;i=Array(e);for(let t=0;t<e;++t)i[t]=n[t]}return i[t]=r,i}function z1(e,t,r){let n=r.length-1,i=0,s=0,a=r;if(e)i=s=t;else for(a=Array(n);i<t;)a[s++]=r[i++];for(++i;i<=n;)a[s++]=r[i++];return e&&(a.length=n),a}class z2{_tag="EmptyNode";modify(e,t,r,n,i,s){let a=r(PY());return D8(a)?new z2:(++s.value,new z4(e,n,i,a))}}function z3(e){return jQ(e,"EmptyNode")}function z5(e,t){return!z3(e)&&t===e.edit}class z4{edit;hash;key;value;_tag="LeafNode";constructor(e,t,r,n){this.edit=e,this.hash=t,this.key=r,this.value=n}modify(e,t,r,n,i,s){if(Dg(i,this.key)){let t=r(this.value);return t===this.value?this:D8(t)?(--s.value,new z2):z5(this,e)?(this.value=t,this):new z4(e,n,i,t)}let a=r(PY());return D8(a)?this:(++s.value,z9(e,t,this.hash,this,n,new z4(e,n,i,a)))}}class z6{edit;hash;children;_tag="CollisionNode";constructor(e,t,r){this.edit=e,this.hash=t,this.children=r}modify(e,t,r,n,i,s){if(n===this.hash){let t=z5(this,e),n=this.updateCollisionList(t,e,this.hash,this.children,r,i,s);return n===this.children?this:n.length>1?new z6(e,this.hash,n):n[0]}let a=r(PY());return D8(a)?this:(++s.value,z9(e,t,this.hash,this,n,new z4(e,n,i,a)))}updateCollisionList(e,t,r,n,i,s,a){let o=n.length;for(let l=0;l<o;++l){let o=n[l];if("key"in o&&Dg(s,o.key)){let u=o.value,c=i(u);if(c===u)return n;if(D8(c))return--a.value,z1(e,l,n);return z0(e,l,new z4(t,r,s,c),n)}}let l=i(PY());return D8(l)?n:(++a.value,z0(e,o,new z4(t,r,s,l),n))}}class z8{edit;mask;children;_tag="IndexedNode";constructor(e,t,r){this.edit=e,this.mask=t,this.children=r}modify(e,t,r,n,i,s){let a,o=this.mask,l=this.children,u=n>>>t&31,c=1<<u,h=zY(o,c),f=o&c,p=z5(this,e);if(!f){let a=new z2().modify(e,t+5,r,n,i,s);return a?l.length>=16?function(e,t,r,n,i){let s=[],a=n,o=0;for(let e=0;a;++e)1&a&&(s[e]=i[o++]),a>>>=1;return s[t]=r,new z7(e,o+1,s)}(e,u,a,o,l):new z8(e,o|c,function(e,t,r,n){let i=n.length;if(e){let e=i;for(;e>=t;)n[e--]=n[e];return n[t]=r,n}let s=0,a=0,o=Array(i+1);for(;s<t;)o[a++]=n[s++];for(o[t]=r;s<i;)o[++a]=n[s++];return o}(p,h,a,l)):this}let d=l[h],g=d.modify(e,t+5,r,n,i,s);if(d===g)return this;let m=o;if(z3(g)){var b;if(!(m&=~c))return new z2;if(l.length<=2&&(z3(b=l[1^h])||"LeafNode"===b._tag||"CollisionNode"===b._tag))return l[1^h];a=z1(p,h,l)}else a=z0(p,h,g,l);return p?(this.mask=m,this.children=a,this):new z8(e,m,a)}}class z7{edit;size;children;_tag="ArrayNode";constructor(e,t,r){this.edit=e,this.size=t,this.children=r}modify(e,t,r,n,i,s){let a,o=this.size,l=this.children,u=n>>>t&31,c=l[u],h=(c||new z2).modify(e,t+5,r,n,i,s);if(c===h)return this;let f=z5(this,e);if(z3(c)&&!z3(h))++o,a=z0(f,u,h,l);else if(!z3(c)&&z3(h)){if(--o<=8)return function(e,t,r,n){let i=Array(t-1),s=0,a=0;for(let e=0,t=n.length;e<t;++e)if(e!==r){let t=n[e];t&&!z3(t)&&(i[s++]=t,a|=1<<e)}return new z8(e,a,i)}(e,o,u,l);a=z0(f,u,new z2,l)}else a=z0(f,u,h,l);return f?(this.size=o,this.children=a,this):new z7(e,o,a)}}function z9(e,t,r,n,i,s){let a,o=t;for(;;){let t=function(e,t,r,n,i,s){if(r===i)return new z6(e,r,[s,n]);let a=r>>>t&31,o=i>>>t&31;return a===o?t=>new z8(e,1<<a|1<<o,[t]):new z8(e,1<<a|1<<o,a<o?[n,s]:[s,n])}(e,o,r,n,i,s);if("function"==typeof t)a=zX(t,a),o+=5;else{let e=t;for(;null!=a;)e=a.value(e),a=a.previous;return e}}}let Le="effect/HashMap",Lt=Symbol.for(Le),Lr={[Lt]:Lt,[Symbol.iterator](){return new Li(this,(e,t)=>[e,t])},[Dn](){let e=Di(Le);for(let t of this)e^=j$(Di(t[0]),Da(Di(t[1])));return Dp(this,e)},[Dd](e){if(Lu(e)){if(e._size!==this._size)return!1;for(let t of this){let r=j$(e,Lh(t[0],Di(t[0])));if(D8(r)||!Dg(t[1],r.value))return!1}return!0}return!1},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"HashMap",values:Array.from(this).map(Dv)}},[Dy](){return this.toJSON()},pipe(){return DF(this,arguments)}},Ln=(e,t,r,n)=>{let i=Object.create(Lr);return i._editable=e,i._edit=t,i._root=r,i._size=n,i};class Li{map;f;v;constructor(e,t){this.map=e,this.f=t,this.v=La(this.map._root,this.f,void 0)}next(){if(D8(this.v))return{done:!0,value:void 0};let e=this.v.value;return this.v=Ls(e.cont),{done:!1,value:e.value}}[Symbol.iterator](){return new Li(this.map,this.f)}}let Ls=e=>e?Lo(e[0],e[1],e[2],e[3],e[4]):PY(),La=(e,t,r)=>{switch(e._tag){case"LeafNode":if(D7(e.value))return Pe({value:t(e.key,e.value.value),cont:r});return Ls(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let n=e.children;return Lo(n.length,n,0,t,r)}default:return Ls(r)}},Lo=(e,t,r,n,i)=>{for(;r<e;){let s=t[r++];if(s&&!z3(s))return La(s,n,[e,t,r,n,i])}return Ls(i)},Ll=Ln(!1,0,new z2,0),Lu=e=>jZ(e,Lt),Lc=jN(2,(e,t)=>Lh(e,t,Di(t))),Lh=jN(3,(e,t,r)=>{let n=e._root,i=0;for(;;)switch(n._tag){case"LeafNode":return Dg(t,n.key)?n.value:PY();case"CollisionNode":if(r===n.hash){let e=n.children;for(let r=0,n=e.length;r<n;++r){let n=e[r];if("key"in n&&Dg(t,n.key))return n.value}}return PY();case"IndexedNode":{let e=1<<(r>>>i&31);if(n.mask&e){n=n.children[zY(n.mask,e)],i+=5;break}return PY()}case"ArrayNode":if(n=n.children[r>>>i&31]){i+=5;break}return PY();default:return PY()}}),Lf=jN(2,(e,t)=>D7(Lh(e,t,Di(t)))),Lp=jN(3,(e,t,r)=>Ly(e,t,()=>Pe(r))),Ld=jN(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:Ln(e._editable,e._edit,t,r)),Lg=e=>new Li(e,e=>e),Lm=e=>Ln(!0,e._edit+1,e._root,e._size),Lb=e=>(e._editable=!1,e),Ly=((e,t)=>{let r=Lm(e);return t(r),Lb(r)},jN(3,(e,t,r)=>Lv(e,t,Di(t),r))),Lv=jN(4,(e,t,r,n)=>{let i={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,n,r,t,i);return j$(e,Ld(s,i.value))}),LS=jN(2,(e,t)=>Ly(e,t,PY)),Lx=jN(2,(e,t)=>Lw(e,Ll,(e,r,n)=>Lp(e,n,t(r,n)))),L_=jN(2,(e,t)=>Lw(e,void 0,(e,r,n)=>t(r,n))),Lw=jN(3,(e,t,r)=>{let n,i=e._root;if("LeafNode"===i._tag)return D7(i.value)?r(t,i.value.value,i.key):t;if("EmptyNode"===i._tag)return t;let s=[i.children];for(;n=s.pop();)for(let e=0,i=n.length;e<i;){let i=n[e++];i&&!z3(i)&&("LeafNode"===i._tag?D7(i.value)&&(t=r(t,i.value.value,i.key)):s.push(i.children))}return t}),Lk=((e,t)=>{for(let r of e)if(t(r[1],r[0]))return Pe(r);return PY()},"effect/HashSet"),LO=Symbol.for(Lk),LE={[LO]:LO,[Symbol.iterator](){return Lg(this._keyMap)},[Dn](){return Dp(this,Da(Di(this._keyMap))(Di(Lk)))},[Dd](e){return!!LF(e)&&this._keyMap._size===e._keyMap._size&&Dg(this._keyMap,e._keyMap)},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"HashSet",values:Array.from(this).map(Dv)}},[Dy](){return this.toJSON()},pipe(){return DF(this,arguments)}},LC=e=>{let t=Object.create(LE);return t._keyMap=e,t},LF=e=>jZ(e,LO),LI=LC(Ll),LT=()=>LI,LR=jN(2,(e,t)=>Lf(e._keyMap,t)),LN=jN(2,(e,t)=>{let r=!1;for(let n of e)if(r=t(n))break;return r}),LM=jN(2,(e,t)=>!LN(e,e=>!t(e))),LA=e=>LC(Lm(e._keyMap)),Lj=e=>(e._keyMap._editable=!1,e),LD=jN(2,(e,t)=>{let r=LA(e);return t(r),Lj(r)}),LP=jN(2,(e,t)=>e._keyMap._editable?(Lp(t,!0)(e._keyMap),e):LC(Lp(t,!0)(e._keyMap))),L$=jN(2,(e,t)=>e._keyMap._editable?(LS(t)(e._keyMap),e):LC(LS(t)(e._keyMap))),Lz=jN(2,(e,t)=>LD(e,e=>{for(let r of t)L$(e,r)})),LL=jN(2,(e,t)=>LD(LT(),r=>{for(let n of(LU(e,e=>LP(r,e)),t))LP(r,n)})),LU=jN(2,(e,t)=>L_(e._keyMap,(e,r)=>t(r))),LB=jN(3,(e,t,r)=>Lw(e._keyMap,t,(e,t,n)=>r(e,n))),Lq=(...e)=>{let t=LA(LT());for(let r of e)LP(t,r);return Lj(t)},LJ=e=>e._keyMap._size,LH="Empty",LW="Fail",LK="Interrupt",LV="Parallel",LG="Sequential",LZ="effect/Cause",LQ=Symbol.for(LZ),LY={[LQ]:{_E:e=>e},[Dn](){return j$(Di(LZ),Da(Di(Ul(this))),Dp(this))},[Dd](e){return L4(e)&&Uo(this,e)},pipe(){return DF(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:Dv(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:Dv(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:Dv(this.left),right:Dv(this.right)}}},toString(){return Uy(this)},[Dy](){return this.toJSON()}},LX=((k=Object.create(LY))._tag=LH,k),L0=e=>{let t=Object.create(LY);return t._tag=LW,t.error=e,t},L1=e=>{let t=Object.create(LY);return t._tag="Die",t.defect=e,t},L2=e=>{let t=Object.create(LY);return t._tag=LK,t.fiberId=e,t},L3=(e,t)=>{let r=Object.create(LY);return r._tag=LV,r.left=e,r.right=t,r},L5=(e,t)=>{let r=Object.create(LY);return r._tag=LG,r.left=e,r.right=t,r},L4=e=>jZ(e,LQ),L6=e=>e._tag===LH||Um(e,!0,(e,t)=>{switch(t._tag){case LH:return Pe(e);case"Die":case LW:case LK:return Pe(!1);default:return PY()}}),L8=e=>Ub(void 0,Uf)(e),L7=e=>zS(Um(e,zd(),(e,t)=>"Die"===t._tag?Pe(j$(e,zE(t.defect))):PY())),L9=e=>Um(e,LT(),(e,t)=>t._tag===LK?Pe(j$(e,LP(t.fiberId))):PY()),Ue=e=>Uc(e,e=>e._tag===LW?Pe(e.error):PY()),Ut=e=>{let t=Ue(e);switch(t._tag){case"None":return PA(e);case"Some":return PM(t.value)}},Ur=e=>Uc(e,e=>e._tag===LK?Pe(e.fiberId):PY()),Un=e=>Ug(e,{onEmpty:LX,onFail:()=>LX,onDie:L1,onInterrupt:L2,onSequential:L5,onParallel:L3}),Ui=jN(2,(e,t)=>Ug(e,{onEmpty:Pe(LX),onFail:e=>Pe(L0(e)),onDie:e=>D7(t(e))?PY():Pe(L1(e)),onInterrupt:e=>Pe(L2(e)),onSequential:$i(L5),onParallel:$i(L3)})),Us=jN(2,(e,t)=>Ua(e,e=>L0(t(e)))),Ua=jN(2,(e,t)=>Ug(e,{onEmpty:LX,onFail:e=>t(e),onDie:e=>L1(e),onInterrupt:e=>L2(e),onSequential:(e,t)=>L5(e,t),onParallel:(e,t)=>L3(e,t)})),Uo=(e,t)=>{let r=zm(e),n=zm(t);for(;zP(r)&&zP(n);){let[e,t]=j$(zz(r),Um([LT(),zd()],([e,t],r)=>{let[n,i]=Uh(r);return Pe([j$(e,LL(n)),j$(t,zT(i))])})),[i,s]=j$(zz(n),Um([LT(),zd()],([e,t],r)=>{let[n,i]=Uh(r);return Pe([j$(e,LL(n)),j$(t,zT(i))])}));if(!Dg(e,i))return!1;r=t,n=s}return!0},Ul=e=>Uu(zm(e),zd()),Uu=(e,t)=>{for(;;){let[r,n]=j$(e,$9([LT(),zd()],([e,t],r)=>{let[n,i]=Uh(r);return[j$(e,LL(n)),j$(t,zT(i))]})),i=LJ(r)>0?j$(t,zE(r)):t;if(zD(n))return zS(i);e=n,t=i}throw Error(j2("Cause.flattenCauseLoop"))},Uc=jN(2,(e,t)=>{let r=[e];for(;r.length>0;){let e=r.pop(),n=t(e);switch(n._tag){case"None":switch(e._tag){case LG:case LV:r.push(e.right),r.push(e.left)}break;case"Some":return n}}return PY()}),Uh=e=>{let t=e,r=[],n=LT(),i=zd();for(;void 0!==t;)switch(t._tag){case LH:if(0===r.length)return[n,i];t=r.pop();break;case LW:if(n=LP(n,zg(t._tag,t.error)),0===r.length)return[n,i];t=r.pop();break;case"Die":if(n=LP(n,zg(t._tag,t.defect)),0===r.length)return[n,i];t=r.pop();break;case LK:if(n=LP(n,zg(t._tag,t.fiberId)),0===r.length)return[n,i];t=r.pop();break;case LG:switch(t.left._tag){case LH:t=t.right;break;case LG:t=L5(t.left.left,L5(t.left.right,t.right));break;case LV:t=L3(L5(t.left.left,t.right),L5(t.left.right,t.right));break;default:i=zE(i,t.right),t=t.left}break;case LV:r.push(t.right),t=t.left}throw Error(j2("Cause.evaluateCauseLoop"))},Uf={emptyCase:jj,failCase:jD,dieCase:jD,interruptCase:jj,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r},Up="SequentialCase",Ud="ParallelCase",Ug=jN(2,(e,{onDie:t,onEmpty:r,onFail:n,onInterrupt:i,onParallel:s,onSequential:a})=>Ub(e,void 0,{emptyCase:()=>r,failCase:(e,t)=>n(t),dieCase:(e,r)=>t(r),interruptCase:(e,t)=>i(t),sequentialCase:(e,t,r)=>a(t,r),parallelCase:(e,t,r)=>s(t,r)})),Um=jN(3,(e,t,r)=>{let n=t,i=e,s=[];for(;void 0!==i;){let e=r(n,i);switch(n=D7(e)?e.value:n,i._tag){case LG:case LV:s.push(i.right),i=i.left;break;default:i=void 0}void 0===i&&s.length>0&&(i=s.pop())}return n}),Ub=jN(3,(e,t,r)=>{let n=[e],i=[];for(;n.length>0;){let e=n.pop();switch(e._tag){case LH:i.push(PA(r.emptyCase(t)));break;case LW:i.push(PA(r.failCase(t,e.error)));break;case"Die":i.push(PA(r.dieCase(t,e.defect)));break;case LK:i.push(PA(r.interruptCase(t,e.fiberId)));break;case LG:n.push(e.right),n.push(e.left),i.push(PM({_tag:Up}));break;case LV:n.push(e.right),n.push(e.left),i.push(PM({_tag:Ud}))}}let s=[];for(;i.length>0;){let e=i.pop();switch(e._tag){case"Left":switch(e.left._tag){case Up:{let e=s.pop(),n=s.pop(),i=r.sequentialCase(t,e,n);s.push(i);break}case Ud:{let e=s.pop(),n=s.pop(),i=r.parallelCase(t,e,n);s.push(i)}}break;case"Right":s.push(e.right)}}if(0===s.length)throw Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),Uy=(e,t)=>L8(e)?"All fibers interrupted without errors.":UE(e).map(function(e){return t?.renderErrorCause!==!0||void 0===e.cause?e.stack:`${e.stack} {
${Uv(e.cause,"  ")}
}`}).join("\n"),Uv=(e,t)=>{let r=e.stack.split("\n"),n=`${t}[cause]: ${r[0]}`;for(let e=1,i=r.length;e<i;e++)n+=`
${t}${r[e]}`;return e.cause&&(n+=` {
${Uv(e.cause,`${t}  `)}
${t}}`),n};class US extends globalThis.Error{span=void 0;constructor(e){const t="object"==typeof e&&null!==e,r=Error.stackTraceLimit;Error.stackTraceLimit=1,super(Ux(e),t&&"cause"in e&&void 0!==e.cause?{cause:new US(e.cause)}:void 0),""===this.message&&(this.message="An error has occurred"),Error.stackTraceLimit=r,this.name=e instanceof Error?e.name:"Error",t&&(UO in e&&(this.span=e[UO]),Object.keys(e).forEach(t=>{t in this||(this[t]=e[t])})),this.stack=Uk(`${this.name}: ${this.message}`,e instanceof Error&&e.stack?e.stack:"",this.span)}}let Ux=e=>{if("string"==typeof e)return e;if("object"==typeof e&&null!==e&&e instanceof Error)return e.message;try{let t;if(jZ(e,"toString")&&(t=e.toString,"function"==typeof t)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return Dw(e)},U_=/\((.*)\)/g,Uw=jL("effect/Tracer/spanToTrace",()=>new WeakMap),Uk=(e,t,r)=>{let n=[e],i=t.startsWith(e)?t.slice(e.length).split("\n"):t.split("\n");for(let e=1;e<i.length;e++){if(i[e].includes(" at new BaseEffectError")||i[e].includes(" at new YieldableError")){e++;continue}if(i[e].includes("Generator.next")||i[e].includes("effect_internal_function"))break;n.push(i[e].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(r){let e=r,t=0;for(;e&&"Span"===e._tag&&t<10;){let r=Uw.get(e);if("function"==typeof r){let t=r();if("string"==typeof t){let r=t.matchAll(U_),i=!1;for(let[,t]of r)i=!0,n.push(`    at ${e.name} (${t})`);i||n.push(`    at ${e.name} (${t.replace(/^at /,"")})`)}else n.push(`    at ${e.name}`)}else n.push(`    at ${e.name}`);e=P5(e.parent),t++}}return n.join("\n")},UO=Symbol.for("effect/SpanAnnotation"),UE=e=>Ub(e,void 0,{emptyCase:()=>[],dieCase:(e,t)=>[new US(t)],failCase:(e,t)=>[new US(t)],interruptCase:()=>[],parallelCase:(e,t,r)=>[...t,...r],sequentialCase:(e,t,r)=>[...t,...r]}),UC=Symbol.for("effect/Duration"),UF=BigInt(0),UI=BigInt(24),UT=BigInt(60),UR=BigInt(1e3),UN=BigInt(1e6),UM=BigInt(1e9),UA=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,Uj=e=>{if(UL(e))return e;if(jB(e))return UH(e);if(jJ(e))return Uq(e);if(Array.isArray(e)&&2===e.length&&e.every(jB))return e[0]===-1/0||e[1]===-1/0||Number.isNaN(e[0])||Number.isNaN(e[1])?UU:e[0]===1/0||e[1]===1/0?UB:Uq(BigInt(Math.round(1e9*e[0]))+BigInt(Math.round(e[1])));if(jU(e)){let t=UA.exec(e);if(t){let[e,r,n]=t,i=Number(r);switch(n){case"nano":case"nanos":return Uq(BigInt(r));case"micro":case"micros":return UJ(BigInt(r));case"milli":case"millis":return UH(i);case"second":case"seconds":return UW(i);case"minute":case"minutes":return UK(i);case"hour":case"hours":return UV(i);case"day":case"days":return UG(i);case"week":case"weeks":return UZ(i)}}}throw Error("Invalid DurationInput")},UD={_tag:"Millis",millis:0},UP={_tag:"Infinity"},U$={[UC]:UC,[Dn](){return Dp(this,Dh(this.value))},[Dd](e){return UL(e)&&U8(this,e)},toString(){return`Duration(${U7(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:UY(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[Dy](){return this.toJSON()},pipe(){return DF(this,arguments)}},Uz=e=>{let t=Object.create(U$);return jB(e)?isNaN(e)||e<=0?t.value=UD:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(1e6*e))}:t.value=UP:e<=UF?t.value=UD:t.value={_tag:"Nanos",nanos:e},t},UL=e=>jZ(e,UC),UU=Uz(0),UB=Uz(1/0),Uq=e=>Uz(e),UJ=e=>Uz(e*UR),UH=e=>Uz(e),UW=e=>Uz(1e3*e),UK=e=>Uz(6e4*e),UV=e=>Uz(36e5*e),UG=e=>Uz(864e5*e),UZ=e=>Uz(6048e5*e),UQ=e=>UX(e,{onMillis:e=>e,onNanos:e=>Number(e)/1e6}),UY=e=>{let t=Uj(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/UM),Number(t.value.nanos%UM)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},UX=jN(2,(e,t)=>{let r=Uj(e);switch(r.value._tag){case"Nanos":return t.onNanos(r.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(r.value.millis)}}),U0=jN(3,(e,t,r)=>{let n=Uj(e),i=Uj(t);if("Infinity"===n.value._tag||"Infinity"===i.value._tag)return r.onMillis(UQ(n),UQ(i));if("Nanos"===n.value._tag||"Nanos"===i.value._tag){let e="Nanos"===n.value._tag?n.value.nanos:BigInt(Math.round(1e6*n.value.millis)),t="Nanos"===i.value._tag?i.value.nanos:BigInt(Math.round(1e6*i.value.millis));return r.onNanos(e,t)}return r.onMillis(n.value.millis,i.value.millis)}),U1=PH((e,t)=>U0(e,t,{onMillis:(e,t)=>e<t?-1:+(e>t),onNanos:(e,t)=>e<t?-1:+(e>t)})),U2=(e,t)=>U0(e,t,{onMillis:(e,t)=>e===t,onNanos:(e,t)=>e===t}),U3=(jN(2,(e,t)=>PZ(U1)(t.maximum,PQ(U1)(t.minimum,e))),jN(2,(e,t)=>U0(e,t,{onMillis:(e,t)=>Uz(e+t),onNanos:(e,t)=>Uz(e+t)}))),U5=((e,t)=>U0(e,t,{onMillis:(e,t)=>e<t,onNanos:(e,t)=>e<t}),jN(2,(e,t)=>U0(e,t,{onMillis:(e,t)=>e<=t,onNanos:(e,t)=>e<=t}))),U4=jN(2,(e,t)=>U0(e,t,{onMillis:(e,t)=>e>t,onNanos:(e,t)=>e>t})),U6=jN(2,(e,t)=>U0(e,t,{onMillis:(e,t)=>e>=t,onNanos:(e,t)=>e>=t})),U8=jN(2,(e,t)=>U2(Uj(e),Uj(t))),U7=e=>{let t=Uj(e);if("Infinity"===t.value._tag)return"Infinity";if((e=>{switch(e.value._tag){case"Millis":return 0===e.value.millis;case"Nanos":return e.value.nanos===UF;case"Infinity":return!1}})(t))return"0";let r=(e=>{let t=Uj(e);if("Infinity"===t.value._tag)return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};let r=(e=>{let t=Uj(e);switch(t.value._tag){case"Infinity":throw Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(1e6*t.value.millis))}})(t),n=r/UN,i=n/UR,s=i/UT,a=s/UT;return{days:Number(a/UI),hours:Number(a%UI),minutes:Number(s%UT),seconds:Number(i%UT),millis:Number(n%UR),nanos:Number(r%UN)}})(t),n=[];return 0!==r.days&&n.push(`${r.days}d`),0!==r.hours&&n.push(`${r.hours}h`),0!==r.minutes&&n.push(`${r.minutes}m`),0!==r.seconds&&n.push(`${r.seconds}s`),0!==r.millis&&n.push(`${r.millis}ms`),0!==r.nanos&&n.push(`${r.nanos}ns`),n.join(" ")},U9=Symbol.for("effect/MutableRef"),Be={[U9]:U9,toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"MutableRef",current:Dv(this.current)}},[Dy](){return this.toJSON()},pipe(){return DF(this,arguments)}},Bt=e=>{let t=Object.create(Be);return t.current=e,t},Br=jN(3,(e,t,r)=>!!Dg(t,e.current)&&(e.current=r,!0)),Bn=((e,t)=>{let r=e.current;return e.current=t,r},jN(2,(e,t)=>(e.current=t,e))),Bi=((e,t)=>(e.current=t,e.current),"effect/FiberId"),Bs=Symbol.for(Bi),Ba="None",Bo="Runtime",Bl="Composite",Bu=Dc(`${Bi}-${Ba}`);class Bc{id;startTimeMillis;[Bs]=Bs;_tag=Bo;constructor(e,t){this.id=e,this.startTimeMillis=t}[Dn](){return Dp(this,Dc(`${Bi}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[Dd](e){return Bp(e)&&e._tag===Bo&&this.id===e.id&&this.startTimeMillis===e.startTimeMillis}toString(){return JSON.stringify(this.toJSON(),null,2)}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[Dy](){return this.toJSON()}}class Bh{left;right;[Bs]=Bs;_tag=Bl;constructor(e,t){this.left=e,this.right=t}_hash;[Dn](){return j$(Dc(`${Bi}-${this._tag}`),Da(Di(this.left)),Da(Di(this.right)),Dp(this))}[Dd](e){return Bp(e)&&e._tag===Bl&&Dg(this.left,e.left)&&Dg(this.right,e.right)}toString(){return JSON.stringify(this.toJSON(),null,2)}toJSON(){return{_id:"FiberId",_tag:this._tag,left:Dv(this.left),right:Dv(this.right)}}[Dy](){return this.toJSON()}}let Bf=new class{[Bs]=Bs;_tag=Ba;id=-1;startTimeMillis=-1;[Dn](){return Bu}[Dd](e){return Bp(e)&&e._tag===Ba}toString(){return JSON.stringify(this.toJSON(),null,2)}toJSON(){return{_id:"FiberId",_tag:this._tag}}[Dy](){return this.toJSON()}},Bp=e=>jZ(e,Bs),Bd=e=>e._tag===Ba||j$(BS(e),LM(e=>Bd(e))),Bg=jN(2,(e,t)=>e._tag===Ba?t:t._tag===Ba?e:new Bh(e,t)),Bm=jN(2,(e,t)=>Bd(e)?t:e),Bb=e=>{switch(e._tag){case Ba:return LT();case Bo:return Lq(e.id);case Bl:return j$(Bb(e.left),LL(Bb(e.right)))}},By=jL(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>Bt(0)),Bv=e=>Array.from(Bb(e)).map(e=>`#${e}`).join(","),BS=e=>{switch(e._tag){case Ba:return LT();case Bo:return Lq(e);case Bl:return j$(BS(e.left),LL(BS(e.right)))}},Bx=Bf,B_=(e,t)=>new Bc(e,t),Bw=Bp,Bk=()=>{let e=By.current;return j$(By,Bn(e+1)),new Bc(e,Date.now())},BO=Symbol.for("effect/List"),BE=e=>$y(e),BC=Pw(zr(Dg),BE),BF={[BO]:BO,_tag:"Cons",toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"List",_tag:"Cons",values:BE(this).map(Dv)}},[Dy](){return this.toJSON()},[Dd](e){return BN(e)&&this._tag===e._tag&&BC(this,e)},[Dn](){return Dp(this,Df(BE(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if("Nil"===t._tag)return e=!0,this.return();let r=t.head;return t=t.tail,{done:e,value:r}},return:t=>(e||(e=!0),{done:!0,value:t})}},pipe(){return DF(this,arguments)}},BI=(e,t)=>{let r=Object.create(BF);return r.head=e,r.tail=t,r},BT=Dc("Nil"),BR=Object.create({[BO]:BO,_tag:"Nil",toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON:()=>({_id:"List",_tag:"Nil"}),[Dy](){return this.toJSON()},[Dn]:()=>BT,[Dd](e){return BN(e)&&this._tag===e._tag},[Symbol.iterator]:()=>({next:()=>({done:!0,value:void 0})}),pipe(){return DF(this,arguments)}}),BN=e=>jZ(e,BO),BM=e=>"Nil"===e._tag,BA=e=>"Cons"===e._tag,Bj=e=>{let t=e,r=0;for(;!BM(t);)r+=1,t=t.tail;return r},BD=(e,t)=>BI(e,t),BP=()=>BR,B$=e=>{let t,r=e[Symbol.iterator]();if(!(t=r.next())||t.done)return BR;{let e=BI(t.value,BR),n=e;for(;(t=r.next())&&!t.done;){let e=BI(t.value,BR);n.tail=e,n=e}return e}},Bz=jN(2,(e,t)=>BU(t,e)),BL=jN(2,(e,t)=>BD(t,e)),BU=jN(2,(e,t)=>{if(BM(e))return t;{if(BM(t))return e;let r=BI(t.head,e),n=r,i=t.tail;for(;!BM(i);){let t=BI(i.head,e);n.tail=t,n=t,i=i.tail}return r}}),BB=((e,t)=>{if(t<=0)return e;if(t>=Bj(e))return BR;let r=e,n=0;for(;!BM(r)&&n<t;)r=r.tail,n+=1;return r},(e,t,r,n)=>{for(;;)if(BM(t))return e;else{if(r(t.head)===n)return Bq(e,t,r,n);t=t.tail}}),Bq=(e,t,r,n)=>{let i=BI(BK(e),BR),s=BV(e),a=i;for(;s!==t;){let e=BI(BK(s),BR);a.tail=e,a=jM(e),s=jM(s.tail)}let o=t.tail,l=jM(o);for(;!BM(o);)if(r(BK(o))!==n)o=o.tail;else{for(;l!==o;){let e=BI(BK(l),BR);a.tail=e,a=e,l=jM(l.tail)}l=jM(o.tail),o=o.tail}return BM(l)||(a.tail=l),i},BJ=jN(3,(e,t,r)=>{let n=t,i=e;for(;!BM(i);)n=r(n,i.head),i=i.tail;return n}),BH=e=>{let t=BP(),r=e;for(;!BM(r);)t=BL(t,r.head),r=r.tail;return t},BW=((e,t)=>{if(t<=0)return BR;if(t>=Bj(e))return e;let r=((...e)=>B$(e))(BK(e)),n=BV(e);for(let e=1;e<t;e++)r=BI(BK(n),r),n=BV(n);return BH(r)},"Expected List to be non-empty"),BK=e=>{if(BM(e))throw Error(BW);return e.head},BV=e=>{if(BM(e))throw Error(BW);return e.tail},BG=function(){function e(e){e&&Object.assign(this,e)}return e.prototype=DZ,e}(),BZ=e=>Object.assign(Object.create(DZ),e),BQ=Symbol.for("effect/DifferChunkPatch");function BY(e){return e}let BX=({...BG.prototype,[BQ]:{_Value:BY,_Patch:BY}},Symbol.for("effect/DifferContextPatch"));function B0(e){return e}let B1={...BG.prototype,[BX]:{_Value:B0,_Patch:B0}},B2=Object.create(Object.assign(Object.create(B1),{_tag:"Empty"})),B3=Object.assign(Object.create(B1),{_tag:"AndThen"}),B5=Object.assign(Object.create(B1),{_tag:"AddService"}),B4=(e,t)=>{let r=Object.create(B5);return r.key=e,r.service=t,r},B6=Object.assign(Object.create(B1),{_tag:"RemoveService"}),B8=e=>{let t=Object.create(B6);return t.key=e,t},B7=Object.assign(Object.create(B1),{_tag:"UpdateService"}),B9=(e,t)=>{let r=Object.create(B7);return r.key=e,r.update=t,r},qe=jN(2,(e,t)=>{let r;return(r=Object.create(B3)).first=e,r.second=t,r}),qt=jN(2,(e,t)=>{if("Empty"===e._tag)return t;let r=!1,n=zm(e),i=new Map(t.unsafeMap);for(;zP(n);){let e=zz(n),t=zH(n);switch(e._tag){case"Empty":n=t;break;case"AddService":i.set(e.key,e.service),n=t;break;case"AndThen":n=zE(zE(t,e.second),e.first);break;case"RemoveService":i.delete(e.key),n=t;break;case"UpdateService":i.set(e.key,e.update(i.get(e.key))),r=!0,n=t}}if(!r)return Pl(i);let s=new Map;for(let[e]of t.unsafeMap)i.has(e)&&(s.set(e,i.get(e)),i.delete(e));for(let[e,t]of i)s.set(e,t);return Pl(s)}),qr=Symbol.for("effect/DifferHashMapPatch");function qn(e){return e}let qi=({...BG.prototype,[qr]:{_Value:qn,_Key:qn,_Patch:qn}},Symbol.for("effect/DifferHashSetPatch"));function qs(e){return e}let qa={...BG.prototype,[qi]:{_Value:qs,_Key:qs,_Patch:qs}},qo=Object.create(Object.assign(Object.create(qa),{_tag:"Empty"})),ql=Object.assign(Object.create(qa),{_tag:"AndThen"}),qu=Object.assign(Object.create(qa),{_tag:"Add"}),qc=Object.assign(Object.create(qa),{_tag:"Remove"}),qh=jN(2,(e,t)=>{let r;return(r=Object.create(ql)).first=e,r.second=t,r}),qf=jN(2,(e,t)=>{if("Empty"===e._tag)return t;let r=t,n=zm(e);for(;zP(n);){let e=zz(n),t=zH(n);switch(e._tag){case"Empty":n=t;break;case"AndThen":n=zE(e.first)(zE(e.second)(t));break;case"Add":r=LP(e.value)(r),n=t;break;case"Remove":r=L$(e.value)(r),n=t}}return r}),qp=Symbol.for("effect/DifferOrPatch");function qd(e){return e}let qg={...BG.prototype,[qp]:{_Value:qd,_Key:qd,_Patch:qd}},qm=Object.assign(Object.create(qg),{_tag:"AndThen"}),qb=((e,t)=>{let r;return(r=Object.create(qm)).first=e,r.second=t,r},Symbol.for("effect/DifferReadonlyArrayPatch"));function qy(e){return e}let qv={...BG.prototype,[qb]:{_Value:qy,_Patch:qy}},qS=Object.create(Object.assign(Object.create(qv),{_tag:"Empty"})),qx=Object.assign(Object.create(qv),{_tag:"AndThen"}),q_=Object.assign(Object.create(qv),{_tag:"Append"}),qw=Object.assign(Object.create(qv),{_tag:"Slice"}),qk=Object.assign(Object.create(qv),{_tag:"Update"}),qO=(e,t)=>{let r=Object.create(qk);return r.index=e,r.patch=t,r},qE=jN(2,(e,t)=>{let r;return(r=Object.create(qx)).first=e,r.second=t,r}),qC=jN(3,(e,t,r)=>{if("Empty"===e._tag)return t;let n=t.slice(),i=$0(e);for(;PJ(i);){let e=$N(i),t=$j(i);switch(e._tag){case"Empty":i=t;break;case"AndThen":t.unshift(e.first,e.second),i=t;break;case"Append":for(let t of e.values)n.push(t);i=t;break;case"Slice":n=n.slice(e.from,e.until),i=t;break;case"Update":n[e.index]=r.patch(e.patch,n[e.index]),i=t}}return n}),qF={[Symbol.for("effect/Differ")]:{_P:jM,_V:jM},pipe(){return DF(this,arguments)}},qI=e=>{let t=Object.create(qF);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},qT=()=>qR((e,t)=>t),qR=e=>qI({empty:jM,combine:(e,t)=>e===jM?t:t===jM?e:r=>t(e(r)),diff:(e,t)=>Dg(e,t)?jM:jA(t),patch:(t,r)=>e(r,t(r))}),qN=(e,t)=>(255&e)+((t&e&255)<<8),qM=qN(0,0),qA=jN(2,(e,t)=>qN(255&e&~t,e>>8&255)),qj=jN(2,(e,t)=>e|t),qD=e=>qU(e,32),qP=jN(2,(e,t)=>e&~t),q$=jN(2,(e,t)=>e|t),qz=e=>qL(e)&&!qJ(e),qL=e=>qU(e,1),qU=jN(2,(e,t)=>(e&t)!=0),qB=(...e)=>e.reduce((e,t)=>e|t,0),qq=qB(0),qJ=e=>qU(e,16),qH=jN(2,(e,t)=>qN(e^t,t)),qW=jN(2,(e,t)=>e&(~(255&t)>>>0&255|t>>8&255)|255&t&(t>>8&255)),qK=qI({empty:qM,diff:(e,t)=>qH(e,t),combine:(e,t)=>qj(t)(e),patch:(e,t)=>qW(t,e)}),qV=(e,t)=>({_tag:"Par",left:e,right:t}),qG=(e,t)=>({_tag:"Seq",left:e,right:t}),qZ=e=>{let t=e,r=q5(),n=BP(),i=BP();for(;;)switch(t._tag){case"Empty":if(BM(n))return[r,i];t=n.head,n=n.tail;break;case"Par":n=BD(t.right,n),t=t.left;break;case"Seq":{let e=t.left,r=t.right;switch(e._tag){case"Empty":t=r;break;case"Par":{let n=e.left,i=e.right;t=qV(qG(n,r),qG(i,r));break}case"Seq":t=qG(e.left,qG(e.right,r));break;case"Single":t=e,i=BD(r,i)}break}case"Single":if(r=q4(r,t),BM(n))return[r,i];t=n.head,n=n.tail}throw Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},qQ=(e,t)=>{if(BM(e))return BI(q9(t),BR);if(q8(t))return e;let r=Js(e.head),n=q7(t);return 1===r.length&&1===n.length&&Dg(r[0],n[0])?BD(Ji(e.head,q9(t)),e.tail):BD(q9(t),e)},qY=Symbol.for("effect/RequestBlock/Entry");class qX{request;result;listeners;ownerId;state;[qY]=q0;constructor(e,t,r,n,i){this.request=e,this.result=t,this.listeners=r,this.ownerId=n,this.state=i}}let q0={_R:e=>e},q1=Symbol.for("effect/RequestBlock/RequestBlockParallel"),q2={_R:e=>e};class q3{map;[q1]=q2;constructor(e){this.map=e}}let q5=()=>new q3(Ll),q4=(e,t)=>new q3(Ly(e.map,t.dataSource,e=>P2(P7(e,zO(t.blockedRequest)),()=>zm(t.blockedRequest)))),q6=(e,t)=>new q3(Lw(e.map,t.map,(e,t,r)=>Lp(e,r,PX(Lc(e,r),{onNone:()=>t,onSome:e=>zT(t,e)})))),q8=e=>{let t;return(t=e.map)&&z3(t._root)},q7=e=>Array.from(Lg(e.map)),q9=e=>Jn(Lx(e.map,e=>zm(e))),Je=Symbol.for("effect/RequestBlock/RequestBlockSequential"),Jt={_R:e=>e};class Jr{map;[Je]=Jt;constructor(e){this.map=e}}let Jn=e=>new Jr(e),Ji=(e,t)=>new Jr(Lw(t.map,e.map,(e,t,r)=>Lp(e,r,PX(Lc(e,r),{onNone:()=>zd(),onSome:e=>zT(e,t)})))),Js=e=>Array.from(Lg(e.map)),Ja="Pending",Jo="Done",Jl=Symbol.for("effect/Deferred"),Ju={_E:e=>e,_A:e=>e},Jc=e=>({_tag:Jo,effect:e});class Jh{self;called=!1;constructor(e){this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(e){return{value:e,done:!0}}throw(e){throw e}[Symbol.iterator](){return new Jh(this.self)}}let Jf=(e,t)=>{let r=new Jg("Blocked");return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r},Jp=Symbol.for("effect/Effect");class Jd{patch;op;_op=DB;constructor(e,t){this.patch=e,this.op=t}}class Jg{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[Jp]=DV;constructor(e){this._op=e}[Dd](e){return this===e}[Dn](){return Dp(this,Ds(this))}pipe(){return DF(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:Dv(this.effect_instruction_i0),effect_instruction_i1:Dv(this.effect_instruction_i1),effect_instruction_i2:Dv(this.effect_instruction_i2)}}toString(){return JSON.stringify(this.toJSON(),null,2)}[Dy](){return this.toJSON()}[Symbol.iterator](){return new Jh(new j7(this))}}class Jm{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[Jp]=DV;constructor(e){this._op=e,this._tag=e}[Dd](e){return Wf(e)&&"Failure"===e._op&&Dg(this.effect_instruction_i0,e.effect_instruction_i0)}[Dn](){return j$(Dc(this._tag),Da(Di(this.effect_instruction_i0)),Dp(this))}get cause(){return this.effect_instruction_i0}pipe(){return DF(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return JSON.stringify(this.toJSON(),null,2)}[Dy](){return this.toJSON()}[Symbol.iterator](){return new Jh(new j7(this))}}class Jb{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[Jp]=DV;constructor(e){this._op=e,this._tag=e}[Dd](e){return Wf(e)&&"Success"===e._op&&Dg(this.effect_instruction_i0,e.effect_instruction_i0)}[Dn](){return j$(Dc(this._tag),Da(Di(this.effect_instruction_i0)),Dp(this))}get value(){return this.effect_instruction_i0}pipe(){return DF(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:Dv(this.value)}}toString(){return JSON.stringify(this.toJSON(),null,2)}[Dy](){return this.toJSON()}[Symbol.iterator](){return new Jh(new j7(this))}}let Jy=e=>jZ(e,Jp),Jv=e=>{let t=new Jg(DL);return t.effect_instruction_i0=e,t},JS=jN(3,(e,t,r)=>Hi(n=>JU(e,e=>JU(Jj(J9(()=>n(t(e)))),t=>J9(()=>r(e,t)).pipe(JH({onFailure:e=>{switch(t._tag){case DR:return JP(L5(t.effect_instruction_i0,e));case Dj:return JP(e)}},onSuccess:()=>t})))))),Jx=jN(2,(e,t)=>JU(e,()=>J7(t))),J_=e=>Jx(e,void 0),Jw=function(){let e=new Jg(DT);switch(arguments.length){case 2:e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break;case 3:e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break;case 4:e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break;default:throw Error(j2("you're not supposed to end up here"))}return e},Jk=(e,t=Bx)=>{let r,n=new Jg(DI);return n.effect_instruction_i0=t=>{r=e(t)},n.effect_instruction_i1=t,J3(n,e=>Jy(r)?r:Hs)},JO=(e,t=Bx)=>J9(()=>Jk(e,t)),JE=(e,t=Bx)=>Jw(e,function(){let e,r,n,i;function s(t){e?e(t):void 0===r&&(r=t)}let a=new Jg(DI);return a.effect_instruction_i0=t=>{e=t,r&&t(r)},a.effect_instruction_i1=t,1!==this.effect_instruction_i0.length?(i=new AbortController,n=Dt(()=>this.effect_instruction_i0(s,i.signal))):n=Dt(()=>this.effect_instruction_i0(s)),n||i?J3(a,e=>(i&&i.abort(),n??Hs)):a}),JC=jN(2,(e,t)=>{let r=new Jg(DN);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),JF=jN(2,(e,t)=>JW(e,{onFailure:t,onSuccess:J7})),JI=jN(3,(e,t,r)=>JC(e,e=>{let n=Ut(e);switch(n._tag){case"Left":return t(n.left)?r(n.left):JP(e);case"Right":return JP(n.right)}})),JT=Symbol.for("effect/OriginalAnnotation"),JR=(e,t)=>D7(t)?new Proxy(e,{has:(e,t)=>t===UO||t===JT||t in e,get:(r,n)=>n===UO?t.value:n===JT?e:r[n]}):e,JN=e=>!jG(e)||UO in e?JP(L1(e)):Jv(t=>JP(L1(JR(e,WW(t))))),JM=e=>J$(()=>L1(new H9(e))),JA=e=>JW(e,{onFailure:e=>J7(PM(e)),onSuccess:e=>J7(PA(e))}),Jj=e=>JJ(e,{onFailure:Wv,onSuccess:WO}),JD=e=>!jG(e)||UO in e?JP(L0(e)):Jv(t=>JP(L0(JR(e,WW(t))))),JP=e=>{let t=new Jm(DR);return t.effect_instruction_i0=e,t},J$=e=>JU(He(e),JP),Jz=Jv(e=>J7(e.id())),JL=e=>Jv(t=>e(t.id())),JU=jN(2,(e,t)=>{let r=new Jg(DM);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),JB=e=>{let t=new Jg("OnStep");return t.effect_instruction_i0=e,t},Jq=e=>JU(e,jM),JJ=jN(2,(e,t)=>JH(e,{onFailure:e=>J7(t.onFailure(e)),onSuccess:e=>J7(t.onSuccess(e))})),JH=jN(2,(e,t)=>{let r=new Jg(DA);return r.effect_instruction_i0=e,r.effect_instruction_i1=t.onFailure,r.effect_instruction_i2=t.onSuccess,r}),JW=jN(2,(e,t)=>JH(e,{onFailure:e=>{if(L7(e).length>0)return JP(Ug(e,{onEmpty:LX,onFail:L1,onDie:L1,onInterrupt:L2,onSequential:L5,onParallel:L3}));let r=zS(Um(e,zd(),(e,t)=>t._tag===LW?Pe(j$(e,zE(t.error))):PY()));return r.length>0?t.onFailure(zz(r)):JP(e)},onSuccess:t.onSuccess})),JK=jN(2,(e,t)=>J9(()=>{let r=$y(e),n=Array(r.length),i=0;return Jx(Hl({while:()=>i<r.length,body:()=>t(r[i],i),step:e=>{n[i++]=e}}),n)})),JV=jN(2,(e,t)=>J9(()=>{let r=$y(e),n=0;return Hl({while:()=>n<r.length,body:()=>t(r[n],n),step:()=>{n++}})})),JG=((e=>"boolean"==typeof e[0]||Jy(e[0]),(e,t)=>Jy(e)?JU(e,e=>e?t.onTrue():t.onFalse()):e?t.onTrue():t.onFalse()),JU(Jz,e=>JZ(e))),JZ=e=>JP(L2(e)),JQ=e=>{let t=new Jg(DP);return t.effect_instruction_i0=qN(1,1),t.effect_instruction_i1=()=>e,t},JY=jN(2,(e,t)=>Hi(r=>JU(Jj(r(e)),e=>WD(t,e)))),JX=jN(2,(e,t)=>JU(e,e=>He(()=>t(e)))),J0=jN(2,(e,t)=>JW(e,{onFailure:e=>JU(He(()=>t.onFailure(e)),JD),onSuccess:e=>He(()=>t.onSuccess(e))})),J1=jN(2,(e,t)=>JH(e,{onFailure:e=>{let r=Ut(e);switch(r._tag){case"Left":return JU(He(()=>t(r.left)),JD);case"Right":return JP(r.right)}},onSuccess:J7})),J2=((e,t)=>J2(e,e=>Wp(e)?Hs:t(e.effect_instruction_i0)),jN(2,(e,t)=>Hi(r=>JH(r(e),{onFailure:e=>{let r=Wv(e);return JH(t(r),{onFailure:t=>Wv(L5(e,t)),onSuccess:()=>r})},onSuccess:e=>{let r=WO(e);return Hp(t(r),r)}})))),J3=jN(2,(e,t)=>J2(e,Ww({onFailure:e=>L8(e)?J_(t(L9(e))):Hs,onSuccess:()=>Hs}))),J5=jN(2,(e,t)=>Hr(e,t,J7)),J4=e=>J6(e,jM),J6=jN(2,(e,t)=>JW(e,{onFailure:e=>JN(t(e)),onSuccess:J7})),J8=Jv((e,t)=>J7(t.runtimeFlags)),J7=e=>{let t=new Jb(Dj);return t.effect_instruction_i0=e,t},J9=e=>{let t=new Jg(DT);return t.commit=e,t},He=e=>{let t=new Jg(DD);return t.effect_instruction_i0=e,t},Ht=jN(e=>3===e.length||2===e.length&&!(jG(e[1])&&"onlyEffect"in e[1]),(e,t)=>JU(e,e=>{let r="function"==typeof t?t(e):t;return Jy(r)?Jx(r,e):(e=>jZ(e,"then")&&"function"==typeof e.then)(r)?Jk(t=>{r.then(r=>t(J7(e)),e=>t(JD(new Wh(e,"An unknown error occurred in Effect.tap"))))}):J7(e)})),Hr=jN(3,(e,t,r)=>JH(e,{onFailure:e=>L7(e).length>0?JP(P8(Ug(e,{onEmpty:PY(),onFail:e=>Pe(L1(e)),onDie:e=>Pe(L1(e)),onInterrupt:()=>PY(),onSequential:$i(L5),onParallel:$i(L3)}))):t(),onSuccess:r})),Hn=e=>{let t=new Jg(DP);return t.effect_instruction_i0=qN(1,0),t.effect_instruction_i1=()=>e,t},Hi=e=>Jw(e,function(){let e=new Jg(DP);return e.effect_instruction_i0=qN(1,0),e.effect_instruction_i1=e=>qL(e)?Dt(()=>this.effect_instruction_i0(JQ)):Dt(()=>this.effect_instruction_i0(Hn)),e}),Hs=J7(void 0),Ha=e=>{let t=new Jg(DP);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},Ho=jN(2,(e,t)=>JU(t,t=>t?j$(e,JX(Pe)):J7(PY()))),Hl=e=>{let t=new Jg(D$);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},Hu=jN(2,(e,t)=>{let r=new Jg(DP);return r.effect_instruction_i0=t,r.effect_instruction_i1=()=>e,r}),Hc=e=>{let t=new Jg(DU);return void 0!==e?.priority?HJ(t,e.priority):t},Hh=jN(2,(e,t)=>JU(e,e=>JX(t,t=>[e,t]))),Hf=jN(2,(e,t)=>JU(e,e=>Jx(t,e))),Hp=jN(2,(e,t)=>JU(e,()=>t)),Hd=jN(3,(e,t,r)=>JU(e,e=>JX(t,t=>r(e,t)))),Hg=JO(()=>{let e=setInterval(()=>{},0x80000000-1);return He(()=>clearInterval(e))}),Hm=e=>JU(Jz,t=>j$(e,Hb(t))),Hb=jN(2,(e,t)=>JU(e.interruptAsFork(t),()=>e.await)),Hy={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return DF(this,arguments)}},Hv={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return DF(this,arguments)}},HS={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return DF(this,arguments)}},Hx={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return DF(this,arguments)}},H_={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return DF(this,arguments)}},Hw=Symbol.for("effect/FiberRef"),Hk={_A:e=>e},HO=e=>Jv(t=>WO(t.getFiberRef(e))),HE=jN(2,(e,t)=>JU(HO(e),t)),HC=jN(2,(e,t)=>HF(e,()=>[void 0,t])),HF=jN(2,(e,t)=>Jv(r=>{let[n,i]=t(r.getFiberRef(e));return r.setFiberRef(e,i),J7(n)})),HI=Symbol.for("effect/RequestResolver"),HT={_A:e=>e,_R:e=>e};class HR{runAll;target;[HI]=HT;constructor(e,t){this.runAll=e,this.target=t}[Dn](){return Dp(this,this.target?Di(this.target):Ds(this))}[Dd](e){return this.target?HN(e)&&Dg(this.target,e.target):this===e}identified(...e){return new HR(this.runAll,zb(e))}pipe(){return DF(this,arguments)}}let HN=e=>jZ(e,HI),HM=jN(3,(e,t,r)=>JS(Hf(HO(t),HC(t,r)),()=>e,e=>HC(t,e))),HA=jN(3,(e,t,r)=>HE(t,n=>HM(e,t,r(n)))),Hj=(e,t)=>HP(e,{differ:qT(),fork:t?.fork??jM,join:t?.join}),HD=e=>{let t=qI({empty:B2,combine:(e,t)=>qe(t)(e),diff:(e,t)=>((e,t)=>{let r=new Map(e.unsafeMap),n=B2;for(let[e,i]of t.unsafeMap.entries())if(r.has(e)){let t=r.get(e);r.delete(e),Dg(t,i)||(n=qe(B9(e,()=>i))(n))}else r.delete(e),n=qe(B4(e,i))(n);for(let[e]of r.entries())n=qe(B8(e))(n);return n})(e,t),patch:(e,t)=>qt(t)(e)});return HP(e,{differ:t,fork:t.empty})},HP=(e,t)=>({...DQ,[Hw]:Hk,initial:e,commit(){return HO(this)},diff:(e,r)=>t.differ.diff(e,r),combine:(e,r)=>t.differ.combine(e,r),patch:e=>r=>t.differ.patch(e,r),fork:t.fork,join:t.join??((e,t)=>t)}),H$=jL(Symbol.for("effect/FiberRef/currentContext"),()=>HD(Pc)),Hz=jL(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>Hj(0)),HL=jL(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>Hj(2048)),HU=jL(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>Hj(Ll)),HB=jL(Symbol.for("effect/FiberRef/currentLogLevel"),()=>Hj(HS)),Hq=jL(Symbol.for("effect/FiberRef/currentLogSpan"),()=>Hj(BP())),HJ=jN(2,(e,t)=>HM(e,Hz,t)),HH=jL(Symbol.for("effect/FiberRef/currentConcurrency"),()=>Hj("unbounded")),HW=jL(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>Hj(!0)),HK=jL(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>Hj(Pe(Hx))),HV=jL(Symbol.for("effect/FiberRef/versionMismatchErrorLogLevel"),()=>Hj(Pe(Hv))),HG=jL(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>{var e;let t,r;return e=$X(),t=qT(),HP(e,{differ:r=qI({empty:qS,combine:(e,t)=>qE(e,t),diff:(e,r)=>(e=>{var t,r;let n,i,s=0,a=qS;for(;s<e.oldValue.length&&s<e.newValue.length;){let t=e.oldValue[s],r=e.newValue[s],n=e.differ.diff(t,r);Dg(n,e.differ.empty)||(a=qE(a,qO(s,n))),s+=1}return s<e.oldValue.length&&(a=qE(a,(t=s,(n=Object.create(qw)).from=0,n.until=t,n))),s<e.newValue.length&&(a=qE(a,(r=$P(s)(e.newValue),(i=Object.create(q_)).values=r,i))),a})({oldValue:e,newValue:r,differ:t}),patch:(e,r)=>qC(e,r,t)}),fork:r.empty})}),HZ=jL(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>Hj(PY(),{fork:()=>PY(),join:(e,t)=>e})),HQ=jL(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>Hj(LX,{fork:()=>LX,join:(e,t)=>e})),HY=jL(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>Hj(!0)),HX=jL(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>Hj(!0)),H0=jL(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>Hj(Ll)),H1=jL(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>Hj(zd())),H2=Symbol.for("effect/Scope"),H3=Symbol.for("effect/CloseableScope"),H5=(e,t)=>e.addFinalizer(()=>J_(t)),H4=jN(2,(e,t)=>{let r=j$(e,Ue,P7(t));switch(r._tag){case"None":return j$(L7(e),z$,PX({onNone:()=>{let t=$y(L9(e)).flatMap(e=>$y(Bb(e)).map(e=>`#${e}`));return new Wt(t?`Interrupted by fibers: ${t.join(", ")}`:void 0)},onSome:jM}));case"Some":return r.value}}),H6=function(){class e extends globalThis.Error{commit(){return JD(this)}toJSON(){let e={...this};return this.message&&(e.message=this.message),this.cause&&(e.cause=this.cause),e}[Dy](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split("\n").slice(1).join("\n")}`:this.toString():"Bun"in globalThis?Uy(L0(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,DY),e}(),H8=(e,t)=>{class r extends H6{_tag=t}return Object.assign(r.prototype,e),r.prototype.name=t,r},H7=Symbol.for("effect/Cause/errors/RuntimeException"),H9=H8({[H7]:H7},"RuntimeException"),We=Symbol.for("effect/Cause/errors/InterruptedException"),Wt=H8({[We]:We},"InterruptedException"),Wr=e=>jZ(e,We),Wn=Symbol.for("effect/Cause/errors/IllegalArgument"),Wi=H8({[Wn]:Wn},"IllegalArgumentException"),Ws=Symbol.for("effect/Cause/errors/NoSuchElement"),Wa=H8({[Ws]:Ws},"NoSuchElementException"),Wo=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),Wl=H8({[Wo]:Wo},"InvalidPubSubCapacityException"),Wu=Symbol.for("effect/Cause/errors/Timeout"),Wc=Symbol.for("effect/Cause/errors/UnknownException"),Wh=function(){class e extends H6{_tag="UnknownException";error;constructor(e,t){super(t??"An unknown error occurred",{cause:e}),this.error=e}}return Object.assign(e.prototype,{[Wc]:Wc,name:"UnknownException"}),e}(),Wf=e=>Jy(e)&&"_tag"in e&&("Success"===e._tag||"Failure"===e._tag),Wp=e=>"Success"===e._tag,Wd=jN(2,(e,t)=>{switch(e._tag){case DR:return Wv(e.effect_instruction_i0);case Dj:return WO(t)}}),Wg=e=>Wd(e,void 0),Wm=(e,t)=>WT(e,t?.parallel?L3:L5),Wb=e=>Wv(L1(e)),Wy=e=>Wv(L0(e)),Wv=e=>{let t=new Jm(DR);return t.effect_instruction_i0=e,t},WS=jN(2,(e,t)=>{switch(e._tag){case DR:return Wv(e.effect_instruction_i0);case Dj:return t(e.effect_instruction_i0)}}),Wx=jN(2,(e,t)=>{switch(e._tag){case DR:return J7(Wv(e.effect_instruction_i0));case Dj:return Jj(t(e.effect_instruction_i0))}}),W_=jN(2,(e,t)=>{switch(e._tag){case DR:return Wv(e.effect_instruction_i0);case Dj:return WO(t(e.effect_instruction_i0))}}),Ww=jN(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case DR:return t(e.effect_instruction_i0);case Dj:return r(e.effect_instruction_i0)}}),Wk=jN(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case DR:return t(e.effect_instruction_i0);case Dj:return r(e.effect_instruction_i0)}}),WO=e=>{let t=new Jb(Dj);return t.effect_instruction_i0=e,t},WE=WO(void 0),WC=jN(2,(e,t)=>WI(e,t,{onSuccess:(e,t)=>[e,t],onFailure:L5})),WF=jN(2,(e,t)=>WI(e,t,{onSuccess:(e,t)=>t,onFailure:L5})),WI=jN(3,(e,t,{onFailure:r,onSuccess:n})=>{switch(e._tag){case DR:switch(t._tag){case Dj:return Wv(e.effect_instruction_i0);case DR:return Wv(r(e.effect_instruction_i0,t.effect_instruction_i0))}case Dj:switch(t._tag){case Dj:return WO(n(e.effect_instruction_i0,t.effect_instruction_i0));case DR:return Wv(t.effect_instruction_i0)}}}),WT=(e,t)=>{let r=zb(e);return zP(r)?j$(zH(r),$9(j$(zz(r),W_(zm)),(e,r)=>j$(e,WI(r,{onSuccess:(e,t)=>j$(e,zE(t)),onFailure:t}))),W_(zS),W_(e=>zv(e)),Pe):PY()},WR=e=>({...DQ,[Jl]:Ju,state:Bt({_tag:Ja,joiners:[]}),commit(){return WA(this)},blockingOn:e}),WN=()=>JU(Jz,e=>WM(e)),WM=e=>He(()=>WR(e)),WA=e=>JO(t=>{let r=e.state.current;switch(r._tag){case Jo:return t(r.effect);case Ja:return r.joiners.push(t),WU(e,t)}},e.blockingOn),Wj=jN(2,(e,t)=>He(()=>{let r=e.state.current;switch(r._tag){case Jo:return!1;case Ja:Bn(e.state,Jc(t));for(let e=0,n=r.joiners.length;e<n;e++)r.joiners[e](t);return!0}})),WD=jN(2,(e,t)=>Wj(e,t)),WP=((e,t)=>Wj(e,JD(t)),jN(2,(e,t)=>Wj(e,JP(t)))),W$=jN(2,(e,t)=>Wj(e,JZ(t))),Wz=jN(2,(e,t)=>Wj(e,J7(t))),WL=(e,t)=>{let r=e.state.current;if(r._tag===Ja){Bn(e.state,Jc(t));for(let e=0,n=r.joiners.length;e<n;e++)r.joiners[e](t)}},WU=(e,t)=>He(()=>{let r=e.state.current;if(r._tag===Ja){let e=r.joiners.indexOf(t);e>=0&&r.joiners.splice(e,1)}}),WB=Jv(e=>WO(e.currentContext)),Wq=jN(2,(e,t)=>HM(H$,t)(e)),WJ=jN(2,(e,t)=>HA(H$,e=>Pb(e,t))(e)),WH=jN(2,(e,t)=>JU(WB,r=>Wq(e,t(r)))),WW=((e,t)=>JU(e,e=>JU(t.predicate(e),r=>r?J7(e):t.orElse(e))),e=>{let t=e.currentSpan;return void 0!==t&&"Span"===t._tag?Pe(t):PY()}),WK={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:WE},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}},WV=Symbol.for("effect/Clock"),WG=Py("effect/Clock"),WZ=0x80000000-1,WQ={unsafeSchedule(e,t){let r=UQ(t);if(r>WZ)return jD;let n=!1,i=setTimeout(()=>{n=!0,e()},r);return()=>(clearTimeout(i),!n)}},WY=(E=BigInt(1e6),"undefined"==typeof performance?()=>BigInt(Date.now())*E:()=>(void 0===O&&(O=BigInt(Date.now())*E-BigInt(Math.round(1e6*performance.now()))),O+BigInt(Math.round(1e6*performance.now())))),WX=function(){let e="object"==typeof process&&"hrtime"in process&&"function"==typeof process.hrtime.bigint?process.hrtime:void 0;if(!e)return WY;let t=WY()-e.bigint();return()=>t+e.bigint()}();class W0{[WV]=WV;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return WX()}currentTimeMillis=He(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=He(()=>this.unsafeCurrentTimeNanos());scheduler(){return J7(WQ)}sleep(e){return JE(t=>J_(He(WQ.unsafeSchedule(()=>t(Hs),e))))}}jN(2,(e,t)=>-1!==PW(e,t));let W1=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&"),W2="InvalidData",W3="MissingData",W5="SourceUnavailable",W4="Unsupported",W6=Symbol.for("effect/ConfigError"),W8={_tag:"ConfigError",[W6]:W6},W7=(e,t)=>{let r=Object.create(W8);return r._op="And",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},W9=(e,t)=>{let r=Object.create(W8);return r._op="Or",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},Ke=(e,t,r={pathDelim:"."})=>{let n=Object.create(W8);return n._op=W3,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){let e=j$(this.path,zs(r.pathDelim));return`(Missing data at ${e}: "${this.message}")`}}),n},Kt=jN(2,(e,t)=>{switch(e._op){case"And":return W7(Kt(e.left,t),Kt(e.right,t));case"Or":return W9(Kt(e.left,t),Kt(e.right,t));case W2:return((e,t,r={pathDelim:"."})=>{let n=Object.create(W8);return n._op=W2,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){let e=j$(this.path,zs(r.pathDelim));return`(Invalid data at ${e}: "${this.message}")`}}),n})([...t,...e.path],e.message);case W3:return Ke([...t,...e.path],e.message);case W5:return((e,t,r,n={pathDelim:"."})=>{let i=Object.create(W8);return i._op=W5,i.path=e,i.message=t,i.cause=r,Object.defineProperty(i,"toString",{enumerable:!1,value(){let e=j$(this.path,zs(n.pathDelim));return`(Source unavailable at ${e}: "${this.message}")`}}),i})([...t,...e.path],e.message,e.cause);case W4:return((e,t,r={pathDelim:"."})=>{let n=Object.create(W8);return n._op=W4,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){let e=j$(this.path,zs(r.pathDelim));return`(Unsupported operation at ${e}: "${this.message}")`}}),n})([...t,...e.path],e.message)}}),Kr=jN(3,(e,t,r)=>{let n=[e],i=[];for(;n.length>0;){let e=n.pop();switch(e._op){case"And":n.push(e.right),n.push(e.left),i.push(PM({_op:"AndCase"}));break;case"Or":n.push(e.right),n.push(e.left),i.push(PM({_op:"OrCase"}));break;case W2:i.push(PA(r.invalidDataCase(t,e.path,e.message)));break;case W3:i.push(PA(r.missingDataCase(t,e.path,e.message)));break;case W5:i.push(PA(r.sourceUnavailableCase(t,e.path,e.message,e.cause)));break;case W4:i.push(PA(r.unsupportedCase(t,e.path,e.message)))}}let s=[];for(;i.length>0;){let e=i.pop();switch(e._op){case"Left":switch(e.left._op){case"AndCase":{let e=s.pop(),n=s.pop(),i=r.andCase(t,e,n);s.push(i);break}case"OrCase":{let e=s.pop(),n=s.pop(),i=r.orCase(t,e,n);s.push(i)}}break;case"Right":s.push(e.right)}}if(0===s.length)throw Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),Kn={_tag:"Empty"},Ki=jN(2,(e,t)=>({_tag:"AndThen",first:e,second:t})),Ks=jN(2,(e,t)=>Ki(e,{_tag:"MapName",f:t})),Ka=jN(2,(e,t)=>Ki(e,{_tag:"Nested",name:t})),Ko=jN(2,(e,t)=>Ki(e,{_tag:"Unnested",name:t})),Kl=jN(2,(e,t)=>{let r=BI(t,BR),n=e;for(;BA(r);){let e=r.head;switch(e._tag){case"Empty":r=r.tail;break;case"AndThen":r=BD(e.first,BD(e.second,r.tail));break;case"MapName":n=$1(n,e.f),r=r.tail;break;case"Nested":n=$_(n,e.name),r=r.tail;break;case"Unnested":if(!j$($R(n),$r(e.name)))return PM(Ke(n,`Expected ${e.name} to be in path in ConfigProvider#unnested`));n=$j(n),r=r.tail}}return PA(n)}),Ku="Fallback",Kc="Lazy",Kh="MapOrFail",Kf="Nested",Kp="Primitive",Kd="ZipWith",Kg=(e,t)=>[...e,...t],Km=Symbol.for("effect/ConfigProvider"),Kb=Py("effect/ConfigProvider"),Ky=Symbol.for("effect/ConfigProviderFlat"),Kv=e=>({[Ky]:Ky,patch:e.patch,load:(t,r,n=!0)=>e.load(t,r,n),enumerateChildren:e.enumerateChildren}),KS=e=>({[Km]:Km,pipe(){return DF(this,arguments)},...{load:t=>JU(Kx(e,$X(),t,!1),e=>PX($R(e),{onNone:()=>JD(Ke($X(),`Expected a single value having structure: ${t}`)),onSome:J7})),flattened:e}}),Kx=(e,t,r,n)=>{switch(r._tag){case"Constant":return J7($0(r.value));case"Described":return J9(()=>Kx(e,t,r.config,n));case"Fail":return JD(Ke(t,r.message));case Ku:return j$(J9(()=>Kx(e,t,r.first,n)),JF(i=>r.condition(i)?j$(Kx(e,t,r.second,n),JF(e=>JD(W9(i,e)))):JD(i)));case Kc:return J9(()=>Kx(e,t,r.config(),n));case Kh:return J9(()=>j$(Kx(e,t,r.original,n),JU(JK(e=>j$(r.mapOrFail(e),J1(Kt(((e,t)=>{let r=t;if("Nested"===r._tag){let t=e.slice();for(;"Nested"===r._tag;)t.push(r.name),r=r.config;return t}return e})(t,r.original))))))));case Kf:return J9(()=>Kx(e,Kg(t,$0(r.name)),r.config,n));case Kp:return j$(Kl(t,e.patch),JU(t=>j$(e.load(t,r,n),JU(e=>{if(0===e.length){let e=j$($M(t),P0(()=>"<n/a>"));return JD(Ke([],`Expected ${r.description} with name ${e}`))}return J7(e)}))));case"Sequence":return j$(Kl(t,e.patch),JU(n=>j$(e.enumerateChildren(n),JU(KO),JU(n=>0===n.length?J9(()=>JX(Kx(e,t,r.config,!0),$0)):j$(JK(n,n=>Kx(e,$w(t,`[${n}]`),r.config,!0)),JX(e=>{let t=$3(e);return 0===t.length?$0($X()):$0(t)}))))));case"HashMap":return J9(()=>j$(Kl(t,e.patch),JU(t=>j$(e.enumerateChildren(t),JU(i=>j$(i,JK(i=>Kx(e,Kg(t,$0(i)),r.valueConfig,n)),JX(e=>0===e.length?$0(Ll):j$(Kk(e),$1(e=>(e=>{let t=Lm(Ll);for(let r of e)Lp(t,r[0],r[1]);return Lb(t)})($U($y(i),e)))))))))));case Kd:return J9(()=>j$(Kx(e,t,r.left,n),JA,JU(i=>j$(Kx(e,t,r.right,n),JA,JU(e=>{if(PR(i)&&PR(e))return JD(W7(i.left,e.left));if(PR(i)&&PN(e))return JD(i.left);if(PN(i)&&PR(e))return JD(e.left);if(PN(i)&&PN(e)){var n,s;let a,o,l=j$(t,zs(".")),u=K_(t,l),[c,h]=(n=j$(i.right,$1(PA)),s=j$(e.right,$1(PA)),a=zt(n.length,e=>e>=s.length?PY():Pe([u(e),e+1])),o=zt(s.length,e=>e>=n.length?PY():Pe([u(e),e+1])),[Kg(n,a),Kg(s,o)]);return j$(c,$U(h),JK(([e,t])=>j$(Hh(e,t),JX(([e,t])=>r.zip(e,t)))))}throw Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},K_=(e,t)=>r=>PM(Ke(e,`The element at index ${r} in a sequence at path "${t}" was missing`)),Kw=((e,t)=>KS(Kv({load:(t,r)=>e.flattened.load(t,r,!0),enumerateChildren:t=>e.flattened.enumerateChildren(t),patch:Ka(e.flattened.patch,t)})),(e,t)=>Kv({load:(r,n,i)=>j$(Kl(r,e.patch),JU(t=>e.load(t,n,i)),JF(e=>j$(He(t),JU(t=>j$(Kl(r,t.patch),JU(e=>t.load(e,n,i)),JF(t=>JD(W9(e,t)))))))),enumerateChildren:r=>j$(Kl(r,e.patch),JU(t=>e.enumerateChildren(t)),JA,JU(e=>j$(He(t),JU(t=>j$(Kl(r,t.patch),JU(e=>t.enumerateChildren(e)),JA,JU(t=>{if(PR(e)&&PR(t))return JD(W7(e.left,t.left));if(PR(e)&&PN(t))return J7(t.right);if(PN(e)&&PR(t))return J7(e.right);if(PN(e)&&PN(t))return J7(j$(e.right,LL(t.right)));throw Error("BUG: ConfigProvider.orElseFlat - please report an issue at https://github.com/Effect-TS/effect/issues")})))))),patch:Kn})),Kk=e=>Object.keys(e[0]).map(t=>e.map(e=>e[t])),KO=e=>j$(JK(e,KC),J0({onFailure:()=>$X(),onSuccess:$L(PW)}),JA,JX(PL)),KE=/^(\[(\d+)\])$/,KC=e=>{let t=e.match(KE);if(null!==t){let e=t[2];return j$(void 0!==e&&e.length>0?Pe(e):PY(),P9(KF))}return PY()},KF=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?PY():Pe(t)},KI=Symbol.for("effect/Console"),KT=Py("effect/Console"),KR={[KI]:KI,assert:(e,...t)=>He(()=>{console.assert(e,...t)}),clear:He(()=>{console.clear()}),count:e=>He(()=>{console.count(e)}),countReset:e=>He(()=>{console.countReset(e)}),debug:(...e)=>He(()=>{console.debug(...e)}),dir:(e,t)=>He(()=>{console.dir(e,t)}),dirxml:(...e)=>He(()=>{console.dirxml(...e)}),error:(...e)=>He(()=>{console.error(...e)}),group:e=>e?.collapsed?He(()=>console.groupCollapsed(e?.label)):He(()=>console.group(e?.label)),groupEnd:He(()=>{console.groupEnd()}),info:(...e)=>He(()=>{console.info(...e)}),log:(...e)=>He(()=>{console.log(...e)}),table:(e,t)=>He(()=>{console.table(e,t)}),time:e=>He(()=>console.time(e)),timeEnd:e=>He(()=>console.timeEnd(e)),timeLog:(e,...t)=>He(()=>{console.timeLog(e,...t)}),trace:(...e)=>He(()=>{console.trace(...e)}),warn:(...e)=>He(()=>{console.warn(...e)}),unsafe:console},KN=Symbol.for("effect/Random"),KM=Py("effect/Random"),KA=(e,t)=>J9(()=>j$(He(()=>Array.from(e)),JU(e=>{let r=[];for(let t=e.length;t>=2;t-=1)r.push(t);return j$(r,JV(r=>j$(t(r),JX(t=>Kj(e,r-1,t)))),Jx(zb(e)))}))),Kj=(e,t,r)=>{let n=e[t];return e[t]=e[r],e[r]=n,e},KD=Symbol.for("effect/Tracer"),KP=Py("effect/Tracer"),K$=Py("effect/ParentSpan"),Kz=(F=(C="abcdef0123456789").length,function(e){let t="";for(let r=0;r<e;r++)t+=C.charAt(Math.floor(Math.random()*F));return t});class KL{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor(e,t,r,n,i,s){this.name=e,this.parent=t,this.context=r,this.startTime=i,this.kind=s,this.status={_tag:"Started",startTime:i},this.attributes=new Map,this.traceId="Some"===t._tag?t.value.traceId:Kz(32),this.spanId=Kz(16),this.links=Array.from(n)}end(e,t){this.status={_tag:"Ended",endTime:e,exit:t,startTime:this.status.startTime}}attribute(e,t){this.attributes.set(e,t)}event(e,t,r){this.events.push([e,t,r??{}])}addLinks(e){this.links.push(...e)}}let KU={[KD]:KD,...{span:(e,t,r,n,i,s)=>new KL(e,t,r,n,i,s),context:e=>e()}},KB=PS()("effect/Tracer/DisablePropagation",{defaultValue:jD}),Kq=j$(Pc,Pf(WG,new W0),Pf(KT,KR),Pf(KM,new class e{seed;[KN]=KN;PRNG;constructor(e){this.seed=e,this.PRNG=new j4(e)}get next(){return He(()=>this.PRNG.number())}get nextBoolean(){return JX(this.next,e=>e>.5)}get nextInt(){return He(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(e,t){return JX(this.next,r=>(t-e)*r+e)}nextIntBetween(e,t){return He(()=>this.PRNG.integer(t-e)+e)}shuffle(e){return KA(e,e=>this.nextIntBetween(0,e))}}(Di(Math.random()))),Pf(Kb,(e=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),n=()=>"undefined"!=typeof process&&"env"in process&&"object"==typeof process.env?process.env:{};return KS(Kv({load:(e,i,s=!0)=>{let a=j$(e,zs(t)),o=n();return j$(a in o?Pe(o[a]):PY(),J1(()=>Ke(e,`Expected ${a} to exist in the process context`)),JU(t=>((e,t,r,n,i)=>i?j$(e.split(RegExp(`\\s*${W1(n)}\\s*`)),JK(e=>r.parse(e.trim())),J1(Kt(t))):j$(r.parse(e),J0({onFailure:Kt(t),onSuccess:$0})))(t,e,i,r,s)))},enumerateChildren:e=>He(()=>{var r=Object.keys(n()).map(e=>e.toUpperCase().split(t)).filter(t=>{for(let r=0;r<e.length;r++){let n=j$(e,$T(r)),i=t[r];if(void 0===i||n!==i)return!1}return!0}).flatMap(t=>t.slice(e.length,e.length+1));let i=LA(LT());for(let e of r)LP(i,e);return Lj(i)}),patch:Kn}))})()),Pf(KP,KU)),KJ=jL(Symbol.for("effect/DefaultServices/currentServices"),()=>HD(Kq)),KH=e=>Jv(t=>e(t.currentDefaultServices)),KW=e=>KH(t=>e(t.unsafeMap.get(WG.key))),KK=KW(e=>e.currentTimeMillis),KV=(KH(e=>e.unsafeMap.get(KM.key).next),e=>!e),KG=((e,t)=>!e&&t||e&&!t,DX),KZ=D0;class KQ extends KG{}class KY extends KZ{}let KX="Sequential",K0="Parallel",K1={_tag:KX},K2={_tag:K0},K3=e=>({_tag:"ParallelN",parallelism:e}),K5=Symbol.for("effect/FiberRefs");class K4{locals;[K5]=K5;constructor(e){this.locals=e}pipe(){return DF(this,arguments)}}let K6=jN(3,(e,t,r)=>{let n=new Map(e.locals);return r.locals.forEach((e,r)=>{let i=e[0][1];if(!e[0][0][Dd](t)){if(!n.has(r)){if(Dg(i,r.initial))return;n.set(r,[[t,r.join(r.initial,i)]]);return}let s=n.get(r),[a,o]=((e,t,r,n=!1)=>{let i,s=t,a=r,o=n;for(;void 0===i;)if($E(s)&&$E(a)){let e=$N(s)[0],t=$j(s),r=$N(a)[0],n=$N(a)[1],l=$j(a);e.startTimeMillis<r.startTimeMillis?(a=l,o=!0):e.startTimeMillis>r.startTimeMillis?s=t:e.id<r.id?(a=l,o=!0):e.id>r.id?s=t:i=[n,o]}else i=[e.initial,!0];return i})(r,s,e);if(o){let e=r.diff(a,i),o=s[0][1],l=r.join(o,r.patch(e)(o));if(!Dg(o,l)){let e,i=s[0][0];e=i[Dd](t)?[[i,l],...s.slice(1)]:[[t,l],...s],n.set(r,e)}}}}),new K4(n)}),K8=jN(2,(e,t)=>{let r=new Map;return K7(e,r,t),new K4(r)}),K7=(e,t,r)=>{e.locals.forEach((e,n)=>{let i=e[0][1],s=n.patch(n.fork)(i);Dg(i,s)?t.set(n,e):t.set(n,[[r,s],...e])})},K9=jN(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new K4(r)}),Ve=jN(2,(e,t)=>e.locals.has(t)?Pe($N(e.locals.get(t))[1]):PY()),Vt=jN(2,(e,t)=>j$(Ve(e,t),P0(()=>t.initial))),Vr=jN(2,(e,{fiberId:t,fiberRef:r,value:n})=>{if(0===e.locals.size)return new K4(new Map([[r,[[t,n]]]]));let i=new Map(e.locals);return Vn(i,t,r,n),new K4(i)}),Vn=(e,t,r,n)=>{let i,s=e.get(r)??[];if($E(s)){let[e,r]=$N(s);if(e[Dd](t))if(Dg(r,n))return;else i=[[t,n],...s.slice(1)];else i=[[t,n],...s]}else i=[[t,n]];e.set(r,i)},Vi=jN(2,(e,{entries:t,forkAs:r})=>{if(0===e.locals.size)return new K4(new Map(t));let n=new Map(e.locals);return void 0!==r&&K7(e,n,r),t.forEach(([e,t])=>{1===t.length?Vn(n,t[0][0],e,t[0][1]):t.forEach(([t,r])=>{Vn(n,t,e,r)})}),new K4(n)}),Vs="Empty",Va="Remove",Vo="Update",Vl="AndThen",Vu={_tag:Vs},Vc=(e,t)=>{let r=new Map(e.locals),n=Vu;for(let[e,i]of t.locals.entries()){let t=$N(i)[1],s=r.get(e);if(void 0!==s){let r=$N(s)[1];Dg(r,t)||(n=Vh({_tag:Vo,fiberRef:e,patch:e.diff(r,t)})(n))}else n=Vh({_tag:"Add",fiberRef:e,value:t})(n);r.delete(e)}for(let[e]of r.entries())n=Vh({_tag:Va,fiberRef:e})(n);return n},Vh=jN(2,(e,t)=>({_tag:Vl,first:e,second:t})),Vf=jN(3,(e,t,r)=>{let n=r,i=$0(e);for(;$E(i);){let e=$N(i),r=$j(i);switch(e._tag){case Vs:i=r;break;case"Add":n=Vr(n,{fiberId:t,fiberRef:e.fiberRef,value:e.value}),i=r;break;case Va:n=K9(n,e.fiberRef),i=r;break;case Vo:{let s=Vt(n,e.fiberRef);n=Vr(n,{fiberId:t,fiberRef:e.fiberRef,value:e.fiberRef.patch(e.patch)(s)}),i=r;break}case Vl:i=$_(e.first)($_(e.second)(r))}}return n}),Vp="effect/FiberStatus",Vd=Symbol.for(Vp),Vg="Done",Vm="Running",Vb="Suspended",Vy=Dc(`${Vp}-${Vg}`);class Vv{runtimeFlags;[Vd]=Vd;_tag=Vm;constructor(e){this.runtimeFlags=e}[Dn](){return j$(Di(Vp),Da(Di(this._tag)),Da(Di(this.runtimeFlags)),Dp(this))}[Dd](e){return V_(e)&&e._tag===Vm&&this.runtimeFlags===e.runtimeFlags}}class VS{runtimeFlags;blockingOn;[Vd]=Vd;_tag=Vb;constructor(e,t){this.runtimeFlags=e,this.blockingOn=t}[Dn](){return j$(Di(Vp),Da(Di(this._tag)),Da(Di(this.runtimeFlags)),Da(Di(this.blockingOn)),Dp(this))}[Dd](e){return V_(e)&&e._tag===Vb&&this.runtimeFlags===e.runtimeFlags&&Dg(this.blockingOn,e.blockingOn)}}let Vx=new class{[Vd]=Vd;_tag=Vg;[Dn](){return Vy}[Dd](e){return V_(e)&&e._tag===Vg}},V_=e=>jZ(e,Vd),Vw=e=>new Vv(e),Vk={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return DF(this,arguments)}},VO={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return DF(this,arguments)}},VE={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return DF(this,arguments)}},VC=PG(j$(PW,PV(e=>e.ordinal))),VF=Symbol.for("effect/Micro"),VI=Symbol.for("effect/Micro/MicroExit"),VT=e=>"object"==typeof e&&null!==e&&VF in e,VR=Symbol.for("effect/Micro/MicroCause"),VN={_E:jM};class VM extends globalThis.Error{_tag;traces;[VR];constructor(e,t,r){let n,i,s;const a=`MicroCause.${e}`;if(t instanceof globalThis.Error){n=`(${a}) ${t.name}`;const e=(i=t.message).split("\n").length;s=t.stack?`(${a}) ${t.stack.split("\n").slice(0,e+3).join("\n")}`:`${n}: ${i}`}else n=a,i=D_(t,0),s=`${n}: ${i}`;r.length>0&&(s+=`
    ${r.join("\n    ")}`),super(i),this._tag=e,this.traces=r,this[VR]=VN,this.name=n,this.stack=s}pipe(){return DF(this,arguments)}toString(){return this.stack}[Dy](){return this.stack}}class VA extends VM{error;constructor(e,t=[]){super("Fail",e,t),this.error=e}}class Vj extends VM{defect;constructor(e,t=[]){super("Die",e,t),this.defect=e}}class VD extends VM{constructor(e=[]){super("Interrupt","interrupted",e)}}let VP=e=>"Fail"===e._tag,V$=e=>"Interrupt"===e._tag,Vz=Symbol.for("effect/Micro/MicroFiber"),VL={_A:jM,_E:jM};class VU{context;interruptible;[Vz];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(e,t=!0){this.context=e,this.interruptible=t,this[Vz]=VL}getRef(e){let t;return t=this.context,t.unsafeMap.has(e.key)?t.unsafeMap.get(e.key):Pd(e)}addObserver(e){return this._exit?(e(this._exit),jP):(this._observers.push(e),()=>{let t=this._observers.indexOf(e);t>=0&&this._observers.splice(t,1)})}_interrupted=!1;unsafeInterrupt(){!this._exit&&(this._interrupted=!0,this.interruptible&&this.evaluate(Gf))}unsafePoll(){return this._exit}evaluate(e){if(this._exit)return;if(void 0!==this._yielded){let e=this._yielded;this._yielded=void 0,e()}let t=this.runLoop(e);if(t===VZ)return;let r=VB.interruptChildren&&VB.interruptChildren(this);if(void 0!==r)return this.evaluate(Ga(r,()=>t));this._exit=t;for(let e=0;e<this._observers.length;e++)this._observers[e](t);this._observers.length=0}runLoop(e){let t=!1,r=e;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!t&&this.getRef(G_).shouldYield(this)){t=!0;let e=r;r=Ga(V6,()=>e)}if((r=r[VW](this))===VZ){let e=this._yielded;if(VI in e)return this._yielded=void 0,e;return VZ}}}catch(e){if(!jZ(r,VW))return Gp(`MicroFiber.runLoop: Not a valid effect: ${String(r)}`);return Gp(e)}}getCont(e){for(;;){let t=this._stack.pop();if(!t)return;let r=t[VG]&&t[VG](this);if(r)return{[e]:r};if(t[e])return t}}_yielded=void 0;yieldWith(e){return this._yielded=e,VZ}children(){return this._children??=new Set}}let VB=jL("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),Vq=e=>V4(()=>{for(let t of e)t.unsafeInterrupt();let t=e[Symbol.iterator](),r=V4(()=>{let e=t.next();for(;!e.done;){if(e.value.unsafePoll()){e=t.next();continue}let n=e.value;return Gt(e=>{n.addObserver(t=>{e(r)})})}return Gd});return r}),VJ=Symbol.for("effect/Micro/identifier"),VH=Symbol.for("effect/Micro/args"),VW=Symbol.for("effect/Micro/evaluate"),VK=Symbol.for("effect/Micro/successCont"),VV=Symbol.for("effect/Micro/failureCont"),VG=Symbol.for("effect/Micro/ensureCont"),VZ=Symbol.for("effect/Micro/Yield"),VQ={...DG,_op:"Micro",[VF]:{_A:jM,_E:jM,_R:jM},pipe(){return DF(this,arguments)},[Symbol.iterator](){return new j5(new j7(this))},toJSON(){return{_id:"Micro",op:this[VJ],...VH in this?{args:this[VH]}:void 0}},toString(){return JSON.stringify(this,null,2)},[Dy](){return JSON.stringify(this,null,2)}};function VY(e){return Gp("Micro.evaluate: Not implemented")}let VX=e=>({...VQ,[VJ]:e.op,[VW]:e.eval??VY,[VK]:e.contA,[VV]:e.contE,[VG]:e.ensure}),V0=e=>{let t=VX(e);return function(){let r=Object.create(t);return r[VH]=!1===e.single?arguments:arguments[0],r}},V1=e=>{let t={...VX(e),[VI]:VI,_tag:e.op,get[e.prop](){return this[VH]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[VH]}},[Dd](t){return Gu(t)&&t._tag===e.op&&Dg(this[VH],t[VH])},[Dn](){return Dp(this,Da(Dc(e.op))(Di(this[VH])))}};return function(e){let r=Object.create(t);return r[VH]=e,r[VK]=void 0,r[VV]=void 0,r[VG]=void 0,r}},V2=V1({op:"Success",prop:"value",eval(e){let t=e.getCont(VK);return t?t[VK](this[VH],e):e.yieldWith(this)}}),V3=V1({op:"Failure",prop:"cause",eval(e){let t=e.getCont(VV);for(;V$(this[VH])&&t&&e.interruptible;)t=e.getCont(VV);return t?t[VV](this[VH],e):e.yieldWith(this)}}),V5=V0({op:"Sync",eval(e){let t=this[VH](),r=e.getCont(VK);return r?r[VK](t,e):e.yieldWith(Gc(t))}}),V4=V0({op:"Suspend",eval(e){return this[VH]()}}),V6=V0({op:"Yield",eval(e){let t=!1;return e.getRef(G_).scheduleTask(()=>{t||e.evaluate(Gd)},this[VH]??0),e.yieldWith(()=>{t=!0})}})(0),V8=V2(void 0),V7=V0({op:"WithMicroFiber",eval(e){return this[VH](e)}}),V9=V0({op:"Async",single:!1,eval(e){let t=this[VH][0],r=!1,n=!1,i=this[VH][1]?new AbortController:void 0,s=t(t=>{r||(r=!0,n?e.evaluate(t):n=t)},i?.signal);return!1!==n?n:(n=!0,e._yielded=()=>{r=!0},void 0===i&&void 0===s||e._stack.push(Ge(()=>(r=!0,i?.abort(),s??Gd))),VZ)}}),Ge=V0({op:"AsyncFinalizer",ensure(e){e.interruptible&&(e.interruptible=!1,e._stack.push(GM(!0)))},contE(e,t){return V$(e)?Ga(this[VH](),()=>V3(e)):V3(e)}}),Gt=e=>V9(e,e.length>=2),Gr=jN(2,(e,t)=>Gl(e,e=>t)),Gn=jN(2,(e,t)=>Ga(e,e=>{let r=VT(t)?t:"function"==typeof t?t(e):t;return VT(r)?r:V2(r)})),Gi=((e,t)=>Ga(e,e=>{let r=VT(t)?t:"function"==typeof t?t(e):t;return VT(r)?Gr(r,e):V2(e)}),e=>GF(e,{onFailure:Gh,onSuccess:Gc})),Gs=jN(2,(e,t)=>{let r;return r=[e,t],V7(e=>Gt(t=>{let n=!1,i=new Set,s=e=>{n=!0,t(0===i.size?e:Ga(Vq(i),()=>e))};for(let t of r){if(n)break;let r=Gz(e,GA(t),!0,!0);i.add(r),r.addObserver(e=>{i.delete(r),s(e)})}return Vq(i)}))}),Ga=jN(2,(e,t)=>{let r=Object.create(Go);return r[VH]=e,r[VK]=t,r}),Go=VX({op:"OnSuccess",eval(e){return e._stack.push(this),this[VH]}}),Gl=jN(2,(e,t)=>Ga(e,e=>V2(t(e)))),Gu=e=>jZ(e,VI),Gc=V2,Gh=V3,Gf=Gh(((e=[])=>new VD(e))()),Gp=e=>Gh(((e,t=[])=>new Vj(e,t))(e)),Gd=Gc(void 0),Gg=e=>{for(let t of e)if("Failure"===t._tag)return t;return Gd},Gm="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class Gb{tasks=[];running=!1;scheduleTask(e,t){this.tasks.push(e),this.running||(this.running=!0,Gm(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let e=this.tasks;this.tasks=[];for(let t=0,r=e.length;t<r;t++)e[t]()}shouldYield(e){return e.currentOpCount>=e.getRef(GS)}flush(){for(;this.tasks.length>0;)this.runTasks()}}let Gy=jN(2,(e,t)=>V7(r=>{let n=r.context;return r.context=t(n),GN(e,()=>(r.context=n,V8))})),Gv=jN(2,(e,t)=>Gy(e,Pb(t)));(e,t,r)=>Gy(e,Pf(t,r));class GS extends PS()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class Gx extends PS()("effect/Micro/currentConcurrency",{defaultValue:()=>"unbounded"}){}class G_ extends PS()("effect/Micro/currentScheduler",{defaultValue:()=>new Gb}){}e=>VT(e[1]),(e,t)=>Array.from({length:t},()=>e);let Gw=jN(2,(e,t)=>{let r=Object.create(Gk);return r[VH]=e,r[VV]=t,r}),Gk=VX({op:"OnFailure",eval(e){return e._stack.push(this),this[VH]}}),GO=jN(3,(e,t,r)=>Gw(e,e=>t(e)?r(e):V3(e))),GE=((e,t)=>GO(e,VP,e=>t(e.error)),jN(2,(e,t)=>{let r=Object.create(GC);return r[VH]=e,r[VK]=t.onSuccess,r[VV]=t.onFailure,r})),GC=VX({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[VH]}}),GF=jN(2,(e,t)=>GE(e,{onFailure:e=>V5(()=>t.onFailure(e)),onSuccess:e=>V5(()=>t.onSuccess(e))})),GI=((e,t)=>GE(e,{onFailure:e=>"Fail"===e._tag?t.onFailure(e.error):V3(e),onSuccess:t.onSuccess}),e=>Gt(t=>{let r=setTimeout(()=>{t(V8)},e);return V5(()=>{clearTimeout(r)})})),GT=((e,t)=>Gs(e,Gn(GA(GI(t.duration)),t.onTimeout)),Symbol.for("effect/Micro/MicroScope"));class GR{[GT];state={_tag:"Open",finalizers:new Set};constructor(){this[GT]=GT}unsafeAddFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.add(e)}addFinalizer(e){return V4(()=>"Open"===this.state._tag?(this.state.finalizers.add(e),V8):e(this.state.exit))}unsafeRemoveFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.delete(e)}close(e){return V4(()=>{if("Open"===this.state._tag){let t=Array.from(this.state.finalizers).reverse();return this.state={_tag:"Closed",exit:e},Ga(G$(t,t=>Gi(t(e))),Gg)}return V8})}get fork(){return V5(()=>{let e=new GR;if("Closed"===this.state._tag)return e.state=this.state,e;function t(t){return e.close(t)}return this.state.finalizers.add(t),e.unsafeAddFinalizer(e=>V5(()=>this.unsafeRemoveFinalizer(t))),e})}}let GN=jN(2,(e,t)=>Gj(r=>GE(r(e),{onFailure:e=>Ga(t(Gh(e)),()=>V3(e)),onSuccess:e=>Ga(t(Gc(e)),()=>V2(e))}))),GM=((e,t,r)=>GN(e,e=>t(e)?r(e):Gd),V0({op:"SetInterruptible",ensure(e){if(e.interruptible=this[VH],e._interrupted&&e.interruptible)return()=>Gf}})),GA=e=>V7(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(GM(!1)),t._interrupted)?Gf:e),Gj=e=>V7(t=>t.interruptible?(t.interruptible=!1,t._stack.push(GM(!0)),e(GA)):e(jM)),GD=(e,t)=>Array.isArray(e)||j1(e)?G$(e,jM,t):t?.discard?G$(Object.values(e),jM,t):V4(()=>{let r={};return Gr(G$(Object.entries(e),([e,t])=>Gl(t,t=>{r[e]=t}),{discard:!0,concurrency:t?.concurrency}),r)}),GP=V0({op:"While",contA(e,t){return(this[VH].step(e),this[VH].while())?(t._stack.push(this),this[VH].body()):Gd},eval(e){return this[VH].while()?(e._stack.push(this),this[VH].body()):Gd}}),G$=(e,t,r)=>V7(n=>{let i=r?.concurrency==="inherit"?n.getRef(Gx):r?.concurrency??1,s="unbounded"===i?1/0:Math.max(1,i),a=$y(e),o=a.length;if(0===o)return r?.discard?V8:V2([]);let l=r?.discard?void 0:Array(o),u=0;return 1===s?Gr(GP({while:()=>u<a.length,body:()=>t(a[u],u),step:l?e=>l[u++]=e:e=>u++}),l):Gt(e=>{let r,i=new Set,c=0,h=0,f=!1,p=!1;return!function d(){for(f=!0;c<s&&u<o;){let g=u,m=a[g];u++,c++;try{let a=Gz(n,t(m,g),!0,!0);i.add(a),a.addObserver(t=>{i.delete(a),p||("Failure"===t._tag?void 0===r&&(r=t,o=u,i.forEach(e=>e.unsafeInterrupt())):void 0!==l&&(l[g]=t.value),h++,c--,h===o?e(r??V2(l)):!f&&c<s&&d())})}catch(e){r=Gp(e),o=u,i.forEach(e=>e.unsafeInterrupt())}}f=!1}(),V4(()=>(p=!0,u=o,Vq(i)))})}),Gz=(e,t,r=!1,n=!1)=>{let i=new VU(e.context,e.interruptible);return n||(e.children().add(i),i.addObserver(()=>e.children().delete(i))),r?i.evaluate(t):e.getRef(G_).scheduleTask(()=>i.evaluate(t),0),i},GL=function(){class e extends globalThis.Error{}return Object.assign(e.prototype,VQ,DZ,{[VJ]:"Failure",[VW](){return V3(((e,t=[])=>new VA(e,t))(this))},toString(){return this.message?`${this.name}: ${this.message}`:this.name},toJSON(){return{...this}},[Dy](){let e=this.stack;return e?`${this.toString()}
${e.split("\n").slice(1).join("\n")}`:this.toString()}}),e}(),GU=class extends GL{constructor(e){super(),e&&Object.assign(this,e)}},GB=e=>{class t extends GU{_tag=e}return t.prototype.name=e,t},Gq=Symbol.for("effect/Readable"),GJ=Symbol.for("effect/Ref"),GH={_A:e=>e};class GW extends KQ{ref;commit(){return this.get}[GJ]=GH;[Gq]=Gq;constructor(e){super(),this.ref=e,this.get=He(()=>this.ref.current)}get;modify(e){return He(()=>{let t=this.ref.current,[r,n]=e(t);return t!==n&&Bn(n)(this.ref),r})}}let GK=e=>new GW(Bt(e)),GV=e=>He(()=>GK(e)),GG=jN(2,(e,t)=>e.modify(()=>[void 0,t])),GZ=jN(2,(e,t)=>e.modify(e=>[e,t])),GQ=jN(2,(e,t)=>e.modify(t)),GY=jN(2,(e,t)=>e.modify(e=>[void 0,t(e)]));class GX{buckets=[];scheduleTask(e,t){let r,n=this.buckets.length,i=0;for(;i<n;i++)if(this.buckets[i][0]<=t)r=this.buckets[i];else break;r&&r[0]===t?r[1].push(e):i===n?this.buckets.push([t,[e]]):this.buckets.splice(i,0,[t,[e]])}}class G0{maxNextTickBeforeTimer;running=!1;tasks=new GX;constructor(e){this.maxNextTickBeforeTimer=e}starveInternal(e){let t=this.tasks.buckets;for(let[e,r]of(this.tasks.buckets=[],t))for(let e=0;e<r.length;e++)r[e]();0===this.tasks.buckets.length?this.running=!1:this.starve(e)}starve(e=0){e>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(e+1))}shouldYield(e){return e.currentOpCount>e.getFiberRef(HL)&&e.getFiberRef(Hz)}scheduleTask(e,t){this.tasks.scheduleTask(e,t),this.running||(this.running=!0,this.starve())}}let G1=jL(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new G0(2048));class G2{tasks=new GX;deferred=!1;scheduleTask(e,t){this.deferred?G1.scheduleTask(e,t):this.tasks.scheduleTask(e,t)}shouldYield(e){return e.currentOpCount>e.getFiberRef(HL)&&e.getFiberRef(Hz)}flush(){for(;this.tasks.buckets.length>0;){let e=this.tasks.buckets;for(let[t,r]of(this.tasks.buckets=[],e))for(let e=0;e<r.length;e++)r[e]()}this.deferred=!0}}let G3=jL(Symbol.for("effect/FiberRef/currentScheduler"),()=>Hj(G1)),G5=jL(Symbol.for("effect/FiberRef/currentRequestMap"),()=>Hj(new Map)),G4=(e,t,r,n)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return HE(HH,e=>"unbounded"===e?r():e>1?n(e):t());default:return e>1?n(e):t()}},G6=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return HE(HH,e=>"unbounded"===e||e>1?r():t());default:return e>1?r():t()}},G8=e=>{let t=Uj(e);return KW(e=>e.sleep(t))},G7=e=>e.replace(/[\s="]/g,"_"),G9=e=>t=>{let r=G7(t.label);return`${r}=${e-t.startTime}ms`},Ze=e=>({_tag:"ExternalSpan",spanId:e.spanId,traceId:e.traceId,sampled:e.sampled??!0,context:e.context??Pc}),Zt="effect/MetricLabel",Zr=Symbol.for(Zt);class Zn{key;value;[Zr]=Zr;_hash;constructor(e,t){this.key=e,this.value=t,this._hash=Dc(Zt+this.key+this.value)}[Dn](){return this._hash}[Dd](e){return Zi(e)&&this.key===e.key&&this.value===e.value}pipe(){return DF(this,arguments)}}let Zi=e=>jZ(e,Zr),Zs=(e=>Jy(e[0]),e=>{let t,r;return"function"==typeof e?t=e:(t=e.try,r=e.catch),J9(()=>{try{return J7(Dt(t))}catch(e){return JD(r?Dt(()=>r(e)):new Wh(e,"An unknown error occurred in Effect.try"))}})}),Za=jN(2,(e,t)=>JH(e,{onFailure:e=>{let r=t(e);switch(r._tag){case"None":return JP(e);case"Some":return r.value}},onSuccess:J7})),Zo=((e=>Jy(e[0]),(e,...t)=>{let r=t[t.length-1];return JI(e,2===t.length?jQ(t[0]):e=>{let r=jZ(e,"_tag")?e._tag:void 0;if(!r)return!1;for(let e=0;e<t.length-1;e++)if(t[e]===r)return!0;return!1},r)}),jN(2,(e,t)=>{let r;return JI(e,e=>(r??=Object.keys(t),jZ(e,"_tag")&&jU(e._tag)&&r.includes(e._tag)),e=>t[e._tag](e))})),Zl=jN(3,(e,t,r)=>JU(e,e=>JX(r(e),r=>({...e,[t]:r})))),Zu=jN(2,(e,t)=>JX(e,e=>({[t]:e}))),Zc=((e,t)=>J9(()=>{let r,n=e[Symbol.iterator](),i=[],s=J7(!1),a=0;for(;(r=n.next())&&!r.done;){let e=r.value,n=a++;s=JU(s,r=>r?(i.push(e),J7(!0)):t(e,n))}return JX(s,()=>i)}),jN(3,(e,t,r)=>JU(e,e=>t(e)?J7(e):r(e)))),Zh=((e=>Jy(e[0]),(e,t,r)=>Zc(e,t,e=>void 0===r?JD(new Wa):JU(He(()=>r(e)),JD))),(e,t,r,n)=>JU(r(n,t),i=>{if(i)return J7(Pe(n));let s=e.next();return s.done?J7(PY()):Zh(e,t+1,r,s.value)})),Zf=jN(2,(e,t)=>JW(e,{onFailure:e=>J7(t.onFailure(e)),onSuccess:e=>J7(t.onSuccess(e))})),Zp=e=>{let t=JU(JU(e,()=>Hc()),()=>t);return t},Zd=Jv(e=>J7(e.getFiberRefs())),Zg=((e,t)=>JU(KK,r=>HA(e,Hq,BL({label:t,startTime:r}))),jN(2,(e,t)=>JH(e,{onFailure:e=>J$(()=>t(e)),onSuccess:J7}))),Zm=e=>JX(GV(!0),t=>J_(Ho(e,GZ(t,!1)))),Zb=e=>ZF((t,r)=>j$(e,Vf(t,r))),Zy=jN(3,(e,t,r)=>JU(WB,n=>Wq(e,Pf(n,t,r)))),Zv=jN(3,(e,t,r)=>{let n;return n=n=>JU(r,r=>Wq(e,j$(n,Pf(t,r)))),JU(WB,n)}),ZS=jN(3,(e,t,r)=>$y(e).reduce((e,t,n)=>JU(e,e=>r(e,t,n)),J7(t))),Zx=J7(PY()),Z_=jN(3,(e,t,r)=>JU(t,n=>JU(e,e=>JX(t,t=>[r(n,t),e]))));(e,t)=>J9(()=>{let r,n=e[Symbol.iterator](),i=[],s=J7(!0),a=0;for(;(r=n.next())&&!r.done;){let e=r.value,n=a++;s=JU(s,r=>j$(r?t(e,n):J7(!1),JX(t=>(t&&i.push(e),t))))}return JX(s,()=>i)});let Zw=jN(2,(e,t)=>JC(e,e=>PX(Ug(e,{onEmpty:PY(),onFail:()=>PY(),onDie:e=>Pe(L1(e)),onInterrupt:()=>PY(),onSequential:$i(L5),onParallel:$i(L3)}),{onNone:()=>JP(e),onSome:r=>Hp(t(r),JP(e))}))),Zk=jN(2,(e,t)=>JH(e,{onFailure:e=>{let r=Ut(e);switch(r._tag){case"Left":return Hp(t(r.left),JP(e));case"Right":return JP(e)}},onSuccess:J7})),ZO=jN(2,(e,t)=>JH(e,{onFailure:e=>Hp(t(e),JP(e)),onSuccess:J7})),ZE=e=>{let t,r;"function"==typeof e?t=e:(t=e.try,r=e.catch);let n=e=>r?JU(He(()=>r(e)),JD):JD(new Wh(e,"An unknown error occurred in Effect.tryPromise"));return t.length>=1?JE((e,r)=>{try{t(r).then(t=>e(J7(t)),t=>e(n(t)))}catch(t){e(n(t))}}):JE(e=>{try{t().then(t=>e(J7(t)),t=>e(n(t)))}catch(t){e(n(t))}})},ZC=jN(2,(e,t)=>JU(e,e=>Zs({try:()=>t.try(e),catch:t.catch}))),ZF=e=>Jv(t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),Hs)),ZI=((e,t,r)=>WH(e,e=>Pf(e,t,r(Pg(e,t)))),jN(2,(e,t)=>J9(()=>t()?JX(e,Pe):J7(PY())))),ZT=BigInt(0),ZR=P9(e=>Pg(e.context,KB)?"Span"===e._tag?ZR(e.parent):PY():Pe(e)),ZN=jN(2,(e,t)=>Zy(e,K$,t)),ZM="InterruptSignal",ZA="Stateful",Zj="Resume",ZD="YieldNow",ZP=e=>({_tag:ZM,cause:e}),Z$=e=>({_tag:ZA,onFiber:e}),Zz=e=>({_tag:Zj,effect:e}),ZL=()=>({_tag:ZD}),ZU=Symbol.for("effect/FiberScope");class ZB{[ZU]=ZU;fiberId=Bx;roots=new Set;add(e,t){this.roots.add(t),t.addObserver(()=>{this.roots.delete(t)})}}class Zq{fiberId;parent;[ZU]=ZU;constructor(e,t){this.fiberId=e,this.parent=t}add(e,t){this.parent.tell(Z$(e=>{e.addChild(t),t.addObserver(()=>{e.removeChild(t)})}))}}let ZJ=jL(Symbol.for("effect/FiberScope/Global"),()=>new ZB),ZH=Symbol.for("effect/Fiber"),ZW={_E:e=>e,_A:e=>e},ZK={[ZH]:ZW,pipe(){return DF(this,arguments)}},ZV=Symbol.for("effect/Fiber"),ZG=e=>Hf(Jq(e.await),e.inheritAll),ZZ=((e,t)=>ZZ(e,e=>He(()=>t(e))),jN(2,(e,t)=>({...DQ,commit(){return ZG(this)},...ZK,id:()=>e.id(),await:JU(e.await,Wx(t)),children:e.children,inheritAll:e.inheritAll,poll:JU(e.poll,e=>{switch(e._tag){case"None":return J7(PY());case"Some":return j$(Wx(e.value,t),JX(Pe))}}),interruptAsFork:t=>e.interruptAsFork(t)})));({...DQ,commit(){return ZG(this)},...ZK,id:()=>Bx,await:Hg,children:J7([]),inheritAll:Hg,poll:J7(PY()),interruptAsFork:()=>Hg}),(e,t)=>({...DQ,commit(){return ZG(this)},...ZK,id:()=>Bm(e.id(),t.id()),await:Hd(e.await,t.await,(e,t)=>Wp(e)?e:t),children:e.children,inheritAll:Hp(t.inheritAll,e.inheritAll),poll:Hd(e.poll,t.poll,(e,t)=>{switch(e._tag){case"None":return PY();case"Some":return Wp(e.value)?e:t}}),interruptAsFork:r=>j$(Hb(e,r),Hp(j$(t,Hb(r))),J_)});let ZQ="effect/FiberCurrent",ZY=Symbol.for("effect/Logger"),ZX={_Message:e=>e,_Output:e=>e},Z0=e=>({[ZY]:ZX,log:e,pipe(){return DF(this,arguments)}}),Z1=jN(2,(e,t)=>Z0(r=>t(e.log(r)))),Z2=((e,t)=>Z0(r=>[e.log(r),t.log(r)]),/^[^\s"=]*$/),Z3=(e,t)=>({annotations:r,cause:n,date:i,fiberId:s,logLevel:a,message:o,spans:l})=>{let u=t=>t.match(Z2)?t:e(t),c=(e,t)=>`${G7(e)}=${u(t)}`,h=(e,t)=>" "+c(e,t),f=c("timestamp",i.toISOString());f+=h("level",a.label),f+=h("fiber",Bv(s));let p=$v(o);for(let e=0;e<p.length;e++)f+=h("message",D_(p[e],t));for(let e of(n._tag===LH||(f+=h("cause",Uy(n,{renderErrorCause:!0}))),l))f+=" "+G9(i.getTime())(e);for(let[e,n]of r)f+=h(e,D_(n,t));return f},Z5=Z0(Z3(e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`)),Z4=(JSON.stringify,Z0(({annotations:e,cause:t,date:r,fiberId:n,logLevel:i,message:s,spans:a})=>{let o=r.getTime(),l={},u={};if(e._size>0)for(let[t,r]of e)l[t]=Z6(r);if(BA(a))for(let e of a)u[e.label]=o-e.startTime;let c=$v(s);return{message:1===c.length?Z6(c[0]):c.map(Z6),logLevel:i.label,timestamp:r.toISOString(),cause:L6(t)?void 0:Uy(t,{renderErrorCause:!0}),annotations:l,spans:u,fiberId:Bv(n)}})),Z6=e=>{switch(typeof e){case"bigint":case"function":case"symbol":return String(e);default:return Dv(e)}},Z8=(e,...t)=>{let r="";for(let e=0;e<t.length;e++)r+=`\x1b[${t[e]}m`;return r+e+"\x1b[0m"},Z7=(e,...t)=>e,Z9={None:[],All:[],Trace:["90"],Debug:["34"],Info:["32"],Warning:["33"],Error:["31"],Fatal:["101","30"]},Qe={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},Qt=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`,Qr="object"==typeof process&&null!==process&&"object"==typeof process.stdout&&null!==process.stdout,Qn=Qr&&!0===process.stdout.isTTY,Qi=Qr||"Deno"in globalThis,Qs=(()=>{var e,t,r;let n,i,s,a,o,l;return i="browser"===("auto"===(n=e?.mode??"auto")?Qi?"tty":"browser":n),s="boolean"==typeof e?.colors?e.colors:Qn||i,a=e?.formatDate??Qt,i?(o=(t={colors:s,formatDate:a}).colors?"%c":"",Z0(({annotations:e,cause:r,context:n,date:i,fiberId:s,logLevel:a,message:l,spans:u})=>{let c=Pg(Vt(n,KJ),KT).unsafe,h=$v(l),f=`${o}[${t.formatDate(i)}]`,p=[];if(t.colors&&p.push("color:gray"),f+=` ${o}${a.label}${o} (${Bv(s)})`,t.colors&&p.push(Qe[a._tag],""),BA(u)){let e=G9(i.getTime());for(let t of u)f+=" "+e(t)}f+=":";let d=0;if(h.length>0){let e=Z6(h[0]);"string"==typeof e&&(f+=` ${o}${e}`,t.colors&&p.push("color:deepskyblue"),d++)}if(c.groupCollapsed(f,...p),L6(r)||c.error(Uy(r,{renderErrorCause:!0})),d<h.length)for(;d<h.length;d++)c.log(DC(h[d]));if(e._size>0)for(let[r,n]of e){let e=DC(n);t.colors?c.log(`%c${r}:`,"color:gray",e):c.log(`${r}:`,e)}c.groupEnd()})):(l=(r={colors:s,formatDate:a,stderr:e?.stderr===!0}).colors?Z8:Z7,Z0(({annotations:e,cause:t,context:n,date:i,fiberId:s,logLevel:a,message:o,spans:u})=>{let c=Pg(Vt(n,KJ),KT).unsafe,h=!0===r.stderr?c.error:c.log,f=$v(o),p=l(`[${r.formatDate(i)}]`,"37")+` ${l(a.label,...Z9[a._tag])}`+` (${Bv(s)})`;if(BA(u)){let e=G9(i.getTime());for(let t of u)p+=" "+e(t)}p+=":";let d=0;if(f.length>0){let e=Z6(f[0]);"string"==typeof e&&(p+=" "+l(e,"1","36"),d++)}if(h(p),c.group(),L6(t)||h(Uy(t,{renderErrorCause:!0})),d<f.length)for(;d<f.length;d++)h(DC(f[d]));if(e._size>0)for(let[t,r]of e)h(l(`${t}:`,"1","37"),DC(r));c.groupEnd()}))},"effect/MetricBoundaries"),Qa=Symbol.for(Qs);class Qo{values;[Qa]=Qa;constructor(e){this.values=e,this._hash=j$(Dc(Qs),Da(Df(this.values)))}_hash;[Dn](){return this._hash}[Dd](e){return Ql(e)&&Dg(this.values,e.values)}pipe(){return DF(this,arguments)}}let Ql=e=>jZ(e,Qa),Qu=Symbol.for("effect/MetricKeyType"),Qc="effect/MetricKeyType/Counter",Qh=Symbol.for(Qc),Qf="effect/MetricKeyType/Frequency",Qp=Symbol.for(Qf),Qd="effect/MetricKeyType/Gauge",Qg=Symbol.for(Qd),Qm="effect/MetricKeyType/Histogram",Qb=Symbol.for(Qm),Qy=Symbol.for("effect/MetricKeyType/Summary"),Qv={_In:e=>e,_Out:e=>e};class QS{incremental;bigint;[Qu]=Qv;[Qh]=Qh;constructor(e,t){this.incremental=e,this.bigint=t,this._hash=Dc(Qc)}_hash;[Dn](){return this._hash}[Dd](e){return Qx(e)}pipe(){return DF(this,arguments)}}let Qx=e=>jZ(e,Qh),Q_=e=>jZ(e,Qb),Qw=Symbol.for("effect/MetricKey"),Qk={_Type:e=>e},QO=zr(Dg);class QE{name;keyType;description;tags;[Qw]=Qk;constructor(e,t,r,n=[]){this.name=e,this.keyType=t,this.description=r,this.tags=n,this._hash=j$(Dc(this.name+this.description),Da(Di(this.keyType)),Da(Df(this.tags)))}_hash;[Dn](){return this._hash}[Dd](e){return QC(e)&&this.name===e.name&&Dg(this.keyType,e.keyType)&&Dg(this.description,e.description)&&QO(this.tags,e.tags)}pipe(){return DF(this,arguments)}}let QC=e=>jZ(e,Qw),QF=jN(2,(e,t)=>0===t.length?e:new QE(e.name,e.keyType,e.description,$Z(e.tags,t))),QI=Symbol.for("effect/MutableHashMap"),QT={[QI]:QI,[Symbol.iterator](){return new QR(this)},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(Dv)}},[Dy](){return this.toJSON()},pipe(){return DF(this,arguments)}};class QR{self;referentialIterator;bucketIterator;constructor(e){this.self=e,this.referentialIterator=e.referential[Symbol.iterator]()}next(){if(void 0!==this.bucketIterator)return this.bucketIterator.next();let e=this.referentialIterator.next();return e.done?(this.bucketIterator=new QN(this.self.buckets.values()),this.next()):e}[Symbol.iterator](){return new QR(this.self)}}class QN{backing;constructor(e){this.backing=e}currentBucket;next(){if(void 0===this.currentBucket){let e=this.backing.next();if(e.done)return e;this.currentBucket=e.value[Symbol.iterator]()}let e=this.currentBucket.next();return e.done?(this.currentBucket=void 0,this.next()):e}}let QM=()=>{let e=Object.create(QT);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e},QA=jN(2,(e,t)=>{if(!1===Db(t))return e.referential.has(t)?Pe(e.referential.get(t)):PY();let r=t[Dn](),n=e.buckets.get(r);return void 0===n?PY():Qj(e,n,t)}),Qj=(e,t,r,n=!1)=>{for(let i=0,s=t.length;i<s;i++)if(r[Dd](t[i][0])){let r=t[i][1];return n&&(t.splice(i,1),e.bucketsSize--),Pe(r)}return PY()},QD=jN(2,(e,t)=>D7(QA(e,t))),QP=jN(3,(e,t,r)=>{if(!1===Db(t))return e.referential.set(t,r),e;let n=t[Dn](),i=e.buckets.get(n);return void 0===i?e.buckets.set(n,[[t,r]]):(Q$(e,i,t),i.push([t,r])),e.bucketsSize++,e}),Q$=(e,t,r)=>{for(let n=0,i=t.length;n<i;n++)if(r[Dd](t[n][0])){t.splice(n,1),e.bucketsSize--;return}},Qz=jN(2,(e,t)=>{if(!1===Db(t))return e.referential.delete(t),e;let r=t[Dn](),n=e.buckets.get(r);return void 0===n||(Q$(e,n,t),0===n.length&&e.buckets.delete(r)),e}),QL=e=>e.referential.size+e.bucketsSize,QU=Symbol.for("effect/MetricState"),QB="effect/MetricState/Counter",Qq=Symbol.for(QB),QJ="effect/MetricState/Frequency",QH=Symbol.for(QJ),QW="effect/MetricState/Gauge",QK=Symbol.for(QW),QV="effect/MetricState/Histogram",QG=Symbol.for(QV),QZ="effect/MetricState/Summary",QQ=Symbol.for(QZ),QY={_A:e=>e};class QX{count;[QU]=QY;[Qq]=Qq;constructor(e){this.count=e}[Dn](){return j$(Di(QB),Da(Di(this.count)),Dp(this))}[Dd](e){return Q4(e)&&this.count===e.count}pipe(){return DF(this,arguments)}}let Q0=zr(Dg);class Q1{occurrences;[QU]=QY;[QH]=QH;constructor(e){this.occurrences=e}_hash;[Dn](){return j$(Dc(QJ),Da(Df($y(this.occurrences.entries()))),Dp(this))}[Dd](e){return Q6(e)&&Q0($y(this.occurrences.entries()),$y(e.occurrences.entries()))}pipe(){return DF(this,arguments)}}class Q2{value;[QU]=QY;[QK]=QK;constructor(e){this.value=e}[Dn](){return j$(Di(QW),Da(Di(this.value)),Dp(this))}[Dd](e){return Q8(e)&&this.value===e.value}pipe(){return DF(this,arguments)}}class Q3{buckets;count;min;max;sum;[QU]=QY;[QG]=QG;constructor(e,t,r,n,i){this.buckets=e,this.count=t,this.min=r,this.max=n,this.sum=i}[Dn](){return j$(Di(QV),Da(Di(this.buckets)),Da(Di(this.count)),Da(Di(this.min)),Da(Di(this.max)),Da(Di(this.sum)),Dp(this))}[Dd](e){return Q7(e)&&Dg(this.buckets,e.buckets)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return DF(this,arguments)}}class Q5{error;quantiles;count;min;max;sum;[QU]=QY;[QQ]=QQ;constructor(e,t,r,n,i,s){this.error=e,this.quantiles=t,this.count=r,this.min=n,this.max=i,this.sum=s}[Dn](){return j$(Di(QZ),Da(Di(this.error)),Da(Di(this.quantiles)),Da(Di(this.count)),Da(Di(this.min)),Da(Di(this.max)),Da(Di(this.sum)),Dp(this))}[Dd](e){return Q9(e)&&this.error===e.error&&Dg(this.quantiles,e.quantiles)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return DF(this,arguments)}}let Q4=e=>jZ(e,Qq),Q6=e=>jZ(e,QH),Q8=e=>jZ(e,QK),Q7=e=>jZ(e,QG),Q9=e=>jZ(e,QQ),Ye=Symbol.for("effect/MetricHook"),Yt={_In:e=>e,_Out:e=>e},Yr=e=>({[Ye]:Yt,pipe(){return DF(this,arguments)},...e}),Yn=BigInt(0),Yi=(e,t,r,n,i,s)=>{let a=e,o=t,l=r,u=n,c=i,h=s,f=e,p=t,d=r,g=n,m=i,b=s;for(;;){if(!$E(h))return{quantile:c,value:PY(),consumed:u,rest:[]};if(1===c)return{quantile:c,value:Pe($A(h)),consumed:u+h.length,rest:[]};let e=$N(h),t=$D(h,t=>t===e),r=c*o,n=a/2*r,i=u+t[0].length,s=Math.abs(i-r);if(i<r-n){f=a,p=o,d=$R(h),g=i,m=c,b=t[1],a=f,o=p,l=d,u=g,c=m,h=b;continue}if(i>r+n)return{quantile:c,value:D8(l)?Pe(e):l,consumed:u,rest:h};switch(l._tag){case"None":f=a,p=o,d=$R(h),g=i,m=c,b=t[1],a=f,o=p,l=d,u=g,c=m,h=b;continue;case"Some":if(s<Math.abs(r-l.value)){f=a,p=o,d=$R(h),g=i,m=c,b=t[1],a=f,o=p,l=d,u=g,c=m,h=b;continue}return{quantile:c,value:Pe(l.value),consumed:u,rest:h}}}throw Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},Ys=Symbol.for("effect/MetricPair"),Ya={_Type:e=>e},Yo=(e,t)=>({[Ys]:Ya,metricKey:e,metricState:t,pipe(){return DF(this,arguments)}}),Yl=Symbol.for("effect/MetricRegistry");class Yu{[Yl]=Yl;map=QM();snapshot(){let e=[];for(let[t,r]of this.map)e.push(Yo(t,r.get()));return e}get(e){let t=j$(this.map,QA(e),P5);if(null!=t)return t;if(Qx(e.keyType))return this.getCounter(e);if(jZ(e.keyType,Qg))return this.getGauge(e);if(jZ(e.keyType,Qp))return this.getFrequency(e);if(Q_(e.keyType))return this.getHistogram(e);if(jZ(e.keyType,Qy))return this.getSummary(e);throw Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}getCounter(e){let t=j$(this.map,QA(e),P5);if(null==t){let r,n,i,s=(r=e.keyType.bigint?Yn:0,n=e.keyType.incremental?e.keyType.bigint?e=>e>=Yn:e=>e>=0:e=>!0,Yr({get:()=>new QX(r),update:i=e=>{n(e)&&(r+=e)},modify:i}));j$(this.map,QD(e))||j$(this.map,QP(e,s)),t=s}return t}getFrequency(e){let t=j$(this.map,QA(e),P5);if(null==t){let r=(e=>{let t=new Map;for(let r of e.keyType.preregisteredWords)t.set(r,0);let r=e=>{let r=t.get(e)??0;t.set(e,r+1)};return Yr({get:()=>new Q1(t),update:r,modify:r})})(e);j$(this.map,QD(e))||j$(this.map,QP(e,r)),t=r}return t}getGauge(e){let t=j$(this.map,QA(e),P5);if(null==t){let r,n=(r=e.keyType.bigint?BigInt(0):0,Yr({get:()=>new Q2(r),update:e=>{r=e},modify:e=>{r+=e}}));j$(this.map,QD(e))||j$(this.map,QP(e,n)),t=n}return t}getHistogram(e){let t=j$(this.map,QA(e),P5);if(null==t){let r,n,i,s,a,o,l,u,c,h=(i=new Uint32Array((n=(r=e.keyType.boundaries.values).length)+1),s=new Float64Array(n),a=0,o=0,l=Number.MAX_VALUE,u=5e-324,j$(r,$L(PW),$1((e,t)=>{s[t]=e})),Yr({get:()=>{let e;return new Q3((e={buckets:(()=>{let e=Array(n),t=0;for(let r=0;r<n;r++){let n=s[r];t+=i[r],e[r]=[n,t]}return e})(),count:a,min:l,max:u,sum:o}).buckets,e.count,e.min,e.max,e.sum)},update:c=e=>{let t=0,r=n;for(;t!==r;){let n=Math.floor(t+(r-t)/2);e<=s[n]?r=n:t=n,r===t+1&&(e<=s[t]?r=t:t=r)}i[t]=i[t]+1,a+=1,o+=e,e<l&&(l=e),e>u&&(u=e)},modify:c}));j$(this.map,QD(e))||j$(this.map,QP(e,h)),t=h}return t}getSummary(e){let t=j$(this.map,QA(e),P5);if(null==t){let r=(e=>{let{error:t,maxAge:r,maxSize:n,quantiles:i}=e.keyType,s=j$(i,$L(PW)),a=Array(n),o=0,l=0,u=0,c=0,h=0,f=(e,t)=>{n>0&&(a[(o+=1)%n]=[t,e]),c=0===l?e:Math.min(c,e),h=0===l?e:Math.max(h,e),l+=1,u+=e};return Yr({get:()=>{let e;return e={error:t,quantiles:(e=>{let i=[],o=0;for(;o!==n-1;){let t=a[o];if(null!=t){let[n,s]=t,a=UH(e-n);U6(a,UU)&&U5(a,r)&&i.push(s)}o+=1}return((e,t,r)=>{let n=r.length;if(!$E(t))return $X();let i=t[0],s=t.slice(1),a=Yi(e,n,PY(),0,i,r),o=$0(a);return s.forEach(t=>{o.push(Yi(e,n,a.value,a.consumed,t,a.rest))}),$1(o,e=>[e.quantile,e.value])})(t,s,$L(i,PW))})(Date.now()),count:l,min:c,max:h,sum:u},new Q5(e.error,e.quantiles,e.count,e.min,e.max,e.sum)},update:([e,t])=>f(e,t),modify:([e,t])=>f(e,t)})})(e);j$(this.map,QD(e))||j$(this.map,QP(e,r)),t=r}return t}}let Yc=Symbol.for("effect/Metric"),Yh={_Type:e=>e,_In:e=>e,_Out:e=>e},Yf=jL(Symbol.for("effect/Metric/globalMetricRegistry"),()=>new Yu),Yp=function(e,t,r,n){let i=Object.assign(e=>Ht(e,e=>Yy(i,e)),{[Yc]:Yh,keyType:e,unsafeUpdate:t,unsafeValue:r,unsafeModify:n,register(){return this.unsafeValue([]),this},pipe(){return DF(this,arguments)}});return i},Yd=((e,t)=>Yp(e.keyType,(r,n)=>e.unsafeUpdate(t(r),n),e.unsafeValue,(r,n)=>e.unsafeModify(t(r),n)),(e,t)=>Yg(new QE(e,new QS(t?.incremental??!1,t?.bigint??!1),P3(t?.description)))),Yg=e=>{let t,r=new WeakMap,n=n=>{if(0===n.length)return void 0!==t?t:t=Yf.get(e);let i=r.get(n);return void 0!==i||(i=Yf.get(QF(e,n)),r.set(n,i)),i};return Yp(e.keyType,(e,t)=>n(t).update(e),e=>n(e).get(),(e,t)=>n(t).modify(e))},Ym=((e,t)=>Yp(e.keyType,e.unsafeUpdate,r=>t(e.unsafeValue(r)),e.unsafeModify),jN(3,(e,t,r)=>Yb(e,[new Zn(t,r)]))),Yb=jN(2,(e,t)=>Yp(e.keyType,(r,n)=>e.unsafeUpdate(r,$Z(t,n)),r=>e.unsafeValue($Z(t,r)),(r,n)=>e.unsafeModify(r,$Z(t,n)))),Yy=((e,t,r)=>{let n=e=>Yy(t,r(e));return Zw(e,e=>JV(L7(e),n))},jN(2,(e,t)=>HE(HG,r=>He(()=>e.unsafeUpdate(t,r))))),Yv=jN(2,(e,t)=>HE(G5,r=>He(()=>{if(r.has(e)){let n=r.get(e);n.state.completed||(n.state.completed=!0,WL(n.result,t))}})));class YS{count=0;observers=new Set;interrupted=!1;addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}increment(){this.count++,this.observers.forEach(e=>e(this.count))}decrement(){this.count--,this.observers.forEach(e=>e(this.count))}}let Yx=0;class Y_{self;stack;direction;count=0;constructor(e,t,r){this.self=e,this.stack=t,this.direction=r}clone(){return new Y_(this.self,this.stack.slice(),this.direction)}reversed(){return new Y_(this.self,this.stack.slice(),this.direction===Yx?1:Yx)}next(){let e=this.entry;switch(this.count++,this.direction===Yx?this.moveNext():this.movePrev(),e._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:e.value}}}get key(){return this.stack.length>0?Pe(this.stack[this.stack.length-1].key):PY()}get value(){return this.stack.length>0?Pe(this.stack[this.stack.length-1].value):PY()}get entry(){return P7($M(this.stack),e=>[e.key,e.value])}get index(){let e=0,t=this.stack;if(0===t.length){let e=this.self._root;return null!=e?e.count:0}null!=t[t.length-1].left&&(e=t[t.length-1].left.count);for(let r=t.length-2;r>=0;--r)t[r+1]===t[r].right&&(++e,null!=t[r].left&&(e+=t[r].left.count));return e}moveNext(){let e=this.stack;if(0===e.length)return;let t=e[e.length-1];if(null!=t.right)for(t=t.right;null!=t;)e.push(t),t=t.left;else for(e.pop();e.length>0&&e[e.length-1].right===t;)t=e[e.length-1],e.pop()}get hasNext(){let e=this.stack;if(0===e.length)return!1;if(null!=e[e.length-1].right)return!0;for(let t=e.length-1;t>0;--t)if(e[t-1].left===e[t])return!0;return!1}movePrev(){let e=this.stack;if(0===e.length)return;let t=e[e.length-1];if(null!=t&&null!=t.left)for(t=t.left;null!=t;)e.push(t),t=t.right;else for(e.pop();e.length>0&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}get hasPrev(){let e=this.stack;if(0===e.length)return!1;if(null!=e[e.length-1].left)return!0;for(let t=e.length-1;t>0;--t)if(e[t-1].right===e[t])return!0;return!1}}let Yw=({color:e,count:t,key:r,left:n,right:i,value:s})=>({color:e,key:r,value:s,left:n,right:i,count:t});function Yk(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e.color=t.color,e.count=t.count}let YO=({count:e,key:t,left:r,right:n,value:i},s)=>({color:s,key:t,value:i,left:r,right:n,count:e}),YE=e=>{e.count=1+(e.left?.count??0)+(e.right?.count??0)},YC="effect/RedBlackTree",YF=Symbol.for(YC),YI={[YF]:{_Key:e=>e,_Value:e=>e},[Dn](){let e=Di(YC);for(let t of this)e^=j$(Di(t[0]),Da(Di(t[1])));return Dp(this,e)},[Dd](e){if(YR(e)){if((this._root?.count??0)!==(e._root?.count??0))return!1;let t=Array.from(e);return Array.from(this).every((e,r)=>{let n=t[r];return Dg(e[0],n[0])&&Dg(e[1],n[1])})}return!1},[Symbol.iterator](){let e=[],t=this._root;for(;null!=t;)e.push(t),t=t.left;return new Y_(this,e,Yx)},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(Dv)}},[Dy](){return this.toJSON()},pipe(){return DF(this,arguments)}},YT=(e,t)=>{let r=Object.create(YI);return r._ord=e,r._root=t,r},YR=e=>jZ(e,YF),YN=((e,t)=>{let r=YT(t,void 0);for(let[t,n]of e)r=YA(r,t,n);return r},jN(2,(e,t)=>{let r=e._ord,n=e._root;for(;void 0!==n;){let e=r(t,n.key);if(Dg(t,n.key))return Pe(n.value);n=e<=0?n.left:n.right}return PY()})),YM=jN(2,(e,t)=>D7(YN(e,t))),YA=jN(3,(e,t,r)=>{let n=e._ord,i=e._root,s=[],a=[];for(;null!=i;){let e=n(t,i.key);s.push(i),a.push(e),i=e<=0?i.left:i.right}s.push({color:0,key:t,value:r,left:void 0,right:void 0,count:1});for(let e=s.length-2;e>=0;--e){let t=s[e];a[e]<=0?s[e]={color:t.color,key:t.key,value:t.value,left:s[e+1],right:t.right,count:t.count+1}:s[e]={color:t.color,key:t.key,value:t.value,left:t.left,right:s[e+1],count:t.count+1}}for(let e=s.length-1;e>1;--e){let t=s[e-1],r=s[e];if(1===t.color||1===r.color)break;let n=s[e-2];if(n.left===t)if(t.left===r){let i=n.right;if(i&&0===i.color)t.color=1,n.right=YO(i,1),n.color=0,e-=1;else{if(n.color=0,n.left=t.right,t.color=1,t.right=n,s[e-2]=t,s[e-1]=r,YE(n),YE(t),e>=3){let r=s[e-3];r.left===n?r.left=t:r.right=t}break}}else{let i=n.right;if(i&&0===i.color)t.color=1,n.right=YO(i,1),n.color=0,e-=1;else{if(t.right=r.left,n.color=0,n.left=r.right,r.color=1,r.left=t,r.right=n,s[e-2]=r,s[e-1]=t,YE(n),YE(t),YE(r),e>=3){let t=s[e-3];t.left===n?t.left=r:t.right=r}break}}else if(t.right===r){let i=n.left;if(i&&0===i.color)t.color=1,n.left=YO(i,1),n.color=0,e-=1;else{if(n.color=0,n.right=t.left,t.color=1,t.left=n,s[e-2]=t,s[e-1]=r,YE(n),YE(t),e>=3){let r=s[e-3];r.right===n?r.right=t:r.left=t}break}}else{let i=n.left;if(i&&0===i.color)t.color=1,n.left=YO(i,1),n.color=0,e-=1;else{if(t.left=r.right,n.color=0,n.right=r.left,r.color=1,r.right=t,r.left=n,s[e-2]=r,s[e-1]=t,YE(n),YE(t),YE(r),e>=3){let t=s[e-3];t.right===n?t.right=r:t.left=r}break}}}return s[0].color=1,YT(e._ord,s[0])}),Yj=(e,t)=>{let r=e[Symbol.iterator](),n=0;return{[Symbol.iterator]:()=>Yj(e,t),next:()=>{n++;let e=r.key;switch(t===Yx?r.moveNext():r.movePrev(),e._tag){case"None":return{done:!0,value:n};case"Some":return{done:!1,value:e.value}}}}},YD=jN(2,(e,t)=>{let r=e._root;void 0!==r&&Y$(r,(e,r)=>(t(e,r),PY()))}),YP=jN(2,(e,t)=>{if(!YM(e,t))return e;let r=e._ord,n=e._root,i=[];for(;void 0!==n;){let e=r(t,n.key);i.push(n),n=Dg(t,n.key)?void 0:e<=0?n.left:n.right}if(0===i.length)return e;let s=Array(i.length),a=i[i.length-1];s[s.length-1]={color:a.color,key:a.key,value:a.value,left:a.left,right:a.right,count:a.count};for(let e=i.length-2;e>=0;--e)(a=i[e]).left===i[e+1]?s[e]={color:a.color,key:a.key,value:a.value,left:s[e+1],right:a.right,count:a.count}:s[e]={color:a.color,key:a.key,value:a.value,left:a.left,right:s[e+1],count:a.count};if(void 0!==(a=s[s.length-1]).left&&void 0!==a.right){let e=s.length;for(a=a.left;null!=a.right;)s.push(a),a=a.right;let t=s[e-1];s.push({color:a.color,key:t.key,value:t.value,left:a.left,right:a.right,count:a.count}),s[e-1].key=a.key,s[e-1].value=a.value;for(let t=s.length-2;t>=e;--t)a=s[t],s[t]={color:a.color,key:a.key,value:a.value,left:a.left,right:s[t+1],count:a.count};s[e-1].left=s[e]}if(0===(a=s[s.length-1]).color){let e=s[s.length-2];e.left===a?e.left=void 0:e.right===a&&(e.right=void 0),s.pop();for(let e=0;e<s.length;++e)s[e].count--}else if(void 0!==a.left||void 0!==a.right){void 0!==a.left?Yk(a,a.left):void 0!==a.right&&Yk(a,a.right),a.color=1;for(let e=0;e<s.length-1;++e)s[e].count--}else{if(1===s.length)return YT(r,void 0);for(let e=0;e<s.length;++e)s[e].count--;let e=s[s.length-2];Yz(s),e.left===a?e.left=void 0:e.right=void 0}return YT(r,s[0])}),Y$=(e,t)=>{let r,n=e,i=!1;for(;!i;)if(null!=n)r=zX(n,r),n=n.left;else if(null!=r){let e=t(r.value.key,r.value.value);if(D7(e))return e;n=r.value.right,r=r.previous}else i=!0;return PY()},Yz=e=>{let t,r,n,i;for(let s=e.length-1;s>=0;--s){if(t=e[s],0===s){t.color=1;return}if((r=e[s-1]).left===t){if(void 0!==(n=r.right)&&void 0!==n.right&&0===n.right.color){if(i=(n=r.right=Yw(n)).right=Yw(n.right),r.right=n.left,n.left=r,n.right=i,n.color=r.color,t.color=1,r.color=1,i.color=1,YE(r),YE(n),s>1){let t=e[s-2];t.left===r?t.left=n:t.right=n}e[s-1]=n;return}if(void 0!==n&&void 0!==n.left&&0===n.left.color){if(i=(n=r.right=Yw(n)).left=Yw(n.left),r.right=i.left,n.left=i.right,i.left=r,i.right=n,i.color=r.color,r.color=1,n.color=1,t.color=1,YE(r),YE(n),YE(i),s>1){let t=e[s-2];t.left===r?t.left=i:t.right=i}e[s-1]=i;return}if(void 0!==n&&1===n.color)if(0===r.color){r.color=1,r.right=YO(n,0);return}else{r.right=YO(n,0);continue}if(void 0!==n){if(r.right=(n=Yw(n)).left,n.left=r,n.color=r.color,r.color=0,YE(r),YE(n),s>1){let t=e[s-2];t.left===r?t.left=n:t.right=n}e[s-1]=n,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s+=2}}else{if(void 0!==(n=r.left)&&void 0!==n.left&&0===n.left.color){if(i=(n=r.left=Yw(n)).left=Yw(n.left),r.left=n.right,n.right=r,n.left=i,n.color=r.color,t.color=1,r.color=1,i.color=1,YE(r),YE(n),s>1){let t=e[s-2];t.right===r?t.right=n:t.left=n}e[s-1]=n;return}if(void 0!==n&&void 0!==n.right&&0===n.right.color){if(i=(n=r.left=Yw(n)).right=Yw(n.right),r.left=i.right,n.right=i.left,i.right=r,i.left=n,i.color=r.color,r.color=1,n.color=1,t.color=1,YE(r),YE(n),YE(i),s>1){let t=e[s-2];t.right===r?t.right=i:t.left=i}e[s-1]=i;return}if(void 0!==n&&1===n.color)if(0===r.color){r.color=1,r.left=YO(n,0);return}else{r.left=YO(n,0);continue}if(void 0!==n){if(r.left=(n=Yw(n)).right,n.right=r,n.color=r.color,r.color=0,YE(r),YE(n),s>1){let t=e[s-2];t.right===r?t.right=n:t.left=n}e[s-1]=n,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s+=2}}}},YL=Symbol.for("effect/SortedSet"),YU={[YL]:{_A:e=>e},[Dn](){return j$(Di(this.keyTree),Da(Di(YL)),Dp(this))},[Dd](e){return Yq(e)&&Dg(this.keyTree,e.keyTree)},[Symbol.iterator](){return Yj(this.keyTree,Yx)},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(Dv)}},[Dy](){return this.toJSON()},pipe(){return DF(this,arguments)}},YB=e=>{let t=Object.create(YU);return t.keyTree=e,t},Yq=e=>jZ(e,YL),YJ=((e,t)=>YM(e.keyTree,t)?e:YB(YA(e.keyTree,t,!0)),Symbol.for("effect/Supervisor")),YH={_T:e=>e};class YW{underlying;value0;[YJ]=YH;constructor(e,t){this.underlying=e,this.value0=t}get value(){return this.value0}onStart(e,t,r,n){this.underlying.onStart(e,t,r,n)}onEnd(e,t){this.underlying.onEnd(e,t)}onEffect(e,t){this.underlying.onEffect(e,t)}onSuspend(e){this.underlying.onSuspend(e)}onResume(e){this.underlying.onResume(e)}map(e){return new YW(this,j$(this.value,JX(e)))}zip(e){return new YK(this,e)}}class YK{left;right;_tag="Zip";[YJ]=YH;constructor(e,t){this.left=e,this.right=t}get value(){return Hh(this.left.value,this.right.value)}onStart(e,t,r,n){this.left.onStart(e,t,r,n),this.right.onStart(e,t,r,n)}onEnd(e,t){this.left.onEnd(e,t),this.right.onEnd(e,t)}onEffect(e,t){this.left.onEffect(e,t),this.right.onEffect(e,t)}onSuspend(e){this.left.onSuspend(e),this.right.onSuspend(e)}onResume(e){this.left.onResume(e),this.right.onResume(e)}map(e){return new YW(this,j$(this.value,JX(e)))}zip(e){return new YK(this,e)}}let YV=e=>jZ(e,YJ)&&jQ(e,"Zip");class YG{[YJ]=YH;fibers=new Set;get value(){return He(()=>Array.from(this.fibers))}onStart(e,t,r,n){this.fibers.add(n)}onEnd(e,t){this.fibers.delete(t)}onEffect(e,t){}onSuspend(e){}onResume(e){}map(e){return new YW(this,j$(this.value,JX(e)))}zip(e){return new YK(this,e)}onRun(e,t){return e()}}class YZ{effect;[YJ]=YH;constructor(e){this.effect=e}get value(){return this.effect}onStart(e,t,r,n){}onEnd(e,t){}onEffect(e,t){}onSuspend(e){}onResume(e){}map(e){return new YW(this,j$(this.value,JX(e)))}zip(e){return new YK(this,e)}onRun(e,t){return e()}}let YQ=He(()=>new YG),YY=jL("effect/Supervisor/none",()=>new YZ(Hs)),YX="Empty",Y0="AddSupervisor",Y1="RemoveSupervisor",Y2="AndThen",Y3={_tag:YX},Y5=(e,t)=>({_tag:Y2,first:e,second:t}),Y4=(e,t)=>Dg(e,t)?YY:YV(e)?Y4(e.left,t).zip(Y4(e.right,t)):e,Y6=e=>Dg(e,YY)?LT():YV(e)?j$(Y6(e.left),LL(Y6(e.right))):Lq(e),Y8=qI({empty:Y3,patch:(e,t)=>((e,t)=>{let r=e,n=t;for(;zP(n);){let e=zz(n);switch(e._tag){case YX:n=zH(n);break;case Y0:r=r.zip(e.supervisor),n=zH(n);break;case Y1:r=Y4(r,e.supervisor),n=zH(n);break;case Y2:n=zE(e.first)(zE(e.second)(zH(n)))}}return r})(t,zm(e)),combine:Y5,diff:(e,t)=>{if(Dg(e,t))return Y3;let r=Y6(e),n=Y6(t),i=j$(n,Lz(r),LB(Y3,(e,t)=>Y5(e,{_tag:Y0,supervisor:t}))),s=j$(r,Lz(n),LB(Y3,(e,t)=>Y5(e,{_tag:Y1,supervisor:t})));return Y5(i,s)}}),Y7=Yd("effect_fiber_started",{incremental:!0}),Y9=Yd("effect_fiber_active"),Xe=Yd("effect_fiber_successes",{incremental:!0}),Xt=Yd("effect_fiber_failures",{incremental:!0}),Xr=Ym(Yg((T=j$($b((I={start:.5,factor:2,count:35}).count-1,e=>I.start*Math.pow(I.factor,e)),z_,e=>new Qo(j$(e,$k(zm(1/0)),zi))),new QE("effect_fiber_lifetimes",new class e{boundaries;[Qu]=Qv;[Qb]=Qb;constructor(e){this.boundaries=e,this._hash=j$(Dc(Qm),Da(Di(this.boundaries)))}_hash;[Dn](){return this._hash}[Dd](e){return Q_(e)&&Dg(this.boundaries,e.boundaries)}pipe(){return DF(this,arguments)}}(T),P3(R)))),"time_unit","milliseconds"),Xn="Continue",Xi="Yield",Xs={_E:e=>e,_A:e=>e},Xa=e=>{throw Error(`BUG: FiberRuntime - ${D_(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},Xo=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),Xl=jL("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),Xu={[DM]:(e,t,r)=>Dt(()=>t.effect_instruction_i1(r)),OnStep:(e,t,r)=>WO(WO(r)),[DA]:(e,t,r)=>Dt(()=>t.effect_instruction_i2(r)),[DB]:(e,t,r)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),qz(e.currentRuntimeFlags)&&e.isInterrupted())?Wv(e.getInterruptedCause()):WO(r),[D$]:(e,t,r)=>(Dt(()=>t.effect_instruction_i2(r)),Dt(()=>t.effect_instruction_i0()))?(e.pushStack(t),Dt(()=>t.effect_instruction_i1())):Hs,[Dz]:(e,t,r)=>{let n=Dt(()=>t.effect_instruction_i0.next(r));if(n.done)return WO(n.value);e.pushStack(t);var i=n.value;if("object"==typeof i&&null!==i&&j8 in i)return i[j8]();throw Error(j2("yieldWrapGet"))}},Xc={[ZM]:(e,t,r,n)=>(e.processNewInterruptSignal(n.cause),qz(t)?Wv(n.cause):r),[Zj]:(e,t,r,n)=>{throw Error("It is illegal to have multiple concurrent run loops in a single fiber")},[ZA]:(e,t,r,n)=>(n.onFiber(e,Vw(t)),r),[ZD]:(e,t,r,n)=>JU(Hc(),()=>r)},Xh=Dq();class Xf extends KQ{[ZH]=ZW;[ZV]=Xs;_fiberRefs;_fiberId;_queue=[];_children=null;_observers=[];_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(e,t,r){if(super(),this.currentRuntimeFlags=r,this._fiberId=e,this._fiberRefs=t,qU(r,4)){const e=this.getFiberRef(HG);Y7.unsafeUpdate(1,e),Y9.unsafeUpdate(1,e)}this.refreshRefCache()}commit(){return ZG(this)}id(){return this._fiberId}resume(e){this.tell(Zz(e))}get status(){return this.ask((e,t)=>t)}get runtimeFlags(){return this.ask((e,t)=>t._tag===Vg?e.currentRuntimeFlags:t.runtimeFlags)}scope(){return new Zq(this.id(),this)}get children(){return this.ask(e=>Array.from(e.getChildren()))}getChildren(){return null===this._children&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(HQ)}fiberRefs(){return this.ask(e=>e.getFiberRefs())}ask(e){return J9(()=>{let t=WR(this._fiberId);return this.tell(Z$((r,n)=>{WL(t,He(()=>e(r,n)))})),WA(t)})}tell(e){this._queue.push(e),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return JE(e=>{let t=t=>e(J7(t));return this.tell(Z$((e,r)=>{null!==e._exitValue?t(this._exitValue):e.addObserver(t)})),He(()=>this.tell(Z$((e,r)=>{e.removeObserver(t)})))},this.id())}get inheritAll(){return Jv((e,t)=>{let r=e.id(),n=e.getFiberRefs(),i=t.runtimeFlags,s=K6(n,r,this.getFiberRefs());return e.setFiberRefs(s),Ha(j$(qH(i,e.getFiberRef(XK)),qA(1),qA(16)))})}get poll(){return He(()=>P3(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(e){return He(()=>this.tell(ZP(L2(e))))}unsafeInterruptAsFork(e){this.tell(ZP(L2(e)))}addObserver(e){null!==this._exitValue?e(this._exitValue):this._observers.push(e)}removeObserver(e){this._observers=this._observers.filter(t=>t!==e)}getFiberRefs(){return this.setFiberRef(XK,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(e){this._fiberRefs=K9(this._fiberRefs,e)}getFiberRef(e){return this._fiberRefs.locals.has(e)?this._fiberRefs.locals.get(e)[0][1]:e.initial}setFiberRef(e,t){this._fiberRefs=Vr(this._fiberRefs,{fiberId:this._fiberId,fiberRef:e,value:t}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(KJ),this.currentTracer=this.currentDefaultServices.unsafeMap.get(KP.key),this.currentSupervisor=this.getFiberRef(XV),this.currentScheduler=this.getFiberRef(G3),this.currentContext=this.getFiberRef(H$),this.currentSpan=this.currentContext.unsafeMap.get(K$.key)}setFiberRefs(e){this._fiberRefs=e,this.refreshRefCache()}addChild(e){this.getChildren().add(e)}removeChild(e){this.getChildren().delete(e)}transferChildren(e){let t=this._children;if(this._children=null,null!==t&&t.size>0)for(let r of t)null===r._exitValue&&e.add(this.currentRuntimeFlags,r)}drainQueueOnCurrentThread(){let e=!0;for(;e;){let t=Xn,r=globalThis[ZQ];globalThis[ZQ]=this;try{for(;t===Xn;)t=0===this._queue.length?"Done":this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[ZQ]=r}this._queue.length>0&&!this._running?(this._running=!0,t===Xi?(this.drainQueueLaterOnExecutor(),e=!1):e=!0):e=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(Hz))}drainQueueWhileRunning(e,t){let r=t;for(;this._queue.length>0;){let t=this._queue.splice(0,1)[0];r=Xc[t._tag](this,e,r,t)}return r}isInterrupted(){return!L6(this.getFiberRef(HQ))}addInterruptedCause(e){let t=this.getFiberRef(HQ);this.setFiberRef(HQ,L5(t,e))}processNewInterruptSignal(e){this.addInterruptedCause(e),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(null===this._children||0===this._children.size)return!1;let e=!1;for(let t of this._children)t.tell(ZP(L2(this.id()))),e=!0;return e}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let e=this._children.values();this._children=null;let t=!1;return Hl({while:()=>!t,body:()=>{let r=e.next();return r.done?He(()=>{t=!0}):J_(r.value.await)},step:()=>{}})}return null}reportExitValue(e){if(qU(this.currentRuntimeFlags,4)){let t=this.getFiberRef(HG),r=this.id().startTimeMillis,n=Date.now();switch(Xr.unsafeUpdate(n-r,t),Y9.unsafeUpdate(-1,t),e._tag){case Dj:Xe.unsafeUpdate(1,t);break;case DR:Xt.unsafeUpdate(1,t)}}if("Failure"===e._tag){let t=this.getFiberRef(HK);L8(e.cause)||"Some"!==t._tag||this.log("Fiber terminated with an unhandled error",e.cause,t)}}setExitValue(e){this._exitValue=e,this.reportExitValue(e);for(let t=this._observers.length-1;t>=0;t--)this._observers[t](e);this._observers=[]}getLoggers(){return this.getFiberRef(Xm)}log(e,t,r){let n=D7(r)?r.value:this.getFiberRef(HB);if(VC(this.getFiberRef(Xp),n))return;let i=this.getFiberRef(Hq),s=this.getFiberRef(HU),a=this.getLoggers(),o=this.getFiberRefs();if(LJ(a)>0){let r=new Date(Pg(this.getFiberRef(KJ),WG).unsafeCurrentTimeMillis());((e,t)=>{let r=DE.fiberRefs;DE.fiberRefs=e;try{return t()}finally{DE.fiberRefs=r}})(o,()=>{for(let l of a)l.log({fiberId:this.id(),logLevel:n,message:e,cause:t,context:o,spans:i,annotations:s,date:r})})}}evaluateMessageWhileSuspended(e){switch(e._tag){case ZD:return Xi;case ZM:return this.processNewInterruptSignal(e.cause),null!==this._asyncInterruptor&&(this._asyncInterruptor(Wv(e.cause)),this._asyncInterruptor=null),Xn;case Zj:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(e.effect),Xn;case ZA:return e.onFiber(this,null!==this._exitValue?Vx:new VS(this.currentRuntimeFlags,this._asyncBlockingOn)),Xn;default:return Xa(e)}}evaluateEffect(e){this.currentSupervisor.onResume(this);try{let t=qz(this.currentRuntimeFlags)&&this.isInterrupted()?Wv(this.getInterruptedCause()):e;for(;null!==t;){let e=t,r=this.runLoop(e);if(r===Xo){let e=Xl.currentOp;Xl.currentOp=null,e._op===DU?qD(this.currentRuntimeFlags)?(this.tell(ZL()),this.tell(Zz(WE)),t=null):t=WE:e._op===DI&&(t=null)}else{this.currentRuntimeFlags=j$(this.currentRuntimeFlags,q$(16));let e=this.interruptAllChildren();null!==e?t=JU(e,()=>r):(0===this._queue.length?this.setExitValue(r):this.tell(Zz(r)),t=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(e){if(this._running)this.tell(Zz(e));else{this._running=!0;let t=globalThis[ZQ];globalThis[ZQ]=this;try{this.evaluateEffect(e)}finally{this._running=!1,globalThis[ZQ]=t,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(e){this.tell(Zz(e))}patchRuntimeFlags(e,t){let r=qW(e,t);return globalThis[ZQ]=this,this.currentRuntimeFlags=r,r}initiateAsync(e,t){let r=!1,n=e=>{r||(r=!0,this.tell(Zz(e)))};qz(e)&&(this._asyncInterruptor=n);try{t(n)}catch(e){n(JP(L1(e)))}}pushStack(e){this._stack.push(e),"OnStep"===e._op&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let e=this._stack.pop();if(e)return"OnStep"===e._op&&this._steps.pop(),e}getNextSuccessCont(){let e=this.popStack();for(;e;){if(e._op!==DN)return e;e=this.popStack()}}getNextFailCont(){let e=this.popStack();for(;e;){if(e._op!==DM&&e._op!==D$&&e._op!==Dz)return e;e=this.popStack()}}Tag(e){return He(()=>Pg(this.currentContext,e))}Left(e){return JD(e.left)}None(e){return JD(new Wa)}Right(e){return WO(e.right)}Some(e){return WO(e.value)}Micro(e){return Jk(t=>{let r=t,n=((e,t)=>{let r=new VU(G_.context(t?.scheduler??new Gb));if(r.evaluate(e),t?.signal)if(t.signal.aborted)r.unsafeInterrupt();else{let e=()=>r.unsafeInterrupt();t.signal.addEventListener("abort",e,{once:!0}),r.addObserver(()=>t.signal.removeEventListener("abort",e))}return r})(Gv(e,this.currentContext));return n.addObserver(e=>{if("Success"===e._tag)return r(WO(e.value));switch(e.cause._tag){case"Interrupt":return r(Wv(L2(Bx)));case"Fail":return r(JD(e.cause.error));case"Die":return r(JN(e.cause.defect))}}),Jk(e=>{r=t=>{e(Hs)},n.unsafeInterrupt()})})}[DD](e){let t=Dt(()=>e.effect_instruction_i0()),r=this.getNextSuccessCont();return void 0!==r?(r._op in Xu||Xa(r),Xu[r._op](this,r,t)):(Xl.currentOp=WO(t),Xo)}[Dj](e){let t=this.getNextSuccessCont();return void 0!==t?(t._op in Xu||Xa(t),Xu[t._op](this,t,e.effect_instruction_i0)):(Xl.currentOp=e,Xo)}[DR](e){let t=e.effect_instruction_i0,r=this.getNextFailCont();if(void 0===r)return Xl.currentOp=Wv(t),Xo;switch(r._op){case DN:case DA:if(!(qz(this.currentRuntimeFlags)&&this.isInterrupted()))return Dt(()=>r.effect_instruction_i1(t));return Wv(Un(t));case"OnStep":if(!(qz(this.currentRuntimeFlags)&&this.isInterrupted()))return WO(Wv(t));return Wv(Un(t));case DB:if(this.patchRuntimeFlags(this.currentRuntimeFlags,r.patch),qz(this.currentRuntimeFlags)&&this.isInterrupted())return Wv(L5(t,this.getInterruptedCause()));return Wv(t);default:Xa(r)}}[DL](e){return Dt(()=>e.effect_instruction_i0(this,Vw(this.currentRuntimeFlags)))}Blocked(e){let t=this.getFiberRefs(),r=this.currentRuntimeFlags;if(this._steps.length>0){let n=[],i=this._steps[this._steps.length-1],s=this.popStack();for(;s&&"OnStep"!==s._op;)n.push(s),s=this.popStack();this.setFiberRefs(i.refs),this.currentRuntimeFlags=i.flags;let a=Vc(i.refs,t),o=qH(i.flags,r);return WO(Jf(e.effect_instruction_i0,Jv(t=>{for(;n.length>0;)t.pushStack(n.pop());return t.setFiberRefs(Vf(t.id(),t.getFiberRefs())(a)),t.currentRuntimeFlags=qW(o)(t.currentRuntimeFlags),e.effect_instruction_i1})))}return Hi(t=>{var r;let n;return JU(Xk((r=e.effect_instruction_i0,(n=new Jg("RunBlocked")).effect_instruction_i0=r,n)),()=>t(e.effect_instruction_i1))})}RunBlocked(e){return JV((e=>{let t=BI(e,BR),r=BP();for(;;){let[e,n]=BJ(t,[q5(),BP()],([e,t],r)=>{let[n,i]=qZ(r);return[q6(e,n),Bz(t,i)]});if(r=qQ(r,e),BM(n))return BH(r);t=n}throw Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")})(e.effect_instruction_i0),e=>X_(Array.from(e.map),([e,t])=>{let r=new Map,n=[];for(let e of t)for(let t of(n.push(zv(e)),e))r.set(t.request,t);let i=n.flat();return HM(X0(e.runAll(n),i,()=>i.forEach(e=>{e.listeners.interrupted=!0})),G5,r)},!1,!1))}[DP](e){let t=e.effect_instruction_i0,r=this.currentRuntimeFlags,n=qW(r,t);if(qz(n)&&this.isInterrupted())return Wv(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,t),!e.effect_instruction_i1)return WE;{let t=qH(n,r);return this.pushStack(new Jd(t,e)),Dt(()=>e.effect_instruction_i1(r))}}[DM](e){return this.pushStack(e),e.effect_instruction_i0}OnStep(e){return this.pushStack(e),e.effect_instruction_i0}[DN](e){return this.pushStack(e),e.effect_instruction_i0}[DA](e){return this.pushStack(e),e.effect_instruction_i0}[DI](e){return this._asyncBlockingOn=e.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,e.effect_instruction_i0),Xl.currentOp=e,Xo}[DU](e){return this._isYielding=!1,Xl.currentOp=e,Xo}[D$](e){let t=e.effect_instruction_i0,r=e.effect_instruction_i1;return t()?(this.pushStack(e),r()):WE}[Dz](e){return Xu[Dz](this,e,void 0)}[DT](e){return Dt(()=>e.commit())}runLoop(e){let t=e;for(this.currentOpCount=0;;){if((2&this.currentRuntimeFlags)!=0&&this.currentSupervisor.onEffect(this,t),this._queue.length>0&&(t=this.drainQueueWhileRunning(this.currentRuntimeFlags,t)),!this._isYielding){this.currentOpCount+=1;let e=this.currentScheduler.shouldYield(this);if(!1!==e){this._isYielding=!0,this.currentOpCount=0;let r=t;t=JU(Hc({priority:e}),()=>r)}}try{if((t=this.currentTracer.context(()=>{if(Xh!==t[Jp]._V){let e=this.getFiberRef(HV);if("Some"===e._tag){let r=t[Jp]._V;this.log(`Executing an Effect versioned ${r} with a Runtime of version ${Dq()}, you may want to dedupe the effect dependencies, you can use the language service plugin to detect this at compile time: https://github.com/Effect-TS/language-service`,LX,e)}}return this[t._op](t)},this))===Xo){let e=Xl.currentOp;if(e._op===DU||e._op===DI)return Xo;return Xl.currentOp=null,e._op===Dj||e._op===DR?e:Wv(L1(e))}}catch(e){t=(t===Xo||jZ(t,"_op"))&&t._op in this?Wr(e)?Wv(L5(L1(e),L2(Bx))):JN(e):JM(`Not a valid effect: ${D_(t)}`)}}}run=()=>{this.drainQueueOnCurrentThread()}}let Xp=jL("effect/FiberRef/currentMinimumLogLevel",()=>Hj((e=>{switch(e){case"All":return Hy;case"Debug":return Hx;case"Error":return VO;case"Fatal":return Vk;case"Info":return HS;case"Trace":return VE;case"None":return H_;case"Warning":return Hv}})("Info"))),Xd=jL(Symbol.for("effect/Logger/defaultLogger"),()=>{let e;return e=Z5,Z0(t=>{Pg(Vt(t.context,KJ),KT).unsafe.log(e.log(t))})}),Xg=jL(Symbol.for("effect/Logger/tracerLogger"),()=>Z0(({annotations:e,cause:t,context:r,fiberId:n,logLevel:i,message:s})=>{let a=Pm(Vt(r,H$),K$);if("None"===a._tag||"ExternalSpan"===a.value._tag)return;let o=Pg(Vt(r,KJ),WG),l={};for(let[t,r]of e)l[t]=r;l["effect.fiberId"]=Bv(n),l["effect.logLevel"]=i.label,null!==t&&"Empty"!==t._tag&&(l["effect.cause"]=Uy(t,{renderErrorCause:!0})),a.value.event(D_(Array.isArray(s)&&1===s.length?s[0]:s),o.unsafeCurrentTimeNanos(),l)})),Xm=jL(Symbol.for("effect/FiberRef/currentLoggers"),()=>{var e;let t;return e=Lq(Xd,Xg),HP(e,{differ:t=qI({empty:qo,combine:(e,t)=>qh(t)(e),diff:(e,t)=>((e,t)=>{let[r,n]=LB([e,qo],([e,t],r)=>{let n;return LR(r)(e)?[L$(r)(e),t]:[e,qh(((n=Object.create(qu)).value=r,n))(t)]})(t);return LB(n,(e,t)=>{let r;return qh(((r=Object.create(qc)).value=t,r))(e)})(r)})(e,t),patch:(e,t)=>qf(t)(e)}),fork:t.empty})}),Xb=jN(e=>Jy(e[0]),(e,t)=>Hn(Ht(e,e=>Xy(r=>t(e,r))))),Xy=e=>Jv(t=>{let r=t.getFiberRefs(),n=qP(t.currentRuntimeFlags,1);return JU(Xz,t=>{let i,s;return i=t,s=t=>Jv(i=>{let s=i.getFiberRefs(),a=i.currentRuntimeFlags,o=Vc(s,r),l=qH(a,n),u=Vc(r,s);return i.setFiberRefs(Vf(o,i.id(),r)),XX(Hu(e(t),l),He(()=>{i.setFiberRefs(Vf(u,i.id(),i.getFiberRefs()))}))}),i.addFinalizer(s)})}),Xv=((e=>j1(e[0])&&!Jy(e[0]),(e,t,r)=>{let n=r?.negate?(e,r)=>JX(t(e,r),KV):t;return G6(r?.concurrency,()=>J9(()=>$y(e).reduceRight((e,t,r)=>Hd(e,J9(()=>n(t,r)),(e,r)=>r?[t,...e]:e),He(()=>[]))),()=>JX(XS(e,(e,t)=>JX(n(e,t),t=>t?Pe(e):PY()),r),$8))}),(e,t)=>{let[r,n]=(e=>{if(Array.isArray(e)||j1(e))return[e,PY()];let t=Object.keys(e),r=t.length;return[t.map(t=>e[t]),Pe(e=>{let n={};for(let i=0;i<r;i++)n[t[i]]=e[i];return n})]})(e);if(t?.mode==="validate"){let e=[];for(let t of r)e.push(JA(t));return JU(XS(e,jM,{concurrency:t?.concurrency,batching:t?.batching,concurrentFinalizers:t?.concurrentFinalizers}),e=>{let r=PY(),i=e.length,s=Array(i),a=Array(i),o=!1;for(let t=0;t<i;t++){let n=e[t];"Left"===n._tag?(s[t]=Pe(n.left),o=!0):(a[t]=n.right,s[t]=r)}return o?"Some"===n._tag?JD(n.value(s)):JD(s):t?.discard?Hs:"Some"===n._tag?J7(n.value(a)):J7(a)})}if(t?.mode==="either"){let e=[];for(let t of r)e.push(JA(t));return t?.discard?XS(e,jM,{concurrency:t?.concurrency,batching:t?.batching,discard:!0,concurrentFinalizers:t?.concurrentFinalizers}):JX(XS(e,jM,{concurrency:t?.concurrency,batching:t?.batching,concurrentFinalizers:t?.concurrentFinalizers}),e=>"Some"===n._tag?n.value(e):e)}return t?.discard!==!0&&"Some"===n._tag?JX(XS(r,jM,t),n.value):XS(r,jM,t)}),XS=((e,t)=>Array.from({length:t},()=>e),jN(e=>j1(e[0]),(e,t,r)=>Jv(n=>{let i=r?.batching===!0||r?.batching==="inherit"&&n.getFiberRef(HW);return r?.discard?G4(r.concurrency,()=>XR(K1,r?.concurrentFinalizers)(r=>i?X_(e,(e,n)=>r(t(e,n)),!0,!1,1):JV(e,(e,n)=>r(t(e,n)))),()=>XR(K2,r?.concurrentFinalizers)(r=>X_(e,(e,n)=>r(t(e,n)),i,!1)),n=>XR(K3(n),r?.concurrentFinalizers)(r=>X_(e,(e,n)=>r(t(e,n)),i,!1,n))):G4(r?.concurrency,()=>XR(K1,r?.concurrentFinalizers)(r=>i?Xw(e,1,(e,n)=>r(t(e,n)),!0):JK(e,(e,n)=>r(t(e,n)))),()=>XR(K2,r?.concurrentFinalizers)(r=>Xx(e,(e,n)=>r(t(e,n)),i)),n=>XR(K3(n),r?.concurrentFinalizers)(r=>Xw(e,n,(e,n)=>r(t(e,n)),i)))}))),Xx=(e,t,r)=>J9(()=>{let n=$y(e),i=Array(n.length);return Hp(X_(n,(e,r)=>JU(t(e,r),e=>He(()=>i[r]=e)),r,!1),J7(i))}),X_=(e,t,r,n,i)=>Hi(s=>{let a;return a=a=>Jv(o=>{let l=Array.from(e).reverse(),u=l.length;if(0===u)return Hs;let c=0,h=!1,f=i?Math.min(l.length,i):l.length,p=new Set,d=[],g=[],m=[],b=[],y=()=>{let e=d.filter(({exit:e})=>"Failure"===e._tag).sort((e,t)=>e.index<t.index?-1:+(e.index!==t.index)).map(({exit:e})=>e);return 0===e.length&&e.push(WE),e},v=(e,t=!1)=>{let r=Hn(a(e)),n=XE(r,o,o.currentRuntimeFlags,ZJ);return o.currentScheduler.scheduleTask(()=>{t&&n.unsafeInterruptAsFork(o.id()),n.resume(r)},0),n},S=()=>{n||(u-=l.length,l=[]),h=!0,p.forEach(e=>{e.currentScheduler.scheduleTask(()=>{e.unsafeInterruptAsFork(o.id())},0)})},x=r?JB:Jj,_=v(JE(e=>{let n=(e,t)=>{"Blocked"===e._op?b.push(e):(d.push({index:t,exit:e}),"Failure"!==e._op||h||S())},a=()=>{if(l.length>0){let f=l.pop(),S=c++,_=e=>{if(l.length>0&&(n(e,S),l.length>0)){let e;return e=l.pop(),S=c++,JU(Hc(),()=>JU(x(s(t(e,S))),_))}return J7(e)},w=v(JU(x(s(t(f,S))),_));g.push(w),p.add(w),h&&w.currentScheduler.scheduleTask(()=>{w.unsafeInterruptAsFork(o.id())},0),w.addObserver(t=>{let s;if(s="Failure"===t._op?t:t.effect_instruction_i0,m.push(w),p.delete(w),n(s,S),d.length===u)e(J7(P0(Wm(y(),{parallel:!0}),()=>WE)));else if(b.length+d.length===u){let t=y();e(J7(Jf(b.map(e=>e.effect_instruction_i0).reduce(qV),X_([P0(Wm(t,{parallel:!0}),()=>WE),...b.map(e=>e.effect_instruction_i1)],e=>e,r,!0,i))))}else a()})}};for(let e=0;e<f;e++)a()}));return J_(J2(Jq(s(ZG(_))),Ww({onFailure:e=>{S();let t=b.length+1,r=Math.min("number"==typeof i?i:b.length,b.length),n=Array.from(b);return JE(i=>{let s=[],a=0,o=0,l=(r,o)=>l=>{s[r]=l,++a===t&&i(WO(Wv(e))),n.length>0&&o&&u()},u=()=>{v(n.pop(),!0).addObserver(l(o,!0)),o++};_.addObserver(l(o,!1)),o++;for(let e=0;e<r;e++)u()})},onSuccess:()=>JK(m,e=>e.inheritAll)})))}),Jv(e=>{let t=j$(e.getFiberRef(HZ),P0(()=>e.scope()));return a(HM(HZ,Pe(t)))})}),Xw=(e,t,r,n)=>J9(()=>{let i=$y(e),s=Array(i.length);return Hp(X_(i,(e,t)=>JX(r(e,t),e=>s[t]=e),n,!1,t),J7(s))}),Xk=e=>XF(e,ZJ),XO=(e,t,r,n=null)=>{let i=XC(e,t,r,n);return i.resume(e),i},XE=(e,t,r,n=null)=>XC(e,t,r,n),XC=(e,t,r,n=null)=>{let i=Bk(),s=K8(t.getFiberRefs(),i),a=new Xf(i,s,r),o=Vt(s,H$),l=a.currentSupervisor;return l.onStart(o,e,Pe(t),a),a.addObserver(e=>l.onEnd(e,a)),(null!==n?n:j$(t.getFiberRef(HZ),P0(()=>t.scope()))).add(r,a),a},XF=(e,t)=>Jv((r,n)=>J7(XO(e,r,n.runtimeFlags,t))),XI=((e=>"function"==typeof e[2],(e,t,r,n)=>G6(n?.concurrency,()=>$y(e).reduce((e,t,n)=>Hd(e,t,(e,t)=>r(e,t,n)),J7(t)),()=>JU(GV(t),t=>JU(XS(e,(e,n)=>JU(e,e=>GY(t,t=>r(t,e,n))),n),()=>t.get)))),e=>{let t;return t=t=>PX(Pm(t,X$),{onNone:()=>e,onSome:t=>{switch(t.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":let r,n;return JU((r=t,n=K2,r.fork(n)),t=>Xq(e,t))}}}),JU(WB,t)}),XT=e=>t=>{let r;return r=r=>PX(Pm(r,X$),{onNone:()=>t,onSome:r=>{let n,i;return"ParallelN"===r.strategy._tag&&r.strategy.parallelism===e?t:JU((n=r,i=K3(e),n.fork(i)),e=>Xq(t,e))}}),JU(WB,r)},XR=(e,t)=>r=>JU(WB,n=>PX(Pm(n,X$),{onNone:()=>r(jM),onSome:n=>{if(!0!==t)return r(jM);{let t="Parallel"===e._tag?XI:"Sequential"===e._tag?XM:XT(e.parallelism);switch(n.strategy._tag){case"Parallel":return t(r(XI));case"Sequential":return t(r(XM));case"ParallelN":return t(r(XT(n.strategy.parallelism)))}}}})),XN=e=>JU(XB(),t=>J2(e(t),e=>t.close(e))),XM=e=>{let t;return t=t=>PX(Pm(t,X$),{onNone:()=>e,onSome:t=>{switch(t.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":let r,n;return JU((r=t,n=K1,r.fork(n)),t=>Xq(e,t))}}}),JU(WB,t)},XA=((e=>Jy(e[1]),(e,t,r,n)=>Jq(XP(Jj(e),Jj(t),(e,t)=>WI(e,t,{onSuccess:r,onFailure:(e,t)=>n?.concurrent?L3(e,t):L5(e,t)}),n))),jN(e=>Jy(e[1]),(e,t,r)=>XP(e,t,(e,t)=>[e,t],r))),Xj=jN(e=>Jy(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||!1===r.batching)?Hf(e,t):XP(e,t,(e,t)=>e,r)),XD=jN(e=>Jy(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||!1===r.batching)?Hp(e,t):XP(e,t,(e,t)=>t,r)),XP=jN(e=>Jy(e[1]),(e,t,r,n)=>JX(Xv([e,t],{concurrency:n?.concurrent?2:1,batching:n?.batching,concurrentFinalizers:n?.concurrentFinalizers}),([e,t])=>r(e,t))),X$=Py("effect/Scope"),Xz=X$,XL={[H2]:H2,[H3]:H3,pipe(){return DF(this,arguments)},fork(e){return He(()=>{var t;let r=XU(e);if("Closed"===this.state._tag)return r.state=this.state,r;let n={};return this.state.finalizers.set(n,e=>r.close(e)),t=e=>He(()=>{"Open"===this.state._tag&&this.state.finalizers.delete(n)}),"Open"===r.state._tag&&r.state.finalizers.set({},t),r})},close(e){return J9(()=>{if("Closed"===this.state._tag)return Hs;let t=Array.from(this.state.finalizers.values()).reverse();return(this.state={_tag:"Closed",exit:e},0===t.length)?Hs:this.strategy._tag===KX?j$(JK(t,t=>Jj(t(e))),JU(e=>j$(Wm(e),P7(Wg),P0(()=>WE)))):this.strategy._tag===K0?j$(Xx(t,t=>Jj(t(e)),!1),JU(e=>j$(Wm(e,{parallel:!0}),P7(Wg),P0(()=>WE)))):j$(Xw(t,this.strategy.parallelism,t=>Jj(t(e)),!1),JU(e=>j$(Wm(e,{parallel:!0}),P7(Wg),P0(()=>WE))))})},addFinalizer(e){return J9(()=>"Closed"===this.state._tag?e(this.state.exit):(this.state.finalizers.set({},e),Hs))}},XU=(e=K1)=>{let t=Object.create(XL);return t.strategy=e,t.state={_tag:"Open",finalizers:new Map},t},XB=(e=K1)=>He(()=>XU(e)),Xq=jN(2,(e,t)=>WH(e,Pb(Ph(X$,t)))),XJ=jN(2,(e,t)=>j$(e,Xq(t),J2(e=>t.close(e)))),XH=jN(2,(e,t)=>J_(Xb(JU(HO(e),r=>Jx(HC(e,t),r)),t=>HC(e,t)))),XW=jN(2,(e,t)=>HE(e,r=>XH(e,t(r)))),XK=HP(qq,{differ:qK,fork:qK.empty}),XV=HP(YY,{differ:Y8,fork:Y3}),XG=jN(3,(e,t,r)=>XQ(e,t,{onSelfWin:(e,t)=>JU(e.await,n=>{switch(n._tag){case Dj:return JU(e.inheritAll,()=>r.onSelfDone(n,t));case DR:return r.onSelfDone(n,t)}}),onOtherWin:(e,t)=>JU(e.await,n=>{switch(n._tag){case Dj:return JU(e.inheritAll,()=>r.onOtherDone(n,t));case DR:return r.onOtherDone(n,t)}})})),XZ=jN(2,(e,t)=>JL(r=>XG(e,t,{onSelfDone:(e,t)=>Wk(e,{onFailure:e=>j$(ZG(t),Zg(t=>L3(e,t))),onSuccess:e=>j$(t,Hb(r),Jx(e))}),onOtherDone:(e,t)=>Wk(e,{onFailure:e=>j$(ZG(t),Zg(t=>L3(t,e))),onSuccess:e=>j$(t,Hb(r),Jx(e))})}))),XQ=jN(3,(e,t,r)=>Jv((n,i)=>{let s=i.runtimeFlags,a=Bt(!0),o=XC(e,n,s,r.selfScope),l=XC(t,n,s,r.otherScope);return JE(n=>{o.addObserver(()=>XY(o,l,r.onSelfWin,a,n)),l.addObserver(()=>XY(l,o,r.onOtherWin,a,n)),o.startFork(e),l.startFork(t)},Bg(o.id(),l.id()))})),XY=(e,t,r,n,i)=>{Br(!0,!1)(n)&&i(r(e,t))},XX=jN(2,(e,t)=>Hi(r=>JH(r(e),{onFailure:e=>JH(t,{onFailure:t=>JP(L5(e,t)),onSuccess:()=>JP(e)}),onSuccess:e=>Jx(t,e)}))),X0=(e,t,r)=>JL(n=>JU(JU(Xk(JQ(e)),e=>JE(n=>{let i=t.map(e=>e.listeners.count),s=()=>{i.every(e=>0===e)&&t.every(e=>"Pending"===e.result.state.current._tag||!!("Done"===e.result.state.current._tag&&Wf(e.result.state.current.effect)&&"Failure"===e.result.state.current.effect._tag&&D7(Ur(e.result.state.current.effect.cause))))&&(a.forEach(e=>e()),r?.(),n(Hm(e)))};e.addObserver(e=>{a.forEach(e=>e()),n(e)});let a=t.map((e,t)=>{let r=e=>{i[t]=e,s()};return e.listeners.addObserver(r),()=>e.listeners.removeObserver(r)});return s(),He(()=>{a.forEach(e=>e())})})),()=>J9(()=>JV(t.flatMap(e=>e.state.completed?[]:[e]),e=>Yv(e.request,Wv(L2(n))))))),X1=e=>Ug(e,{onEmpty:Pe(LX),onFail:P7(L0),onDie:e=>Pe(L1(e)),onInterrupt:e=>Pe(L2(e)),onSequential:$i(L5),onParallel:$i(L3)}),X2=Symbol.for("effect/ScheduleInterval"),X3={[X2]:X2,startMillis:0,endMillis:0},X5=(e,t)=>e>t?X3:{[X2]:X2,startMillis:e,endMillis:t},X4=jN(2,(e,t)=>X6(e,t)===e),X6=jN(2,(e,t)=>e.endMillis<=t.startMillis?e:t.endMillis<=e.startMillis?t:e.startMillis<t.startMillis?e:t.startMillis<e.startMillis?t:e.endMillis<=t.endMillis?e:t),X8=jN(2,(e,t)=>X5(Math.max(e.startMillis,t.startMillis),Math.min(e.endMillis,t.endMillis))),X7=e=>e.startMillis>=e.endMillis,X9=Symbol.for("effect/ScheduleIntervals"),eee=e=>({[X9]:X9,intervals:e}),eet=jN(2,(e,t)=>zP(t.intervals)?zP(e.intervals)?zz(e.intervals).startMillis<zz(t.intervals).startMillis?eer(zH(e.intervals),t.intervals,zz(e.intervals),zd()):eer(e.intervals,zH(t.intervals),zz(t.intervals),zd()):t:e),eer=(e,t,r,n)=>{let i=e,s=t,a=r,o=n;for(;zP(i)||zP(s);)if(!zP(i)&&zP(s))a.endMillis<zz(s).startMillis?(o=j$(o,zE(a)),a=zz(s)):a=X5(a.startMillis,zz(s).endMillis),s=zH(s),i=zd();else if(zP(i)&&zD(s))a.endMillis<zz(i).startMillis?(o=j$(o,zE(a)),a=zz(i)):a=X5(a.startMillis,zz(i).endMillis),s=zd(),i=zH(i);else if(zP(i)&&zP(s))zz(i).startMillis<zz(s).startMillis?(a.endMillis<zz(i).startMillis?(o=j$(o,zE(a)),a=zz(i)):a=X5(a.startMillis,zz(i).endMillis),i=zH(i)):(a.endMillis<zz(s).startMillis?(o=j$(o,zE(a)),a=zz(s)):a=X5(a.startMillis,zz(s).endMillis),s=zH(s));else throw Error(j2("Intervals.unionLoop"));return eee(j$(o,zE(a),zS))},een=jN(2,(e,t)=>eei(e.intervals,t.intervals,zd())),eei=(e,t,r)=>{let n=e,i=t,s=r;for(;zP(n)&&zP(i);){let e=j$(zz(n),X8(zz(i))),t=X7(e)?s:j$(s,zE(e));j$(zz(n),X4(zz(i)))?n=zH(n):i=zH(i),s=t}return eee(zS(s))},ees=e=>j$(e.intervals,z$,P0(()=>X3)).startMillis,eea=jN(2,(e,t)=>ees(e)<ees(t)),eeo=((e,t)=>eea(e,t)?t:e,e=>j$(e.intervals,z$,P0(()=>X3)).endMillis),eel="Continue",eeu="Done",eec=e=>({_tag:eel,intervals:e}),eeh=e=>({_tag:eel,intervals:eee(zm(e))}),eef={_tag:eeu};class eep{permits;waiters=new Set;taken=0;constructor(e){this.permits=e}get free(){return this.permits-this.taken}take=e=>JO(t=>{if(this.free<e){let r=()=>{this.free<e||(this.waiters.delete(r),this.taken+=e,t(J7(e)))};return this.waiters.add(r),He(()=>{this.waiters.delete(r)})}return this.taken+=e,t(J7(e))});updateTakenUnsafe(e,t){return this.taken=t(this.taken),this.waiters.size>0&&e.getFiberRef(G3).scheduleTask(()=>{let e=this.waiters.values(),t=e.next();for(;!1===t.done&&this.free>0;)t.value(),t=e.next()},e.getFiberRef(Hz)),J7(this.free)}updateTaken(e){return Jv(t=>this.updateTakenUnsafe(t,e))}resize=e=>J_(Jv(t=>(this.permits=e,this.free<0)?Hs:this.updateTakenUnsafe(t,e=>e)));release=e=>this.updateTaken(t=>t-e);releaseAll=this.updateTaken(e=>0);withPermits=e=>t=>Hi(r=>JU(r(this.take(e)),e=>XX(r(t),this.release(e))));withPermitsIfAvailable=e=>t=>Hi(r=>J9(()=>this.free<e?Zx:(this.taken+=e,XX(r(JX(t,Pe)),this.release(e)))))}let eed=e=>new eep(e);class eeg extends KQ{isOpen;waiters=[];scheduled=!1;constructor(e){super(),this.isOpen=e}commit(){return this.await}unsafeSchedule(e){return this.scheduled||0===this.waiters.length||(this.scheduled=!0,e.currentScheduler.scheduleTask(this.flushWaiters,e.getFiberRef(Hz))),Hs}flushWaiters=()=>{this.scheduled=!1;let e=this.waiters;this.waiters=[];for(let t=0;t<e.length;t++)e[t](WE)};open=Jv(e=>this.isOpen?Hs:(this.isOpen=!0,this.unsafeSchedule(e)));unsafeOpen(){this.isOpen||(this.isOpen=!0,this.flushWaiters())}release=Jv(e=>this.isOpen?Hs:this.unsafeSchedule(e));await=JO(e=>this.isOpen?e(Hs):(this.waiters.push(e),He(()=>{let t=this.waiters.indexOf(e);-1!==t&&this.waiters.splice(t,1)})));unsafeClose(){this.isOpen=!1}close=He(()=>{this.isOpen=!1});whenOpen=e=>Hp(this.await,e)}(e,t)=>{let r=Uj(t);return JU(WB,t=>JX(eeF(PY()),n=>[Wq(eeb(e,r,n),t),eey(n)]))};let eem=(e,t,r)=>{let n=UQ(Uj(t));return j$(WN(),Ht(t=>JY(e,t)),JX(e=>Pe([r+n,e])))},eeb=(e,t,r)=>Hi(n=>j$(KW(e=>e.currentTimeMillis),JU(n=>eeT(r,r=>{switch(r._tag){case"None":return Pe(eem(e,t,n));case"Some":{let[i]=r.value;return i-n<=0?Pe(eem(e,t,n)):PY()}}})),JU(e=>D8(e)?JM("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):n(WA(e.value[1]))))),eey=e=>GG(e,PY()),eev=((e,t)=>JU(YQ,r=>j$(ee_(e,r),XX(JU(r.value,t)))),jN(2,(e,t)=>Jv((r,n)=>{let i=XO(e,r,n.runtimeFlags,ZJ);if("Open"===t.state._tag){let e={};t.state.finalizers.set(e,()=>JL(e=>Dg(e,i.id())?Hs:J_(Hm(i)))),i.addObserver(()=>{"Closed"!==t.state._tag&&t.state.finalizers.delete(e)})}else i.unsafeInterruptAsFork(r.id());return J7(i)}))),eeS=e=>JU(X$,t=>eev(e,t)),eex=jN(2,(e,t)=>j$(Jj(e),XZ(Jj(t)),e=>Jq(e))),ee_=jN(2,(e,t)=>HA(XV,e=>e.zip(t))(e)),eew=((e,{duration:t,onTimeout:r})=>Jq(eek(e,{onTimeout:()=>JU(He(r),JD),onSuccess:J7,duration:t})),jN(2,(e,{duration:t,onTimeout:r})=>Jq(eek(e,{onTimeout:()=>J$(r),onSuccess:J7,duration:t})))),eek=jN(2,(e,{duration:t,onSuccess:r,onTimeout:n})=>JL(i=>Hi(s=>XQ(s(e),JQ(G8(t)),{onSelfWin:(e,t)=>JU(e.await,n=>"Success"===n._tag?JU(e.inheritAll,()=>Jx(Hb(t,i),r(n.value))):JU(Hb(t,i),()=>Wv(n.cause))),onOtherWin:(e,t)=>JU(e.await,r=>"Success"===r._tag?JU(e.inheritAll,()=>Jx(Hb(t,i),n())):JU(Hb(t,i),()=>Wv(r.cause))),otherScope:ZJ})))),eeO=Symbol.for("effect/Ref/SynchronizedRef"),eeE={_A:e=>e};class eeC extends KQ{ref;withLock;[eeO]=eeE;[GJ]=GH;[Gq]=Gq;constructor(e,t){super(),this.ref=e,this.withLock=t,this.get=this.ref.get}get;commit(){return this.get}modify(e){return this.modifyEffect(t=>J7(e(t)))}modifyEffect(e){return this.withLock(j$(JU(this.ref.get,e),JU(([e,t])=>Jx(GG(this.ref,t),e))))}}let eeF=e=>He(()=>eeI(e)),eeI=e=>new eeC(GK(e),eed(1).withPermits(1)),eeT=jN(2,(e,t)=>e.modifyEffect(e=>{let r=t(e);switch(r._tag){case"None":return J7([e,e]);case"Some":return JX(r.value,e=>[e,e])}})),eeR=((e,t,r)=>({...DQ,commit(){return ZG(this)},[ZH]:ZW,id:()=>j$(e.id(),Bm(t.id())),await:j$(e.await,Jq,XP(Jq(t.await),r,{concurrent:!0}),Jj),children:e.children,inheritAll:Hp(t.inheritAll,e.inheritAll),poll:Hd(e.poll,t.poll,(e,t)=>j$(e,P9(e=>j$(t,P7(t=>WI(e,t,{onSuccess:r,onFailure:L3})))))),interruptAsFork:r=>Hp(e.interruptAsFork(r),t.interruptAsFork(r)),pipe(){return DF(this,arguments)}}),Symbol.for("effect/ManagedRuntime")),eeN="Fresh",eeM="ProvideMerge",eeA=e=>function(){if(1==arguments.length){let t=arguments[0];return(r,...n)=>e(t,r,...n)}return e.apply(this,arguments)},eej=eeA((e,t,r)=>{let n,i,s=Bk(),a=[[H$,[[s,e.context]]]];r?.scheduler&&a.push([G3,[[s,r.scheduler]]]);let o=Vi(e.fiberRefs,{entries:a,forkAs:s});r?.updateRefs&&(o=r.updateRefs(o,s));let l=new Xf(s,o,e.runtimeFlags),u=t;r?.scope&&(u=JU((n=r.scope,i=K1,n.fork(i)),e=>Hp(H5(e,JL(e=>Dg(e,l.id())?Hs:Hb(l,e))),J2(t,t=>{let r,n;return r=e,n=t,r.close(n)}))));let c=l.currentSupervisor;return c!==YY&&(c.onStart(e.context,u,PY(),l),l.addObserver(e=>c.onEnd(e,l))),ZJ.add(e.runtimeFlags,l),r?.immediate===!1?l.resume(u):l.start(u),l}),eeD=eeA((e,t,r={})=>{let n=eej(e,t,r);return r.onExit&&n.addObserver(e=>{r.onExit(e)}),(t,r)=>eeD(e)(j$(n,Hb(t??Bx)),{...r,onExit:r?.onExit?e=>r.onExit(j$(e,WS(jM))):void 0})}),eeP=eeA((e,t)=>{let r=eeJ(e)(t);if("Failure"===r._tag)throw eeB(r.effect_instruction_i0);return r.effect_instruction_i0});class ee$ extends Error{fiber;_tag="AsyncFiberException";constructor(e){super(`Fiber #${e.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=e,this.name=this._tag,this.stack=this.message}}let eez=Symbol.for("effect/Runtime/FiberFailure"),eeL=Symbol.for("effect/Runtime/FiberFailure/Cause");class eeU extends Error{[eez];[eeL];constructor(e){const t=UE(e)[0];super(t?.message||"An error has occurred"),this[eez]=eez,this[eeL]=e,this.name=t?`(FiberFailure) ${t.name}`:"FiberFailure",t?.stack&&(this.stack=t.stack)}toJSON(){return{_id:"FiberFailure",cause:this[eeL].toJSON()}}toString(){return"(FiberFailure) "+Uy(this[eeL],{renderErrorCause:!0})}[Dy](){return this.toString()}}let eeB=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new eeU(e);return Error.stackTraceLimit=t,r},eeq=e=>{switch(e._op){case"Failure":case"Success":return e;case"Left":return Wy(e.left);case"Right":return WO(e.right);case"Some":return WO(e.value);case"None":return Wy(Wa())}},eeJ=eeA((e,t)=>{let r,n,i=eeq(t);if(i)return i;let s=new G2,a=eej(e)(t,{scheduler:s});s.flush();let o=a.unsafePoll();return o?o:Wb(JR((r=Error.stackTraceLimit,Error.stackTraceLimit=0,n=new ee$(a),Error.stackTraceLimit=r,n),WW(a)))}),eeH=eeA((e,t,r)=>eeW(e,t,r).then(e=>{switch(e._tag){case Dj:return e.effect_instruction_i0;case DR:throw eeB(e.effect_instruction_i0)}})),eeW=eeA((e,t,r)=>new Promise(n=>{let i=eeq(t);i&&n(i);let s=eej(e)(t);s.addObserver(e=>{n(e)}),r?.signal!==void 0&&(r.signal.aborted?s.unsafeInterruptAsFork(s.id()):r.signal.addEventListener("abort",()=>{s.unsafeInterruptAsFork(s.id())},{once:!0}))}));class eeK{context;runtimeFlags;fiberRefs;constructor(e,t,r){this.context=e,this.runtimeFlags=t,this.fiberRefs=r}pipe(){return DF(this,arguments)}}let eeV=e=>new eeK(e.context,e.runtimeFlags,e.fiberRefs),eeG=()=>Jv((e,t)=>J7(new eeK(e.getFiberRef(H$),t.runtimeFlags,e.getFiberRefs()))),eeZ=eeV({context:Pc,runtimeFlags:qB(1,32,4),fiberRefs:new K4(new Map)}),eeQ=((e,t)=>eeV({context:e.context,runtimeFlags:t(e.runtimeFlags),fiberRefs:e.fiberRefs}),eej(eeZ)),eeY=eeH(eeZ),eeX=eeP(eeZ),ee0=jN(2,(e,t)=>e.modifyEffect(t)),ee1=Symbol.for("effect/Layer"),ee2={[ee1]:{_RIn:e=>e,_E:e=>e,_ROut:e=>e},pipe(){return DF(this,arguments)}},ee3=Symbol.for("effect/Layer/MemoMap"),ee5=PS()("effect/Layer/CurrentMemoMap",{defaultValue:()=>ee8()});class ee4{ref;[ee3];constructor(e){this.ref=e,this[ee3]=ee3}getOrElseMemoize(e,t){return j$(ee0(this.ref,r=>{let n=r.get(e);if(void 0!==n){let[e,i]=n;return J7([j$(e,JU(([e,t])=>j$(Zb(e),Jx(t))),J2(Ww({onFailure:()=>Hs,onSuccess:()=>{let e,r;return e=t,r=i,e.addFinalizer(r)}}))),r])}return j$(GV(0),JU(n=>j$(WN(),JU(i=>j$(GV(()=>Hs),JX(s=>{let a=Hi(a=>j$(XB(),JU(o=>j$(a(JU(ete(e,o,!0),e=>Z_(e(this),Zd,Vc))),Jj,JU(a=>{switch(a._tag){case DR:let l,u;return j$(WP(i,a.effect_instruction_i0),Hp((l=o,u=a,l.close(u))),Hp(JP(a.effect_instruction_i0)));case Dj:let c,h;return j$(GG(s,e=>{let t,r;return j$((t=o,r=e,t.close(r)),Ho(GQ(n,e=>[1===e,e-1])),J_)}),Hp(GY(n,e=>e+1)),Hp((c=t,h=t=>j$(He(()=>r.delete(e)),Hp(s.get),JU(e=>e(t))),c.addFinalizer(h))),Hp(Wz(i,a.effect_instruction_i0)),Jx(a.effect_instruction_i0[1]))}}))))),o=[j$(WA(i),J2(Wk({onFailure:()=>Hs,onSuccess:()=>GY(n,e=>e+1)}))),e=>j$(s.get,JU(t=>t(e)))];return[a,e._op_layer===eeN?r:r.set(e,o)]}))))))}),Jq)}}let ee6=J9(()=>JX(eeF(new Map),e=>new ee4(e))),ee8=()=>new ee4(eeI(new Map)),ee7=jN(2,(e,t)=>JU(ee6,r=>ee9(e,r,t))),ee9=jN(3,(e,t,r)=>JU(ete(e,r),e=>Zy(e(t),ee5,t))),ete=(e,t,r=!1)=>{switch(e._op_layer){case"Locally":return He(()=>r=>e.f(r.getOrElseMemoize(e.self,t)));case"ExtendScope":return He(()=>t=>JU(X$,r=>t.getOrElseMemoize(e.layer,r)));case"Fold":return He(()=>r=>j$(r.getOrElseMemoize(e.layer,t),JH({onFailure:n=>r.getOrElseMemoize(e.failureK(n),t),onSuccess:n=>r.getOrElseMemoize(e.successK(n),t)})));case"Fresh":return He(()=>r=>j$(e.layer,ee7(t)));case"FromEffect":return r?He(()=>t=>e.effect):He(()=>r=>r.getOrElseMemoize(e,t));case"Provide":return He(()=>r=>j$(r.getOrElseMemoize(e.first,t),JU(n=>j$(r.getOrElseMemoize(e.second,t),Wq(n)))));case"Scoped":return r?He(()=>r=>Xq(e.effect,t)):He(()=>r=>r.getOrElseMemoize(e,t));case"Suspend":return He(()=>r=>r.getOrElseMemoize(e.evaluate(),t));case"ProvideMerge":return He(()=>r=>j$(r.getOrElseMemoize(e.first,t),Hd(r.getOrElseMemoize(e.second,t),e.zipK)));case"ZipWith":return He(()=>r=>j$(r.getOrElseMemoize(e.first,t),XP(r.getOrElseMemoize(e.second,t),e.zipK,{concurrent:!0})))}},ett=jN(2,(e,t)=>etc(e,{onFailure:t,onSuccess:etm})),etr=((e,t)=>etu(e,{onFailure:t,onSuccess:etm}),()=>eto(WB)),etn=e=>eti(L0(e)),eti=e=>eto(JP(e)),ets=jN(2,(e,t)=>etc(e,{onFailure:etn,onSuccess:t})),eta=jN(2,(e,t)=>{let r=jZ(e,Pt),n=r?e:t;return eto(JX(r?t:e,e=>Ph(n,e)))});function eto(e){let t=Object.create(ee2);return t._op_layer="FromEffect",t.effect=e,t}(e,t,r)=>etl(e,HM(t,r));let etl=jN(2,(e,t)=>{let r=Object.create(ee2);return r._op_layer="Locally",r.self=e,r.f=t,r});(e,t)=>ets(e,e=>etm(t(e)));let etu=jN(2,(e,{onFailure:t,onSuccess:r})=>{let n=Object.create(ee2);return n._op_layer="Fold",n.layer=e,n.failureK=t,n.successK=r,n}),etc=jN(2,(e,{onFailure:t,onSuccess:r})=>etu(e,{onFailure:e=>{let r=Ut(e);switch(r._tag){case"Left":return t(r.left);case"Right":return eti(r.right)}},onSuccess:r})),eth=jN(2,(e,t)=>etS(e,t,(e,t)=>Pb(e,t))),etf=(...e)=>{let t=e[0];for(let r=1;r<e.length;r++)t=eth(t,e[r]);return t},etp=((e,t)=>{let r=jZ(e,Pt),n=r?e:t;return etd(JX(r?t:e,e=>Ph(n,e)))},e=>etd(j$(e,Jx(Pc)))),etd=e=>{let t=Object.create(ee2);return t._op_layer="Scoped",t.effect=e,t},etg=jN(2,(e,t)=>{let r=jZ(e,Pt);return eto(J7(Ph(r?e:t,r?t:e)))}),etm=e=>eto(J7(e)),etb=e=>{let t=Object.create(ee2);return t._op_layer="Suspend",t.evaluate=e,t},ety=jN(2,(e,t)=>{let r=jZ(e,Pt),n=r?e:t,i=r?t:e;return eto(He(()=>Ph(n,i())))}),etv=jN(2,(e,t)=>etb(()=>{let r=Object.create(ee2);return r._op_layer="Provide",r.first=Object.create(ee2,{_op_layer:{value:eeM,enumerable:!0},first:{value:etr(),enumerable:!0},second:{value:Array.isArray(t)?etf(...t):t},zipK:{value:(e,t)=>j$(e,Pb(t))}}),r.second=e,r})),etS=((e,t)=>{let r=Object.create(ee2);return r._op_layer=eeM,r.first=t,r.second=etv(e,t),r.zipK=(e,t)=>j$(e,Pb(t)),r},jN(3,(e,t,r)=>etb(()=>{let n=Object.create(ee2);return n._op_layer="ZipWith",n.first=e,n.second=t,n.zipK=r,n}))),etx=jN(2,(e,t)=>XN(r=>JU(ee7(t,r),t=>WJ(e,t)))),et_=jN(2,(e,t)=>{let r=Vc(eeZ.fiberRefs,t.fiberRefs),n=qH(eeZ.runtimeFlags,t.runtimeFlags);return Hi(i=>Jv(s=>{let a=s.getFiberRef(H$),o=s.getFiberRefs(),l=Vf(s.id(),o)(r),u=s.currentRuntimeFlags,c=qW(n)(u),h=Vc(l,o),f=qH(c,u);return s.setFiberRefs(l),s.currentRuntimeFlags=c,XX(WJ(i(e),Pb(a,t.context)),Jv(e=>(e.setFiberRefs(Vf(e.id(),e.getFiberRefs())(h)),e.currentRuntimeFlags=qW(f)(e.currentRuntimeFlags),Hs)))}))}),etw=jN(2,(e,t)=>{if(Array.isArray(t))return etx(e,etf(...t));if(jZ(t,ee1))return etx(e,t);if(Pu(t))return WJ(e,t);if(eeR in t)return JU(t.runtimeEffect,t=>et_(e,t));else return et_(e,t)}),etk=(N=Symbol.for("effect/Data/Error/plainArgs"),({BaseEffectError:class extends H6{constructor(e){super(e?.message,e?.cause?{cause:e.cause}:void 0),e&&(Object.assign(this,e),Object.defineProperty(this,N,{value:e,enumerable:!1}))}toJSON(){return{...this[N],...this}}}}).BaseEffectError),etO=e=>{let t=class extends etk{_tag=e};return t.prototype.name=e,t},etE=Symbol.for("effect/DateTime"),etC=Symbol.for("effect/DateTime/TimeZone"),etF={[etE]:etE,pipe(){return DF(this,arguments)},[Dy](){return this.toString()},toJSON(){return etX(this).toJSON()}},etI={...etF,_tag:"Utc",[Dn](){return Dp(this,Du(this.epochMillis))},[Dd](e){return etj(e)&&"Utc"===e._tag&&this.epochMillis===e.epochMillis},toString(){return`DateTime.Utc(${etX(this).toJSON()})`}},etT={...etF,_tag:"Zoned",[Dn](){return j$(Du(this.epochMillis),Da(Di(this.zone)),Dp(this))},[Dd](e){return etj(e)&&"Zoned"===e._tag&&this.epochMillis===e.epochMillis&&Dg(this.zone,e.zone)},toString(){return`DateTime.Zoned(${eri(this)})`}},etR={[etC]:etC,[Dy](){return this.toString()}},etN={...etR,_tag:"Named",[Dn](){return Dp(this,Dc(`Named:${this.id}`))},[Dd](e){return etP(e)&&"Named"===e._tag&&this.id===e.id},toString(){return`TimeZone.Named(${this.id})`},toJSON(){return{_id:"TimeZone",_tag:"Named",id:this.id}}},etM={...etR,_tag:"Offset",[Dn](){return Dp(this,Dc(`Offset:${this.offset}`))},[Dd](e){return etP(e)&&"Offset"===e._tag&&this.offset===e.offset},toString(){return`TimeZone.Offset(${et2(this.offset)})`},toJSON(){return{_id:"TimeZone",_tag:"Offset",offset:this.offset}}},etA=(e,t,r)=>{let n=Object.create(etT);return n.epochMillis=e,n.zone=t,Object.defineProperty(n,"partsUtc",{value:r,enumerable:!1,writable:!0}),Object.defineProperty(n,"adjustedEpochMillis",{value:void 0,enumerable:!1,writable:!0}),Object.defineProperty(n,"partsAdjusted",{value:void 0,enumerable:!1,writable:!0}),n},etj=e=>jZ(e,etE),etD=e=>etj(e[0]),etP=e=>jZ(e,etC),et$=e=>"Zoned"===e._tag,etz=Px((e,t)=>e.epochMillis===t.epochMillis),etL=e=>{let t=Object.create(etI);return t.epochMillis=e,Object.defineProperty(t,"partsUtc",{value:void 0,enumerable:!1,writable:!0}),t},etU=e=>{let t=e.getTime();if(Number.isNaN(t))throw new Wi("Invalid date");return etL(t)},etB=e=>{if(etj(e))return e;if(e instanceof Date)return etU(e);if("object"==typeof e){let t=new Date(0);return et5(t,e),etU(t)}return"string"!=typeof e||etq(e)?etU(new Date(e)):etU(new Date(e+"Z"))},etq=e=>/Z|[+-]\d{2}$|[+-]\d{2}:?\d{2}$|\]$/.test(e),etJ=(e,t)=>{let r;if(t?.timeZone===void 0&&etj(e)&&et$(e))return e;let n=etB(e);if(n.epochMillis<-86399999568e5||n.epochMillis>86399999496e5)throw RangeError(`Epoch millis out of range: ${n.epochMillis}`);if(t?.timeZone===void 0)r=etG(-60*new Date(n.epochMillis).getTimezoneOffset()*1e3);else if(etP(t?.timeZone))r=t.timeZone;else if("number"==typeof t?.timeZone)r=etG(t.timeZone);else{let e=etY(t.timeZone);if(D8(e))throw new Wi(`Invalid time zone: ${t.timeZone}`);r=e.value}return t?.adjustForTimeZone!==!0?etA(n.epochMillis,r,n.partsUtc):et4(n.epochMillis,r,t?.disambiguation??"compatible")},etH=P4(etJ),etW=((e,t,r)=>r?.adjustForTimeZone===!0?et4(e.epochMillis,t,r?.disambiguation??"compatible"):etA(e.epochMillis,t,e.partsUtc),jL("effect/DateTime/validZoneCache",()=>new Map)),etK={day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"longOffset",fractionalSecondDigits:3,hourCycle:"h23"},etV=e=>{if(etW.has(e))return etW.get(e);try{var t=new Intl.DateTimeFormat("en-US",{...etK,timeZone:e});let r=t.resolvedOptions().timeZone;if(etW.has(r))return etW.get(r);let n=Object.create(etN);return n.id=r,n.format=t,etW.set(r,n),n}catch{throw new Wi(`Invalid time zone: ${e}`)}},etG=e=>{let t=Object.create(etM);return t.offset=e,t},etZ=P4(etV),etQ=/^(?:GMT|[+-])/,etY=e=>{if(etQ.test(e)){let t=et8(e);return null===t?PY():Pe(etG(t))}return etZ(e)},etX=((e,t)=>et3(t)-et3(e),e=>new Date(e.epochMillis)),et0=e=>{if("Utc"===e._tag)return new Date(e.epochMillis);if("Offset"===e.zone._tag)return new Date(e.epochMillis+e.zone.offset);if(void 0!==e.adjustedEpochMillis)return new Date(e.adjustedEpochMillis);let t=e.zone.format.formatToParts(e.epochMillis).filter(e=>"literal"!==e.type),r=new Date(0);return r.setUTCFullYear(Number(t[2].value),Number(t[0].value)-1,Number(t[1].value)),r.setUTCHours(Number(t[3].value),Number(t[4].value),Number(t[5].value),Number(t[6].value)),e.adjustedEpochMillis=r.getTime(),r},et1=e=>et0(e).getTime()-et3(e),et2=e=>{let t=Math.abs(e),r=Math.floor(t/36e5),n=Math.round(t%36e5/6e4);return 60===n&&(r+=1,n=0),`${e<0?"-":"+"}${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}`},et3=e=>e.epochMillis,et5=(e,t)=>{if(void 0!==t.year&&e.setUTCFullYear(t.year),void 0!==t.month&&e.setUTCMonth(t.month-1),void 0!==t.day&&e.setUTCDate(t.day),void 0!==t.weekDay){let r=t.weekDay-e.getUTCDay();e.setUTCDate(e.getUTCDate()+r)}void 0!==t.hours&&e.setUTCHours(t.hours),void 0!==t.minutes&&e.setUTCMinutes(t.minutes),void 0!==t.seconds&&e.setUTCSeconds(t.seconds),void 0!==t.millis&&e.setUTCMilliseconds(t.millis)},et4=(e,t,r)=>{if("Offset"===t._tag)return etA(e-t.offset,t);let n=et7(e-864e5,e,t),i=et7(e+864e5,e,t);if(n===i)return etA(e-n,t);let s=n-i;if(n<i){if(et7(e-i,e,t)===i)return etA(e-i,t);let s=etA(e-n,t);if(e!==et0(s).getTime())switch(r){case"reject":{let r=new Date(e).toISOString();throw RangeError(`Gap time: ${r} does not exist in time zone ${t.id}`)}case"earlier":return etA(e-i,t)}return s}if(et7(e-n,e,t)===n){if("earlier"===r||"compatible"===r||et7(e-n+s,e+s,t)===n)return etA(e-n,t);if("reject"===r){let r=new Date(e).toISOString();throw RangeError(`Ambiguous time: ${r} occurs twice in time zone ${t.id}`)}}return etA(e-i,t)},et6=/([+-])(\d{2}):(\d{2})$/,et8=e=>{let t=et6.exec(e);if(null===t)return null;let[,r,n,i]=t;return("+"===r?1:-1)*(60*Number(n)+Number(i))*6e4},et7=(e,t,r)=>{let n=r.format.formatToParts(e).find(e=>"timeZoneName"===e.type)?.value??"";if("GMT"===n)return 0;let i=et8(n);return null===i?et1(etA(t,r)):i},et9=jN(etD,(e,t,r)=>{if("Utc"===e._tag){let r=etX(e);return t(r),etL(r.getTime())}let n=new Date(et0(e).getTime());return t(n),et4(n.getTime(),e.zone,r?.disambiguation??"compatible")}),ere=((e,t)=>ere(e,e=>{let r=new Date(e);return t(r),r.getTime()}),jN(2,(e,t)=>{let r=t(et3(e));return"Utc"===e._tag?etL(r):etA(r,e.zone)})),ert=((e,t)=>t(et0(e)),jN(2,(e,t)=>t(etX(e)))),err=(e,t)=>{e.setTime(e.getTime()+t)},ern=((e,t)=>et9(e,e=>{if(t.millis&&err(e,t.millis),t.seconds&&err(e,1e3*t.seconds),t.minutes&&err(e,60*t.minutes*1e3),t.hours&&err(e,60*t.hours*6e4),t.days&&e.setUTCDate(e.getUTCDate()+t.days),t.weeks&&e.setUTCDate(e.getUTCDate()+7*t.weeks),t.months){let r=e.getUTCDate();e.setUTCMonth(e.getUTCMonth()+t.months+1,0),r<e.getUTCDate()&&e.setUTCDate(r)}if(t.years){let r=e.getUTCDate(),n=e.getUTCMonth();e.setUTCFullYear(e.getUTCFullYear()+t.years,n+1,0),r<e.getUTCDate()&&e.setUTCDate(r)}}),e=>{let t=et0(e);return"Utc"===e._tag?t.toISOString():`${t.toISOString().slice(0,-1)}${et2(et1(e))}`}),eri=e=>"Offset"===e.zone._tag?ern(e):`${ern(e)}[${e.zone.id}]`;class ers{s;stripped;index;length;constructor(e,t=!1){this.s=e,this.stripped=t,this.index=0,this.length=e.length}next(){if(this.done)return{done:!0,value:void 0};let e=this.index;for(;!this.done&&!era(this.s[this.index]);)this.index=this.index+1;let t=this.index;if(!this.done){let e=this.s[this.index];this.index=this.index+1,!this.done&&ero(e,this.s[this.index])&&(this.index=this.index+1),this.stripped||(t=this.index)}return{done:!1,value:this.s.substring(e,t)}}[Symbol.iterator](){return new ers(this.s,this.stripped)}get done(){return this.index>=this.length}}let era=e=>{let t=e.charCodeAt(0);return 13===t||10===t},ero=(e,t)=>13===e.charCodeAt(0)&&10===t.charCodeAt(0),erl=((e,t)=>eru(e.seconds,t.seconds)&&eru(e.minutes,t.minutes)&&eru(e.hours,t.hours)&&eru(e.days,t.days)&&eru(e.months,t.months)&&eru(e.weekdays,t.weekdays),PO(P_)),eru=(e,t)=>erl($y(e),$y(t)),erc=Symbol.for("effect/Schedule"),erh=Symbol.for("effect/ScheduleDriver"),erf={start:0,now:0,input:void 0,output:void 0,elapsed:UU,elapsedSincePrevious:UU,recurrence:0},erp=PS()("effect/Schedule/CurrentIterationMetadata",{defaultValue:()=>erf}),erd={_Out:e=>e,_In:e=>e,_R:e=>e},erg={_Out:e=>e,_In:e=>e,_R:e=>e};class erm{initial;step;[erc]=erd;constructor(e,t){this.initial=e,this.step=t}pipe(){return DF(this,arguments)}}let erb=(e,t,r,n)=>GY(e,e=>0===e.recurrence?{now:t,input:r,output:n,recurrence:e.recurrence+1,elapsed:UU,elapsedSincePrevious:UU,start:t}:{now:t,input:r,output:n,recurrence:e.recurrence+1,elapsed:UH(t-e.start),elapsedSincePrevious:UH(t-e.now),start:e.start});class ery{schedule;ref;[erh]=erg;constructor(e,t){this.schedule=e,this.ref=t}get state(){return JX(this.ref.get,e=>e[1])}get last(){return JU(this.ref.get,([e,t])=>{switch(e._tag){case"None":return JU(He(()=>new Wa),JD);case"Some":return J7(e.value)}})}iterationMeta=GK(erf);get reset(){return GG(this.ref,[PY(),this.schedule.initial]).pipe(Hf(GG(this.iterationMeta,erf)))}next(e){return j$(JX(this.ref.get,e=>e[1]),JU(t=>j$(KK,JU(r=>j$(J9(()=>this.schedule.step(r,e,t)),JU(([t,n,i])=>{let s=GG(this.ref,[Pe(n),t]);if(i._tag===eeu)return s.pipe(Hp(JD(PY())));let a=ees(i.intervals)-r;if(a<=0)return s.pipe(Hp(erb(this.iterationMeta,r,e,n)),Jx(n));let o=UH(a);return j$(s,Hp(erb(this.iterationMeta,r,e,n)),Hp(G8(o)),Jx(n))}))))))}}let erv=(e,t)=>new erm(e,t),erS=((e,t)=>erS(e,e=>He(()=>t(e))),jN(2,(e,t)=>erT(e,(e,r)=>JX(t(e),e=>U3(r,Uj(e)))))),erx=((e,t)=>erv([e.initial,t.initial,!0],(r,n,i)=>i[2]?JU(e.step(r,n,i[0]),([e,s,a])=>a._tag===eeu?JX(t.step(r,n,i[1]),([t,r,n])=>[[e,t,!1],PA(r),n]):J7([[e,i[1],!0],PM(s),a])):JX(t.step(r,n,i[1]),([e,t,r])=>[[i[0],e,!1],PA(t),r])),jN(2,(e,t)=>er_(e,(e,r)=>He(()=>t(e,r))))),er_=jN(2,(e,t)=>erv(e.initial,(r,n,i)=>JU(e.step(r,n,i),([e,r,i])=>i._tag===eeu?J7([e,r,eef]):JX(t(n,r),t=>t?[e,r,i]:[e,r,eef])))),erw=((e,t)=>erw(e,e=>He(()=>t(e))),jN(2,(e,t)=>erv(e.initial,(r,n,i)=>JU(t(n),t=>e.step(r,t,i))))),erk=((e,t)=>erT(e,(e,r)=>t(r)),e=>j$(GV([PY(),e.initial]),JX(t=>new ery(e,t)))),erO=jN(2,(e,t)=>erE(e,t,een)),erE=jN(3,(e,t,r)=>erv([e.initial,t.initial],(n,i,s)=>j$(Hd(e.step(n,i,s[0]),t.step(n,i,s[1]),(e,t)=>[e,t]),JU(([[n,s,a],[o,l,u]])=>a._tag===eel&&u._tag===eel?erC(e,t,i,n,s,a.intervals,o,l,u.intervals,r):J7([[n,o],[s,l],eef]))))),erC=(e,t,r,n,i,s,a,o,l,u)=>{let c=u(s,l);return zP(c.intervals)?J7([[n,a],[i,o],eec(c)]):j$(s,eea(l))?JU(e.step(eeo(s),r,n),([n,i,s])=>s._tag===eeu?J7([[n,a],[i,o],eef]):erC(e,t,r,n,i,s.intervals,a,o,l,u)):JU(t.step(eeo(l),r,a),([a,o,l])=>l._tag===eeu?J7([[n,a],[i,o],eef]):erC(e,t,r,n,i,s,a,o,l.intervals,u))},erF=jN(2,(e,t)=>erI(e,e=>He(()=>t(e)))),erI=jN(2,(e,t)=>erv(e.initial,(r,n,i)=>JU(e.step(r,n,i),([e,r,n])=>JX(t(r),t=>[e,t,n])))),erT=jN(2,(e,t)=>erv(e.initial,(r,n,i)=>JU(e.step(r,n,i),([e,n,i])=>{let s;if(i._tag===eeu)return J7([e,n,i]);let a=i.intervals;return JX(t(n,UH((s=X5(r,ees(a))).endMillis-s.startMillis)),t=>{let i=Uj(t),s=ees(a),o=r+UQ(i),l=o-s;return[e,n,eeh(X5(o,Math.max(0,eeo(a)+l)))]})}))),erR=e=>erj(erQ,t=>t<e),erN=((e,t,r)=>erv([e.initial,t],(t,n,[i,s])=>JU(e.step(t,n,i),([e,t,n])=>n._tag===eeu?J7([[e,s],s,n]):JX(r(s,t),t=>[[e,t],s,n]))),jN(3,(e,t,r)=>erv([e.initial,t.initial],(n,i,s)=>Hd(e.step(n,i,s[0]),t.step(n,i,s[1]),([e,t,n],[i,s,a])=>{if(n._tag===eeu&&a._tag===eeu)return[[e,i],[t,s],eef];if(n._tag===eeu&&a._tag===eel)return[[e,i],[t,s],eec(a.intervals)];if(n._tag===eel&&a._tag===eeu)return[[e,i],[t,s],eec(n.intervals)];if(n._tag===eel&&a._tag===eel)return[[e,i],[t,s],eec(r(n.intervals,a.intervals))];throw Error("BUG: Schedule.unionWith - please report an issue at https://github.com/Effect-TS/effect/issues")})))),erM=jN(2,(e,t)=>er_(e,(e,r)=>JX(t(e),e=>!e))),erA=jN(2,(e,t)=>er_(e,(e,r)=>t(e))),erj=jN(2,(e,t)=>erx(e,(e,r)=>t(r))),erD=((e,t)=>erF(erO(e,t),e=>e[0]),Symbol.for("effect/Schedule/ScheduleDefect"));class erP{error;[erD];constructor(e){this.error=e,this[erD]=erD}}let er$=e=>JF(e,e=>JN(new erP(e))),erz=e=>PX(Uc(e,e=>"Die"===e._tag&&jZ(e.defect,erD)?Pe(e.defect):PY()),{onNone:()=>e,onSome:e=>L0(e.error)}),erL=e=>JC(e,e=>JP(erz(e))),erU=jN(2,(e,t)=>erq(e,t,(e,t)=>JD(e))),erB=jN(2,(e,t)=>{if(jZ(t,erc))return erU(e,t);let r=t.schedule??erv(erQ.initial,(e,t,r)=>j$(erQ.step(e,t,r),JX(([e,r,n])=>[e,t,n]))),n=t.while?erA(r,e=>{let r=t.while(e);return"boolean"==typeof r?J7(r):er$(r)}):r,i=t.until?erM(n,e=>{let r=t.until(e);return"boolean"==typeof r?J7(r):er$(r)}):n;return erL(erU(e,t.times?erO(i,erR(t.times)).pipe(erF(e=>e[0])):i))}),erq=jN(3,(e,t,r)=>JU(erk(t),t=>JW(e,{onFailure:e=>r(e,PY()),onSuccess:n=>erJ(Zv(e,erp,t.iterationMeta.get),t,(e,n)=>Zv(r(e,n),erp,t.iterationMeta.get),n)}))),erJ=(e,t,r,n)=>JW(t.next(n),{onFailure:()=>J4(t.last),onSuccess:n=>JW(e,{onFailure:e=>r(e,Pe(n)),onSuccess:n=>erJ(e,t,r,n)})}),erH=jN(2,(e,t)=>erK(e,t,(e,t)=>JD(e))),erW=((e,t)=>jZ(t,erc)?erH(e,t):erL(erH(e,erW(t))),e=>{let t=e.schedule??erQ,r=e.while?erA(t,t=>{let r=e.while(t);return"boolean"==typeof r?J7(r):er$(r)}):t,n=e.until?erM(r,t=>{let r=e.until(t);return"boolean"==typeof r?J7(r):er$(r)}):r;return e.times?erO(n,erR(e.times)):n}),erK=jN(3,(e,t,r)=>JU(erk(t),t=>erV(Zv(e,erp,t.iterationMeta.get),t,(e,n)=>Zv(r(e,n),erp,t.iterationMeta.get)))),erV=(e,t,r)=>JF(e,n=>JW(t.next(n),{onFailure:()=>j$(t.last,J4,JU(e=>r(n,e))),onSuccess:()=>erV(e,t,r)})),erG=((e,t)=>erG(e,void 0,t),jN(3,(e,t,r)=>JU(erk(r),r=>erZ(Zv(e,erp,r.iterationMeta.get),t,r)))),erZ=(e,t,r)=>JW(r.next(t),{onFailure:()=>J4(r.last),onSuccess:()=>JU(e,t=>erZ(e,t,r))}),erQ=(M=e=>e+1,erv(0,(e,t,r)=>He(()=>[M(r),r,eeh(X5(e,1/0))]))),erY=erF(erR(1),jP),erX=e=>He(()=>e.state.current._tag===Jo),er0=Symbol.for("effect/MutableList"),er1={[er0]:er0,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(null==t)return e=!0,this.return();let r=t.value;return t=t.next,{done:e,value:r}},return:t=>(e||(e=!0),{done:!0,value:t})}},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"MutableList",values:Array.from(this).map(Dv)}},[Dy](){return this.toJSON()},pipe(){return DF(this,arguments)}},er2=jN(2,(e,t)=>{let r={value:t,removed:!1,prev:void 0,next:void 0};return void 0===e.head&&(e.head=r),void 0===e.tail||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),er3=Symbol.for("effect/MutableQueue"),er5=Symbol.for("effect/mutable/MutableQueue/Empty"),er4={[er3]:er3,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return JSON.stringify(this.toJSON(),null,2)},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(Dv)}},[Dy](){return this.toJSON()},pipe(){return DF(this,arguments)}},er6=e=>{let t,r=Object.create(er4);return(t=Object.create(er1)).head=void 0,t.tail=void 0,t._length=0,r.queue=t,r.capacity=e,r},er8=e=>0===e.queue._length,er7=jN(2,(e,t)=>{let r=e.queue._length;return(void 0===e.capacity||r!==e.capacity)&&(er2(t)(e.queue),!0)}),er9=jN(2,(e,t)=>{let r,n=t[Symbol.iterator](),i=zd(),s=!0;for(;s&&(r=n.next())&&!r.done;)s=er7(r.value)(e);for(;null!=r&&!r.done;)i=zE(r.value)(i),r=n.next();return zS(i)}),ene=jN(2,(e,t)=>{if(0===e.queue._length)return t;var r,n,i=e.queue;let s=i.head;return void 0!==s?(r=i,!(n=s).removed&&(n.removed=!0,void 0!==n.prev&&void 0!==n.next?(n.prev.next=n.next,n.next.prev=n.prev):void 0!==n.prev?(r.tail=n.prev,n.prev.next=void 0):void 0!==n.next?(r.head=n.next,n.next.prev=void 0):(r.tail=void 0,r.head=void 0),r._length>0&&(r._length-=1)),s.value):void 0}),ent=jN(2,(e,t)=>{let r=zd(),n=0;for(;n<t;){let t=ene(er5)(e);if(t===er5)break;r=zE(t)(r),n+=1}return zS(r)}),enr=(e,t,r,n)=>BZ({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:n}),enn=(e,t)=>BZ({_tag:"Pending",key:e,deferred:t}),eni=Symbol.for("effect/Cache/MapKey");class ens{current;[eni]=eni;previous=void 0;next=void 0;constructor(e){this.current=e}[Dn](){return j$(Di(this.current),Da(Di(this.previous)),Da(Di(this.next)),Dp(this))}[Dd](e){return this===e||eno(e)&&Dg(this.current,e.current)&&Dg(this.previous,e.previous)&&Dg(this.next,e.next)}}let ena=e=>new ens(e),eno=e=>jZ(e,eni);class enl{head=void 0;tail=void 0;add(e){if(e!==this.tail)if(void 0===this.tail)this.head=e,this.tail=e;else{let t=e.previous,r=e.next;void 0!==r&&(e.next=void 0,void 0!==t?(t.next=r,r.previous=t):(this.head=r,this.head.previous=void 0)),this.tail.next=e,e.previous=this.tail,this.tail=e}}remove(){let e=this.head;if(void 0!==e){let t=e.next;void 0!==t?(e.next=void 0,this.head=t,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return e}}let enu=Symbol.for("effect/Cache"),enc={_Key:e=>e,_Error:e=>e,_Value:e=>e},enh=Symbol.for("effect/ConsumerCache"),enf={_Key:e=>e,_Error:e=>e,_Value:e=>e},enp=e=>({loadedMillis:e});class end{capacity;context;fiberId;lookup;timeToLive;[enu]=enc;[enh]=enf;cacheState;constructor(e,t,r,n,i){this.capacity=e,this.context=t,this.fiberId=r,this.lookup=n,this.timeToLive=i,this.cacheState=(()=>{let e,t;return e=QM(),t=new enl,{map:e,keys:t,accesses:er6(void 0),updating:Bt(!1),hits:0,misses:0}})()}get(e){return JX(this.getEither(e),PL)}get cacheStats(){return He(()=>({hits:this.cacheState.hits,misses:this.cacheState.misses,size:QL(this.cacheState.map)}))}getOption(e){return J9(()=>PX(QA(this.cacheState.map,e),{onNone:()=>{let t=ena(e);return this.trackAccess(t),this.trackMiss(),J7(PY())},onSome:e=>this.resolveMapValue(e)}))}getOptionComplete(e){return J9(()=>PX(QA(this.cacheState.map,e),{onNone:()=>{let t=ena(e);return this.trackAccess(t),this.trackMiss(),J7(PY())},onSome:e=>this.resolveMapValue(e,!0)}))}contains(e){return He(()=>QD(this.cacheState.map,e))}entryStats(e){return He(()=>{let t=QA(this.cacheState.map,e);if(D7(t))switch(t.value._tag){case"Complete":return Pe(enp(t.value.entryStats.loadedMillis));case"Pending":break;case"Refreshing":return Pe(enp(t.value.complete.entryStats.loadedMillis))}return PY()})}getEither(e){return J9(()=>{let t,r,n=P5(QA(this.cacheState.map,e));return(void 0===n&&(r=WR(this.fiberId),t=ena(e),QD(this.cacheState.map,e)?n=P5(QA(this.cacheState.map,e)):QP(this.cacheState.map,e,enn(t,r))),void 0===n)?(this.trackAccess(t),this.trackMiss(),JX(this.lookupValueOf(e,r),PA)):JU(this.resolveMapValue(n),PX({onNone:()=>this.getEither(e),onSome:e=>J7(PM(e))}))})}invalidate(e){return He(()=>{Qz(this.cacheState.map,e)})}invalidateWhen(e,t){return He(()=>{let r=QA(this.cacheState.map,e);D7(r)&&"Complete"===r.value._tag&&"Success"===r.value.exit._tag&&t(r.value.exit.value)&&Qz(this.cacheState.map,e)})}get invalidateAll(){return He(()=>{this.cacheState.map=QM()})}refresh(e){return KW(t=>J9(()=>{let r=WR(this.fiberId),n=P5(QA(this.cacheState.map,e));if(void 0===n&&(QD(this.cacheState.map,e)?n=P5(QA(this.cacheState.map,e)):QP(this.cacheState.map,e,enn(ena(e),r))),void 0===n)return J_(this.lookupValueOf(e,r));switch(n._tag){case"Complete":if(this.hasExpired(t,n.timeToLiveMillis))return Dg(P5(QA(this.cacheState.map,e)),n)&&Qz(this.cacheState.map,e),J_(this.get(e));return j$(this.lookupValueOf(e,r),ZI(()=>{if(Dg(P5(QA(this.cacheState.map,e)),n)){let t=BZ({_tag:"Refreshing",deferred:r,complete:n});return QP(this.cacheState.map,e,t),!0}return!1}),J_);case"Pending":case"Refreshing":return WA(n.deferred)}}))}set(e,t){return KW(r=>He(()=>{let n=r.unsafeCurrentTimeMillis(),i=WO(t),s=enr(ena(e),i,enp(n),n+UQ(Uj(this.timeToLive(i))));QP(this.cacheState.map,e,s)}))}get size(){return He(()=>QL(this.cacheState.map))}get values(){return He(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push(t[1].exit.value);return e})}get entries(){return He(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push([t[0],t[1].exit.value]);return e})}get keys(){return He(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push(t[0]);return e})}resolveMapValue(e,t=!1){return KW(r=>{switch(e._tag){case"Complete":if(this.trackAccess(e.key),this.hasExpired(r,e.timeToLiveMillis))return Qz(this.cacheState.map,e.key.current),J7(PY());return this.trackHit(),JX(e.exit,Pe);case"Pending":if(this.trackAccess(e.key),this.trackHit(),t)return J7(PY());return JX(WA(e.deferred),Pe);case"Refreshing":if(this.trackAccess(e.complete.key),this.trackHit(),this.hasExpired(r,e.complete.timeToLiveMillis)){if(t)return J7(PY());return JX(WA(e.deferred),Pe)}return JX(e.complete.exit,Pe)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(e){if(er7(this.cacheState.accesses,e),Br(this.cacheState.updating,!1,!0)){let e=!0;for(;e;){let t=ene(this.cacheState.accesses,er5);t===er5?e=!1:this.cacheState.keys.add(t)}let t=QL(this.cacheState.map);for(e=t>this.capacity;e;){let r=this.cacheState.keys.remove();void 0!==r?QD(this.cacheState.map,r.current)&&(Qz(this.cacheState.map,r.current),t-=1,e=t>this.capacity):e=!1}Bn(this.cacheState.updating,!1)}}hasExpired(e,t){return e.unsafeCurrentTimeMillis()>t}lookupValueOf(e,t){return KW(r=>J9(()=>j$(this.lookup(e),Wq(this.context),Jj,JU(n=>{let i=r.unsafeCurrentTimeMillis(),s=enp(i),a=enr(ena(e),n,s,i+UQ(Uj(this.timeToLive(n))));return QP(this.cacheState.map,e,a),Hp(WD(t,n),n)}),J3(()=>Hp(JU(Jz,e=>Wj(t,JZ(e))),He(()=>{Qz(this.cacheState.map,e)}))))))}}()=>{let e,t;return Hj((e=()=>JX(WN(),e=>({listeners:new YS,handle:e})),t=()=>UW(60),new end(65536,Pc,Bf,e,e=>Uj(t(e)))))},()=>Hj(!1);let eng=e=>j$(WN(),JU(t=>j$(Z_(e,Hh(Zd,J8),([e,t],[r,n])=>[Vc(e,r),qH(t,n)]),JY(t),Zm,JX(e=>Hp(e,j$(WA(t),JU(([e,t])=>Jx(Hh(Zb(e[0]),Ha(e[1])),t)))))))),enm=function(){let e,t=1==arguments.length?arguments[0]:arguments[1].bind(arguments[0]);return e=()=>t(j$),J9(()=>{let t=new Jg(Dz);return t.effect_instruction_i0=e(),t})},enb=e=>JU(XB(),t=>XJ(e,t)),eny=e=>He(()=>eed(e)),env=(e,...t)=>{let r=(e=>{if(e?.captureStackTrace===!1||e?.captureStackTrace!==void 0&&"boolean"!=typeof e.captureStackTrace)return e;let t=Error.stackTraceLimit;Error.stackTraceLimit=3;let r=Error();Error.stackTraceLimit=t;let n=!1;return{...e,captureStackTrace:()=>{if(!1!==n)return n;if(void 0!==r.stack){let e=r.stack.split("\n");if(void 0!==e[3])return n=e[3].trim()}}}})(1===t.length?void 0:t[0]),n=t[t.length-1];return Jv(t=>{let i=((e,t,r)=>{let n,i=!e.getFiberRef(HY)||r.context&&Pg(r.context,KB),s=e.getFiberRef(H$),a=r.parent?Pe(r.parent):r.root?PY():ZR(Pm(s,K$));if(i){let e;e={name:t,parent:a,context:Pf(r.context??Pc,KB,!0)},n=Object.assign(Object.create(WK),e)}else{let i=e.getFiberRef(KJ),s=Pg(i,KP),o=Pg(i,WG),l=e.getFiberRef(HX),u=e.getFiberRefs(),c=Ve(u,H0),h=Ve(u,H1),f="Some"===h._tag?void 0!==r.links?[...zv(h.value),...r.links??[]]:zv(h.value):r.links??$X();n=s.span(t,a,r.context??Pc,f,l?o.unsafeCurrentTimeNanos():ZT,r.kind??"internal",r),"Some"===c._tag&&L_(c.value,(e,t)=>n.attribute(t,e)),void 0!==r.attributes&&Object.entries(r.attributes).forEach(([e,t])=>n.attribute(e,t))}return"function"==typeof r.captureStackTrace&&Uw.set(n,r.captureStackTrace),n})(t,e,r),s=t.getFiberRef(HX),a=Pg(t.getFiberRef(KJ),WG);return J2(n(i),e=>He(()=>{"Ended"!==i.status._tag&&("Failure"===e._tag&&Uw.has(i)&&i.attribute("code.stacktrace",Uw.get(i)()),i.end(s?a.unsafeCurrentTimeNanos():ZT,e))}))})},enS=Symbol.for("effect/QueueEnqueue"),enx=Symbol.for("effect/QueueDequeue"),en_=Symbol.for("effect/QueueStrategy"),enw=Symbol.for("effect/BackingQueue"),enk={_A:e=>e},enO={_A:e=>e},enE={_In:e=>e},enC={_Out:e=>e};class enF extends KQ{queue;takers;shutdownHook;shutdownFlag;strategy;[enS]=enE;[enx]=enC;constructor(e,t,r,n,i){super(),this.queue=e,this.takers=t,this.shutdownHook=r,this.shutdownFlag=n,this.strategy=i}pipe(){return DF(this,arguments)}commit(){return this.take}capacity(){return this.queue.capacity()}get size(){return J9(()=>JF(this.unsafeSize(),()=>JG))}unsafeSize(){if(this.shutdownFlag.current)return PY();return Pe(this.queue.length()-this.takers.queue._length+this.strategy.surplusSize())}get isEmpty(){return JX(this.size,e=>e<=0)}get isFull(){return JX(this.size,e=>e>=this.capacity())}get shutdown(){return Hn(Jv(e=>(j$(this.shutdownFlag,Bn(!0)),j$(X_(enH(this.takers),t=>W$(t,e.id()),!1,!1),Hp(this.strategy.shutdown),Ho(Wz(this.shutdownHook,void 0)),J_))))}get isShutdown(){return He(()=>this.shutdownFlag.current)}get awaitShutdown(){return WA(this.shutdownHook)}isActive(){return!this.shutdownFlag.current}unsafeOffer(e){let t;if(this.shutdownFlag.current)return!1;if(0===this.queue.length()){let r=j$(this.takers,ene(er5));r!==er5?(enq(r,e),t=!0):t=!1}else t=!1;if(t)return!0;let r=this.queue.offer(e);return enV(this.strategy,this.queue,this.takers),r}offer(e){return J9(()=>{let t;if(this.shutdownFlag.current)return JG;if(0===this.queue.length()){let r=j$(this.takers,ene(er5));r!==er5?(enq(r,e),t=!0):t=!1}else t=!1;if(t)return J7(!0);let r=this.queue.offer(e);return enV(this.strategy,this.queue,this.takers),r?J7(!0):this.strategy.handleSurplus([e],this.queue,this.takers,this.shutdownFlag)})}offerAll(e){return J9(()=>{if(this.shutdownFlag.current)return JG;let t=$y(e),r=0===this.queue.length()?$y(enW(this.takers,t.length)):$X,[n,i]=j$(t,$W(r.length));for(let e=0;e<r.length;e++)enq(r[e],n[e]);if(0===i.length)return J7(!0);let s=this.queue.offerAll(i);return enV(this.strategy,this.queue,this.takers),zD(s)?J7(!0):this.strategy.handleSurplus(s,this.queue,this.takers,this.shutdownFlag)})}get take(){return Jv(e=>{if(this.shutdownFlag.current)return JG;let t=this.queue.poll(er5);if(t!==er5)return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),J7(t);{let t=WR(e.id());return j$(J9(()=>(j$(this.takers,er7(t)),enV(this.strategy,this.queue,this.takers),this.shutdownFlag.current?JG:WA(t))),J3(()=>He(()=>enK(this.takers,t))))}})}get takeAll(){return J9(()=>this.shutdownFlag.current?JG:He(()=>{let e=this.queue.pollUpTo(1/0);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),zb(e)}))}takeUpTo(e){return J9(()=>this.shutdownFlag.current?JG:He(()=>{let t=this.queue.pollUpTo(e);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),zb(t)}))}takeBetween(e,t){return J9(()=>enI(this,e,t,zd()))}}let enI=(e,t,r,n)=>r<t?J7(n):j$(enD(e,r),JU(i=>{let s=t-i.length;return 1===s?j$(enj(e),JX(e=>j$(n,zT(i),zO(e)))):s>1?j$(enj(e),JU(t=>enI(e,s-1,r-i.length-1,j$(n,zT(i),zO(t))))):J7(j$(n,zT(i)))})),enT=(e,t)=>j$(WN(),JX(r=>{let n;return n=er6(void 0),new enF(e,n,r,Bt(!1),t)}));class enR{mutable;[enw]=enO;constructor(e){this.mutable=e}poll(e){return ene(this.mutable,e)}pollUpTo(e){return ent(this.mutable,e)}offerAll(e){return er9(this.mutable,e)}offer(e){return er7(this.mutable,e)}capacity(){let e;return void 0===(e=this.mutable).capacity?1/0:e.capacity}length(){return this.mutable.queue._length}}let enN=e=>new enR(e),enM=jN(2,(e,t)=>e.offer(t)),enA=jN(2,(e,t)=>e.offerAll(t)),enj=e=>e.take,enD=jN(2,(e,t)=>e.takeUpTo(t)),enP=jN(3,(e,t,r)=>e.takeBetween(t,r)),en$=jN(2,(e,t)=>e.takeBetween(t,t)),enz=()=>new enU;class enL{[en_]=enk;putters=er6(void 0);surplusSize(){return this.putters.queue._length}onCompleteTakersWithEmptyQueue(e){for(;!er8(this.putters)&&!er8(e);){let t=ene(e,void 0),r=ene(this.putters,void 0);r[2]&&enq(r[1],!0),enq(t,r[0])}}get shutdown(){return j$(Jz,JU(e=>j$(He(()=>enH(this.putters)),JU(t=>X_(t,([t,r,n])=>n?j$(W$(r,e),J_):Hs,!1,!1)))))}handleSurplus(e,t,r,n){return Jv(i=>{let s=WR(i.id());return j$(J9(()=>(this.unsafeOffer(e,s),this.unsafeOnQueueEmptySpace(t,r),enV(this,t,r),n.current?JG:WA(s))),J3(()=>He(()=>this.unsafeRemove(s))))})}unsafeOnQueueEmptySpace(e,t){let r=!0;for(;r&&(e.capacity()===1/0||e.length()<e.capacity());){let n=j$(this.putters,ene(er5));if(n===er5)r=!1;else{let r=e.offer(n[0]);r&&n[2]?enq(n[1],!0):r||enJ(this.putters,j$(enH(this.putters),zE(n))),enV(this,e,t)}}}unsafeOffer(e,t){let r=$y(e);for(let e=0;e<r.length;e++){let n=r[e];e===r.length-1?j$(this.putters,er7([n,t,!0])):j$(this.putters,er7([n,t,!1]))}}unsafeRemove(e){enJ(this.putters,j$(enH(this.putters),zN(([,t])=>t!==e)))}}class enU{[en_]=enk;surplusSize(){return 0}get shutdown(){return Hs}onCompleteTakersWithEmptyQueue(){}handleSurplus(e,t,r,n){return J7(!1)}unsafeOnQueueEmptySpace(e,t){}}class enB{[en_]=enk;surplusSize(){return 0}get shutdown(){return Hs}onCompleteTakersWithEmptyQueue(){}handleSurplus(e,t,r,n){return He(()=>(this.unsafeOffer(t,e),enV(this,t,r),!0))}unsafeOnQueueEmptySpace(e,t){}unsafeOffer(e,t){let r,n=t[Symbol.iterator](),i=!0;for(;!(r=n.next()).done&&i;){if(0===e.capacity())return;e.poll(er5),i=e.offer(r.value)}}}let enq=(e,t)=>WL(e,J7(t)),enJ=(e,t)=>j$(e,er9(t)),enH=e=>j$(e,ent(1/0)),enW=(e,t)=>j$(e,ent(t)),enK=(e,t)=>{enJ(e,j$(enH(e),zN(e=>t!==e)))},enV=(e,t,r)=>{let n=!0;for(;n&&0!==t.length();){let i=j$(r,ene(er5));if(i!==er5){let s=t.poll(er5);s!==er5?(enq(i,s),e.unsafeOnQueueEmptySpace(t,r)):enJ(r,j$(enH(r),zE(i))),n=!0}else n=!1}n&&0===t.length()&&!er8(r)&&e.onCompleteTakersWithEmptyQueue(r)},enG=e=>j$(He(()=>er6(e)),JU(e=>enT(enN(e),new enL))),enZ=e=>j$(He(()=>er6(e)),JU(e=>enT(enN(e),enz()))),enQ=e=>j$(He(()=>er6(e)),JU(e=>enT(enN(e),new enB))),enY=()=>j$(He(()=>er6(void 0)),JU(e=>enT(enN(e),enz()))),enX=e=>e.shutdown,en0=Symbol.for("effect/PubSub/AbsentValue"),en1=(e,t)=>r=>{r.has(e)||r.set(e,new Set),r.get(e).add(t)},en2=(e,t)=>r=>{if(!r.has(e))return;let n=r.get(e);n.delete(t),0===n.size&&r.delete(e)},en3=e=>{let t="number"==typeof e?{capacity:e}:e;eio(t.capacity);let r=t.replay&&t.replay>0?new eiS(Math.ceil(t.replay)):void 0;return 1===t.capacity?new en7(r):Math.max(Math.pow(2,Math.ceil(Math.log(t.capacity)/Math.log(2))),2)===t.capacity?new en6(t.capacity,r):new en5(t.capacity,r)};class en5{capacity;replayBuffer;array;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(e,t){this.capacity=e,this.replayBuffer=t,this.array=Array.from({length:e}),this.subscribers=Array.from({length:e})}replayWindow(){return this.replayBuffer?new eix(this.replayBuffer):ei_}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(e){if(this.isFull())return!1;if(0!==this.subscriberCount){let t=this.publisherIndex%this.capacity;this.array[t]=e,this.subscribers[t]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),zd();let t=zb(e),r=t.length,n=this.publisherIndex-this.subscribersIndex,i=Math.min(r,this.capacity-n);if(0===i)return t;let s=0,a=this.publisherIndex+i;for(;this.publisherIndex!==a;){let e=zk(t,s++),r=this.publisherIndex%this.capacity;this.array[r]=e,this.subscribers[r]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(e)}return zF(t,s)}slide(){if(this.subscribersIndex!==this.publisherIndex){let e=this.subscribersIndex%this.capacity;this.array[e]=en0,this.subscribers[e]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new en4(this,this.publisherIndex,!1)}}class en4{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let e=this.subscriberIndex%this.self.capacity,t=this.self.array[e];return this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=en0,this.self.subscribersIndex+=1),this.subscriberIndex+=1,t}return e}pollUpTo(e){if(this.unsubscribed)return zd();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let t=Math.min(e,this.self.publisherIndex-this.subscriberIndex);if(t<=0)return zd();let r=[],n=this.subscriberIndex+t;for(;this.subscriberIndex!==n;){let e=this.subscriberIndex%this.self.capacity,t=this.self.array[e];this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=en0,this.self.subscribersIndex+=1),r.push(t),this.subscriberIndex+=1}return zb(r)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let e=this.subscriberIndex%this.self.capacity;this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=en0,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class en6{capacity;replayBuffer;array;mask;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(e,t){this.capacity=e,this.replayBuffer=t,this.array=Array.from({length:e}),this.mask=e-1,this.subscribers=Array.from({length:e})}replayWindow(){return this.replayBuffer?new eix(this.replayBuffer):ei_}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(e){if(this.isFull())return!1;if(0!==this.subscriberCount){let t=this.publisherIndex&this.mask;this.array[t]=e,this.subscribers[t]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),zd();let t=zb(e),r=t.length,n=this.publisherIndex-this.subscribersIndex,i=Math.min(r,this.capacity-n);if(0===i)return t;let s=0,a=this.publisherIndex+i;for(;this.publisherIndex!==a;){let e=zk(t,s++),r=this.publisherIndex&this.mask;this.array[r]=e,this.subscribers[r]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(e)}return zF(t,s)}slide(){if(this.subscribersIndex!==this.publisherIndex){let e=this.subscribersIndex&this.mask;this.array[e]=en0,this.subscribers[e]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new en8(this,this.publisherIndex,!1)}}class en8{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let e=this.subscriberIndex&this.self.mask,t=this.self.array[e];return this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=en0,this.self.subscribersIndex+=1),this.subscriberIndex+=1,t}return e}pollUpTo(e){if(this.unsubscribed)return zd();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let t=Math.min(e,this.self.publisherIndex-this.subscriberIndex);if(t<=0)return zd();let r=[],n=this.subscriberIndex+t;for(;this.subscriberIndex!==n;){let e=this.subscriberIndex&this.self.mask,t=this.self.array[e];this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=en0,this.self.subscribersIndex+=1),r.push(t),this.subscriberIndex+=1}return zb(r)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let e=this.subscriberIndex&this.self.mask;this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=en0,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class en7{replayBuffer;publisherIndex=0;subscriberCount=0;subscribers=0;value=en0;capacity=1;constructor(e){this.replayBuffer=e}replayWindow(){return this.replayBuffer?new eix(this.replayBuffer):ei_}pipe(){return DF(this,arguments)}isEmpty(){return 0===this.subscribers}isFull(){return!this.isEmpty()}size(){return+!this.isEmpty()}publish(e){return!this.isFull()&&(0!==this.subscriberCount&&(this.value=e,this.subscribers=this.subscriberCount,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(e),!0)}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),zd();let t=zb(e);return zD(t)?t:this.publish(zz(t))?zF(t,1):t}slide(){this.isFull()&&(this.subscribers=0,this.value=en0),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new en9(this,this.publisherIndex,!1)}}class en9{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||0===this.self.subscribers||this.subscriberIndex===this.self.publisherIndex}size(){return+!this.isEmpty()}poll(e){if(this.isEmpty())return e;let t=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=en0),this.subscriberIndex+=1,t}pollUpTo(e){if(this.isEmpty()||e<1)return zd();let t=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=en0),this.subscriberIndex+=1,zm(t)}unsubscribe(){this.unsubscribed||(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex!==this.self.publisherIndex&&(this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=en0)))}}class eie{replayBuffer;publisherHead={value:en0,subscribers:0,next:null};publisherTail=this.publisherHead;publisherIndex=0;subscribersIndex=0;capacity=Number.MAX_SAFE_INTEGER;constructor(e){this.replayBuffer=e}replayWindow(){return this.replayBuffer?new eix(this.replayBuffer):ei_}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(e){let t=this.publisherTail.subscribers;return 0!==t&&(this.publisherTail.next={value:e,subscribers:t,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0!==this.publisherTail.subscribers)for(let t of e)this.publish(t);else this.replayBuffer&&this.replayBuffer.offerAll(e);return zd()}slide(){this.publisherHead!==this.publisherTail&&(this.publisherHead=this.publisherHead.next,this.publisherHead.value=en0,this.subscribersIndex+=1),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new eit(this,this.publisherTail,this.publisherIndex,!1)}}class eit{self;subscriberHead;subscriberIndex;unsubscribed;constructor(e,t,r,n){this.self=e,this.subscriberHead=t,this.subscriberIndex=r,this.unsubscribed=n}isEmpty(){if(this.unsubscribed)return!0;let e=!0,t=!0;for(;t;)this.subscriberHead===this.self.publisherTail?t=!1:this.subscriberHead.next.value!==en0?(e=!1,t=!1):(this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1);return e}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;let t=!0,r=e;for(;t;)if(this.subscriberHead===this.self.publisherTail)t=!1;else{let e=this.subscriberHead.next.value;e!==en0&&(r=e,this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=en0,this.self.subscribersIndex+=1),t=!1),this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return r}pollUpTo(e){let t=[],r=0;for(;r!==e;){let n=this.poll(en0);n===en0?r=e:(t.push(n),r+=1)}return zb(t)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;this.subscriberHead!==this.self.publisherTail;)this.subscriberHead.next.value!==en0&&(this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=en0,this.self.subscribersIndex+=1)),this.subscriberHead=this.subscriberHead.next}}class eir extends KQ{pubsub;subscribers;subscription;pollers;shutdownHook;shutdownFlag;strategy;replayWindow;[enx]=enC;constructor(e,t,r,n,i,s,a,o){super(),this.pubsub=e,this.subscribers=t,this.subscription=r,this.pollers=n,this.shutdownHook=i,this.shutdownFlag=s,this.strategy=a,this.replayWindow=o}commit(){return this.take}pipe(){return DF(this,arguments)}capacity(){return this.pubsub.capacity}isActive(){return!this.shutdownFlag.current}get size(){return J9(()=>this.shutdownFlag.current?JG:J7(this.subscription.size()+this.replayWindow.remaining))}unsafeSize(){return this.shutdownFlag.current?PY():Pe(this.subscription.size()+this.replayWindow.remaining)}get isFull(){return J9(()=>this.shutdownFlag.current?JG:J7(this.subscription.size()===this.capacity()))}get isEmpty(){return JX(this.size,e=>0===e)}get shutdown(){return Hn(Jv(e=>(Bn(this.shutdownFlag,!0),j$(Xx(eic(this.pollers),t=>W$(t,e.id()),!1),Hp(He(()=>{this.subscribers.delete(this.subscription),this.subscription.unsubscribe(),this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers)})),Ho(Wz(this.shutdownHook,void 0)),J_))))}get isShutdown(){return He(()=>this.shutdownFlag.current)}get awaitShutdown(){return WA(this.shutdownHook)}get take(){return Jv(e=>{if(this.shutdownFlag.current)return JG;if(this.replayWindow.remaining>0)return J7(this.replayWindow.take());let t=er8(this.pollers)?this.subscription.poll(er5):er5;if(t!==er5)return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),J7(t);{let t=WR(e.id());return j$(J9(()=>(j$(this.pollers,er7(t)),j$(this.subscribers,en1(this.subscription,this.pollers)),this.strategy.unsafeCompletePollers(this.pubsub,this.subscribers,this.subscription,this.pollers),this.shutdownFlag.current?JG:WA(t))),J3(()=>He(()=>eid(this.pollers,t))))}})}get takeAll(){return J9(()=>{if(this.shutdownFlag.current)return JG;let e=er8(this.pollers)?eih(this.subscription):zd();return(this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),this.replayWindow.remaining>0)?J7(zT(this.replayWindow.takeAll(),e)):J7(e)})}takeUpTo(e){return J9(()=>{let t;if(this.shutdownFlag.current)return JG;if(this.replayWindow.remaining>=e)return J7(this.replayWindow.takeN(e));this.replayWindow.remaining>0&&(t=this.replayWindow.takeAll(),e-=t.length);let r=er8(this.pollers)?eif(this.subscription,e):zd();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),t?J7(zT(t,r)):J7(r)})}takeBetween(e,t){return J9(()=>ein(this,e,t,zd()))}}let ein=(e,t,r,n)=>r<t?J7(n):j$(e.takeUpTo(r),JU(i=>{let s=t-i.length;return 1===s?j$(e.take,JX(e=>j$(n,zT(i),zO(e)))):s>1?j$(e.take,JU(t=>ein(e,s-1,r-i.length-1,j$(n,zT(i),zO(t))))):J7(j$(n,zT(i)))}));class eii{pubsub;subscribers;scope;shutdownHook;shutdownFlag;strategy;[enS]=enE;[enx]=enC;constructor(e,t,r,n,i,s){this.pubsub=e,this.subscribers=t,this.scope=r,this.shutdownHook=n,this.shutdownFlag=i,this.strategy=s}capacity(){return this.pubsub.capacity}get size(){return J9(()=>this.shutdownFlag.current?JG:He(()=>this.pubsub.size()))}unsafeSize(){return this.shutdownFlag.current?PY():Pe(this.pubsub.size())}get isFull(){return JX(this.size,e=>e===this.capacity())}get isEmpty(){return JX(this.size,e=>0===e)}get awaitShutdown(){return WA(this.shutdownHook)}get isShutdown(){return He(()=>this.shutdownFlag.current)}get shutdown(){return Hn(Jv(e=>(j$(this.shutdownFlag,Bn(!0)),j$(this.scope.close(Wv(L2(e.id()))),Hp(this.strategy.shutdown),Ho(Wz(this.shutdownHook,void 0)),J_))))}publish(e){return J9(()=>this.shutdownFlag.current?JG:this.pubsub.publish(e)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),J7(!0)):this.strategy.handleSurplus(this.pubsub,this.subscribers,zm(e),this.shutdownFlag))}isActive(){return!this.shutdownFlag.current}unsafeOffer(e){return!this.shutdownFlag.current&&!!this.pubsub.publish(e)&&(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),!0)}publishAll(e){return J9(()=>{if(this.shutdownFlag.current)return JG;let t=eip(this.pubsub,e);return(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),zD(t))?J7(!0):this.strategy.handleSurplus(this.pubsub,this.subscribers,t,this.shutdownFlag)})}get subscribe(){let e,t,r,n=Ht(Xv([this.scope.fork(K1),(e=this.pubsub,t=this.subscribers,r=this.strategy,JX(WN(),n=>{let i,s,a,o,l,u;return i=e,s=t,a=e.subscribe(),o=er6(void 0),l=n,u=Bt(!1),new eir(i,s,a,o,l,u,r,i.replayWindow())}))]),e=>e[0].addFinalizer(()=>e[1].shutdown));return JX(Xb(n,(e,t)=>e[0].close(t)),e=>e[1])}offer(e){return this.publish(e)}offerAll(e){return this.publishAll(e)}pipe(){return DF(this,arguments)}}let eis=(e,t)=>JU(XB(),r=>JX(WN(),n=>eia(e,new Map,r,n,Bt(!1),t))),eia=(e,t,r,n,i,s)=>new eii(e,t,r,n,i,s),eio=e=>{if(e<=0)throw new Wl(`Cannot construct PubSub with capacity of ${e}`)},eil=(e,t)=>{WL(e,J7(t))},eiu=(e,t)=>j$(e,er9(t)),eic=e=>j$(e,ent(1/0)),eih=e=>e.pollUpTo(1/0),eif=(e,t)=>e.pollUpTo(t),eip=(e,t)=>e.publishAll(t),eid=(e,t)=>{eiu(e,j$(eic(e),zN(e=>e!==t)))};class eig{publishers=er6(void 0);get shutdown(){return JU(Jz,e=>JU(He(()=>eic(this.publishers)),t=>X_(t,([t,r,n])=>n?j$(W$(r,e),J_):Hs,!1,!1)))}handleSurplus(e,t,r,n){return Jv(i=>{let s=WR(i.id());return j$(J9(()=>(this.unsafeOffer(r,s),this.unsafeOnPubSubEmptySpace(e,t),this.unsafeCompleteSubscribers(e,t),n.current?JG:WA(s))),J3(()=>He(()=>this.unsafeRemove(s))))})}unsafeOnPubSubEmptySpace(e,t){let r=!0;for(;r&&!e.isFull();){let n=j$(this.publishers,ene(er5));if(n===er5)r=!1;else{let r=e.publish(n[0]);r&&n[2]?eil(n[1],!0):r||eiu(this.publishers,j$(eic(this.publishers),zE(n))),this.unsafeCompleteSubscribers(e,t)}}}unsafeCompletePollers(e,t,r,n){return eiy(this,e,t,r,n)}unsafeCompleteSubscribers(e,t){return eiv(this,e,t)}unsafeOffer(e,t){let r=e[Symbol.iterator](),n=r.next();if(!n.done)for(;;){let e=n.value;if((n=r.next()).done){j$(this.publishers,er7([e,t,!0]));break}j$(this.publishers,er7([e,t,!1]))}}unsafeRemove(e){eiu(this.publishers,j$(eic(this.publishers),zN(([t,r])=>r!==e)))}}class eim{get shutdown(){return Hs}handleSurplus(e,t,r,n){return J7(!1)}unsafeOnPubSubEmptySpace(e,t){}unsafeCompletePollers(e,t,r,n){return eiy(this,e,t,r,n)}unsafeCompleteSubscribers(e,t){return eiv(this,e,t)}}class eib{get shutdown(){return Hs}handleSurplus(e,t,r,n){return He(()=>(this.unsafeSlidingPublish(e,r),this.unsafeCompleteSubscribers(e,t),!0))}unsafeOnPubSubEmptySpace(e,t){}unsafeCompletePollers(e,t,r,n){return eiy(this,e,t,r,n)}unsafeCompleteSubscribers(e,t){return eiv(this,e,t)}unsafeSlidingPublish(e,t){let r=t[Symbol.iterator](),n=r.next();if(!n.done&&e.capacity>0){let t=n.value,i=!0;for(;i;){e.slide();let s=e.publish(t);s&&(n=r.next())&&!n.done?t=n.value:s&&(i=!1)}}}}let eiy=(e,t,r,n,i)=>{let s=!0;for(;s&&!n.isEmpty();){let a=j$(i,ene(er5));if(a===er5)j$(r,en2(n,i)),er8(i)?s=!1:j$(r,en1(n,i));else{let s=n.poll(er5);s===er5?eiu(i,j$(eic(i),zE(a))):(eil(a,s),e.unsafeOnPubSubEmptySpace(t,r))}}},eiv=(e,t,r)=>{for(let[n,i]of r)for(let s of i)e.unsafeCompletePollers(t,r,n,s)};class eiS{capacity;constructor(e){this.capacity=e}head={value:en0,next:null};tail=this.head;size=0;index=0;slide(){this.index++}offer(e){this.tail.value=e,this.tail.next={value:en0,next:null},this.tail=this.tail.next,this.size===this.capacity?this.head=this.head.next:this.size+=1}offerAll(e){for(let t of e)this.offer(t)}}class eix{buffer;head;index;remaining;constructor(e){this.buffer=e,this.index=e.index,this.remaining=e.size,this.head=e.head}fastForward(){for(;this.index<this.buffer.index;)this.head=this.head.next,this.index++}take(){if(0===this.remaining)return;this.index<this.buffer.index&&this.fastForward(),this.remaining--;let e=this.head.value;return this.head=this.head.next,e}takeN(e){if(0===this.remaining)return zd();this.index<this.buffer.index&&this.fastForward();let t=Math.min(e,this.remaining),r=Array(t);for(let e=0;e<t;e++){let t=this.head.value;this.head=this.head.next,r[e]=t}return this.remaining-=t,z_(r)}takeAll(){return this.takeN(this.remaining)}}let ei_={remaining:0,take:()=>void 0,takeN:()=>zd(),takeAll:()=>zd()},eiw=e=>J9(()=>eis(en3(e),new eig)),eik="Continue",eiO=Symbol.for("effect/ChannelChildExecutorDecision"),eiE={[eiO]:eiO},eiC=e=>{let t=Object.create(eiE);return t._tag=eik,t},eiF="ContinuationK",eiI=Symbol.for("effect/ChannelContinuation"),eiT={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutDone:e=>e,_OutErr2:e=>e,_OutElem:e=>e,_OutDone2:e=>e};class eiR{onSuccess;onHalt;_tag=eiF;[eiI]=eiT;constructor(e,t){this.onSuccess=e,this.onHalt=t}onExit(e){return"Failure"===e._tag?this.onHalt(e.cause):this.onSuccess(e.value)}}class eiN{finalizer;_tag="ContinuationFinalizer";[eiI]=eiT;constructor(e){this.finalizer=e}}let eiM="PullAfterNext",eiA={[Symbol.for("effect/ChannelUpstreamPullStrategy")]:{_A:e=>e}},eij=e=>{let t=Object.create(eiA);return t._tag=eiM,t.emitSeparator=e,t},eiD="BracketOut",eiP="Bridge",ei$="ConcatAll",eiz="Emit",eiL="Ensuring",eiU="Fail",eiB="Fold",eiq="FromEffect",eiJ="PipeTo",eiH="Provide",eiW="Read",eiK="Succeed",eiV="SucceedNow",eiG="Suspend",eiZ=Symbol.for("effect/Channel"),eiQ={[eiZ]:{_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},pipe(){return DF(this,arguments)}},eiY=e=>jZ(e,eiZ)||Jy(e),eiX=jN(2,(e,t)=>{let r=Object.create(eiQ);return r._tag=eiD,r.acquire=()=>e,r.finalizer=t,r}),ei0=jN(2,(e,t)=>{let r=Object.create(eiQ);return r._tag=eiB,r.channel=e,r.k=new eiR(eso,t),r}),ei1=e=>esu(()=>{let t=[];return ese(esn(e,ei2(t)),e=>esc(()=>[zb(t),e]))}),ei2=e=>ess({onInput:t=>ese(esc(()=>{e.push(t)}),()=>ei2(e)),onFailure:ei8,onDone:esl}),ei3=(e,t,r)=>{let n=Object.create(eiQ);return n._tag=ei$,n.combineInners=t,n.combineAll=r,n.onPull=()=>eij(PY()),n.onEmit=()=>eiC,n.value=()=>e,n.k=jM,n},ei5=jN(4,(e,t,r,n)=>{let i=Object.create(eiQ);return i._tag=ei$,i.combineInners=r,i.combineAll=n,i.onPull=()=>eij(PY()),i.onEmit=()=>eiC,i.value=()=>e,i.k=t,i}),ei4=jN(2,(e,t)=>{let r=Object.create(eiQ);return r._tag=eiP,r.input=t,r.channel=e,r}),ei6=jN(2,(e,t)=>{let r=Object.create(eiQ);return r._tag=eiL,r.channel=e,r.finalizer=t,r}),ei8=e=>ei7(L0(e)),ei7=e=>ei9(()=>e),ei9=e=>{let t=Object.create(eiQ);return t._tag=eiU,t.error=e,t},ese=jN(2,(e,t)=>{let r=Object.create(eiQ);return r._tag=eiB,r.channel=e,r.k=new eiR(t,ei7),r}),est=jN(2,(e,t)=>{let r=Object.create(eiQ);return r._tag=eiB,r.channel=e,r.k=new eiR(t.onSuccess,t.onFailure),r}),esr=e=>{let t=Object.create(eiQ);return t._tag=eiq,t.effect=()=>e,t},esn=jN(2,(e,t)=>{let r=Object.create(eiQ);return r._tag=eiJ,r.left=()=>e,r.right=()=>t,r}),esi=jN(2,(e,t)=>{let r=Object.create(eiQ);return r._tag=eiH,r.context=()=>t,r.inner=e,r}),ess=e=>esa({onInput:e.onInput,onFailure:t=>Pz(Ut(t),{onLeft:e.onFailure,onRight:ei7}),onDone:e.onDone}),esa=e=>{let t=Object.create(eiQ);return t._tag=eiW,t.more=e.onInput,t.done=new eiR(e.onDone,e.onFailure),t},eso=e=>esc(()=>e),esl=e=>{let t=Object.create(eiQ);return t._tag=eiV,t.terminal=e,t},esu=e=>{let t=Object.create(eiQ);return t._tag=eiG,t.channel=e,t},esc=e=>{let t=Object.create(eiQ);return t._tag=eiK,t.evaluate=e,t},esh=esl(void 0),esf=e=>{let t=Object.create(eiQ);return t._tag=eiz,t.out=e,t},esp="Done",esd="Emit",esg="FromEffect",esm="Read",esb={[Symbol.for("effect/ChannelState")]:{_E:e=>e,_R:e=>e}},esy=()=>{let e=Object.create(esb);return e._tag=esp,e},esv=()=>{let e=Object.create(esb);return e._tag=esd,e},esS=e=>{let t=Object.create(esb);return t._tag=esg,t.effect=e,t},esx=(e,t,r,n)=>{let i=Object.create(esb);return i._tag=esm,i.upstream=e,i.onEffect=t,i.onEmit=r,i.onDone=n,i},es_=e=>e._tag===esg,esw=e=>es_(e)?Zf(e.effect,{onFailure:jP,onSuccess:jP}):void 0,esk="PullFromChild",esO="PullFromUpstream",esE="DrainChildExecutors",esC="Emit";class esF{childExecutor;parentSubexecutor;onEmit;_tag=esk;constructor(e,t,r){this.childExecutor=e,this.parentSubexecutor=t,this.onEmit=r}close(e){let t=this.childExecutor.close(e),r=this.parentSubexecutor.close(e);return void 0!==t&&void 0!==r?XP(Jj(t),Jj(r),(e,t)=>j$(e,WF(t))):void 0!==t?t:void 0!==r?r:void 0}enqueuePullFromChild(e){return this}}class esI{upstreamExecutor;createChild;lastDone;activeChildExecutors;combineChildResults;combineWithChildResult;onPull;onEmit;_tag=esO;constructor(e,t,r,n,i,s,a,o){this.upstreamExecutor=e,this.createChild=t,this.lastDone=r,this.activeChildExecutors=n,this.combineChildResults=i,this.combineWithChildResult=s,this.onPull=a,this.onEmit=o}close(e){let t=this.upstreamExecutor.close(e);return[...this.activeChildExecutors.map(t=>void 0!==t?t.childExecutor.close(e):void 0),t].reduce((e,t)=>void 0!==e&&void 0!==t?XP(e,Jj(t),(e,t)=>WF(e,t)):void 0!==e?e:void 0!==t?Jj(t):void 0,void 0)}enqueuePullFromChild(e){return new esI(this.upstreamExecutor,this.createChild,this.lastDone,[...this.activeChildExecutors,e],this.combineChildResults,this.combineWithChildResult,this.onPull,this.onEmit)}}class esT{upstreamExecutor;lastDone;activeChildExecutors;upstreamDone;combineChildResults;combineWithChildResult;onPull;_tag=esE;constructor(e,t,r,n,i,s,a){this.upstreamExecutor=e,this.lastDone=t,this.activeChildExecutors=r,this.upstreamDone=n,this.combineChildResults=i,this.combineWithChildResult=s,this.onPull=a}close(e){let t=this.upstreamExecutor.close(e);return[...this.activeChildExecutors.map(t=>void 0!==t?t.childExecutor.close(e):void 0),t].reduce((e,t)=>void 0!==e&&void 0!==t?XP(e,Jj(t),(e,t)=>WF(e,t)):void 0!==e?e:void 0!==t?Jj(t):void 0,void 0)}enqueuePullFromChild(e){return new esT(this.upstreamExecutor,this.lastDone,[...this.activeChildExecutors,e],this.upstreamDone,this.combineChildResults,this.combineWithChildResult,this.onPull)}}class esR{value;next;_tag=esC;constructor(e,t){this.value=e,this.next=t}close(e){return this.next.close(e)}enqueuePullFromChild(e){return this}}let esN={[Symbol.for("effect/ChannelUpstreamPullRequest")]:{_A:e=>e}},esM=e=>{let t=Object.create(esN);return t._tag="Pulled",t.value=e,t};class esA{_activeSubexecutor=void 0;_cancelled=void 0;_closeLastSubstream=void 0;_currentChannel;_done=void 0;_doneStack=[];_emitted=void 0;_executeCloseLastSubstream;_input=void 0;_inProgressFinalizer=void 0;_providedEnv;constructor(e,t,r){this._currentChannel=e,this._executeCloseLastSubstream=r,this._providedEnv=t}run(){let e;for(;void 0===e;)if(void 0!==this._cancelled)e=this.processCancellation();else if(void 0!==this._activeSubexecutor)e=this.runSubexecutor();else try{if(void 0===this._currentChannel)e=esy();else switch(Jy(this._currentChannel)&&(this._currentChannel=esr(this._currentChannel)),this._currentChannel._tag){case eiD:e=this.runBracketOut(this._currentChannel);break;case eiP:{let t=this._currentChannel.input;if(this._currentChannel=this._currentChannel.channel,void 0!==this._input){let r=this._input;this._input=void 0;let n=()=>JU(t.awaitRead(),()=>J9(()=>{let e=r.run();switch(e._tag){case esp:return Ww(r.getDone(),{onFailure:e=>t.error(e),onSuccess:e=>t.done(e)});case esd:return JU(t.emit(r.getEmit()),()=>n());case esg:return JH(e.effect,{onFailure:e=>t.error(e),onSuccess:()=>n()});case esm:return esP(e,()=>n(),e=>t.error(e))}}));e=esS(JU(Xk(JQ(n())),e=>He(()=>this.addFinalizer(t=>JU(Hm(e),()=>J9(()=>{let e=this.restorePipe(t,r);return void 0!==e?e:Hs}))))))}break}case ei$:{let e=new esA(this._currentChannel.value(),this._providedEnv,e=>He(()=>{let t=void 0===this._closeLastSubstream?Hs:this._closeLastSubstream;this._closeLastSubstream=j$(t,XD(e))}));e._input=this._input;let t=this._currentChannel;this._activeSubexecutor=new esI(e,e=>t.k(e),void 0,[],(e,r)=>t.combineInners(e,r),(e,r)=>t.combineAll(e,r),e=>t.onPull(e),e=>t.onEmit(e)),this._closeLastSubstream=void 0,this._currentChannel=void 0;break}case eiz:this._emitted=this._currentChannel.out,this._currentChannel=void 0!==this._activeSubexecutor?void 0:esh,e=esv();break;case eiL:this.runEnsuring(this._currentChannel);break;case eiU:e=this.doneHalt(this._currentChannel.error());break;case eiB:this._doneStack.push(this._currentChannel.k),this._currentChannel=this._currentChannel.channel;break;case eiq:{let t=void 0===this._providedEnv?this._currentChannel.effect():j$(this._currentChannel.effect(),etw(this._providedEnv));e=esS(JH(t,{onFailure:e=>{let t=this.doneHalt(e);return void 0!==t&&es_(t)?t.effect:Hs},onSuccess:e=>{let t=this.doneSucceed(e);return void 0!==t&&es_(t)?t.effect:Hs}}));break}case eiJ:{let e=this._input,t=new esA(this._currentChannel.left(),this._providedEnv,e=>this._executeCloseLastSubstream(e));t._input=e,this._input=t,this.addFinalizer(t=>{let r=this.restorePipe(t,e);return void 0!==r?r:Hs}),this._currentChannel=this._currentChannel.right();break}case eiH:{let e=this._providedEnv;this._providedEnv=this._currentChannel.context(),this._currentChannel=this._currentChannel.inner,this.addFinalizer(()=>He(()=>{this._providedEnv=e}));break}case eiW:{let t=this._currentChannel;e=esx(this._input,jM,e=>{try{this._currentChannel=t.more(e)}catch(e){this._currentChannel=t.done.onExit(Wb(e))}},e=>{let r=e=>t.done.onExit(e);this._currentChannel=r(e)});break}case eiK:e=this.doneSucceed(this._currentChannel.evaluate());break;case eiV:e=this.doneSucceed(this._currentChannel.terminal);break;case eiG:this._currentChannel=this._currentChannel.channel()}}catch(e){this._currentChannel=ei7(L1(e))}return e}getDone(){return this._done}getEmit(){return this._emitted}cancelWith(e){this._cancelled=e}clearInProgressFinalizer(){this._inProgressFinalizer=void 0}storeInProgressFinalizer(e){this._inProgressFinalizer=e}popAllFinalizers(e){let t=[],r=this._doneStack.pop();for(;r;)"ContinuationFinalizer"===r._tag&&t.push(r.finalizer),r=this._doneStack.pop();let n=0===t.length?Hs:esD(t,e);return this.storeInProgressFinalizer(n),n}popNextFinalizers(){let e=[];for(;0!==this._doneStack.length;){let t=this._doneStack[this._doneStack.length-1];if(t._tag===eiF)break;e.push(t),this._doneStack.pop()}return e}restorePipe(e,t){let r=this._input;return(this._input=t,void 0!==r)?r.close(e):Hs}close(e){let t,r,n=this._inProgressFinalizer;void 0!==n&&(t=j$(n,XX(He(()=>this.clearInProgressFinalizer()))));let i=this.popAllFinalizers(e);void 0!==i&&(r=j$(i,XX(He(()=>this.clearInProgressFinalizer()))));let s=void 0===this._activeSubexecutor?void 0:this._activeSubexecutor.close(e);if(void 0!==s||void 0!==t||void 0!==r)return j$(Jj(esj(s)),XA(Jj(esj(t))),XA(Jj(esj(r))),JX(([[e,t],r])=>j$(e,WF(t),WF(r))),Hn,JU(e=>J9(()=>e)))}doneSucceed(e){if(0===this._doneStack.length)return this._done=WO(e),this._currentChannel=void 0,esy();let t=this._doneStack[this._doneStack.length-1];if(t._tag===eiF){this._doneStack.pop(),this._currentChannel=t.onSuccess(e);return}let r=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=r.reverse(),this._done=WO(e),this._currentChannel=void 0,esy();let n=esD(r.map(e=>e.finalizer),WO(e));return this.storeInProgressFinalizer(n),esS(j$(n,XX(He(()=>this.clearInProgressFinalizer())),Hn,JU(()=>He(()=>this.doneSucceed(e)))))}doneHalt(e){if(0===this._doneStack.length)return this._done=Wv(e),this._currentChannel=void 0,esy();let t=this._doneStack[this._doneStack.length-1];if(t._tag===eiF){this._doneStack.pop();try{this._currentChannel=t.onHalt(e)}catch(e){this._currentChannel=ei7(L1(e))}return}let r=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=r.reverse(),this._done=Wv(e),this._currentChannel=void 0,esy();let n=esD(r.map(e=>e.finalizer),Wv(e));return this.storeInProgressFinalizer(n),esS(j$(n,XX(He(()=>this.clearInProgressFinalizer())),Hn,JU(()=>He(()=>this.doneHalt(e)))))}processCancellation(){return this._currentChannel=void 0,this._done=this._cancelled,this._cancelled=void 0,esy()}runBracketOut(e){return esS(Hn(JH(this.provide(e.acquire()),{onFailure:e=>He(()=>{this._currentChannel=ei7(e)}),onSuccess:t=>He(()=>{this.addFinalizer(r=>this.provide(e.finalizer(t,r))),this._currentChannel=esf(t)})})))}provide(e){return void 0===this._providedEnv?e:j$(e,etw(this._providedEnv))}runEnsuring(e){this.addFinalizer(e.finalizer),this._currentChannel=e.channel}addFinalizer(e){this._doneStack.push(new eiN(e))}runSubexecutor(){let e=this._activeSubexecutor;switch(e._tag){case esk:return this.pullFromChild(e.childExecutor,e.parentSubexecutor,e.onEmit,e);case esO:return this.pullFromUpstream(e);case esE:return this.drainChildExecutors(e);case esC:return this._emitted=e.value,this._activeSubexecutor=e.next,esv()}}replaceSubexecutor(e){this._currentChannel=void 0,this._activeSubexecutor=e}finishWithExit(e){let t=Ww(e,{onFailure:e=>this.doneHalt(e),onSuccess:e=>this.doneSucceed(e)});return this._activeSubexecutor=void 0,void 0===t?Hs:es_(t)?t.effect:Hs}finishSubexecutorWithCloseEffect(e,...t){this.addFinalizer(()=>j$(t,XS(t=>j$(He(()=>t(e)),JU(e=>void 0!==e?e:Hs)),{discard:!0})));let r=j$(e,Ww({onFailure:e=>this.doneHalt(e),onSuccess:e=>this.doneSucceed(e)}));return this._activeSubexecutor=void 0,r}applyUpstreamPullStrategy(e,t,r){switch(r._tag){case eiM:{let n=!e||t.some(e=>void 0!==e);return[r.emitSeparator,n?[void 0,...t]:t]}case"PullAfterAllEnqueued":{let n=!e||t.some(e=>void 0!==e);return[r.emitSeparator,n?[...t,void 0]:t]}}}pullFromChild(e,t,r,n){return esx(e,jM,i=>{let s=r(i);switch(s._tag){case eik:break;case"Close":this.finishWithDoneValue(e,t,s.value);break;case"Yield":{let e=t.enqueuePullFromChild(n);this.replaceSubexecutor(e)}}this._activeSubexecutor=new esR(i,this._activeSubexecutor)},Ww({onFailure:r=>{let n=this.handleSubexecutorFailure(e,t,r);return void 0===n?void 0:esw(n)},onSuccess:r=>{this.finishWithDoneValue(e,t,r)}}))}finishWithDoneValue(e,t,r){switch(t._tag){case esO:{let n=new esI(t.upstreamExecutor,t.createChild,void 0!==t.lastDone?t.combineChildResults(t.lastDone,r):r,t.activeChildExecutors,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit);this._closeLastSubstream=e.close(WO(r)),this.replaceSubexecutor(n);break}case esE:{let n=new esT(t.upstreamExecutor,void 0!==t.lastDone?t.combineChildResults(t.lastDone,r):r,t.activeChildExecutors,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull);this._closeLastSubstream=e.close(WO(r)),this.replaceSubexecutor(n)}}}handleSubexecutorFailure(e,t,r){return this.finishSubexecutorWithCloseEffect(Wv(r),e=>t.close(e),t=>e.close(t))}pullFromUpstream(e){if(0===e.activeChildExecutors.length)return this.performPullFromUpstream(e);let t=e.activeChildExecutors[0],r=new esI(e.upstreamExecutor,e.createChild,e.lastDone,e.activeChildExecutors.slice(1),e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit);if(void 0===t)return this.performPullFromUpstream(r);this.replaceSubexecutor(new esF(t.childExecutor,r,t.onEmit))}performPullFromUpstream(e){return esx(e.upstreamExecutor,e=>{let t=void 0===this._closeLastSubstream?Hs:this._closeLastSubstream;return this._closeLastSubstream=void 0,j$(this._executeCloseLastSubstream(t),XD(e))},t=>{if(void 0!==this._closeLastSubstream){let r=this._closeLastSubstream;return this._closeLastSubstream=void 0,j$(this._executeCloseLastSubstream(r),JX(()=>{let r=new esA(e.createChild(t),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;let[n,i]=this.applyUpstreamPullStrategy(!1,e.activeChildExecutors,e.onPull(esM(t)));this._activeSubexecutor=new esF(r,new esI(e.upstreamExecutor,e.createChild,e.lastDone,i,e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit),e.onEmit),D7(n)&&(this._activeSubexecutor=new esR(n.value,this._activeSubexecutor))}))}let r=new esA(e.createChild(t),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;let[n,i]=this.applyUpstreamPullStrategy(!1,e.activeChildExecutors,e.onPull(esM(t)));this._activeSubexecutor=new esF(r,new esI(e.upstreamExecutor,e.createChild,e.lastDone,i,e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit),e.onEmit),D7(n)&&(this._activeSubexecutor=new esR(n.value,this._activeSubexecutor))},t=>{if(e.activeChildExecutors.some(e=>void 0!==e)){let t=new esT(e.upstreamExecutor,e.lastDone,[void 0,...e.activeChildExecutors],e.upstreamExecutor.getDone(),e.combineChildResults,e.combineWithChildResult,e.onPull);if(void 0!==this._closeLastSubstream){let e=this._closeLastSubstream;return this._closeLastSubstream=void 0,j$(this._executeCloseLastSubstream(e),JX(()=>this.replaceSubexecutor(t)))}return void this.replaceSubexecutor(t)}let r=this._closeLastSubstream,n=this.finishSubexecutorWithCloseEffect(j$(t,W_(t=>e.combineWithChildResult(e.lastDone,t))),()=>r,t=>e.upstreamExecutor.close(t));return void 0===n?void 0:esw(n)})}drainChildExecutors(e){if(0===e.activeChildExecutors.length){let t=this._closeLastSubstream;return void 0!==t&&this.addFinalizer(()=>J7(t)),this.finishSubexecutorWithCloseEffect(e.upstreamDone,()=>t,t=>e.upstreamExecutor.close(t))}let t=e.activeChildExecutors[0],r=e.activeChildExecutors.slice(1);if(void 0===t){var n;let t,[i,s]=this.applyUpstreamPullStrategy(!0,r,e.onPull((n=r.reduce((e,t)=>void 0!==t?e+1:e,0),(t=Object.create(esN))._tag="NoUpstream",t.activeDownstreamCount=n,t)));return(this.replaceSubexecutor(new esT(e.upstreamExecutor,e.lastDone,s,e.upstreamDone,e.combineChildResults,e.combineWithChildResult,e.onPull)),D7(i))?(this._emitted=i.value,esv()):void 0}let i=new esT(e.upstreamExecutor,e.lastDone,r,e.upstreamDone,e.combineChildResults,e.combineWithChildResult,e.onPull);this.replaceSubexecutor(new esF(t.childExecutor,i,t.onEmit))}}let esj=e=>void 0!==e?e:Hs,esD=(e,t)=>j$(XS(e,e=>Jj(e(t))),JX(e=>j$(Wm(e),P0(()=>WE))),JU(e=>J9(()=>e))),esP=(e,t,r)=>{let n=[e],i=()=>{let e=n.pop();if(void 0===e||void 0===e.upstream)return JM("Unexpected end of input for channel execution");let s=e.upstream.run();switch(s._tag){case esd:{let s=e.onEmit(e.upstream.getEmit());if(0===n.length){if(void 0===s)return J9(t);return j$(s,JH({onFailure:r,onSuccess:t}))}if(void 0===s)return J9(()=>i());return j$(s,JH({onFailure:r,onSuccess:()=>i()}))}case esp:{let s=e.onDone(e.upstream.getDone());if(0===n.length){if(void 0===s)return J9(t);return j$(s,JH({onFailure:r,onSuccess:t}))}if(void 0===s)return J9(()=>i());return j$(s,JH({onFailure:r,onSuccess:()=>i()}))}case esg:return n.push(e),j$(e.onEffect(s.effect),JC(t=>J9(()=>{let r=e.onDone(Wv(t));return void 0===r?Hs:r})),JH({onFailure:r,onSuccess:()=>i()}));case esm:return n.push(e),n.push(s),J9(()=>i())}};return i()},es$=jN(2,(e,t)=>Hi(r=>{let n,i;return Xv([(n=t,i=K1,n.fork(i)),WN(),WN()]).pipe(JU(([n,i,s])=>r(JS(He(()=>new esA(e,void 0,jM)),e=>J9(()=>esz(e.run(),e).pipe(JY(i),XD(WA(i)),Xj(WA(s)))),(e,t)=>{let r=e.close(t);return void 0===r?Hs:ZO(r,e=>H5(n,JP(e)))})).pipe(eev(t),JU(e=>t.addFinalizer(t=>{let r="Failure"===t._tag?L9(t.cause):void 0;return erX(i).pipe(JU(t=>t?Wz(s,void 0).pipe(XD(e.await),XD(e.inheritAll)):Wz(s,void 0).pipe(XD(r&&LJ(r)>0?Hb(e,j$(r,LB(Bf,(e,t)=>Bg(t)(e)))):Hm(e)),XD(e.inheritAll))))}).pipe(XD(r(WA(i))))))))})),esz=(e,t)=>{switch(e._tag){case esg:return j$(e.effect,JU(()=>esz(t.run(),t)));case esd:return esz(t.run(),t);case esp:return J9(()=>t.getDone());case esm:return esP(e,()=>esz(t.run(),t),JP)}},esL="Done",esU={[Symbol.for("effect/ChannelMergeDecision")]:{_R:e=>e,_E0:e=>e,_Z0:e=>e,_E:e=>e,_Z:e=>e}},esB=e=>{let t=Object.create(esU);return t._tag=esL,t.effect=e,t},esq=e=>{let t=Object.create(esU);return t._tag="Await",t.f=e,t},esJ="BothRunning",esH="LeftDone",esW="RightDone",esK=Symbol.for("effect/ChannelMergeState"),esV={[esK]:esK},esG=(e,t)=>{let r=Object.create(esV);return r._tag=esJ,r.left=e,r.right=t,r},esZ=e=>{let t=Object.create(esV);return t._tag=esH,t.f=e,t},esQ=e=>{let t=Object.create(esV);return t._tag=esW,t.f=e,t},esY="BackPressure",esX="BufferSliding",es0=Symbol.for("effect/ChannelMergeStrategy"),es1={[es0]:es0},es2=e=>{let t=Object.create(es1);return t._tag=esY,t},es3=jN(2,(e,{onBackPressure:t,onBufferSliding:r})=>{switch(e._tag){case esY:return t();case esX:return r()}}),es5="Empty",es4="Emit",es6="Error",es8="Done",es7=e=>({_tag:es5,notifyProducer:e}),es9=e=>({_tag:es4,notifyConsumers:e});class eae{ref;constructor(e){this.ref=e}awaitRead(){return Jq(GQ(this.ref,e=>e._tag===es5?[WA(e.notifyProducer),e]:[Hs,e]))}get close(){return JL(e=>this.error(L2(e)))}done(e){return Jq(GQ(this.ref,t=>{switch(t._tag){case es5:return[WA(t.notifyProducer),t];case es4:return[XS(t.notifyConsumers,t=>Wz(t,PM(e)),{discard:!0}),{_tag:es8,done:e}];case es6:case es8:return[JG,t]}}))}emit(e){return JU(WN(),t=>Jq(GQ(this.ref,r=>{switch(r._tag){case es5:return[WA(r.notifyProducer),r];case es4:{let n=r.notifyConsumers[0],i=r.notifyConsumers.slice(1);if(void 0!==n)return[Wz(n,PA(e)),0===i.length?es7(t):es9(i)];throw Error("Bug: Channel.SingleProducerAsyncInput.emit - Queue was empty! please report an issue at https://github.com/Effect-TS/effect/issues")}case es6:case es8:return[JG,r]}})))}error(e){return Jq(GQ(this.ref,t=>{switch(t._tag){case es5:return[WA(t.notifyProducer),t];case es4:return[XS(t.notifyConsumers,t=>WP(t,e),{discard:!0}),{_tag:es6,cause:e}];case es6:case es8:return[JG,t]}}))}get take(){return this.takeWith(e=>Wv(Us(e,PM)),e=>WO(e),e=>Wy(PA(e)))}takeWith(e,t,r){return JU(WN(),n=>Jq(GQ(this.ref,i=>{switch(i._tag){case es5:return[XD(Wz(i.notifyProducer,void 0),JJ(WA(n),{onFailure:e,onSuccess:Pz({onLeft:r,onRight:t})})),es9([n])];case es4:return[JJ(WA(n),{onFailure:e,onSuccess:Pz({onLeft:r,onRight:t})}),es9([...i.notifyConsumers,n])];case es6:return[J7(e(i.cause)),i];case es8:return[J7(r(i.done)),i]}})))}}let eat=()=>j$(WN(),JU(e=>GV(es7(e))),JX(e=>new eae(e))),ear=jN(2,(e,t)=>eag(e,()=>t)),ean=jN(2,(e,t)=>ei0(e,e=>Pz(Ut(e),{onLeft:t,onRight:ei7}))),eai=jN(2,(e,t)=>ei5(e,t,()=>void 0,()=>void 0)),eas=e=>ess({onInput:t=>ese(esc(()=>{e.push(t)}),()=>eas(e)),onFailure:ei8,onDone:eso}),eaa=e=>{let t=esa({onInput:()=>t,onFailure:ei7,onDone:eso});return esn(e,t)},eao=jN(2,(e,t)=>ei6(e,()=>t)),eal=jN(2,(e,t)=>est(e,{onFailure:e=>{let r=Ut(e);switch(r._tag){case"Left":return t.onFailure(r.left);case"Right":return ei7(r.right)}},onSuccess:t.onSuccess})),eau=e=>eaj(e.takeWith(ei7,t=>ese(esf(t),()=>eau(e)),eso)),eac=e=>esu(()=>eah(e)),eah=e=>j$(esr(enj(e)),ese(Pz({onLeft:Ww({onFailure:ei7,onSuccess:esl}),onRight:t=>ese(esf(t),()=>eah(e))}))),eaf=()=>ess({onInput:e=>ese(esf(e),()=>eaf()),onFailure:ei8,onDone:esl}),eap=jN(2,(e,t)=>eak(e,{other:esr(t),onSelfDone:e=>esB(J9(()=>e)),onOtherDone:e=>esB(J9(()=>e))})),ead=jN(2,(e,t)=>eap(e,WA(t))),eag=jN(2,(e,t)=>ese(e,e=>esc(()=>t(e)))),eam=jN(2,(e,t)=>ese(e,e=>esr(t(e)))),eab=jN(2,(e,t)=>eay(e,Us(t))),eay=jN(2,(e,t)=>ei0(e,e=>ei7(t(e)))),eav=jN(2,(e,t)=>{let r=ess({onInput:e=>ese(esf(t(e)),()=>r),onFailure:ei8,onDone:esl});return esn(e,r)}),eaS=jN(2,(e,t)=>{let r=esa({onInput:e=>j$(esr(t(e)),ese(esf),ese(()=>r)),onFailure:ei7,onDone:esl});return esn(e,r)}),eax=jN(3,(e,t,r)=>eaP(n=>enm(function*(){let i=yield*eat(),s=eau(i),a=yield*enG(r);yield*H5(n,enX(a));let o=yield*WN(),l=r===1/0?e=>jM:(yield*eny(r)).withPermits,u=yield*s.pipe(esn(e),eaN(n));yield*u.pipe(JH({onFailure:e=>enM(a,JP(e)),onSuccess:Pz({onLeft:e=>XD(JQ(l(r)(Hs)),J_(enM(a,J7(PM(e))))),onRight:e=>enm(function*(){let r=yield*WN(),i=yield*WN();yield*enM(a,JX(WA(r),PA)),yield*Wz(i,void 0).pipe(XD(Hi(r=>Jj(r(WA(o))).pipe(eex(Jj(r(t(e)))),JU(jM))).pipe(ZO(e=>WP(o,e)),JY(r))),l(1),eev(n)),yield*WA(i)})})}),Zp,JQ,eev(n));let c=eaj(JJ(Jq(enj(a)),{onFailure:ei7,onSuccess:Pz({onLeft:esl,onRight:e=>ese(esf(e),()=>c)})}));return ei4(c,i)}))),ea_=({bufferSize:e=16,concurrency:t,mergeStrategy:r=es2()})=>(n,i)=>eaP(s=>enm(function*(){let a="unbounded"===t?Number.MAX_SAFE_INTEGER:t,o=yield*eat(),l=eau(o),u=yield*enG(e);yield*H5(s,enX(u));let c=yield*enY();yield*H5(s,enX(c));let h=yield*GV(PY()),f=yield*WN(),p=(yield*eny(a)).withPermits,d=yield*eaN(esn(l,n),s);function g(e){return e.pipe(JU(Pz({onLeft:e=>J7(Pe(e)),onRight:e=>Jx(enM(u,J7(PA(e))),PY())})),erB({until:e=>D7(e)}),JU(e=>GY(h,PX({onNone:()=>Pe(e.value),onSome:t=>Pe(i(t,e.value))}))),JC(e=>D7(Ur(e))?JP(e):enM(u,JP(e)).pipe(XD(Wz(f,void 0)),J_)))}yield*d.pipe(JH({onFailure:e=>enM(u,JP(e)).pipe(XD(J7(!1))),onSuccess:Pz({onLeft:e=>XG(JQ(WA(f)),JQ(p(a)(Hs)),{onSelfDone:(e,t)=>Jx(Hm(t),!1),onOtherDone:(t,r)=>XD(Hm(r),h.get.pipe(JU(PX({onNone:()=>enM(u,J7(PM(e))),onSome:t=>enM(u,J7(PM(i(t,e))))})),Jx(!1)))}),onRight:e=>es3(r,{onBackPressure:()=>enm(function*(){let t=yield*WN(),r=XN(t=>eaN(esn(l,e),t).pipe(JU(e=>XZ(Jj(g(e)),Jj(JQ(WA(f))))),JU(jM)));return yield*Wz(t,void 0).pipe(XD(r),p(1),eev(s)),yield*WA(t),!(yield*erX(f))}),onBufferSliding:()=>enm(function*(){let t=yield*WN(),r=yield*WN(),n=yield*c.size;yield*enj(c).pipe(JU(e=>Wz(e,void 0)),ZI(()=>n>=a)),yield*enM(c,t);let i=XN(r=>eaN(esn(l,e),r).pipe(JU(e=>Jj(g(e)).pipe(XZ(Jj(JQ(WA(f)))),XZ(Jj(JQ(WA(t)))))),JU(jM)));return yield*Wz(r,void 0).pipe(XD(i),p(1),eev(s)),yield*WA(r),!(yield*erX(f))})})})}),erB({while:e=>e}),eev(s));let m=j$(enj(u),Jq,JJ({onFailure:ei7,onSuccess:Pz({onLeft:esl,onRight:e=>ese(esf(e),()=>m)})}),eaj);return ei4(m,o)})),eaw=jN(3,(e,t,r)=>{let n;return(n=r,e=>ea_(n)(e,jP))(eav(e,t))}),eak=jN(2,(e,t)=>eaP(function(r){return enm(function*(){let n=yield*eat(),i=eau(n),s=yield*eaN(esn(i,e),r),a=yield*eaN(esn(i,t.other),r);function o(e,t,n){return(i,s,a)=>{function o(e){return e._tag===esL?J7(esr(XD(Hm(t),e.effect))):JX(t.await,Ww({onFailure:t=>esr(e.f(Wv(t))),onSuccess:Pz({onLeft:t=>esr(e.f(WO(t))),onRight:t=>eaB(esf(t),l(a(e.f)))})}))}return Ww(e,{onFailure:e=>o(i(Wv(e))),onSuccess:Pz({onLeft:e=>o(i(WO(e))),onRight:e=>J7(ese(esf(e),()=>ese(esr(eev(JQ(n),r)),e=>l(s(e,t)))))})})}}function l(e){switch(e._tag){case esJ:return eaj(XG(JQ(ZG(e.left)),JQ(ZG(e.right)),{onSelfDone:(r,n)=>XD(Hm(n),o(r,e.right,s)(t.onSelfDone,esG,e=>esZ(e))),onOtherDone:(r,n)=>XD(Hm(n),o(r,e.left,a)(t.onOtherDone,(e,t)=>esG(t,e),e=>esQ(e)))}));case esH:return eaj(JX(Jj(a),Ww({onFailure:t=>esr(e.f(Wv(t))),onSuccess:Pz({onLeft:t=>esr(e.f(WO(t))),onRight:t=>ese(esf(t),()=>l(esZ(e.f)))})})));case esW:return eaj(JX(Jj(s),Ww({onFailure:t=>esr(e.f(Wv(t))),onSuccess:Pz({onLeft:t=>esr(e.f(WO(t))),onRight:t=>ese(esf(t),()=>l(esQ(e.f)))})})))}}return esr(Jv(e=>{let t=Jv(t=>(t.transferChildren(e.scope()),Hs));return XP(JQ(s).pipe(XX(t),eev(r)),JQ(a).pipe(XX(t),eev(r)),(e,t)=>esG(e,t))})).pipe(ese(l),ei4(n))})})),eaO=((e,t)=>ean(e,e=>ei9(()=>L1(t(e)))),jN(2,(e,t)=>ean(e,t))),eaE=jN(2,(e,t)=>esu(()=>{let r,n=ess({onInput:e=>ese(esf(e),()=>n),onFailure:e=>ei7(L1(r=eaJ(e))),onDone:esl}),i=esa({onInput:e=>j$(esf(e),ese(()=>i)),onFailure:e=>"Die"===e._tag&&eaH(e.defect)&&Dg(e.defect,r)?ei8(e.defect.error):ei7(e),onDone:esl});return esn(esn(esn(e,n),t),i)})),eaC=((e,t)=>eaP(r=>JX(ee7(t,r),t=>esi(e,t))),e=>XN(t=>es$(e,t))),eaF=e=>eaC(eaa(e)),eaI=e=>JU(X$,t=>es$(e,t)),eaT=e=>eaj(Hi(t=>JX(XB(),r=>eiX(ZO(t(Xq(e,r)),e=>{let t,n;return t=r,n=Wv(e),t.close(n)}),(e,t)=>{let n,i;return n=r,i=t,n.close(i)})))),eaR=e=>eaD(JX(Xz,t=>ese(esr(e(t)),esf))),eaN=jN(2,(e,t)=>XA(He(()=>new esA(e,void 0,jM)),eeG()).pipe(Ht(([e,r])=>{let n,i;return n=t,i=t=>{let n=e.close(t);return void 0!==n?etw(n,r):Hs},n.addFinalizer(i)}),Hn,JX(([e])=>J9(()=>eaM(e.run(),e))))),eaM=(e,t)=>{switch(e._tag){case esp:return Ww(t.getDone(),{onFailure:JP,onSuccess:e=>J7(PM(e))});case esd:return J7(PA(t.getEmit()));case esg:return j$(e.effect,JU(()=>eaM(t.run(),t)));case esm:return esP(e,()=>eaM(t.run(),t),e=>JP(e))}},eaA=e=>esa({onInput:t=>ese(esr(enM(e,PA(t))),()=>eaA(e)),onFailure:t=>esr(enM(e,PM(Wv(t)))),onDone:t=>esr(enM(e,PM(WO(t))))}),eaj=e=>ese(esr(e),jM),eaD=e=>ei3(eaT(e),(e,t)=>e,(e,t)=>e),eaP=e=>ei3(eaR(e),(e,t)=>e,(e,t)=>e),ea$=e=>eaz(0,e.length,e),eaz=(e,t,r)=>e===t?esh:j$(esf(j$(r,zk(e))),ese(()=>eaz(e+1,t,r))),eaL=jN(e=>eiY(e[1]),(e,t,r)=>r?.concurrent?eak(e,{other:t,onSelfDone:e=>esq(t=>J9(()=>WC(e,t))),onOtherDone:e=>esq(t=>J9(()=>WC(t,e)))}):ese(e,e=>eag(t,t=>[e,t]))),eaU=jN(e=>eiY(e[1]),(e,t,r)=>r?.concurrent?eag(eaL(e,t,{concurrent:!0}),e=>e[0]):ese(e,e=>ear(t,e))),eaB=jN(e=>eiY(e[1]),(e,t,r)=>r?.concurrent?eag(eaL(e,t,{concurrent:!0}),e=>e[1]):ese(e,()=>t)),eaq=Symbol.for("effect/Channel/ChannelException"),eaJ=e=>({_tag:"ChannelException",[eaq]:eaq,error:e}),eaH=e=>jZ(e,eaq),eaW=Symbol.for("effect/RcRef"),eaK={_tag:"Left"},eaV={_tag:"Right"},eaG={_tag:"Both"},eaZ={_tag:"Either"},eaQ=Symbol.for("effect/Sink"),eaY={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e};class eaX{channel;[eaQ]=eaY;constructor(e){this.channel=e}pipe(){return DF(this,arguments)}}let ea0=e=>new eaX(esu(()=>eoc(e()))),ea1=((e,t)=>j$(e,ea1(zU(t))),jN(2,(e,t)=>{let r=ess({onInput:e=>j$(esf(t(e)),ese(()=>r)),onFailure:ei8,onDone:eso});return new eaX(j$(r,esn(eoc(e))))})),ea2=jN(2,(e,t)=>{let r=ess({onInput:e=>j$(esr(t(e)),ese(esf),ese(()=>r)),onFailure:ei8,onDone:eso});return new eaX(j$(r,eaE(eoc(e))))}),ea3=e=>new eaX(ei8(e)),ea5=(e,t,r)=>ea0(()=>new eaX(ea4(e,t,r))),ea4=(e,t,r)=>t(e)?ess({onInput:n=>{let[i,s]=ea6(e,n,t,r,0,n.length);return zP(s)?j$(esf(s),ear(i)):ea4(i,t,r)},onFailure:ei8,onDone:()=>esl(e)}):esl(e),ea6=(e,t,r,n,i,s)=>{if(i===s)return[e,zd()];let a=n(e,j$(t,zk(i)));return r(a)?ea6(a,t,r,n,i+1,s):[a,j$(t,zF(i+1))]},ea8=jN(2,(e,t)=>new eaX(j$(eoc(e),ei1,eal({onFailure:e=>eoc(t.onFailure(e)),onSuccess:([e,r])=>esu(()=>{let n={ref:j$(e,zN(zP))},i=j$(esc(()=>{let e=n.ref;return n.ref=zd(),e}),ese(e=>ea$(e)));return ese(ei1(j$(i,eaB(eaf()),esn(eoc(t.onSuccess(r))))),([e,t])=>j$(eso(n.ref),ese(ea$),eaB(ea$(e)),ear(t)))})})))),ea7=(e,t,r)=>ea0(()=>new eaX(ea9(e,t,r))),ea9=(e,t,r)=>t(e)?ess({onInput:n=>j$(esr(eoe(e,n,t,r)),ese(([e,n])=>j$(n,PX({onNone:()=>ea9(e,t,r),onSome:t=>j$(esf(t),ear(e))})))),onFailure:ei8,onDone:()=>esl(e)}):esl(e),eoe=(e,t,r,n)=>eot(e,t,0,t.length,r,n),eot=(e,t,r,n,i,s)=>r===n?J7([e,PY()]):j$(s(e,j$(t,zk(r))),JU(e=>i(e)?eot(e,t,r+1,n,i,s):J7([e,Pe(j$(t,zF(r+1)))]))),eor=jN(2,(e,t)=>ea8(e,{onFailure:ea3,onSuccess:t})),eon=e=>{let t=esa({onInput:r=>j$(esr(XS(r,t=>e(t),{discard:!0})),ese(()=>t)),onFailure:ei7,onDone:()=>esh});return new eaX(t)},eoi=e=>{let t=esa({onInput:r=>j$(esr(e(r)),ese(()=>t)),onFailure:ei7,onDone:()=>esh});return new eaX(t)},eos=(e,t,r,n,i)=>r===n?i:j$(esr(e(j$(t,zk(r)))),ese(s=>s?eos(e,t,r+1,n,i):esf(j$(t,zF(r)))),ean(e=>j$(esf(j$(t,zF(r))),eaB(ei8(e))))),eoa=(e,t)=>t?.shutdown?eoh(JX(Xb(J7(e),enX),eoa)):eoi(t=>enA(e,t)),eoo=jN(2,(e,t)=>new eaX(j$(eoc(e),eag(t)))),eol=((e,t)=>new eaX(j$(eoc(e),eam(t))),jN(2,(e,t)=>eof(function(r){return enm(function*(){let n,i=yield*eiw(t?.capacity??16),s=yield*Xq(i.subscribe,r),a=yield*Xq(i.subscribe,r),o=(n=i,esu(()=>eaA(n))),l=eac(s).pipe(esn(eoc(e)),eaU(esr(enX(s))),eak({other:eac(a).pipe(esn(eoc(t.other)),eaU(esr(enX(a)))),onSelfDone:t.onSelfDone,onOtherDone:t.onOtherDone}));return new eaX(eak(o,{other:l,onSelfDone:()=>esq(jM),onOtherDone:e=>esB(e)}))})}))),eou=((e,t,r)=>new eaX(j$(e,eoc,ean(e=>PX(t(e),{onNone:()=>ei9(()=>L1(r(e))),onSome:ei8})))),(e,t,r=0)=>{let n,i=e[Symbol.iterator](),s=0,a=-1;for(;a<0&&(n=i.next())&&!n.done;){let e=n.value;s>=r&&t(e)&&(a=s),s+=1}return a}),eoc=((e,t,r)=>new eaX(j$(esr(t),ese(n=>j$(e,eoc,ese(e=>j$(esr(t),eag(t=>[e,r(n,t)]))))))),e=>Jy(e)?eoc(new eaX(esr(e))):e.channel),eoh=e=>new eaX(eaD(e.pipe(JX(e=>eoc(e))))),eof=e=>new eaX(eaP(t=>e(t).pipe(JX(e=>eoc(e))))),eop=((e=>jZ(e[1],eaQ),(e,t,r)=>eop(e,t,(e,t)=>t,r)),jN(e=>jZ(e[1],eaQ),(e,t,r,n)=>n?.concurrent?eol(e,{other:t,onSelfDone:Ww({onFailure:e=>esB(JP(e)),onSuccess:e=>esq(Ww({onFailure:JP,onSuccess:t=>J7(r(e,t))}))}),onOtherDone:Ww({onFailure:e=>esB(JP(e)),onSuccess:e=>esq(Ww({onFailure:JP,onSuccess:t=>J7(r(t,e))}))})}):eor(e,e=>eoo(t,t=>r(e,t)))));class eod{value;constructor(e){this.value=e}}let eog=(e,t)=>{e.isChanged=!0,e.newValue=t},eom=e=>{e.ref.versioned=new eod(e.newValue)},eob=e=>({ref:e.ref,isNew:e.isNew,isChanged:e.isChanged,expected:e.expected,newValue:e.newValue}),eoy=e=>e.ref.versioned!==e.expected,eov=e=>e.isChanged,eoS="Invalid",eox="ReadWrite",eo_=e=>{for(let t of e)eom(t[1])},eow=e=>{let t="ReadOnly";for(let[,r]of e)if((t=eoy(r)?eoS:eov(r)?eox:t)===eoS)break;return t},eok="WithSTMRuntime",eoO="OnFailure",eoE="OnRetry",eoC="OnSuccess",eoF="Provide",eoI="Sync",eoT="Succeed",eoR="Retry",eoN="Fail",eoM="Interrupt",eoA="Fail",eoj="Interrupt",eoD="Succeed",eoP="Retry",eo$="Done",eoz="Suspend",eoL="Done",eoU="Interrupted",eoB="Running",eoq="effect/STM/State",eoJ=Symbol.for(eoq),eoH=e=>({[eoJ]:eoJ,_tag:eoL,exit:e,[Dn](){return j$(Di(eoq),Da(Di(eoL)),Da(Di(e)),Dp(this))},[Dd]:t=>jZ(t,eoJ)&&t._tag===eoL&&Dg(e,t.exit)}),eoW=j$(Di(eoq),Da(Di(eoU)),Da(Di("interrupted"))),eoK={[eoJ]:eoJ,_tag:eoU,[Dn]:()=>eoW,[Dd]:e=>jZ(e,eoJ)&&e._tag===eoU},eoV=j$(Di(eoq),Da(Di(eoB)),Da(Di("running"))),eoG={[eoJ]:eoJ,_tag:eoB,[Dn]:()=>eoV,[Dd]:e=>jZ(e,eoJ)&&e._tag===eoB},eoZ=e=>{switch(e._tag){case eoA:return eoH(Wy(e.error));case"Die":return eoH(Wb(e.defect));case eoj:return eoH(Wv(L2(e.fiberId)));case eoD:return eoH(WO(e.value));case eoP:throw Error("BUG: STM.STMState.fromTExit - please report an issue at https://github.com/Effect-TS/effect/issues")}},eoQ="effect/TExit",eoY=Symbol.for(eoQ),eoX={_A:e=>e,_E:e=>e},eo0=e=>({[eoY]:eoX,_tag:eoA,error:e,[Dn](){return j$(Di(eoQ),Da(Di(eoA)),Da(Di(e)),Dp(this))},[Dd]:t=>jZ(t,eoY)&&t._tag===eoA&&Dg(e,t.error)}),eo1=e=>({[eoY]:eoX,_tag:"Die",defect:e,[Dn](){return j$(Di(eoQ),Da(Di("Die")),Da(Di(e)),Dp(this))},[Dd]:t=>jZ(t,eoY)&&"Die"===t._tag&&Dg(e,t.defect)}),eo2=e=>({[eoY]:eoX,_tag:eoj,fiberId:e,[Dn](){return j$(Di(eoQ),Da(Di(eoj)),Da(Di(e)),Dp(this))},[Dd]:t=>jZ(t,eoY)&&t._tag===eoj&&Dg(e,t.fiberId)}),eo3=e=>({[eoY]:eoX,_tag:eoD,value:e,[Dn](){return j$(Di(eoQ),Da(Di(eoD)),Da(Di(e)),Dp(this))},[Dd]:t=>jZ(t,eoY)&&t._tag===eoD&&Dg(e,t.value)}),eo5=j$(Di(eoQ),Da(Di(eoP)),Da(Di("retry"))),eo4={[eoY]:eoX,_tag:eoP,[Dn]:()=>eo5,[Dd]:e=>jZ(e,eoY)&&e._tag===eoP},eo6=e=>({_tag:eoz,journal:e}),eo8={ref:0},eo7=Symbol.for("effect/STM"),eo9={_R:e=>e,_E:e=>e,_A:e=>e};class ele{effect_instruction_i0;_op=DT;effect_instruction_i1=void 0;effect_instruction_i2=void 0;[Jp];[DH];[eaQ];[eiZ];get[eo7](){return eo9}constructor(e){this.effect_instruction_i0=e,this[Jp]=DV,this[DH]=eo9,this[eaQ]=eo9,this[eiZ]=eo9}[Dd](e){return this===e}[Dn](){return Dp(this,Ds(this))}[Symbol.iterator](){return new Jh(new j7(this))}commit(){return elt(this,jP,jP)}pipe(){return DF(this,arguments)}}let elt=(e,t,r)=>Jv(n=>{let i=n.id(),s=n.getFiberRef(H$),a=n.getFiberRef(G3),o=n.getFiberRef(Hz),l=elr(i,e,s,a,o);switch(l._tag){case eo$:return t(l.exit),l.exit;case eoz:{let n,l=(n=eo8.ref+1,eo8.ref=n,n),u={value:eoG},c=JE(t=>eln(i,e,l,u,s,a,o,t));return Hi(e=>j$(e(c),JC(e=>{let n=u.value;return n._tag===eoB&&(u.value=eoK),(n=u.value)._tag===eoL?(t(n.exit),n.exit):(r(),JP(e))})))}}}),elr=(e,t,r,n,i)=>{let s=new Map,a=new ela(t,s,e,r).run(),o=eow(s);if(o===eox&&a._tag===eoD)eo_(s);else if(o===eoS)throw Error("BUG: STM.TryCommit.tryCommitSync - please report an issue at https://github.com/Effect-TS/effect/issues");switch(a._tag){case eoD:return eli(WO(a.value),s,n,i);case eoA:return eli(Wv(L0(a.error)),s,n,i);case"Die":return eli(Wv(L1(a.defect)),s,n,i);case eoj:return eli(Wv(L2(e)),s,n,i);case eoP:return eo6(s)}},eln=(e,t,r,n,i,s,a,o)=>{if(n.value._tag===eoB){let l=((e,t,r,n,i,s)=>{let a=new Map,o=new ela(t,a,e,n).run(),l=eow(a);if(l===eox)eo_(a);else if(l===eoS)throw Error("BUG: STM.TryCommit.tryCommit - please report an issue at https://github.com/Effect-TS/effect/issues");switch(o._tag){case eoD:return r.value=eoZ(o),eli(WO(o.value),a,i,s);case eoA:return r.value=eoZ(o),eli(Wv(L0(o.error)),a,i,s);case"Die":return r.value=eoZ(o),eli(Wv(L1(o.defect)),a,i,s);case eoj:return r.value=eoZ(o),eli(Wv(L2(e)),a,i,s);case eoP:return eo6(a)}})(e,t,n,i,s,a);switch(l._tag){case eo$:els(l.exit,o);break;case eoz:((e,t,r)=>{for(let[,n]of t)n.ref.todos.has(e)||n.ref.todos.set(e,r)})(r,l.journal,()=>eln(e,t,r,n,i,s,a,o))}}},eli=(e,t,r,n)=>{let i=(e=>{let t=new Map;for(let[,r]of e){for(let e of r.ref.todos)t.set(e[0],e[1]);r.ref.todos=new Map}return t})(t);return i.size>0&&r.scheduleTask(()=>(e=>{for(let[t,r]of Array.from(e.entries()).sort((e,t)=>e[0]-t[0]))r()})(i),n),{_tag:eo$,exit:e}},els=(e,t)=>{t(e)};class ela{self;journal;fiberId;contStack=[];env;constructor(e,t,r,n){this.self=e,this.journal=t,this.fiberId=r,this.env=n}getEnv(){return this.env}pushStack(e){this.contStack.push(e)}popStack(){return this.contStack.pop()}nextSuccess(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==eoC;)e=this.popStack();return e}nextFailure(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==eoO;)e=this.popStack();return e}nextRetry(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==eoE;)e=this.popStack();return e}run(){let e,t=this.self;for(;void 0===e&&void 0!==t;)try{let r=t;if(r)switch(r._op){case"Tag":t=elh((e,t,n)=>Pg(n,r));break;case"Left":t=elp(r.left);break;case"None":t=elp(new Wa);break;case"Right":t=elx(r.right);break;case"Some":t=elx(r.value);break;case"Commit":switch(r.effect_instruction_i0){case"Die":e=eo1(Dt(()=>r.effect_instruction_i1()));break;case eoN:{let n=this.nextFailure();void 0===n?e=eo0(Dt(()=>r.effect_instruction_i1())):t=Dt(()=>n.effect_instruction_i2(Dt(()=>r.effect_instruction_i1())));break}case eoR:{let r=this.nextRetry();void 0===r?e=eo4:t=Dt(()=>r.effect_instruction_i2());break}case eoM:e=eo2(this.fiberId);break;case eok:t=Dt(()=>r.effect_instruction_i1(this));break;case eoC:case eoO:case eoE:this.pushStack(r),t=r.effect_instruction_i1;break;case eoF:{let e=this.env;this.env=Dt(()=>r.effect_instruction_i2(e)),t=j$(r.effect_instruction_i1,elf(el_(()=>this.env=e)));break}case eoT:{let n=r.effect_instruction_i1,i=this.nextSuccess();void 0===i?e=eo3(n):t=Dt(()=>i.effect_instruction_i2(n));break}case eoI:{let n=Dt(()=>r.effect_instruction_i1()),i=this.nextSuccess();void 0===i?e=eo3(n):t=Dt(()=>i.effect_instruction_i2(n))}}}}catch(e){t=elu(e)}return e}}let elo=jN(2,(e,t)=>{let r=new ele(eoO);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),ell=jN(2,(e,t)=>{let r=new ele(eoF);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),elu=e=>elc(()=>e),elc=e=>{let t=new ele("Die");return t.effect_instruction_i1=e,t},elh=e=>elb(t=>elx(e(t.journal,t.fiberId,t.getEnv()))),elf=jN(2,(e,t)=>elm(e,{onFailure:e=>elw(t,elp(e)),onSuccess:e=>elw(t,elx(e))})),elp=e=>eld(()=>e),eld=e=>{let t=new ele(eoN);return t.effect_instruction_i1=e,t},elg=jN(2,(e,t)=>{let r=new ele(eoC);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),elm=jN(2,(e,{onFailure:t,onSuccess:r})=>j$(e,ely(PA),elo(e=>j$(t(e),ely(PM))),elg(e=>{switch(e._tag){case"Left":return elx(e.left);case"Right":return r(e.right)}}))),elb=e=>{let t=new ele(eok);return t.effect_instruction_i1=e,t},ely=jN(2,(e,t)=>j$(e,elg(e=>el_(()=>t(e))))),elv=jN(2,(e,t)=>{let r=new ele(eoE);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),elS=new ele(eoR),elx=e=>{let t=new ele(eoT);return t.effect_instruction_i1=e,t},el_=e=>{let t=new ele(eoI);return t.effect_instruction_i1=e,t},elw=jN(2,(e,t)=>j$(e,elg(()=>t))),elk=jN(3,(e,t,r)=>j$(e,elg(e=>j$(t,ely(t=>r(e,t)))))),elO=((e,t)=>j$(e,ely(()=>t)),jN(2,(e,{onFailure:t,onSuccess:r})=>elm(e,{onFailure:e=>elx(t(e)),onSuccess:e=>elx(r(e))}))),elE=jN(e=>j1(e[0]),(e,t,r)=>r?.discard?j$(el_(()=>e[Symbol.iterator]()),elg(e=>{let r=elF(()=>{let n=e.next();return n.done?elI:j$(t(n.value),elg(()=>r))});return r})):elF(()=>$y(e).reduce((e,r)=>elk(e,t(r),(e,t)=>(e.push(t),e)),elx([])))),elC=((e,t)=>elm(e,{onFailure:e=>elp(t(e)),onSuccess:elx}),jN(2,(e,t)=>ell(e,e=>t))),elF=((e,t,r)=>{let n;return n=n=>elg(r,r=>elC(e,Pf(n,t,r))),elg(elh((e,t,r)=>r),n)},e=>elg(el_(e),jM)),elI=elx(void 0),elT=Symbol.for("effect/TRef"),elR=(e,t)=>{if(t.has(e))return t.get(e);let r={ref:e,isNew:!1,isChanged:!1,expected:e.versioned,newValue:e.versioned.value};return t.set(e,r),r};(e,t)=>elR(e,t).newValue,(e,t,r)=>elF(()=>{let n=(t,r,i)=>r<t?elx(i):j$(e.takeUpTo(r),elg(s=>{let a=t-s.length;return 1===a?j$(e.take,ely(e=>j$(i,zT(z_(s)),zO(e)))):a>1?j$(e.take,elg(e=>n(a-1,r-s.length-1,j$(i,zT(z_(s)),zO(e))))):elx(j$(i,zT(z_(s))))}));return ely(n(t,r,zd()),e=>Array.from(e))});class elN{capacity;array;size=0;current=0;constructor(e){this.capacity=e,this.array=Array.from({length:e},jP)}head(){return P3(this.array[this.current])}lastOrNull(){if(0===this.size)return;let e=0===this.current?this.array.length-1:this.current-1;return this.array[e]??void 0}put(e){this.array[this.current]=e,this.increment()}dropLast(){this.size>0&&(this.decrement(),this.array[this.current]=void 0)}toChunk(){let e=this.current-this.size;return zb(e<0?[...this.array.slice(this.capacity+e,this.capacity),...this.array.slice(0,this.current)]:this.array.slice(e,this.current))}increment(){this.size<this.capacity&&(this.size+=1),this.current=(this.current+1)%this.capacity}decrement(){this.size-=1,this.current>0?this.current-=1:this.current=this.capacity-1}}let elM=Symbol.for("effect/Stream/Handoff"),elA="Empty",elj="Full",elD=e=>({_tag:elA,notifyConsumer:e}),elP=(e,t)=>r=>{switch(r._tag){case elA:return e(r.notifyConsumer);case elj:return t(r.value,r.notifyProducer)}},el$={_A:e=>e},elz=()=>j$(WN(),JU(e=>GV(elD(e))),JX(e=>({[elM]:el$,ref:e}))),elL=jN(2,(e,t)=>JU(WN(),r=>Jq(GQ(e.ref,n=>j$(n,elP(e=>[XD(Wz(e,void 0),WA(r)),{_tag:elj,value:t,notifyProducer:r}],(r,i)=>[JU(WA(i),()=>j$(e,elL(t))),n])))))),elU=e=>JU(WN(),t=>Jq(GQ(e.ref,r=>j$(r,elP(t=>[JU(WA(t),()=>elU(e)),r],(e,r)=>[Jx(Wz(r,void 0),e),elD(t)]))))),elB="Emit",elq="Halt",elJ=e=>({_tag:elq,cause:e}),elH=e=>({_tag:"End",reason:e}),elW=Symbol.for("effect/Take"),elK={_A:e=>e,_E:e=>e};class elV{exit;[elW]=elK;constructor(e){this.exit=e}pipe(){return DF(this,arguments)}}let elG=e=>new elV(WO(e)),elZ=e=>J9(()=>e.exit),elQ=new elV(Wy(PY())),elY=e=>new elV(Wv(j$(e,Us(Pe)))),elX=jN(2,(e,{onEnd:t,onFailure:r,onSuccess:n})=>Ww(e.exit,{onFailure:e=>PX(X1(e),{onNone:t,onSome:r}),onSuccess:n})),el0=e=>new elV(WO(zm(e))),el1="ScheduleEnd",el2="UpstreamEnd",el3={_tag:el1},el5={_tag:el2},el4="DrainLeft",el6="DrainRight",el8="PullBoth",el7="PullLeft",el9="PullRight",eue={_tag:el4},eut={_tag:el6},eur={_tag:el8},eun=e=>({_tag:el7,rightChunk:e}),eui=e=>({_tag:el9,leftChunk:e}),eus="PullBoth",eua="PullLet",euo="PullRight",eul={_tag:eus},euu=e=>({_tag:eua,rightChunk:e}),euc=e=>({_tag:euo,leftChunk:e}),euh=Symbol.for("effect/Stream"),euf={_R:e=>e,_E:e=>e,_A:e=>e};class eup{channel;[euh]=euf;constructor(e){this.channel=e}pipe(){return DF(this,arguments)}}let eud=e=>jZ(e,euh)||Jy(e),eug=4096,eum=((e,t,r)=>euj(eum(e,t,r),e=>Pz(e,{onLeft:PY,onRight:Pe})),jN(3,(e,t,r)=>euH(Xv([elz(),GV(el3),GV(zd()),erk(r),GV(!1),GV(!1)])).pipe(euD(([r,n,i,s,a,o])=>{let l=esa({onInput:e=>ese(esr(j$(r,elL({_tag:elB,elements:e}),ZI(()=>zP(e)))),()=>l),onFailure:e=>esr(elL(r,elJ(e))),onDone:()=>esr(elL(r,elH(el5)))}),u=j$(GZ(i,zd()),JU(e=>zP(e)?j$(GG(a,!0),XD(J7(j$(esf(e),ese(()=>u))))):j$(elU(r),JX(e=>{switch(e._tag){case elB:return j$(esr(GG(a,!0)),eaB(esf(e.elements)),eaB(esr(o.get)),ese(e=>e?esh:u));case elq:return ei7(e.cause);case"End":if(e.reason._tag===el1)return j$(a.get,JX(e=>e?esr(j$(GG(n,el3),XD(GG(o,!0)))):j$(esr(j$(GG(n,el3),XD(GG(o,!0)))),ese(()=>u))),eaj);return j$(GG(n,e.reason),XD(GG(o,!0)),esr)}}))),eaj),c=(e,l,h)=>{let f=j$(GG(a,!1),XD(GG(o,!1)),XD(j$(u,eaE(eoc(t)),ei1,eaC,eev(h)))),p=(e,t,r)=>j$(GG(i,zj(e)),XD(JX(n.get,e=>{switch(e._tag){case el1:let n;return j$(Xv([a.get,f,j$((n=Pe(t),s.next(n)),eev(h))]),JX(([e,n,i])=>{let s=j$(r,PX({onNone:()=>zm(PA(t)),onSome:e=>zg(PA(t),PM(e))}));return e?j$(esf(s),ese(()=>c(n,i,h))):c(n,i,h)}),eaj);case el2:return j$(a.get,JX(e=>e?esf(zm(PA(t))):esh),eaj)}})),eaj);return eaj(XG(ZG(e),ZG(l),{onSelfDone:(e,t)=>j$(Hm(l),XD(j$(J9(()=>e),JX(([e,t])=>p(e,t,PY()))))),onOtherDone:(t,n)=>JH(J9(()=>t),{onFailure:t=>Pz(Ut(t),{onLeft:()=>j$(r,elL(elH(el3)),Xk,XD(j$(ZG(e),JX(([e,t])=>p(e,t,PY()))))),onRight:t=>j$(r,elL(elJ(t)),Xk,XD(j$(ZG(e),JX(([e,t])=>p(e,t,PY())))))}),onSuccess:t=>j$(r,elL(elH(el3)),Xk,XD(j$(ZG(e),JX(([e,r])=>p(e,r,Pe(t))))))})}))};return ecA(r=>esn(euq(e),l).pipe(eaC,eev(r),XD(eaE(u,eoc(t)).pipe(ei1,eaC,eev(r),JU(e=>{let t;return(t=PY(),s.next(t)).pipe(eev(r),JX(t=>new eup(c(e,t,r))))})))))})))),eub=((e,t)=>JX(ecE(e,t),e=>euU(euK(e))),(e,t)=>{let r=(e,t)=>{let n=r=>j$(t.get,Ht(WA),XD(WN()),JU(n=>j$(enM(e,[r,n]),XD(GG(t,n)),XD(WA(n)))),J_,esr);return esa({onInput:n=>j$(WN(),JU(r=>j$(enM(e,[elG(n),r]),JU(e=>j$(GG(t,r),ZI(()=>e))))),J_,esr,ese(()=>r(e,t))),onFailure:e=>n(elY(e)),onDone:()=>n(elQ)})};return eaD(j$(e,JU(e=>j$(WN(),Ht(e=>Wz(e,void 0)),JU(n=>{let i;return j$(GV(n),JU(n=>j$(t,esn(r(e,n)),eaI,eeS)),Jx(i=j$(esr(enj(e)),ese(([e,t])=>eaB(esr(Wz(t,void 0)),elX(e,{onEnd:()=>esh,onFailure:ei7,onSuccess:e=>j$(esf(e),ese(()=>i))}))))))})))))}),euy=jN(2,(e,t)=>euv(e,e=>Pz(Ut(e),{onLeft:t,onRight:euA}))),euv=jN(2,(e,t)=>new eup(j$(euq(e),ei0(e=>euq(t(e)))))),euS=jN(2,(e,t)=>j$(e,euv(e=>j$(t(e),P0(()=>euA(e)))))),eux=e=>JF(JX(e,Pe),e=>"None"===e._tag?Zx:JD(e.value)),eu_=jN(4,(e,t,r,n)=>{let i=(e,t)=>eaB(esr(elU(t)),esa({onInput:r=>ese(esr(j$(e,elL(elG(r)))),()=>i(e,t)),onFailure:t=>esr(elL(e,elY(t))),onDone:()=>esr(elL(e,elQ))}));return new eup(eaP(s=>Xv([elz(),elz(),elz(),elz()]).pipe(Ht(([t,r,n])=>esn(euq(e),i(t,n)).pipe(es$(s),eev(s))),Ht(([e,r,n,a])=>esn(euq(t),i(r,a)).pipe(es$(s),eev(s))),JX(([e,t,i,s])=>{let a=elL(i,void 0).pipe(XD(elU(e).pipe(JU(elZ)))),o=elL(s,void 0).pipe(XD(elU(t).pipe(JU(elZ))));return euq(ecR(r,e=>JU(n(e,a,o),eux)))}))))}),euw=jN(2,(e,t)=>new eup(j$(euq(e),eaB(euq(t))))),euk=((e,t)=>euD(e,()=>t),jN(2,(e,t)=>j$(WN(),JU(r=>j$(e,euC({maximumLag:t.maximumLag,decide:e=>JU(WA(r),t=>t(e))}),JU(e=>{let n;return j$(Xv(zU(0<=(n=t.size-1)?zZ(n-0+1,e=>0+e):zm(0),t=>JX(e,([e,r])=>[[e,t],r]))),JX(z_),JU(e=>{let[n,i]=ze(e,[new Map,zd()],([e,t],[r,n])=>[e.set(r[0],r[1]),j$(t,zE(n))]);return j$(Wz(r,e=>JX(t.decide(e),e=>t=>e(n.get(t)))),Jx(Array.from(i)))}))})))))),euO={ref:0},euE=()=>{let e=euO.ref;return euO.ref=e+1,e},euC=jN(2,(e,t)=>euF(e,t.maximumLag,t.decide,()=>Hs)),euF=jN(4,(e,t,r,n)=>j$(Xb(GV(new Map),(e,t)=>j$(e.get,JU(e=>j$(e.values(),XS(enX))))),JU(i=>enm(function*(){let s=yield*eny(1),a=yield*GV(j$(enG(t),JU(e=>{let t=euE();return j$(GY(i,r=>r.set(t,e)),Jx([t,e]))}))),o=e=>s.withPermits(1)(j$(GG(a,j$(enG(1),Ht(t=>enM(t,e)),JU(e=>{let t=euE();return j$(GY(i,r=>r.set(t,e)),Jx($s(t,e)))}))),XD(j$(i.get,JU(t=>j$(zb(t.values()),XS(t=>j$(enM(t,e),Za(e=>D7(Ur(e))?Pe(Hs):PY()))))))),XD(n(e)),J_));return yield*j$(e,ecd(e=>j$(r(e),JU(t=>j$(i.get,JU(r=>j$(r.entries(),ZS(zd(),(r,[n,i])=>t(n)?j$(enM(i,WO(e)),JH({onFailure:e=>D7(Ur(e))?J7(j$(r,zE(n))):JP(e),onSuccess:()=>J7(r)})):J7(r)),JU(e=>zP(e)?GY(i,t=>{for(let r of e)t.delete(r);return t}):Hs))))),J_)),JH({onFailure:e=>o(Wv(j$(e,Us(Pe)))),onSuccess:()=>o(Wy(PY()))}),eeS),s.withPermits(1)(Jq(a.get))})))),euI=((e,t)=>{let r=e=>ess({onInput:t=>{let n=j$(t,zF(e)),i=Math.max(0,e-t.length);return zD(t)||i>0?r(i):j$(esf(n),eaB(eaf()))},onFailure:ei8,onDone:()=>esh});return new eup(j$(euq(e),eaE(r(t))))},new eup(esh)),euT=jN(2,(e,t)=>new eup(j$(euq(e),eao(t)))),euR=jN(2,(e,t)=>new eup(ei6(euq(e),t))),euN=e=>j$(euH(WB),euD(e)),euM=e=>euW(JD(Pe(e))),euA=e=>euH(JP(e)),euj=((e,t)=>{let r=e=>{let n=e.next();return n.done?esa({onInput:e=>r(e[Symbol.iterator]()),onFailure:ei7,onDone:eso}):j$(t(n.value),JX(t=>t?j$(esf(zm(n.value)),ese(()=>r(e))):r(e)),eaj)};return new eup(esu(()=>j$(euq(e),esn(r(zd()[Symbol.iterator]())))))},jN(2,(e,t)=>eu1(e,zR(t)))),euD=jN(e=>eud(e[0]),(e,t,r)=>{let n=r?.bufferSize??16;return r?.switch?euP(r?.concurrency,()=>eu$(e,1,n,t),r=>eu$(e,r,n,t)):euP(r?.concurrency,()=>new eup(eai(euq(e),e=>j$(e,zU(e=>euq(t(e))),$9(esh,(e,t)=>j$(e,eaB(t)))))),n=>new eup(j$(euq(e),eai(ea$),eaw(e=>euq(t(e)),r))))}),euP=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r(Number.MAX_SAFE_INTEGER);default:return e>1?r(e):t()}},eu$=jN(4,(e,t,r,n)=>{let i;return new eup(j$(euq(e),eai(ea$),eaw(e=>euq(n(e)),{concurrency:t,mergeStrategy:((i=Object.create(es1))._tag=esX,i),bufferSize:r})))}),euz=jN(e=>eud(e[0]),(e,t)=>euD(e,jM,t)),euL=e=>{let t=esa({onInput:e=>((e,t)=>{let[r,n]=j$(e,zJ(e=>!Wp(e))),i=j$(z$(n),PX({onNone:()=>t,onSome:Ww({onFailure:e=>PX(X1(e),{onNone:()=>esh,onSome:ei7}),onSuccess:()=>esh})}));return j$(esf(j$(r,zR(e=>Wp(e)?Pe(e.value):PY()))),ese(()=>i))})(e,t),onFailure:e=>ei7(e),onDone:()=>esh});return new eup(j$(euq(e),esn(t)))},euU=e=>{var t;let r;return t=euL(j$(e,euX(e=>e.exit))),r=esa({onInput:e=>ese(ea$(e),()=>r),onFailure:ei7,onDone:()=>esh}),new eup(j$(euq(t),esn(r)))},euB=e=>new eup(e),euq=e=>{if("channel"in e)return e.channel;if(Jy(e))return euq(euH(e));throw TypeError("Expected a Stream.")},euJ=e=>new eup(zD(e)?esh:esf(e)),euH=e=>j$(e,J1(Pe),euW),euW=e=>new eup(eaj(Zf(e,{onFailure:PX({onNone:()=>esh,onSome:ei8}),onSuccess:e=>esf(zm(e))}))),euK=(e,t)=>{let r=t?.maxChunkSize??eug;if(t?.scoped){let n=JX(e.subscribe,e=>euQ(e,{maxChunkSize:r,shutdown:!0}));return t.shutdown?JX(n,euT(e.shutdown)):n}let n=euD(ecv(e.subscribe),e=>euQ(e,{maxChunkSize:r}));return t?.shutdown?euT(n,e.shutdown):n},euV=e=>ecS(()=>zf(e)?euJ(e):euG(e[Symbol.iterator]())),euG=(e,t=eug)=>j$(He(()=>{let r=[],n=e=>j$(He(()=>{let i=e.next();if(1===t)return i.done?esh:j$(esf(zm(i.value)),ese(()=>n(e)));r=[];let s=0;for(;!1===i.done&&(r.push(i.value),!((s+=1)>=t));)i=e.next();return s>0?j$(esf(z_(r)),ese(()=>n(e))):esh}),eaj);return new eup(n(e))}),ecN),euZ=e=>j$(e,JX(ecl),ecM),euQ=(e,t)=>j$(enP(e,1,t?.maxChunkSize??eug),JC(t=>j$(e.isShutdown,JU(e=>e&&D7(Ur(t))?JD(PY()):J1(JP(t),Pe)))),ecl,t?.shutdown?euT(enX(e)):jM),euY=((e,t)=>{let r=e=>j$(e.poll,JX(PX({onNone:()=>ess({onInput:t=>ese(esf(t),()=>r(e)),onFailure:ei8,onDone:()=>esh}),onSome:Ww({onFailure:ei7,onSuccess:()=>esh})})),eaj);return new eup(eaP(n=>t.pipe(eev(n),JX(t=>euq(e).pipe(esn(r(t)))))))},jN(2,(e,t)=>new eup(j$(euq(e),eap(t))))),euX=((e,t)=>new eup(j$(euq(e),ead(t))),jN(2,(e,t)=>new eup(j$(euq(e),eav(zU(t)))))),eu0=((e,t,r)=>{let n=e=>ess({onInput:t=>{let[i,s]=zB(t,e,r);return ese(esf(s),()=>n(i))},onFailure:ei8,onDone:()=>esh});return new eup(j$(euq(e),esn(n(t))))},jN(3,(e,t,r)=>ecS(()=>{let n=e=>ess({onInput:t=>j$(J9(()=>{let i=[];return j$(t,ZS(e,(e,t)=>j$(r(e,t),JU(([e,t])=>j$(He(()=>{i.push(t)}),Jx(e))))),Zf({onFailure:e=>0!==i.length?eaB(esf(z_(i)),ei8(e)):ei8(e),onSuccess:e=>ese(esf(z_(i)),()=>n(e))}))}),eaj),onFailure:ei8,onDone:()=>esh});return new eup(j$(euq(e),eaE(n(t))))}))),eu1=jN(2,(e,t)=>new eup(j$(euq(e),eav(t)))),eu2=((e,t)=>j$(e,eu1(zM(t))),jN(2,(e,t)=>{let r=e=>{let n=e.next();return n.done?esa({onInput:e=>r(e[Symbol.iterator]()),onFailure:ei7,onDone:eso}):eaj(JX(t(n.value),t=>ese(esf(zm(t)),()=>r(e))))};return new eup(j$(euq(e),esn(esu(()=>r(zd()[Symbol.iterator]())))))})),eu3=jN(3,(e,t,r)=>new eup(j$(euq(e),eai(ea$),eax(r,t),eav(zm)))),eu5=jN(2,(e,t)=>new eup(j$(euq(e),eab(t)))),eu4=((e=>eud(e[1]),(e,t,r)=>eu8(e,t,{onSelf:jM,onOther:jM,haltStrategy:r?.haltStrategy})),jN(e=>Symbol.iterator in e[0],(e,t)=>euz(euV(e),t))),eu6=jN(2,(e,t)=>eu8(e,t,{onSelf:PM,onOther:PA})),eu8=jN(3,(e,t,r)=>{let n=r.haltStrategy?(e=>{switch(e){case"left":return eaK;case"right":return eaV;case"both":return eaG;case"either":return eaZ;default:return e}})(r.haltStrategy):eaG,i=e=>t=>e||!Wp(t)?esB(J9(()=>t)):esq(e=>J9(()=>e));return new eup(eak(euq(euX(e,r.onSelf)),{other:euq(euX(t,r.onOther)),onSelfDone:i("Either"===n._tag||"Left"===n._tag),onOtherDone:i("Either"===n._tag||"Right"===n._tag)}))}),eu7=((e,t)=>new eup(j$(euq(e),eaO(()=>euq(t())))),jN(2,(e,t)=>{let r=ess({onInput:e=>zD(e)?esu(()=>r):j$(esf(e),eaB(eaf())),onFailure:ei8,onDone:()=>esu(()=>euq(t()))});return new eup(j$(euq(e),esn(r)))})),eu9=((e=>"function"==typeof e[1],(e,t,r)=>j$(eu2(e,t),euk({size:2,maximumLag:r?.bufferSize??16,decide:Pz({onLeft:()=>J7(e=>0===e),onRight:()=>J7(e=>1===e)})}),JU(([e,t])=>J7([euj(euL(euQ(e,{shutdown:!0})),e=>Pz(e,{onLeft:Pe,onRight:PY})),euj(euL(euQ(t,{shutdown:!0})),e=>Pz(e,{onLeft:PY,onRight:Pe}))])))),jN(2,(e,t)=>new eup(esn(euq(e),t)))),ece=jN(2,(e,t)=>new eup(j$(euq(e),esi(t)))),ect=((e,t)=>eci(e,Pb(t)),jN(2,(e,t)=>new eup(eaP(r=>ee7(t,r).pipe(JX(t=>j$(euq(e),esi(t)))))))),ecr=jN(3,(e,t,r)=>ecn(e,t,euH(r))),ecn=jN(3,(e,t,r)=>euN(n=>euD(r,r=>j$(e,ece(Pf(n,t,r)))))),eci=jN(2,(e,t)=>euN(r=>j$(e,ece(t(r))))),ecs=((e,t)=>j$(e,ect(j$(etr(),eth(t)))),jN(2,(e,t)=>ecS(()=>{let r=Math.max(t,1),n=eca(new eco(r),r);return new eup(j$(euq(e),esn(n)))}))),eca=(e,t)=>esa({onInput:r=>{if(r.length===t&&e.isEmpty())return ese(esf(r),()=>eca(e,t));if(r.length>0){let n,i=[],s=0;for(;s<r.length;){for(;s<r.length&&void 0===n;)n=e.write(j$(r,zk(s))),s+=1;void 0!==n&&(i.push(n),n=void 0)}return ese(((...e)=>ea$(zb(e)))(...i),()=>eca(e,t))}return esu(()=>eca(e,t))},onFailure:t=>eaB(e.emitIfNotEmpty(),ei7(t)),onDone:()=>e.emitIfNotEmpty()});class eco{n;builder=[];pos=0;constructor(e){this.n=e}isEmpty(){return 0===this.pos}write(e){if(this.builder.push(e),this.pos+=1,this.pos===this.n){let e=z_(this.builder);return this.builder=[],this.pos=0,e}}emitIfNotEmpty(){return 0!==this.pos?esf(z_(this.builder)):esh}}(e,t,r)=>new eup(ean(euq(e),e=>PX(t(e),{onNone:()=>ei7(L1(r(e))),onSome:ei8})));let ecl=e=>ecR(e,e=>j$(JX(e,t=>Pe([t,e])),JF(PX({onNone:()=>J7(PY()),onSome:JD})))),ecu=e=>ecl(j$(e,JX(zm))),ecc=((e,t)=>ecc(e,t,{onElement:e=>PA(e),onSchedule:PM}),jN(3,(e,t,r)=>j$(erk(t),JX(t=>{let n=j$(e,ecr(erp,t.iterationMeta.get),euX(r.onElement),euq),i=eaj(Zf(t.next(void 0),{onFailure:()=>esh,onSuccess:e=>ese(n,()=>eaB(esf(zm(r.onSchedule(e))),i))}));return new eup(eaB(n,i))}),ecN))),ech=((e,t)=>erk(t).pipe(JX(t=>{let r=euq(ecr(erp,t.iterationMeta.get)(e)).pipe(eaS(e=>Jx(t.reset,e)),ean(e=>t.next(e).pipe(Zf({onFailure:()=>ei8(e),onSuccess:()=>r}),eaj)));return r}),eaj,euB),jN(2,(e,t)=>euq(e).pipe(eaE(eoc(t)),eaF))),ecf=((e,t,r,n)=>ech(e,ea5(t,r,n)),jN(2,(e,t)=>ech(e,eon(t)))),ecp=jN(2,(e,t)=>ech(e,eoi(t))),ecd=jN(2,(e,t)=>j$(e,ecy(eon(t)))),ecg=jN(2,(e,t)=>j$(e,ecb(t))),ecm=((e,t)=>j$(e,ecb(t),enb),jN(2,(e,t)=>{let r=esa({onInput:e=>ese(esr(enA(t,zU(e,WO))),()=>r),onFailure:e=>esr(enM(t,Wv(Us(e,Pe)))),onDone:()=>esr(enM(t,Wy(PY())))});return j$(esn(euq(e),r),eaa,eaI,J_)})),ecb=jN(2,(e,t)=>{let r=esa({onInput:e=>ese(esf(elG(e)),()=>r),onFailure:e=>esf(elY(e)),onDone:()=>esf(elQ)});return j$(esn(euq(e),r),eaS(e=>enM(t,e)),eaa,eaI,J_)}),ecy=jN(2,(e,t)=>j$(euq(e),eaE(eoc(t)),eaa,eaI)),ecv=((e,t)=>j$(e,eu0(PY(),(e,r)=>{switch(e._tag){case"None":return J7([Pe(r),r]);case"Some":return j$(t(e.value,r),JX(e=>[Pe(e),e]))}})),e=>new eup(eao(eaT(j$(e,JX(zm))),Hs))),ecS=((e,t,r)=>t<=0||r<=0?euH(JN(new Wi("Invalid bounds - `chunkSize` and `stepSize` must be greater than zero"))):new eup(esu(()=>{let n=new elN(t),i=(e,i)=>{if(e<t){let e=n.toChunk();return j$(esf(zD(e)?zd():zm(e)),ese(()=>i))}let s=e-(e-t)%r;if(s===e)return i;let a=j$(n.toChunk(),zW(e-(s-t+r)));return j$(esf(zD(a)?zd():zm(a)),ese(()=>i))},s=e=>esa({onInput:i=>ese(esf(zR(i,(i,s)=>{n.put(i);let a=e+s+1;return a<t||(a-t)%r>0?PY():Pe(n.toChunk())})),()=>s(e+i.length)),onFailure:t=>i(e,ei7(t)),onDone:()=>i(e,esh)});return j$(euq(e),esn(s(0)))})),e=>new eup(esu(()=>euq(e())))),ecx=jN(2,(e,t)=>{let r=ess({onInput:e=>{let n=j$(e,zK(t));return n.length===e.length?j$(esf(n),ese(()=>r)):esf(n)},onFailure:ei8,onDone:eso});return new eup(j$(euq(e),eaE(r)))}),ec_=((e,t)=>eu2(e,e=>Jx(t(e),e)),(e,t,r,n,i)=>{let s=(e,a)=>esa({onInput:o=>j$(t(o),XA(KK),JX(([t,l])=>{let u=e+(l-a)/UQ(n)*r,c=r+i<0?1/0:r+i,h=u<0?c:Math.min(u,c);return t<=h?j$(esf(o),ese(()=>s(h-t,l))):s(e,a)}),eaj),onFailure:ei7,onDone:()=>esh}),a=j$(KK,JX(e=>s(r,e)),eaj);return new eup(j$(euq(e),eaE(a)))}),ecw=(e,t,r,n,i)=>{let s=(e,a)=>esa({onInput:o=>j$(t(o),XA(KK),JX(([t,l])=>{let u=e+(l-a)/UQ(n)*r,c=r+i<0?1/0:r+i,h=(u<0?c:Math.min(u,c))-t,f=UH(Math.max(0,(h>=0?0:-h/r)*UQ(n)));return U4(f,UU)?j$(esr(G8(f)),eaB(esf(o)),ese(()=>s(h,l))):ese(esf(o),()=>s(h,l))}),eaj),onFailure:ei7,onDone:()=>esh}),a=j$(KK,JX(e=>s(r,e)),eaj);return new eup(j$(euq(e),eaE(a)))},eck=jN(3,(e,t,r)=>j$(ecC(e),JX(eew({onTimeout:()=>Us(t(),Pe),duration:r})),euZ)),ecO=((e,t,r)=>{let n=new H9("Stream Timeout");return j$(e,eck(()=>L1(n),t),euS(e=>"Die"===e._tag&&jZ(e.defect,H7)&&void 0!==e.defect.message&&"Stream Timeout"===e.defect.message?Pe(r):PY()))},e=>{if("number"==typeof e)return eiw(e);if("unbounded"===e.capacity){let t;return t={replay:e.replay},J9(()=>{let e;return eis((e=t,new eie(e?.replay?new eiS(e.replay):void 0)),new eim)})}switch(e.strategy){case"dropping":return J9(()=>eis(en3(e),new eim));case"sliding":return J9(()=>eis(en3(e),new eib));default:return eiw(e)}}),ecE=jN(2,(e,t)=>j$(Xb(ecO(t),e=>e.shutdown),Ht(t=>j$(e,ecg(t),eeS)))),ecC=e=>{let t;return JX((t=euq(e),JU(Xz,e=>eaN(t,e))),e=>j$(e,J1(Pe),JU(Pz({onLeft:()=>JD(PY()),onRight:J7}))))},ecF=jN(e=>eud(e[0]),(e,t)=>Ht(Xb(t?.strategy==="unbounded"?enY():t?.strategy==="dropping"?enZ(t.capacity??2):t?.strategy==="sliding"?enQ(t.capacity??2):enG(t?.capacity??2),e=>enX(e)),t=>eeS(ecb(e,t)))),ecI=((e=>eud(e[0]),(e,t)=>Ht(Xb(enG(t?.capacity??2),e=>enX(e)),t=>eeS(ecm(e,t)))),jN(e=>eud(e[0]),(e,t)=>JX(eeG(),r=>ecT(e,r,t)))),ecT=jN(e=>eud(e[0]),(e,t,r)=>{let n,i,s=eej(t),a=new eeg(!1??!1);return new ReadableStream({start(t){(i=s(ecp(e,e=>0===e.length?Hs:a.whenOpen(He(()=>{for(let r of(a.unsafeClose(),e))t.enqueue(r);n(),n=void 0}))))).addObserver(e=>{try{if("Failure"===e._tag){let r;t.error((r=e.cause,H4(jM)(r)))}else t.close()}catch{}})},pull:()=>new Promise(e=>{n=e,eeX(a.open)}),cancel(){if(i)return eeY(J_(Hm(i)))}},r?.strategy)}),ecR=(e,t)=>ecS(()=>{let r=e=>eaj(JX(t(e),PX({onNone:()=>esh,onSome:([e,t])=>ese(esf(e),()=>r(t))})));return new eup(r(e))}),ecN=e=>euz(euH(e)),ecM=e=>euz(ecv(e)),ecA=e=>{let t;return euz((t=t=>e(t),new eup(eaR(e=>t(e).pipe(JX(zm))))))},ecj=((e,t)=>j$(euH(t),euD(t=>t?e:euI)),jN(3,(e,t,r)=>{let n=(e,t,r)=>{switch(e._tag){case eus:return j$(eux(t),XA(eux(r),{concurrent:!0}),JW({onFailure:e=>J7(Wy(Pe(e))),onSuccess:([e,s])=>D7(e)&&D7(s)?zD(e.value)&&zD(s.value)?n(eul,t,r):zD(e.value)?n(euu(s.value),t,r):zD(s.value)?n(euc(e.value),t,r):J7(WO(i(e.value,s.value))):J7(Wy(PY()))}));case eua:return JW(t,{onFailure:e=>J7(Wy(e)),onSuccess:s=>zD(s)?n(euu(e.rightChunk),t,r):zD(e.rightChunk)?n(euc(s),t,r):J7(WO(i(s,e.rightChunk)))});case euo:return JW(r,{onFailure:e=>J7(Wy(e)),onSuccess:s=>zD(s)?n(euc(e.leftChunk),t,r):zD(e.leftChunk)?n(euu(s),t,r):J7(WO(i(e.leftChunk,s)))})}},i=(e,t)=>{let[n,i]=r(e,t);switch(i._tag){case"Left":if(zD(i.left))return[n,eul];return[n,euc(i.left)];case"Right":if(zD(i.right))return[n,eul];return[n,euu(i.right)]}};return j$(e,eu_(t,eul,n))})),ecD=(e,t,r)=>e.length>t.length?[j$(e,zC(t.length),zV(t,r)),PM(j$(e,zF(t.length)))]:[j$(e,zV(j$(t,zC(e.length)),r)),PA(j$(t,zF(e.length)))],ecP=Symbol.for("effect/GroupBy"),ec$={_R:e=>e,_E:e=>e,_K:e=>e,_V:e=>e},ecz=jN(e=>jZ(e[0],ecP),(e,t,r)=>euD(e.grouped,([e,r])=>t(e,euU(euQ(r,{shutdown:!0}))),{concurrency:"unbounded",bufferSize:r?.bufferSize??16}));e=>"function"!=typeof e[0],(e,t,r)=>r?.key?ecz(ecU(e,r.key,{bufferSize:r.bufferSize}),(e,r)=>eu2(r,t)):euP(r?.concurrency,()=>eu2(e,t),n=>r?.unordered?euD(e,e=>euH(t(e)),{concurrency:n}):eu3(e,n,t));class ecL extends KQ{dequeue;f;[enx]={_Out:e=>e};constructor(e,t){super(),this.dequeue=e,this.f=t}capacity(){return this.dequeue.capacity()}get size(){return this.dequeue.size}unsafeSize(){return this.dequeue.unsafeSize()}get awaitShutdown(){return this.dequeue.awaitShutdown}isActive(){return this.dequeue.isActive()}get isShutdown(){return this.dequeue.isShutdown}get shutdown(){return enX(this.dequeue)}get isFull(){return this.dequeue.isFull}get isEmpty(){return this.dequeue.isEmpty}get take(){return j$(enj(this.dequeue),JX(e=>this.f(e)))}get takeAll(){return j$(this.dequeue.takeAll,JX(zU(e=>this.f(e))))}takeUpTo(e){return j$(enD(this.dequeue,e),JX(zU(e=>this.f(e))))}takeBetween(e,t){return j$(enP(this.dequeue,e,t),JX(zU(e=>this.f(e))))}takeN(e){return j$(en$(this.dequeue,e),JX(zU(e=>this.f(e))))}poll(){return j$(JX(this.dequeue.takeUpTo(1),z$),JX(P7(e=>this.f(e))))}pipe(){return DF(this,arguments)}commit(){return this.take}}let ecU=jN(e=>"function"!=typeof e[0],(e,t,r)=>{let n=(e,i)=>esa({onInput:s=>ese(esr(XS(ecB(s,t),([t,n])=>{let s=e.get(t);return void 0===s?j$(enG(r?.bufferSize??16),JU(r=>j$(He(()=>{e.set(t,r)}),XD(enM(i,el0([t,r]))),XD(j$(enM(r,elG(n)),Za(e=>L8(e)?Pe(Hs):PY())))))):Za(enM(s,elG(n)),e=>L8(e)?Pe(Hs):PY())},{discard:!0})),()=>n(e,i)),onFailure:e=>esr(enM(i,elY(e))),onDone:()=>esr(j$(XS(e.entries(),([e,t])=>j$(enM(t,elQ),Za(e=>L8(e)?Pe(Hs):PY())),{discard:!0}),XD(enM(i,elQ))))});return{[ecP]:ec$,pipe(){return DF(this,arguments)},grouped:ecA(t=>enm(function*(){let r=new Map,i=yield*enY();return yield*H5(t,enX(i)),yield*euq(e).pipe(esn(n(r,i)),eaa,es$(t),eev(t),Jx(euU(euQ(i,{shutdown:!0}))))}))}}),ecB=jN(2,(e,t)=>{let r,n=[],i=e[Symbol.iterator](),s=new Map;for(;(r=i.next())&&!r.done;){let e=r.value,i=t(e);if(s.has(i))s.get(i).push(e);else{let t=[e];n.push([i,t]),s.set(i,t)}}return z_(n.map(e=>[e[0],z_(e[1])]))}),ecq=(...e)=>{let t=1===e.length?e[0].evaluate:e[0],r=1===e.length?e[0].onError:e[1],n=1===e.length&&!0===e[0].releaseLockOnEnd;return ecM(JX(Xb(He(()=>t().getReader()),e=>{let t;return n?He(()=>e.releaseLock()):(t=()=>e.cancel()).length>=1?JE((e,r)=>{try{t(r).then(t=>e(J7(t)),t=>e(JN(t)))}catch(t){e(JN(t))}}):JE(e=>{try{t().then(t=>e(J7(t)),t=>e(JN(t)))}catch(t){e(JN(t))}})}),e=>ecu(JU(ZE({try:()=>e.read(),catch:e=>Pe(r(e))}),({done:e,value:t})=>e?JD(PY()):J7(t)))))},ecJ=Symbol.for("effect/BigDecimal"),ecH={[ecJ]:ecJ,[Dn](){let e=ecX(this);return j$(Di(e.value),Da(Du(e.scale)),Dp(this))},[Dd](e){return ecW(e)&&ec8(this,e)},toString(){return`BigDecimal(${ec7(this)})`},toJSON(){return{_id:"BigDecimal",value:String(this.value),scale:this.scale}},[Dy](){return this.toJSON()},pipe(){return DF(this,arguments)}},ecW=e=>jZ(e,ecJ),ecK=(e,t)=>{let r=Object.create(ecH);return r.value=e,r.scale=t,r},ecV=(e,t)=>{if(e!==ecG&&e%ecQ===ecG)throw RangeError("Value must be normalized");let r=ecK(e,t);return r.normalized=r,r},ecG=BigInt(0),ecZ=BigInt(1),ecQ=BigInt(10),ecY=ecV(ecG,0),ecX=e=>{if(void 0===e.normalized)if(e.value===ecG)e.normalized=ecY;else{let t=`${e.value}`,r=0;for(let e=t.length-1;e>=0;e--)if("0"===t[e])r++;else break;0===r&&(e.normalized=e);let n=BigInt(t.substring(0,t.length-r)),i=e.scale-r;e.normalized=ecV(n,i)}return e.normalized},ec0=jN(2,(e,t)=>t>e.scale?ecK(e.value*ecQ**BigInt(t-e.scale),t):t<e.scale?ecK(e.value/ecQ**BigInt(e.scale-t),t):e),ec1=jN(2,(e,t)=>t.value===ecG?e:e.value===ecG?t:e.scale>t.scale?ecK(ec0(t,e.scale).value+e.value,e.scale):e.scale<t.scale?ecK(ec0(e,t.scale).value+t.value,t.scale):ecK(e.value+t.value,e.scale)),ec2=PH((e,t)=>{let r=PW(ec4(e),ec4(t));return 0!==r?r:e.scale>t.scale?PK(e.value,ec0(t,e.scale).value):e.scale<t.scale?PK(ec0(e,t.scale).value,t.value):PK(e.value,t.value)}),ec3=(V=ec2,jN(2,(e,t)=>-1===V(e,t))),ec5=PG(ec2),ec4=e=>e.value===ecG?0:e.value<ecG?-1:1,ec6=Px((e,t)=>e.scale>t.scale?ec0(t,e.scale).value===e.value:e.scale<t.scale?ec0(e,t.scale).value===t.value:e.value===t.value),ec8=jN(2,(e,t)=>ec6(e,t)),ec7=e=>{let t,r,n=ecX(e);if(Math.abs(n.scale)>=16)return ec9(n);let i=n.value<ecG,s=i?`${n.value}`.substring(1):`${n.value}`;if(n.scale>=s.length)t="0",r="0".repeat(n.scale-s.length)+s;else{let e=s.length-n.scale;if(e>s.length){let n=e-s.length;t=`${s}${"0".repeat(n)}`,r=""}else r=s.slice(e),t=s.slice(0,e)}let a=""===r?t:`${t}.${r}`;return i?`-${a}`:a},ec9=e=>{if(ehe(e))return"0e+0";let t=ecX(e),r=`${(t.value<ecG?ecK(-t.value,t.scale):t).value}`,n=r.slice(0,1),i=r.slice(1),s=`${eht(t)?"-":""}${n}`;""!==i&&(s+=`.${i}`);let a=i.length-t.scale;return`${s}e${a>=0?"+":""}${a}`},ehe=e=>e.value===ecG,eht=e=>e.value<ecG,ehr=e=>ecW(e[0]),ehn=((e,t=0)=>{let r=ehn(e,t);return e.value>ecG&&ec3(r,e)?ec1(r,ecK(1n,t)):r},jN(ehr,(e,t=0)=>e.scale<=t?e:ecK(e.value/10n**BigInt(e.scale-t),t))),ehi=((e,t)=>e.scale<t?0n:e.value/10n**BigInt(e.scale-t)%10n,BigInt(0)),ehs=((e,t)=>{for(;t!==ehi;){let r=t;t=e%t,e=r}return e},e=>{try{return""===e.trim()?PY():Pe(BigInt(e))}catch{return PY()}}),eha="effect/Redacted",eho=jL("effect/Redacted/redactedRegistry",()=>new WeakMap),ehl=Symbol.for(eha),ehu={[ehl]:{_A:e=>e},pipe(){return DF(this,arguments)},toString:()=>"<redacted>",toJSON:()=>"<redacted>",[Dy]:()=>"<redacted>",[Dn](){return j$(Di(eha),Da(Di(eho.get(this))),Dp(this))},[Dd](e){return ehc(e)&&Dg(eho.get(this),eho.get(e))}},ehc=e=>jZ(e,ehl),ehh=Symbol.for("effect/Secret");({...ehu,[ehh]:ehh});let ehf=Symbol.for("effect/Config"),ehp={...DQ,[ehf]:{_A:e=>e},commit(){var e;let t;return e=this,t=t=>t.load(e),KH(e=>t(e.unsafeMap.get(Kb.key)))}},ehd=((e,t)=>ehd(e,e=>PA(t(e))),jN(2,(e,t)=>{let r=Object.create(ehp);return r._tag=Kh,r.original=e,r.mapOrFail=t,r})),ehg=jN(2,(e,t)=>{let r=Object.create(ehp);return r._tag=Kf,r.name=t,r.config=e,r}),ehm=((e,t)=>{let r=Object.create(ehp);return r._tag=Ku,r.first=e,r.second=ehm(t.orElse),r.condition=t.if,r},e=>{let t=Object.create(ehp);return t._tag=Kc,t.config=e,t}),ehb=((e,t,r)=>{let n=Object.create(ehp);return n._tag=Kd,n.left=e,n.right=t,n.zip=r,n},etj),ehy=e=>etP(e)&&"Offset"===e._tag,ehv=e=>etP(e)&&"Named"===e._tag,ehS=e=>"Utc"===e._tag,ehx=et$,eh_=etz,ehw=etU,ehk=etJ;e=>e.replace(/[\n\r]/g,"");let ehO=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return ehO(e,t.from)}},ehE=e=>{let t,r=!1;return()=>(r||(t=e(),r=!0),t)},ehC=e=>{try{return e.toISOString()}catch{return String(e)}},ehF="[Circular]";function ehI(e,t=0){let r=new WeakSet,n=t?"number"==typeof t?" ".repeat(t):t:"",i=(e,t)=>{let r=e?.constructor;return r&&r!==Object.prototype.constructor&&r.name?`${r.name}(${t})`:t};return function e(t,s=0){if(Array.isArray(t)){let i,a;if(r.has(t))return ehF;if(r.add(t),!n||t.length<=1)return`[${t.map(t=>e(t,s)).join(",")}]`;let o=t.map(t=>e(t,s+1)).join(",\n"+(i=s+1,n.repeat(i)));return`[
${a=s+1,n.repeat(a)}${o}
${n.repeat(s)}]`}if(j0(t))return ehC(t);if(jZ(t,"toString")&&"function"==typeof t.toString&&t.toString!==Object.prototype.toString)try{let e=t.toString();return"string"==typeof e?e:String(e)}catch{return"[toString threw]"}if(jU(t))return JSON.stringify(t);if(jB(t)||null==t||jq(t)||jH(t))return String(t);if(jJ(t))return String(t)+"n";if(t instanceof Set||t instanceof Map)return r.has(t)?ehF:(r.add(t),`${t.constructor.name}(${e(Array.from(t),s)})`);if(jG(t)){if(r.has(t))return ehF;r.add(t);let a=(e=>{try{return Reflect.ownKeys(e)}catch{return["[ownKeys threw]"]}})(t);if(!n||a.length<=1){let r=`{${a.map(r=>`${ehT(r)}:${e(t[r],s)}`).join(",")}}`;return i(t,r)}let o=`{
${a.map(r=>{let i;return`${i=s+1,n.repeat(i)}${ehT(r)}: ${e(t[r],s+1)}`}).join(",\n")}
${n.repeat(s)}}`;return i(t,o)}return String(t)}(e,0)}function ehT(e){return jU(e)?JSON.stringify(e):String(e)}let ehR=e=>`[${ehT(e)}]`,ehN=e=>Array.isArray(e)?e.map(ehR).join(""):ehR(e),ehM=(e,t,r,n)=>{let i=e;return r&&$E(r)&&(i+=`
at path: ${ehN(r)}`),void 0!==t&&(i+=`
details: ${t}`),n&&(i+=`
schema (${n._tag}): ${n}`),i},ehA=(e,t,r)=>ehM("Unsupported schema or overlapping types",`cannot extend ${e} with ${t}`,r),ehj=e=>ehM("Unsupported schema",void 0,void 0,e),ehD=e=>ehM("Duplicate index signature",`${e} index signature`),ehP=ehM("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),eh$=ehM("Invalid element","A required element cannot follow an optional element. ts(1257)"),ehz=e=>ehM("Duplicate property signature transformation",`Duplicate key ${ehI(e)}`),ehL=e=>ehM("Duplicate property signature",`Duplicate key ${ehI(e)}`),ehU=Symbol.for("effect/SchemaId/DateFromSelf"),ehB=Symbol.for("effect/SchemaId/GreaterThan"),ehq=Symbol.for("effect/SchemaId/GreaterThanOrEqualTo"),ehJ=Symbol.for("effect/SchemaId/LessThan"),ehH=Symbol.for("effect/SchemaId/LessThanOrEqualTo"),ehW=Symbol.for("effect/SchemaId/Int"),ehK=Symbol.for("effect/SchemaId/NonNaN"),ehV=Symbol.for("effect/SchemaId/Finite"),ehG=Symbol.for("effect/SchemaId/JsonNumber"),ehZ=Symbol.for("effect/SchemaId/Between"),ehQ=Symbol.for("effect/SchemaId/GreaterThanOrEqualToBigint"),ehY=Symbol.for("effect/SchemaId/BetweenBigint"),ehX=Symbol.for("effect/SchemaId/MinLength"),eh0=Symbol.for("effect/SchemaId/Length"),eh1=Symbol.for("effect/annotation/Brand"),eh2=Symbol.for("effect/annotation/SchemaId"),eh3=Symbol.for("effect/annotation/Message"),eh5=Symbol.for("effect/annotation/MissingMessage"),eh4=Symbol.for("effect/annotation/Identifier"),eh6=Symbol.for("effect/annotation/Title"),eh8=Symbol.for("effect/annotation/AutoTitle"),eh7=Symbol.for("effect/annotation/Description"),eh9=Symbol.for("effect/annotation/Examples"),efe=Symbol.for("effect/annotation/Default"),eft=Symbol.for("effect/annotation/JSONSchema"),efr=Symbol.for("effect/annotation/Arbitrary"),efn=Symbol.for("effect/annotation/Pretty"),efi=Symbol.for("effect/annotation/Equivalence"),efs=Symbol.for("effect/annotation/Documentation"),efa=Symbol.for("effect/annotation/Concurrency"),efo=Symbol.for("effect/annotation/Batching"),efl=Symbol.for("effect/annotation/ParseIssueTitle"),efu=Symbol.for("effect/annotation/ParseOptions"),efc=Symbol.for("effect/annotation/DecodingFallback"),efh=Symbol.for("effect/annotation/Surrogate"),eff=Symbol.for("effect/annotation/StableFilter"),efp=jN(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?Pe(e.annotations[t]):PY()),efd=efp(eh1),efg=efp(eh3),efm=efp(eh5),efb=efp(eh6),efy=efp(eh8),efv=efp(eh4),efS=efp(eh7),efx=efp(efa),ef_=efp(efo),efw=efp(efl),efk=efp(efu),efO=efp(efc),efE=efp(efh),efC=efp(eff),efF=e=>$n(efC(e),e=>!0===e),efI=Symbol.for("effect/annotation/JSONIdentifier"),efT=efp(efI);class efR{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(e,t,r,n={}){this.typeParameters=e,this.decodeUnknown=t,this.encodeUnknown=r,this.annotations=n}toString(){return P0(epK(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(e=>e.toJSON()),annotations:ep$(this.annotations)}}}let efN=e=>t=>t._tag===e;class efM{literal;annotations;_tag="Literal";constructor(e,t={}){this.literal=e,this.annotations=t}toString(){return P0(epK(this),()=>ehI(this.literal))}toJSON(){return{_tag:this._tag,literal:jJ(this.literal)?String(this.literal):this.literal,annotations:ep$(this.annotations)}}}let efA=efN("Literal"),efj=new efM(null);class efD{symbol;annotations;_tag="UniqueSymbol";constructor(e,t={}){this.symbol=e,this.annotations=t}toString(){return P0(epK(this),()=>ehI(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:ep$(this.annotations)}}}let efP=efN("UniqueSymbol"),ef$=new class{annotations;_tag="UndefinedKeyword";constructor(e={}){this.annotations=e}toString(){return epH(this)}toJSON(){return{_tag:this._tag,annotations:ep$(this.annotations)}}}({[eh6]:"undefined"}),efz=new class{annotations;_tag="NeverKeyword";constructor(e={}){this.annotations=e}toString(){return epH(this)}toJSON(){return{_tag:this._tag,annotations:ep$(this.annotations)}}}({[eh6]:"never"}),efL=efN("NeverKeyword"),efU=new class{annotations;_tag="UnknownKeyword";constructor(e={}){this.annotations=e}toString(){return epH(this)}toJSON(){return{_tag:this._tag,annotations:ep$(this.annotations)}}}({[eh6]:"unknown"}),efB=new class{annotations;_tag="AnyKeyword";constructor(e={}){this.annotations=e}toString(){return epH(this)}toJSON(){return{_tag:this._tag,annotations:ep$(this.annotations)}}}({[eh6]:"any"}),efq=new class{annotations;_tag="StringKeyword";constructor(e={}){this.annotations=e}toString(){return epH(this)}toJSON(){return{_tag:this._tag,annotations:ep$(this.annotations)}}}({[eh6]:"string",[eh7]:"a string"}),efJ=efN("StringKeyword"),efH=new class{annotations;_tag="NumberKeyword";constructor(e={}){this.annotations=e}toString(){return epH(this)}toJSON(){return{_tag:this._tag,annotations:ep$(this.annotations)}}}({[eh6]:"number",[eh7]:"a number"}),efW=efN("NumberKeyword"),efK=new class{annotations;_tag="BooleanKeyword";constructor(e={}){this.annotations=e}toString(){return epH(this)}toJSON(){return{_tag:this._tag,annotations:ep$(this.annotations)}}}({[eh6]:"boolean",[eh7]:"a boolean"}),efV=efN("BooleanKeyword"),efG=new class{annotations;_tag="BigIntKeyword";constructor(e={}){this.annotations=e}toString(){return epH(this)}toJSON(){return{_tag:this._tag,annotations:ep$(this.annotations)}}}({[eh6]:"bigint",[eh7]:"a bigint"}),efZ=new class{annotations;_tag="SymbolKeyword";constructor(e={}){this.annotations=e}toString(){return epH(this)}toJSON(){return{_tag:this._tag,annotations:ep$(this.annotations)}}}({[eh6]:"symbol",[eh7]:"a symbol"}),efQ=efN("SymbolKeyword"),efY=efN("Enums"),efX=e=>{switch(e._tag){case"Literal":case"NumberKeyword":case"StringKeyword":case"TemplateLiteral":return!0;case"Union":return e.types.every(efX)}return!1},ef0=e=>{switch(e._tag){case"Literal":return JSON.stringify(String(e.literal));case"StringKeyword":return"string";case"NumberKeyword":return"number";case"TemplateLiteral":return String(e);case"Union":return e.types.map(ef0).join(" | ")}},ef1=efN("TemplateLiteral");class ef2{type;annotations;constructor(e,t={}){this.type=e,this.annotations=t}toJSON(){return{type:this.type.toJSON(),annotations:ep$(this.annotations)}}toString(){return String(this.type)}}class ef3 extends ef2{isOptional;constructor(e,t,r={}){super(e,r),this.isOptional=t}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:ep$(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}let ef5=e=>e.map(e=>e.type);class ef4{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(e,t,r,n={}){this.elements=e,this.rest=t,this.isReadonly=r,this.annotations=n;let i=!1,s=!1;for(const t of e)if(t.isOptional)i=!0;else if(i){s=!0;break}if(s||i&&t.length>1)throw Error(eh$)}toString(){return P0(epK(this),()=>ef6(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(e=>e.toJSON()),rest:this.rest.map(e=>e.toJSON()),isReadonly:this.isReadonly,annotations:ep$(this.annotations)}}}let ef6=e=>{let t=e.elements.map(String).join(", ");return $x(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(r,n)=>{let i=String(r),s=i.includes(" | ")?`(${i})`:i;if(n.length>0){let r=n.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${s}[], ${r}]`:`readonly [...${s}[], ${r}]`}return e.elements.length>0?`readonly [${t}, ...${s}[]]`:`ReadonlyArray<${i}>`}})};class ef8 extends ef3{name;isReadonly;constructor(e,t,r,n,i){super(t,r,i),this.name=e,this.isReadonly=n}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:ep$(this.annotations)}}}let ef7=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return ef7(e.from)}return!1};class ef9{type;isReadonly;parameter;constructor(e,t,r){if(this.type=t,this.isReadonly=r,ef7(e))this.parameter=e;else throw Error(ehP)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class epe{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(e,t,r={}){this.annotations=r;const n={};for(let t=0;t<e.length;t++){const r=e[t].name;if(Object.prototype.hasOwnProperty.call(n,r))throw Error(ehL(r));n[r]=null}const i={string:!1,symbol:!1};for(let e=0;e<t.length;e++){const r=epz(t[e].parameter);if(efJ(r)){if(i.string)throw Error(ehD("string"));i.string=!0}else if(efQ(r)){if(i.symbol)throw Error(ehD("symbol"));i.symbol=!0}}this.propertySignatures=e,this.indexSignatures=t}toString(){return P0(epK(this),()=>epr(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(e=>e.toJSON()),indexSignatures:this.indexSignatures.map(e=>e.toJSON()),annotations:ep$(this.annotations)}}}let ept=e=>e.map(String).join("; "),epr=e=>{if(e.propertySignatures.length>0){let t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${ept(e.indexSignatures)} }`:`{ ${t} }`}return e.indexSignatures.length>0?`{ ${ept(e.indexSignatures)} }`:"{}"},epn=efN("TypeLiteral"),epi=$L(PV(PW,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),eps={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},epa=e=>$2(e,e=>epu(e)?epa(e.types):[e]);class epo{types;annotations;static make=(e,t)=>epl(e)?new epo(e,t):1===e.length?e[0]:efz;static unify=(e,t)=>epo.make((e=>{let t=epi(e),r=[],n={},i=[];for(let e of t)switch(e._tag){case"NeverKeyword":break;case"AnyKeyword":return[efB];case"UnknownKeyword":return[efU];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":n[e._tag]||(n[e._tag]=e,r.push(e));break;case"Literal":{let t=typeof e.literal;switch(t){case"string":case"number":case"bigint":case"boolean":n[eps[t]]||i.includes(e.literal)||(i.push(e.literal),r.push(e));break;case"object":i.includes(e.literal)||(i.push(e.literal),r.push(e))}break}case"UniqueSymbol":n.SymbolKeyword||i.includes(e.symbol)||(i.push(e.symbol),r.push(e));break;case"TupleType":n.ObjectKeyword||r.push(e);break;case"TypeLiteral":0===e.propertySignatures.length&&0===e.indexSignatures.length?n["{}"]||(n["{}"]=e,r.push(e)):n.ObjectKeyword||r.push(e);break;default:r.push(e)}return r})(epa(e)),t);_tag="Union";constructor(e,t={}){this.types=e,this.annotations=t}toString(){return P0(epK(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(e=>e.toJSON()),annotations:ep$(this.annotations)}}}let epl=e=>e.length>1,epu=efN("Union"),epc=jL(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class eph{f;annotations;_tag="Suspend";constructor(e,t={}){this.f=e,this.annotations=t,this.f=ehE(e)}toString(){return epK(this).pipe(P1(()=>P9(P4(this.f)(),e=>epK(e))),P0(()=>"<suspended schema>"))}toJSON(){let e=this.f(),t=epc.get(e);return t||(epc.set(e,{_tag:this._tag}),t={_tag:this._tag,ast:e.toJSON(),annotations:ep$(this.annotations)},epc.set(e,t)),t}}class epf{from;filter;annotations;_tag="Refinement";constructor(e,t,r={}){this.from=e,this.filter=t,this.annotations=r}toString(){return efv(this).pipe(P0(()=>PX(epW(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:e=>epp(this.from)?String(this.from)+" & "+e:e})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:ep$(this.annotations)}}}let epp=efN("Refinement"),epd={};class epg{from;to;transformation;annotations;_tag="Transformation";constructor(e,t,r,n={}){this.from=e,this.to=t,this.transformation=r,this.annotations=n}toString(){return P0(epK(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:ep$(this.annotations)}}}let epm=efN("Transformation");class epb{decode;encode;_tag="FinalTransformation";constructor(e,t){this.decode=e,this.encode=t}}let epy=new class{_tag="ComposeTransformation"};class epv{from;to;decode;encode;constructor(e,t,r,n){this.from=e,this.to=t,this.decode=r,this.encode=n}}class epS{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(e){this.propertySignatureTransformations=e;const t={},r={};for(const n of e){const e=n.from;if(t[e])throw Error(ehz(e));t[e]=!0;const i=n.to;if(r[i])throw Error(ehz(i));r[i]=!0}}}let epx=(e,t)=>{let r=Object.getOwnPropertyDescriptors(e),n={...e.annotations};delete n[eh4];let i={...n,...t},s=efE(e);return D7(s)&&(i[efh]=epx(s.value,t)),r.annotations.value=i,Object.create(Object.getPrototypeOf(e),r)},ep_=(e,t)=>{switch(e._tag){case"Literal":return W1(String(e.literal));case"StringKeyword":return"[\\s\\S]*?";case"NumberKeyword":return"[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?";case"TemplateLiteral":return epk(e,t,!1);case"Union":return e.types.map(e=>ep_(e,t)).join("|")}},epw=(e,t,r,n)=>{if(epu(e)){if(r&&!n)return`(?:${t})`}else if(!r||!n)return t;return`(${t})`},epk=(e,t,r)=>{let n="";if(""!==e.head){let i=W1(e.head);n+=t&&r?`(${i})`:i}for(let i of e.spans){let e=ep_(i.type,t);if(n+=epw(i.type,e,t,r),""!==i.literal){let e=W1(i.literal);n+=t&&r?`(${e})`:e}}return n},epO=e=>RegExp(`^${epk(e,!1,!0)}$`),epE=e=>{switch(e._tag){case"TupleType":{let t=!1,r=[];for(let n of e.elements)n.isOptional&&(t=!0),r.push(n.type);return t&&r.push(ef$),r=r.concat(ef5(e.rest)),epo.make(r)}case"Refinement":return epE(e.from);case"Union":return epo.make(e.types.map(epE));case"Suspend":return epE(e.f())}throw Error(ehj(e))},epC=(e,t)=>{let r=$o(e.propertySignatures,e=>e.name===t);if(D7(r))return r.value;if(jU(t)){let r;for(let n of e.indexSignatures){let e=epz(n.parameter);switch(e._tag){case"TemplateLiteral":if(epO(e).test(t))return new ef8(t,n.type,!1,!0);break;case"StringKeyword":void 0===r&&(r=new ef8(t,n.type,!1,!0))}}if(r)return r}else if(jH(t)){for(let r of e.indexSignatures)if(efQ(epz(r.parameter)))return new ef8(t,r.type,!1,!0)}},epF=(e,t)=>{let r=efE(e);if(D7(r))return epF(r.value,t);switch(e._tag){case"TypeLiteral":{let r=epC(e,t);if(r)return r;break}case"Union":return new ef8(t,epo.make(e.types.map(e=>epF(e,t).type)),!1,!0);case"Suspend":return epF(e.f(),t);case"Refinement":return epF(e.from,t)}throw Error(ehj(e))},epI=(e,t)=>{let r=[],n=[],i=e=>{switch(e._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":n.push(new ef9(e,t,!0));break;case"Literal":if(jU(e.literal)||jB(e.literal))r.push(new ef8(e.literal,t,!1,!0));else{let t;throw Error((t=e.literal,ehM("Unsupported literal",`literal value: ${ehI(t)}`)))}break;case"Enums":for(let[n,i]of e.enums)r.push(new ef8(i,t,!1,!0));break;case"UniqueSymbol":r.push(new ef8(e.symbol,t,!1,!0));break;case"Union":e.types.forEach(i);break;default:throw Error(ehM("Unsupported key schema",void 0,void 0,e))}};return i(e),{propertySignatures:r,indexSignatures:n}},epT=e=>{switch(e._tag){case"TupleType":return!1===e.isReadonly?e:new ef4(e.elements,e.rest,!1,e.annotations);case"TypeLiteral":{let t=epA(e.propertySignatures,e=>!1===e.isReadonly?e:new ef8(e.name,e.type,e.isOptional,!1,e.annotations)),r=epA(e.indexSignatures,e=>!1===e.isReadonly?e:new ef9(e.parameter,e.type,!1));return t===e.propertySignatures&&r===e.indexSignatures?e:new epe(t,r,e.annotations)}case"Union":{let t=epA(e.types,epT);return t===e.types?e:epo.make(t,e.annotations)}case"Suspend":return new eph(()=>epT(e.f()),e.annotations);case"Refinement":{let t=epT(e.from);return t===e.from?e:new epf(t,e.filter,e.annotations)}case"Transformation":{let t=epT(e.from),r=epT(e.to);return t===e.from&&r===e.to?e:new epg(t,r,e.transformation,e.annotations)}}return e},epR=e=>t=>{let r;for(let n of e)Object.prototype.hasOwnProperty.call(t.annotations,n)&&(void 0===r&&(r={}),r[n]=t.annotations[n]);return r},epN=epR([eh9,efe,eft,efr,efn,efi]),epM=e=>{switch(e._tag){case"Declaration":{let t=epA(e.typeParameters,epM);return t===e.typeParameters?e:new efR(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{let t=epA(e.elements,e=>{let t=epM(e.type);return t===e.type?e:new ef3(t,e.isOptional)}),r=ef5(e.rest),n=epA(r,epM);return t===e.elements&&n===r?e:new ef4(t,n.map(e=>new ef2(e)),e.isReadonly,e.annotations)}case"TypeLiteral":{let t=epA(e.propertySignatures,e=>{let t=epM(e.type);return t===e.type?e:new ef8(e.name,t,e.isOptional,e.isReadonly)}),r=epA(e.indexSignatures,e=>{let t=epM(e.type);return t===e.type?e:new ef9(e.parameter,t,e.isReadonly)});return t===e.propertySignatures&&r===e.indexSignatures?e:new epe(t,r,e.annotations)}case"Union":{let t=epA(e.types,epM);return t===e.types?e:epo.make(t,e.annotations)}case"Suspend":return new eph(()=>epM(e.f()),e.annotations);case"Refinement":{let t=epM(e.from);return t===e.from?e:new epf(t,e.filter,e.annotations)}case"Transformation":{let t=epN(e);return epM(void 0!==t?epx(e.to,t):e.to)}}return e};function epA(e,t){let r=!1,n=Array(e.length);for(let i=0;i<e.length;i++){let s=e[i],a=t(s);a!==s&&(r=!0),n[i]=a}return r?n:e}let epj=e=>{switch(e._tag){case"Transformation":return e.from;case"Refinement":return epj(e.from);case"Suspend":return epj(e.f())}},epD=(e,t)=>{switch(e._tag){case"Declaration":{let r=epA(e.typeParameters,e=>epD(e,t));return r===e.typeParameters?e:new efR(r,e.decodeUnknown,e.encodeUnknown)}case"TupleType":{let r=epA(e.elements,e=>{let r=epD(e.type,t);return r===e.type?e:new ef3(r,e.isOptional)}),n=ef5(e.rest),i=epA(n,e=>epD(e,t));return r===e.elements&&i===n?e:new ef4(r,i.map(e=>new ef2(e)),e.isReadonly)}case"TypeLiteral":{let r=epA(e.propertySignatures,e=>{let r=epD(e.type,t);return r===e.type?e:new ef8(e.name,r,e.isOptional,e.isReadonly)}),n=epA(e.indexSignatures,e=>{let r=epD(e.type,t);return r===e.type?e:new ef9(e.parameter,r,e.isReadonly)});return r===e.propertySignatures&&n===e.indexSignatures?e:new epe(r,n)}case"Union":{let r=epA(e.types,e=>epD(e,t));return r===e.types?e:epo.make(r)}case"Suspend":{let r,n=P1(efT(e),()=>efv(e));if(D7(n)){let e=t?"Bound":"";r={[efI]:`${n.value}Encoded${e}`}}return new eph(()=>epD(e.f(),t),r)}case"Refinement":{let r=epD(e.from,t);if(!t)return r;if(r===e.from)return e;if(void 0===epj(e.from)&&efF(e))return new epf(r,e.filter,e.annotations);return r}case"Transformation":return epD(e.from,t)}return e},epP=e=>epD(e,!1),ep$=e=>{let t={};for(let r of Object.getOwnPropertySymbols(e))t[String(r)]=e[r];return t},epz=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return epz(e.from)}},epL=(e,t)=>{switch(e._tag){case"Literal":return efA(t)&&t.literal===e.literal;case"UniqueSymbol":return efP(t)&&t.symbol===e.symbol;case"UndefinedKeyword":case"VoidKeyword":case"NeverKeyword":case"UnknownKeyword":case"AnyKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":case"ObjectKeyword":return t._tag===e._tag;case"TemplateLiteral":return ef1(t)&&t.head===e.head&&epU(t.spans,e.spans);case"Enums":return efY(t)&&epB(t.enums,e.enums);case"Union":return epu(t)&&epq(e.types,t.types);case"Refinement":case"TupleType":case"TypeLiteral":case"Suspend":case"Transformation":case"Declaration":return e===t}},epU=zr((e,t)=>e.literal===t.literal&&epL(e.type,t.type)),epB=zr((e,t)=>t[0]===e[0]&&t[1]===e[1]),epq=zr(epL),epJ=(e,t)=>new epg(e,t,epy),epH=e=>P0(epK(e),()=>e._tag),epW=e=>efb(e).pipe(P1(()=>efS(e)),P1(()=>efy(e)),P7(t=>t+PX(efd(e),{onNone:()=>"",onSome:e=>e.map(e=>` & Brand<${ehI(e)}>`).join("")}))),epK=e=>P1(efv(e),()=>epW(e));class epV{path;actual;issue;_tag="Pointer";constructor(e,t,r){this.path=e,this.actual=t,this.issue=r}}class epG{actual;message;_tag="Unexpected";constructor(e,t){this.actual=e,this.message=t}}class epZ{ast;message;_tag="Missing";actual=void 0;constructor(e,t){this.ast=e,this.message=t}}class epQ{ast;actual;issues;output;_tag="Composite";constructor(e,t,r,n){this.ast=e,this.actual=t,this.issues=r,this.output=n}}class epY{ast;actual;kind;issue;_tag="Refinement";constructor(e,t,r,n){this.ast=e,this.actual=t,this.kind=r,this.issue=n}}class epX{ast;actual;kind;issue;_tag="Transformation";constructor(e,t,r,n){this.ast=e,this.actual=t,this.kind=r,this.issue=n}}class ep0{ast;actual;message;_tag="Type";constructor(e,t,r){this.ast=e,this.actual=t,this.message=r}}class ep1{ast;actual;message;_tag="Forbidden";constructor(e,t,r){this.ast=e,this.actual=t,this.message=r}}let ep2=Symbol.for("effect/Schema/ParseErrorTypeId");class ep3 extends etO("ParseError"){[ep2]=ep2;get message(){return this.toString()}toString(){return edS.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[Dy](){return this.toJSON()}}let ep5=e=>new ep3({issue:e}),ep4=PA,ep6=Pj,ep8=jN(2,(e,t)=>PT(e)?Pz(e,{onLeft:PM,onRight:t}):JU(e,t)),ep7=jN(2,(e,t)=>PT(e)?P$(e,t):JX(e,t)),ep9=jN(2,(e,t)=>PT(e)?PP(e,t):J1(e,t)),ede=jN(2,(e,t)=>PT(e)?PD(e,{onLeft:t.onFailure,onRight:t.onSuccess}):J0(e,t)),edt=jN(2,(e,t)=>PT(e)?Pz(e,{onLeft:t,onRight:PA}):JF(e,t)),edr=(e,t)=>void 0===t||jB(t)?e:void 0===e?t:{...e,...t},edn=(e,t,r)=>{let n=edu(e,t);return(e,t)=>n(e,{...edr(r,t),isEffectAllowed:!0})},edi=(e,t)=>edn(e.ast,!0,t),eds=(e,t)=>edn(e.ast,!1,t),eda=(e,t)=>{var r;let n,i;return r=epM(e.ast),n=edu(r,!0),i=(e,r)=>n(e,edr(t,r)),(e,t)=>PU(i(e,t),ep5)},edo=jL(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),edl=jL(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),edu=(e,t)=>{let r=t?edo:edl,n=r.get(e);if(n)return n;let i=edc(e,t),s=efk(e),a=D7(s)?(e,t)=>i(e,edr(t,s.value)):i,o=efO(e),l=t&&D7(o)?(t,r)=>edg(edt(a(t,r),o.value),e,t,r):a;return r.set(e,l),l},edc=(e,t)=>{switch(e._tag){case"Refinement":if(t){let t=edu(e.from,!0);return(r,n)=>{n=n??epd;let i=n?.errors==="all";return edg(ep8(edt(t(r,n),t=>{let s=new epY(e,r,"From",t);return i&&efF(e)&&edE(t)?PX(e.filter(r,n,e),{onNone:()=>PM(s),onSome:t=>PM(new epQ(e,r,[s,new epY(e,r,"Predicate",t)]))}):PM(s)}),t=>PX(e.filter(t,n,e),{onNone:()=>PA(t),onSome:t=>PM(new epY(e,r,"Predicate",t))})),e,r,n)}}{let t=edu(epM(e),!0),r=edu(edd(e.from),!1);return(n,i)=>edg(ep8(t(n,i),e=>r(e,i)),e,n,i)}case"Transformation":{let r=edy(e.transformation,t),n=t?edu(e.from,!0):edu(e.to,!1),i=t?edu(e.to,!0):edu(e.from,!1);return(s,a)=>edg(ep8(ep9(n(s,a),r=>new epX(e,s,t?"Encoded":"Type",r)),n=>ep8(ep9(r(n,a??epd,e,s),t=>new epX(e,s,"Transformation",t)),r=>ep9(i(r,a),r=>new epX(e,s,t?"Type":"Encoded",r)))),e,s,a)}case"Declaration":{let r=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(t,n)=>edg(r(t,n??epd,e),e,t,n)}case"Literal":return edh(e,t=>t===e.literal);case"UniqueSymbol":return edh(e,t=>t===e.symbol);case"UndefinedKeyword":return edh(e,jW);case"NeverKeyword":return edh(e,jK);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return PA;case"StringKeyword":return edh(e,jU);case"NumberKeyword":return edh(e,jB);case"BooleanKeyword":return edh(e,jq);case"BigIntKeyword":return edh(e,jJ);case"SymbolKeyword":return edh(e,jH);case"ObjectKeyword":return edh(e,jG);case"Enums":return edh(e,t=>e.enums.some(([e,r])=>r===t));case"TemplateLiteral":{let t=epO(e);return edh(e,e=>jU(e)&&t.test(e))}case"TupleType":{let r=e.elements.map(e=>edu(e.type,t)),n=e.rest.map(e=>edu(e.type,t)),i=e.elements.filter(e=>!e.isOptional);e.rest.length>0&&(i=i.concat(e.rest.slice(1)));let s=i.length,a=e.elements.length>0?e.elements.map((e,t)=>t).join(" | "):"never",o=P5(efx(e)),l=P5(ef_(e));return(t,u)=>{let c;if(!$O(t))return PM(new ep0(e,t));let h=u?.errors==="all",f=[],p=0,d=[],g=t.length;for(let r=g;r<=s-1;r++){let n=new epV(r,t,new epZ(i[r-g]));if(!h)return PM(new epQ(e,t,n,d));f.push([p++,n])}if(0===e.rest.length)for(let r=e.elements.length;r<=g-1;r++){let n=new epV(r,t,new epG(t[r],`is unexpected, expected: ${a}`));if(!h)return PM(new epQ(e,t,n,d));f.push([p++,n])}let m=0;for(;m<r.length;m++)if(g<m+1){if(e.elements[m].isOptional)continue}else{let n=(0,r[m])(t[m],u);if(PT(n)){if(PR(n)){let r=new epV(m,t,n.left);if(!h)return PM(new epQ(e,t,r,edb(d)));f.push([p++,r]);continue}d.push([p++,n.right])}else{let r=p++,i=m;c||(c=[]),c.push(({es:s,output:a})=>JU(JA(n),n=>{if(PR(n)){let o=new epV(i,t,n.left);return h?(s.push([r,o]),Hs):PM(new epQ(e,t,o,edb(a)))}return a.push([r,n.right]),Hs}))}}if($E(n)){let[r,...i]=n;for(;m<g-i.length;m++){let n=r(t[m],u);if(PT(n))if(PR(n)){let r=new epV(m,t,n.left);if(!h)return PM(new epQ(e,t,r,edb(d)));f.push([p++,r]);continue}else d.push([p++,n.right]);else{let r=p++,i=m;c||(c=[]),c.push(({es:s,output:a})=>JU(JA(n),n=>{if(!PR(n))return a.push([r,n.right]),Hs;{let o=new epV(i,t,n.left);return h?(s.push([r,o]),Hs):PM(new epQ(e,t,o,edb(a)))}}))}}for(let r=0;r<i.length;r++)if(!(g<(m+=r)+1)){let n=i[r](t[m],u);if(PT(n)){if(PR(n)){let r=new epV(m,t,n.left);if(!h)return PM(new epQ(e,t,r,edb(d)));f.push([p++,r]);continue}d.push([p++,n.right])}else{let r=p++,i=m;c||(c=[]),c.push(({es:s,output:a})=>JU(JA(n),n=>{if(PR(n)){let o=new epV(i,t,n.left);return h?(s.push([r,o]),Hs):PM(new epQ(e,t,o,edb(a)))}return a.push([r,n.right]),Hs}))}}}let b=({es:r,output:n})=>PJ(r)?PM(new epQ(e,t,edb(r),edb(n))):PA(edb(n));if(c&&c.length>0){let e=c;return J9(()=>{let t={es:$V(f),output:$V(d)};return JU(XS(e,e=>e(t),{concurrency:o,batching:l,discard:!0}),()=>b(t))})}return b({output:d,es:f})}}case"TypeLiteral":{if(0===e.propertySignatures.length&&0===e.indexSignatures.length)return edh(e,jY);let r=[],n={},i=[];for(let s of e.propertySignatures)r.push([edu(s.type,t),s]),n[s.name]=null,i.push(s.name);let s=e.indexSignatures.map(e=>[edu(e.parameter,t),edu(e.type,t),e.parameter]),a=epo.make(e.indexSignatures.map(e=>e.parameter).concat(i.map(e=>jH(e)?new efD(e):new efM(e)))),o=edu(a,t),l=P5(efx(e)),u=P5(ef_(e));return(t,c)=>{let h,f,p;if(!(jV(p=t)&&!Array.isArray(p)))return PM(new ep0(e,t));let d=c?.errors==="all",g=[],m=0,b=c?.onExcessProperty==="error",y=c?.onExcessProperty==="preserve",v={};if(b||y)for(let r of h=Reflect.ownKeys(t)){let n=o(r,c);if(PT(n)&&PR(n))if(b){let n=new epV(r,t,new epG(t[r],`is unexpected, expected: ${String(a)}`));if(!d)return PM(new epQ(e,t,n,v));g.push([m++,n]);continue}else v[r]=t[r]}let S=c?.exact===!0;for(let n=0;n<r.length;n++){let i=r[n][1],s=i.name,a=Object.prototype.hasOwnProperty.call(t,s);if(!a){if(i.isOptional)continue;else if(S){let r=new epV(s,t,new epZ(i));if(!d)return PM(new epQ(e,t,r,v));g.push([m++,r]);continue}}let o=(0,r[n][0])(t[s],c);if(PT(o)){if(PR(o)){let r=new epV(s,t,a?o.left:new epZ(i));if(!d)return PM(new epQ(e,t,r,v));g.push([m++,r]);continue}v[s]=o.right}else{let r=m++;f||(f=[]),f.push(({es:n,output:l})=>JU(JA(o),o=>{if(PR(o)){let u=new epV(s,t,a?o.left:new epZ(i));return d?(n.push([r,u]),Hs):PM(new epQ(e,t,u,l))}return l[s]=o.right,Hs}))}}for(let r=0;r<s.length;r++){let i=s[r],a=i[0],o=i[1];for(let r of ehO(t,i[2])){let i=a(r,c);if(PT(i)&&PN(i)){let i=o(t[r],c);if(PT(i))if(PR(i)){let n=new epV(r,t,i.left);if(!d)return PM(new epQ(e,t,n,v));g.push([m++,n]);continue}else Object.prototype.hasOwnProperty.call(n,r)||(v[r]=i.right);else{let s=m++,a=r;f||(f=[]),f.push(({es:o,output:l})=>JU(JA(i),i=>{if(!PR(i))return Object.prototype.hasOwnProperty.call(n,r)||(l[r]=i.right),Hs;{let r=new epV(a,t,i.left);return d?(o.push([s,r]),Hs):PM(new epQ(e,t,r,l))}}))}}}}let x=({es:r,output:n})=>{if(PJ(r))return PM(new epQ(e,t,edb(r),n));if(c?.propertyOrder==="original"){let e=h||Reflect.ownKeys(t);for(let t of i)-1===e.indexOf(t)&&e.push(t);let r={};for(let t of e)Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t]);return PA(r)}return PA(n)};if(f&&f.length>0){let e=f;return J9(()=>{let t={es:$V(g),output:Object.assign({},v)};return JU(XS(e,e=>e(t),{concurrency:l,batching:u,discard:!0}),()=>x(t))})}return x({es:g,output:v})}}case"Union":{let r=edp(e.types,t),n=Reflect.ownKeys(r.keys),i=n.length,s=e.types.length,a=new Map;for(let r=0;r<s;r++)a.set(e.types[r],edu(e.types[r],t));let o=P5(efx(e))??1,l=P5(ef_(e));return(t,u)=>{let c,h=[],f=0,p=[];if(i>0)if(jV(t))for(let e=0;e<i;e++){let i=n[e],a=r.keys[i].buckets;if(Object.prototype.hasOwnProperty.call(t,i)){let e=String(t[i]);if(Object.prototype.hasOwnProperty.call(a,e))p=p.concat(a[e]);else{let{candidates:e,literals:n}=r.keys[i],a=epo.make(n),o=e.length===s?new epe([new ef8(i,a,!1,!0)],[]):epo.make(e);h.push([f++,new epQ(o,t,new epV(i,t,new ep0(a,t[i])))])}}else{let{candidates:e,literals:n}=r.keys[i],a=new ef8(i,epo.make(n),!1,!0),o=e.length===s?new epe([a],[]):epo.make(e);h.push([f++,new epQ(o,t,new epV(i,t,new epZ(a)))])}}else{let n=r.candidates.length===s?e:epo.make(r.candidates);h.push([f++,new ep0(n,t)])}r.otherwise.length>0&&(p=p.concat(r.otherwise));for(let e=0;e<p.length;e++){let r=p[e],n=a.get(r)(t,u);if(PT(n)&&(!c||0===c.length))if(PN(n))return n;else h.push([f++,n.left]);else{let e=f++;c||(c=[]),c.push(t=>J9(()=>"finalResult"in t?Hs:JU(JA(n),r=>(PN(r)?t.finalResult=r:t.es.push([e,r.left]),Hs))))}}let d=r=>PJ(r)?1===r.length&&"Type"===r[0][1]._tag?PM(r[0][1]):PM(new epQ(e,t,edb(r))):PM(new ep0(e,t));if(c&&c.length>0){let e=c;return J9(()=>{let t={es:$V(h)};return JU(XS(e,e=>e(t),{concurrency:o,batching:l,discard:!0}),()=>"finalResult"in t?t.finalResult:d(t.es))})}return d(h)}}case"Suspend":{let r=ehE(()=>edu(e.f(),t));return(e,t)=>r()(e,t)}}},edh=(e,t)=>r=>t(r)?PA(r):PM(new ep0(e,r)),edf=(e,t)=>{switch(e._tag){case"Declaration":{let r=efE(e);if(D7(r))return edf(r.value,t);break}case"TypeLiteral":{let r=[];for(let n=0;n<e.propertySignatures.length;n++){let i=e.propertySignatures[n],s=t?epP(i.type):epM(i.type);efA(s)&&!i.isOptional&&r.push([i.name,s])}return r}case"TupleType":{let r=[];for(let n=0;n<e.elements.length;n++){let i=e.elements[n],s=t?epP(i.type):epM(i.type);efA(s)&&!i.isOptional&&r.push([n,s])}return r}case"Refinement":return edf(e.from,t);case"Suspend":return edf(e.f(),t);case"Transformation":return edf(t?e.from:e.to,t)}return[]},edp=(e,t)=>{let r={},n=[],i=[];for(let s=0;s<e.length;s++){let a=e[s],o=edf(a,t);if(o.length>0){i.push(a);for(let e=0;e<o.length;e++){let[t,n]=o[e],i=String(n.literal);r[t]=r[t]||{buckets:{},literals:[],candidates:[]};let s=r[t].buckets;if(Object.prototype.hasOwnProperty.call(s,i)){if(e<o.length-1)continue;s[i].push(a),r[t].literals.push(n),r[t].candidates.push(a)}else{s[i]=[a],r[t].literals.push(n),r[t].candidates.push(a);break}}}else n.push(a)}return{keys:r,otherwise:n,candidates:i}},edd=e=>epp(e)?edd(e.from):e,edg=(e,t,r,n)=>{if(n?.isEffectAllowed===!0||PT(e))return e;let i=new G2,s=eeQ(e,{scheduler:i});i.flush();let a=s.unsafePoll();if(a){if(Wp(a))return PA(a.value);let e=a.cause;return e._tag===LW?PM(e.error):PM(new ep1(t,r,Uy(e)))}return PM(new ep1(t,r,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},edm=([e],[t])=>e>t?1:e<t?-1:0;function edb(e){return e.sort(edm).map(e=>e[1])}let edy=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return PA;case"TypeLiteralTransformation":return r=>{let n=PA(r);for(let r of e.propertySignatureTransformations){let[e,i]=t?[r.from,r.to]:[r.to,r.from],s=t?r.decode:r.encode;n=ep7(n,t=>{let r=s(Object.prototype.hasOwnProperty.call(t,e)?Pe(t[e]):PY());return delete t[e],D7(r)&&(t[i]=r.value),t})}return n}}},edv=(e,t=[])=>({value:e,forest:t}),edS={formatIssue:e=>ep7(edA(e),edx),formatIssueSync:e=>{let t=edS.formatIssue(e);return PT(t)?PB(t):eeX(t)},formatError:e=>edS.formatIssue(e.issue),formatErrorSync:e=>edS.formatIssueSync(e.issue)},edx=e=>e.value+ed_("\n",e.forest),ed_=(e,t)=>{let r,n="",i=t.length;for(let s=0;s<i;s++){r=t[s];let a=s===i-1;n+=e+(a?"└":"├")+"─ "+r.value,n+=ed_(e+(i>1&&!a?"│  ":"   "),r.forest)}return n},edw=e=>"ast"in e?Pe(e.ast):PY(),edk=PA(void 0),edO=e=>t=>t._tag===e,edE=edO("Composite"),edC=edO("Refinement"),edF=edO("Transformation"),edI=e=>ep8(edw(e).pipe(P9(efg),PX({onNone:()=>edk,onSome:t=>{let r=t(e);return jU(r)?PA({message:r,override:!1}):Jy(r)?JX(r,e=>({message:e,override:!1})):jU(r.message)?PA({message:r.message,override:r.override}):JX(r.message,e=>({message:e,override:r.override}))}})),t=>void 0!==t?!t.override&&(edE(e)||edC(e)&&"From"===e.kind||edF(e)&&"Transformation"!==e.kind)?edF(e)||edC(e)?edI(e.issue):edk:PA(t.message):edk),edT=e=>edw(e).pipe(P9(efw),$e(t=>t(e)),P5),edR=e=>ep7(edI(e),t=>t??edT(e)??function(e){var t;if(void 0!==e.message)return e.message;let r=epp(e.ast)?efS(t=e.ast).pipe(P1(()=>efb(t)),P1(()=>efy(t)),P1(()=>efv(t)),P0(()=>`{ ${t.from} | filter }`)):String(e.ast);return`Expected ${r}, actual ${ehI(e.actual)}`}(e)),edN=e=>edT(e)??String(e.ast),edM=e=>{let t=efm(e.ast);if(D7(t)){let e=t.value();return jU(e)?PA(e):e}return PA(e.message??"is missing")},edA=e=>{switch(e._tag){case"Type":return ep7(edR(e),edv);case"Forbidden":return PA(edv(edN(e),[edv(e.message??"is forbidden")]));case"Unexpected":return PA(edv(e.message??"is unexpected"));case"Missing":return ep7(edM(e),edv);case"Transformation":return ep8(edI(e),t=>void 0!==t?PA(edv(t)):ep7(edA(e.issue),t=>edv(edN(e),[edv((e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}})(e.kind),[t])])));case"Refinement":return ep8(edI(e),t=>void 0!==t?PA(edv(t)):ep7(edA(e.issue),t=>edv(edN(e),[edv((e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}})(e.kind),[t])])));case"Pointer":return ep7(edA(e.issue),t=>edv(ehN(e.path),[t]));case"Composite":return ep8(edI(e),t=>{if(void 0!==t)return PA(edv(t));let r=edN(e);return Array.isArray(e.issues)?ep7(XS(e.issues,edA),e=>edv(r,e)):ep7(edA(e.issues),e=>edv(r,[e]))})}},edj=e=>{let t=Object.create(ehu);return eho.set(t,e),t},edD=jN(e=>jG(e[0]),(e,...t)=>{let r={};for(let n of t)n in e&&(r[n]=e[n]);return r}),edP=jN(e=>jG(e[0]),(e,...t)=>{let r={...e};for(let e of t)delete r[e];return r}),ed$=Symbol.for("effect/Schema");function edz(e){return class{[ed$]=edL;static ast=e;static annotations(e){return edz(edq(this.ast,e))}static pipe(){return DF(this,arguments)}static toString(){return String(e)}static Type;static Encoded;static Context;static [ed$]=edL}}let edL={_A:e=>e,_I:e=>e,_R:e=>e},edU={schemaId:eh2,message:eh3,missingMessage:eh5,identifier:eh4,title:eh6,description:eh7,examples:eh9,default:efe,documentation:efs,jsonSchema:eft,arbitrary:efr,pretty:efn,equivalence:efi,concurrency:efa,batching:efo,parseIssueTitle:efl,parseOptions:efu,decodingFallback:efc},edB=e=>{if(!e)return{};let t={...e};for(let r in edU)r in e&&(t[edU[r]]=e[r],delete t[r]);return t},edq=(e,t)=>epx(e,edB(t)),edJ=e=>edz(epM(e.ast)),edH=(e,t)=>{let r=edi(e,t);return(e,t)=>ep9(r(e,t),ep5)},edW=e=>jZ(e,ed$)&&jG(e[ed$]);function edK(...e){return $E(e)?function e(t,r=function(e){let t;return epl(e)?epo.make((t=e=>new efM(e),e.map(t))):new efM(e[0])}(t)){return class extends edz(r){static annotations(t){return e(this.literals,edq(this.ast,t))}static literals=[...t]}}(e):edX}function edV(e,t){return class extends edz(t){static annotations(e){return edV(this.typeParameters,edq(this.ast,e))}static typeParameters=[...e]}}let edG=function(){let e;if(Array.isArray(arguments[0])){let e=arguments[0],t=arguments[1],r=arguments[2];return edV(e,new efR(e.map(e=>e.ast),(...e)=>t.decode(...e.map(edz)),(...e)=>t.encode(...e.map(edz)),edB(r)))}let t=arguments[0],r=arguments[1];return edV([],new efR([],e=()=>(e,r,n)=>t(e)?ep4(e):PM(new ep0(n,e)),e,edB(r)))},edZ=Symbol.for("effect/SchemaId/InstanceOf"),edQ=(e,t)=>edG(t=>t instanceof e,{title:e.name,description:`an instance of ${e.name}`,pretty:()=>String,schemaId:edZ,[edZ]:{constructor:e},...t});class edY extends edz(ef$){}class edX extends edz(efz){}class ed0 extends edz(efU){}class ed1 extends edz(efG){}class ed2 extends edz(efZ){}class ed3 extends edz(efq){}class ed5 extends edz(efH){}function ed4(...e){return epl(e)?function e(t,r=(e=>epo.make(e.map(e=>e.ast)))(t)){return class extends edz(r){static annotations(t){return e(this.members,edq(this.ast,t))}static members=[...t]}}(e):$E(e)?e[0]:edX}let ed6=e=>new ed8(new ef3(e.ast,!1),e);class ed8{ast;from;[ed$];_Token;constructor(e,t){this.ast=e,this.from=t}annotations(e){return new ed8(new ef3(this.ast.type,this.ast.isOptional,{...this.ast.annotations,...edB(e)}),this.from)}toString(){return`${this.ast.type}${this.ast.isOptional?"?":""}`}}function ed7(e,t,r=((e,t)=>new ef4(e.map(e=>edW(e)?new ef3(e.ast,!1):e.ast),t.map(e=>edW(e)?new ef2(e.ast):e.ast),!0))(e,t)){return class extends edz(r){static annotations(e){return ed7(this.elements,this.rest,edq(this.ast,e))}static elements=[...e];static rest=[...t]}}function ed9(...e){return Array.isArray(e[0])?ed7(e[0],e.slice(1)):ed7(e,[])}let ege=e=>e?'"?:"':'":"';class egt extends ef3{isReadonly;defaultValue;_tag="PropertySignatureDeclaration";constructor(e,t,r,n,i){super(e,t,n),this.isReadonly=r,this.defaultValue=i}toString(){let e=ege(this.isOptional),t=String(this.type);return`PropertySignature<${e}, ${t}, never, ${e}, ${t}>`}}class egr extends ef3{isReadonly;fromKey;constructor(e,t,r,n,i){super(e,t,n),this.isReadonly=r,this.fromKey=i}}class egn extends ef3{isReadonly;defaultValue;constructor(e,t,r,n,i){super(e,t,n),this.isReadonly=r,this.defaultValue=i}}class egi{from;to;decode;encode;_tag="PropertySignatureTransformation";constructor(e,t,r,n){this.from=e,this.to=t,this.decode=r,this.encode=n}toString(){var e;return`PropertySignature<${ege(this.to.isOptional)}, ${this.to.type}, ${void 0===(e=this.from.fromKey)?"never":jU(e)?JSON.stringify(e):String(e)}, ${ege(this.from.isOptional)}, ${this.from.type}>`}}let egs=(e,t)=>{switch(e._tag){case"PropertySignatureDeclaration":return new egt(e.type,e.isOptional,e.isReadonly,{...e.annotations,...t},e.defaultValue);case"PropertySignatureTransformation":return new egi(e.from,new egn(e.to.type,e.to.isOptional,e.to.isReadonly,{...e.to.annotations,...t},e.to.defaultValue),e.decode,e.encode)}},ega=Symbol.for("effect/PropertySignature"),ego=e=>jZ(e,ega);class egl{ast;[ed$];[ega]=null;_TypeToken;_Key;_EncodedToken;_HasDefault;constructor(e){this.ast=e}pipe(){return DF(this,arguments)}annotations(e){return new egl(egs(this.ast,edB(e)))}toString(){return String(this.ast)}}let egu=e=>new egl(e);class egc extends egl{from;constructor(e,t){super(e),this.from=t}annotations(e){return new egc(egs(this.ast,edB(e)),this.from)}}let egh=e=>new egc(new egt(e.ast,!1,!0,{},void 0),e),egf=jN(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":return egu(new egt(r.type,r.isOptional,r.isReadonly,r.annotations,t));case"PropertySignatureTransformation":return egu(new egi(r.from,new egn(r.to.type,r.to.isOptional,r.to.isReadonly,r.to.annotations,t),r.decode,r.encode))}}),egp=(e,t)=>PX(e,{onNone:()=>Pe(t()),onSome:e=>Pe(void 0===e?t():e)}),egd=e=>((e,t,r)=>{switch(e._tag){case"UndefinedKeyword":return efz;case"Union":{let r=[],n=!1;for(let i of e.types){let e=t(i);e?(n=!0,efL(e)||r.push(e)):r.push(i)}if(n)return epo.make(r);break}case"Suspend":return t(e.f());case"Transformation":return r(e)}})(e,egd,e=>{let t=egd(e.to);if(t)return new epg(e.from,t,e.transformation)}),egg=((e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":{let e=epM(r.type);return egu(new egi(new egr(r.type,r.isOptional,r.isReadonly,r.annotations),new egn(egd(e)??e,!1,!0,{},r.defaultValue),e=>egp(e,t),jM))}case"PropertySignatureTransformation":{let e=r.to.type;return egu(new egi(r.from,new egn(egd(e)??e,!1,r.to.isReadonly,r.to.annotations,r.to.defaultValue),e=>egp(r.decode(e),t),r.encode))}}},e=>new egc(new egt(e.ast===ef$||e.ast===efz?ef$:ed4(e,edY).ast,!0,!0,{},void 0),e)),egm=epR([eh5]),egb=(e,t)=>{for(let r of Reflect.ownKeys(e)){let n=e[r];if(void 0===t[r]&&ego(n)){let e=n.ast,i="PropertySignatureDeclaration"===e._tag?e.defaultValue:e.to.defaultValue;void 0!==i&&(t[r]=i())}}return t};function egy(e,...t){return function e(t,r,n=((e,t)=>{let r=Reflect.ownKeys(e),n=[];if(r.length>0){let i=[],s=[],a=[];for(let t=0;t<r.length;t++){let o=r[t],l=e[o];if(ego(l)){let e=l.ast;switch(e._tag){case"PropertySignatureDeclaration":{let t=e.type,r=e.isOptional,a=e.annotations;i.push(new ef8(o,t,r,!0,egm(e))),s.push(new ef8(o,epM(t),r,!0,a)),n.push(new ef8(o,t,r,!0,a));break}case"PropertySignatureTransformation":{let t=e.from.fromKey??o;i.push(new ef8(t,e.from.type,e.from.isOptional,!0,e.from.annotations)),s.push(new ef8(o,e.to.type,e.to.isOptional,!0,e.to.annotations)),a.push(new epv(t,o,e.decode,e.encode))}}}else i.push(new ef8(o,l.ast,!1,!0)),s.push(new ef8(o,epM(l.ast),!1,!0)),n.push(new ef8(o,l.ast,!1,!0))}if($E(a)){let e=[],r=[];for(let n of t){let{indexSignatures:t,propertySignatures:a}=epI(n.key.ast,n.value.ast);a.forEach(e=>{i.push(e),s.push(new ef8(e.name,epM(e.type),e.isOptional,e.isReadonly,e.annotations))}),t.forEach(t=>{e.push(t),r.push(new ef9(t.parameter,epM(t.type),t.isReadonly))})}return new epg(new epe(i,e,{[eh8]:"Struct (Encoded side)"}),new epe(s,r,{[eh8]:"Struct (Type side)"}),new epS(a))}}let i=[];for(let e of t){let{indexSignatures:t,propertySignatures:r}=epI(e.key.ast,e.value.ast);r.forEach(e=>n.push(e)),t.forEach(e=>i.push(e))}return new epe(n,i)})(t,r)){return class extends edz(n){static annotations(t){return e(this.fields,this.records,edq(this.ast,t))}static fields={...t};static records=[...r];static make=(e,r)=>{let n=egb(t,{...e});return emc(r)?n:eda(this)(n)};static pick(...e){return egy(edD(t,...e))}static omit(...e){return egy(edP(t,...e))}}}(e,t)}let egv=(e,t)=>egy({_tag:edK(e).pipe(egh,egf(()=>e)),...t}),egS=(e,t,r)=>{if(epn(e)&&epn(t)){let n=[...e.propertySignatures];for(let e of t.propertySignatures){let t=e.name,i=n.findIndex(e=>e.name===t);if(-1===i)n.push(e);else{let{isOptional:s,type:a}=n[i];n[i]=new ef8(t,egw(a,e.type,r.concat(t)),s,!0)}}return new epe(n,e.indexSignatures.concat(t.indexSignatures))}throw Error(ehA(e,t,r))},egx=(A=[eh4],e=>{let t={...e.annotations};for(let e of A)delete t[e];return t}),eg_=(e,t)=>t.map(t=>new epf(t,e.filter,egx(e))),egw=(e,t,r)=>epo.make(egO([e],[t],r)),egk=e=>epu(e)?e.types:[e],egO=(e,t,r)=>$2(e,e=>$2(t,t=>{switch(t._tag){case"Literal":if(jU(t.literal)&&efJ(e)||jB(t.literal)&&efW(e)||jq(t.literal)&&efV(e))return[t];break;case"StringKeyword":if(t===efq){if(efJ(e)||efA(e)&&jU(e.literal))return[e];else if(epp(e))return eg_(e,egO(egk(e.from),[t],r))}else if(e===efq)return[t];break;case"NumberKeyword":if(t===efH){if(efW(e)||efA(e)&&jB(e.literal))return[e];else if(epp(e))return eg_(e,egO(egk(e.from),[t],r))}else if(e===efH)return[t];break;case"BooleanKeyword":if(t===efK){if(efV(e)||efA(e)&&jq(e.literal))return[e];else if(epp(e))return eg_(e,egO(egk(e.from),[t],r))}else if(e===efK)return[t];break;case"Union":return egO(egk(e),t.types,r);case"Suspend":return[new eph(()=>egw(e,t.f(),r))];case"Refinement":return eg_(t,egO(egk(e),egk(t.from),r));case"TypeLiteral":switch(e._tag){case"Union":return egO(e.types,[t],r);case"Suspend":return[new eph(()=>egw(e.f(),t,r))];case"Refinement":return eg_(e,egO(egk(e.from),[t],r));case"TypeLiteral":return[egS(e,t,r)];case"Transformation":{let n=e.transformation,i=egS(e.from,t,r),s=egS(e.to,epM(t),r);switch(n._tag){case"TypeLiteralTransformation":return[new epg(i,s,new epS(n.propertySignatureTransformations))];case"ComposeTransformation":return[new epg(i,s,epy)];case"FinalTransformation":return[new epg(i,s,new epb((e,t,r,i)=>ep7(n.decode(e,t,r,i),t=>({...e,...t})),(e,t,r,i)=>ep7(n.encode(e,t,r,i),t=>({...e,...t}))))]}}}break;case"Transformation":if(!epm(e))return egO([t],[e],r);if("TypeLiteralTransformation"===t.transformation._tag&&"TypeLiteralTransformation"===e.transformation._tag)return[new epg(egS(e.from,t.from,r),egS(e.to,t.to,r),new epS(t.transformation.propertySignatureTransformations.concat(e.transformation.propertySignatureTransformations)))]}throw Error(ehA(e,t,r))})),egE=jN(2,(e,t)=>edz(egw(e.ast,t.ast,[]))),egC=((e=>edW(e[1]),(e,t)=>egR(e,t,epJ(e.ast,t.ast))),e=>edz(new eph(()=>e().ast))),egF=Symbol.for("effect/SchemaId/Refine"),egI=(e,t,r)=>{if(jq(e))return e?PY():Pe(new ep0(t,r));if(jU(e))return Pe(new ep0(t,r,e));if(void 0!==e){if("_tag"in e)return Pe(e);let n=new ep0(t,r,e.message);return Pe($E(e.path)?new epV(e.path,r,n):n)}return PY()};function egT(e,t){return r=>{function n(t,r,n){var i=e(t,r,n),s=n,a=t;if(!Array.isArray(i))return egI(i,s,a);if($E(i)){let e=$5(i,e=>egI(e,s,a));if($E(e))return Pe(1===e.length?e[0]:new epQ(s,a,e))}return PY()}let i=new epf(r.ast,n,edB(t));return function e(t,r,n){return class extends edz(n){static annotations(t){return e(this.from,this.filter,edq(this.ast,t))}static [egF]=t;static from=t;static filter=r;static make=(e,t)=>emc(t)?e:eda(this)(e)}}(r,n,i)}}function egR(e,t,r){return class extends edz(r){static annotations(e){return egR(this.from,this.to,edq(this.ast,e))}static from=e;static to=t}}let egN=jN(e=>edW(e[0])&&edW(e[1]),(e,t,r)=>egR(e,t,new epg(e.ast,t.ast,new epb(r.decode,r.encode)))),egM=jN(e=>edW(e[0])&&edW(e[1]),(e,t,r)=>egN(e,t,{strict:!0,decode:(e,t,n,i)=>ep4(r.decode(e,i)),encode:(e,t,n,i)=>ep4(r.encode(e,i))})),egA=Symbol.for("effect/SchemaId/Trimmed"),egj=e=>t=>t.pipe(egT(e=>e===e.trim(),{schemaId:egA,title:"trimmed",description:"a string with no leading or trailing whitespace",jsonSchema:{pattern:"^\\S[\\s\\S]*\\S$|^\\S$|^$"},...e})),egD=Symbol.for("effect/SchemaId/Pattern"),egP=Symbol.for("effect/SchemaId/Lowercased"),eg$=e=>t=>t.pipe(egT(e=>e===e.toLowerCase(),{schemaId:egP,title:"lowercased",description:"a lowercase string",jsonSchema:{pattern:"^[^A-Z]*$"},...e})),egz=Symbol.for("effect/SchemaId/Uppercased"),egL=e=>t=>t.pipe(egT(e=>e===e.toUpperCase(),{schemaId:egz,title:"uppercased",description:"an uppercase string",jsonSchema:{pattern:"^[^a-z]*$"},...e})),egU=Symbol.for("effect/SchemaId/Capitalized"),egB=e=>t=>t.pipe(egT(e=>e[0]?.toUpperCase()===e[0],{schemaId:egU,title:"capitalized",description:"a capitalized string",jsonSchema:{pattern:"^[^a-z]?.*$"},...e})),egq=Symbol.for("effect/SchemaId/Uncapitalized"),egJ=e=>t=>t.pipe(egT(e=>e[0]?.toLowerCase()===e[0],{schemaId:egq,title:"uncapitalized",description:"a uncapitalized string",jsonSchema:{pattern:"^[^A-Z]?.*$"},...e})),egH=e=>{let t;return t={title:"nonEmptyString",description:"a non empty string",...e},e=>e.pipe(egT(e=>e.length>=1,{schemaId:ehX,title:"minLength(1)",description:"a string at least 1 character(s) long",jsonSchema:{minLength:1},...t}))};class egW extends ed3.pipe(egj({identifier:"Trimmed"})){}/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.source,URL;let egK=e=>t=>t.pipe(egT(e=>Number.isSafeInteger(e),{schemaId:ehW,title:"int",description:"an integer",jsonSchema:{type:"integer"},...e})),egV=(e,t,r)=>n=>n.pipe(egT(r=>r>=e&&r<=t,{schemaId:ehZ,title:`between(${e}, ${t})`,description:`a number between ${e} and ${t}`,jsonSchema:{minimum:e,maximum:t},...r})),egG=e=>{let t;return t={title:"nonNegative",...e},e=>e.pipe(egT(e=>e>=0,{schemaId:ehq,title:"greaterThanOrEqualTo(0)",description:"a non-negative number",jsonSchema:{minimum:0},...t}))};class egZ extends ed5.pipe(egK({identifier:"Int"})){}class egQ extends ed5.pipe(egG({identifier:"NonNegative"})){}class egY extends egN(ed3.annotations({description:"a string to be decoded into a bigint"}),ed1,{strict:!0,decode:(e,t,r)=>ep6(ehs(e),()=>new ep0(r,e,`Unable to decode ${JSON.stringify(e)} into a bigint`)),encode:e=>ep4(String(e))}).annotations({identifier:"BigInt"}){}j={title:"nonNegativeBigInt",identifier:"NonNegativeBigintFromSelf"},e=>e.pipe(egT(e=>e>=0n,{schemaId:ehQ,[ehQ]:{min:0n},title:`greaterThanOrEqualToBigInt(${0n})`,description:0n===0n?"a non-negative bigint":`a bigint greater than or equal to ${0n}n`,...j}));let egX=egQ.pipe(egK()).annotations({identifier:"NonNegativeInt"}),eg0=egv("Millis",{millis:egX}),eg1=egv("Nanos",{nanos:egY}),eg2=egv("Infinity",{}),eg3=ed9(ed6(egX).annotations({title:"seconds"}),ed6(egX).annotations({title:"nanos"})).annotations({identifier:"FiniteHRTime"}),eg5=Symbol.for("effect/SchemaId/ValidDate"),eg4=ehU;class eg6 extends edG(j0,{identifier:"DateFromSelf",schemaId:eg4,[eg4]:{noInvalidDate:!1},description:"a potentially invalid Date instance",pretty:()=>e=>`new Date(${JSON.stringify(e)})`,arbitrary:()=>e=>e.date({noInvalidDate:!1}),equivalence:()=>Pk}){}e=>ehb(e)&&ehS(e);let eg8=()=>e=>e.integer({min:-432e5,max:504e5}).map(etG);class eg7 extends edG(ehy,{identifier:"TimeZoneOffsetFromSelf",description:"a TimeZone.Offset instance",pretty:()=>e=>e.toString(),arbitrary:eg8}){}let eg9=()=>e=>e.constantFrom(...Intl.supportedValuesOf("timeZone")).map(etV);class eme extends edG(ehv,{identifier:"TimeZoneNamedFromSelf",description:"a TimeZone.Named instance",pretty:()=>e=>e.toString(),arbitrary:eg9}){}let emt=e=>e.oneof(eg8()(e),eg9()(e));e=>ehb(e)&&ehx(e);let emr=()=>e=>`BigDecimal(${ec7(ecX(e))})`,emn=()=>e=>e.tuple(e.bigInt(),e.integer({min:0,max:18})).map(([e,t])=>ecK(e,t)),emi=e=>Reflect.ownKeys(e).every(t=>{let r;return edW(r=e[t])||ego(r)}),ems=e=>"fields"in e?e.fields:ems(e[egF]),ema=e=>emi(e)?egy(e):edW(e)?e:egy(ems(e)),emo=e=>emi(e)?e:ems(e),eml=e=>(t,r,n)=>{class i extends etk{}i.prototype.name=t;let s=emo(r),a=ema(r),o={_tag:egf(egh(edK(t)),()=>t)},l=emu(o,s),u="message"in l;class c extends emf({kind:"TaggedError",identifier:e??t,schema:egE(a,egy(o)),fields:l,Base:i,annotations:n,disableToString:!0}){static _tag=t}return u||Object.defineProperty(c.prototype,"message",{get(){return`{ ${Reflect.ownKeys(s).map(e=>`${ehT(e)}: ${ehI(this[e])}`).join(", ")} }`},enumerable:!1,configurable:!0}),c},emu=(e,t)=>{let r={...e};for(let n of Reflect.ownKeys(t)){if(n in e)throw Error(ehL(n));r[n]=t[n]}return r};function emc(e){return jq(e)?e:e?.disableValidation??!1}let emh=jL("effect/Schema/astCache",()=>new WeakMap),emf=({Base:e,annotations:t,disableToString:r,fields:n,identifier:i,kind:s,schema:a})=>{let o=Symbol.for(`effect/Schema/${s}/${i}`),[l,u,c]=void 0===t?[]:Array.isArray(t)?t:[t],h=edJ(a),f=h.annotations({identifier:i,...l}),p=h.annotations({[eh8]:`${i} (Type side)`,...l}),d=a.annotations({[eh8]:`${i} (Constructor)`,...l}),g=a.annotations({[eh8]:`${i} (Encoded side)`,...c}),m=a.annotations({...c,...l,...u}),b=class extends e{constructor(e={},t=!1){e={...e},"Class"!==s&&delete e._tag,e=egb(n,e),emc(t)||(e=eda(d)(e)),super(e,!0)}static [ed$]=edL;static get ast(){let e=emh.get(this);return e||(e=egM(g,edG([a],{decode:()=>(e,t,r)=>{var n;let i;return e instanceof this||jZ(e,o)&&(i=edu(epM(p.ast),!0),(e,t)=>PN(i(e,{exact:!0,...edr(n,t)})))(e)?ep4(e):PM(new ep0(r,e))},encode:()=>(e,t)=>e instanceof this?ep4(e):ep7(eds(p)(e,t),e=>new this(e,!0))},{identifier:i,pretty:e=>t=>`${i}(${e(t)})`,arbitrary:e=>t=>e(t).map(e=>new this(e)),equivalence:jM,[efh]:f.ast,...l}),{strict:!0,decode:e=>new this(e,!0),encode:jM}).annotations({[efh]:m.ast,...u}).ast,emh.set(this,e)),e}static pipe(){return DF(this,arguments)}static annotations(e){return edz(this.ast).annotations(e)}static toString(){return`(${String(g)} <-> ${i})`}static make(...e){return new this(...e)}static fields={...n};static identifier=i;static extend(e){return(t,r)=>{let i=emo(t),o=ema(t),l=emu(n,i);return emf({kind:s,identifier:e,schema:egE(a,o),fields:l,Base:this,annotations:r})}}static transformOrFail(e){return(t,r,i)=>{let o=emu(n,t);return emf({kind:s,identifier:e,schema:egN(a,edJ(egy(o)),r),fields:o,Base:this,annotations:i})}}static transformOrFailFrom(e){return(t,r,i)=>{let o=emu(n,t);return emf({kind:s,identifier:e,schema:egN(edz(epP(a.ast)),egy(o),r),fields:o,Base:this,annotations:i})}}get[o](){return o}};return!0!==r&&Object.defineProperty(b.prototype,"toString",{value(){return`${i}({ ${Reflect.ownKeys(n).map(e=>`${ehT(e)}: ${ehI(this[e])}`).join(", ")} })`},configurable:!0,writable:!0}),b},emp=ed4(egy({_tag:edK("None")}).annotations({identifier:"FiberIdNoneEncoded"}),egy({_tag:edK("Runtime"),id:egZ,startTimeMillis:egZ}).annotations({identifier:"FiberIdRuntimeEncoded"}),egy({_tag:edK("Composite"),left:egC(()=>emp),right:egC(()=>emp)}).annotations({identifier:"FiberIdCompositeEncoded"})).annotations({identifier:"FiberIdEncoded"}),emd=e=>e.letrec(t=>({None:e.record({_tag:e.constant("None")}),Runtime:e.record({_tag:e.constant("Runtime"),id:e.integer(),startTimeMillis:e.integer()}),Composite:e.record({_tag:e.constant("Composite"),left:t("FiberId"),right:t("FiberId")}),FiberId:e.oneof(t("None"),t("Runtime"),t("Composite"))})).FiberId.map(emm),emg=e=>{switch(e._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${e.id}, ${e.startTimeMillis})`;case"Composite":return`FiberId.composite(${emg(e.right)}, ${emg(e.left)})`}},emm=e=>{switch(e._tag){case"None":return Bx;case"Runtime":return B_(e.id,e.startTimeMillis);case"Composite":return new Bh(emm(e.left),emm(e.right))}},emb=egy({_tag:edK("Empty")}),emy=egy({_tag:edK("Interrupt"),fiberId:emp});class emv extends egM(ed0,ed0,{strict:!0,decode:e=>{if(jG(e)&&"message"in e&&"string"==typeof e.message){let t=Error(e.message,{cause:e});return"name"in e&&"string"==typeof e.name&&(t.name=e.name),t.stack="stack"in e&&"string"==typeof e.stack?e.stack:"",t}return Ux(e)},encode:e=>e instanceof Error?{name:e.name,message:e.message}:Ux(e)}).annotations({identifier:"Defect"}){}let emS=Symbol.for("effect/Schema/Serializable/symbolResult"),emx=jL("effect/Schema/Serializable/exitSchemaCache",()=>new WeakMap),em_=egv("symbol",{key:ed3}).annotations({description:"an object to be decoded into a globally shared symbol"}),emw=egN(em_,ed2,{strict:!0,decode:e=>ep4(Symbol.for(e.key)),encode:(e,t,r)=>{var n,i;let s;return ep7((n=e,i=r,void 0===(s=Symbol.keyFor(n))?PM(new ep0(i,n,`Unable to encode a unique symbol ${String(n)} into a string`)):ep4(s)),e=>em_.make({key:e}))}}),emk=Symbol.for("@effect/platform/Error"),emO=(e,t)=>{class r extends etk{_tag=t}return r.prototype[e]=e,r.prototype.name=t,r},emE=edK("Clipboard","Command","FileSystem","KeyValueStore","Path","Stream","Terminal");class emC extends eml("@effect/platform/Error/BadArgument")("BadArgument",{module:emE,method:ed3,description:egg(ed3),cause:egg(emv)}){[emk]=emk;get message(){return`${this.module}.${this.method}${this.description?`: ${this.description}`:""}`}}let emF=edK("AlreadyExists","BadResource","Busy","InvalidData","NotFound","PermissionDenied","TimedOut","UnexpectedEof","Unknown","WouldBlock","WriteZero");class emI extends eml("@effect/platform/Error/SystemError")("SystemError",{reason:emF,module:emE,method:ed3,description:egg(ed3),syscall:egg(ed3),pathOrDescriptor:egg(ed4(ed3,ed5)),cause:egg(emv)}){[emk]=emk;get message(){return`${this.reason}: ${this.module}.${this.method}${void 0!==this.pathOrDescriptor?` (${this.pathOrDescriptor})`:""}${this.description?`: ${this.description}`:""}`}}let emT=Py("@effect/platform/FileSystem"),emR=e=>"bigint"==typeof e?e:BigInt(e),emN=e=>{let t=emM(e),r=[];for(let e=0;e<t.length;e++)if(Array.isArray(t[e][0])){let[n,i]=t[e];r.push([`${n[0]}[${n.slice(1).join("][")}]`,i])}else r.push(t[e]);return r},emM=e=>{let t=Symbol.iterator in e?$y(e):Object.entries(e),r=[];for(let[e,n]of t)if(Array.isArray(n))for(let t=0;t<n.length;t++)void 0!==n[t]&&r.push([e,String(n[t])]);else if("object"==typeof n)for(let[t,i]of emM(n))r.push([[e,..."string"==typeof t?[t]:t],i]);else void 0!==n&&r.push([e,String(n)]);return r},emA=((e,t,r)=>$w($7(e,([e])=>e!==t),[t,String(r)]),jN(2,(e,t)=>{let r=emN(t),n=r.map(([e])=>e);return $k($7(e,([e])=>n.includes(e)),r)})),emj=jN(3,(e,t,r)=>$w(e,[t,String(r)])),emD=((e,t)=>$k(e,emN(t)),Symbol.for("@effect/platform/HttpBody")),emP=Symbol.for("@effect/platform/HttpBody/HttpBodyError");class em${[emD];constructor(){this[emD]=emD}[Dy](){return this.toJSON()}toString(){return JSON.stringify(this,null,2)}}let emz=new class extends em${_tag="Empty";toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Empty"}}};class emL extends em${body;contentType;_tag="Uint8Array";constructor(e,t){super(),this.body=e,this.contentType=t}get contentLength(){return this.body.length}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Uint8Array",body:this.contentType.startsWith("text/")||this.contentType.endsWith("json")?new TextDecoder().decode(this.body):`Uint8Array(${this.body.length})`,contentType:this.contentType,contentLength:this.contentLength}}}let emU=new TextEncoder,emB=(e,t)=>{let r;return r=emU.encode(e),new emL(r,t??"text/plain"??"application/octet-stream")},emq=e=>Zs({try:()=>emB(JSON.stringify(e),"application/json"),catch:e=>{var t;let r;return(r=(t={[emP]:emP,reason:{_tag:"JsonError",error:e}},BZ(t)))._tag="HttpBodyError",r}});class emJ extends em${stream;contentType;contentLength;_tag="Stream";constructor(e,t,r){super(),this.stream=e,this.contentType=t,this.contentLength=r}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Stream",contentType:this.contentType,contentLength:this.contentLength}}}let emH=(e,t,r)=>new emJ(e,t??"application/octet-stream",r),emW=Symbol.for("@effect/platform/Cookies"),emK=Symbol.for("@effect/platform/Cookies/Cookie"),emV=Symbol.for("@effect/platform/Cookies/CookieError");class emG extends emO(emV,"CookieError"){get message(){return this.reason}}let emZ={[emW]:emW,...DS,toJSON(){return{_id:"@effect/platform/Cookies",cookies:$d(this.cookies,e=>e.toJSON())}},pipe(){return DF(this,arguments)}},emQ=e=>{let t=Object.create(emZ);return t.cookies=e,t},emY=e=>{let t={};for(let r of e)t[r.name]=r;return emQ(t)},emX=emY([]),em0=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,em1={[emK]:emK,...DS,toJSON(){return{_id:"@effect/platform/Cookies/Cookie",name:this.name,value:this.value,options:this.options}}};function em2(e,t,r){if(!em0.test(e))return PM(new emG({reason:"InvalidName"}));let n=encodeURIComponent(t);if(n&&!em0.test(n))return PM(new emG({reason:"InvalidValue"}));if(void 0!==r){if(void 0!==r.domain&&!em0.test(r.domain))return PM(new emG({reason:"InvalidDomain"}));if(void 0!==r.path&&!em0.test(r.path))return PM(new emG({reason:"InvalidPath"}));if(void 0!==r.maxAge&&"Infinity"===Uj(r.maxAge).value._tag)return PM(new emG({reason:"InfinityMaxAge"}))}return PA(Object.assign(Object.create(em1),{name:e,value:t,valueEncoded:n,options:r}))}(e,t)=>emQ({...e.cookies,...t.cookies}),(e,t,r,n)=>emQ($m(e.cookies,t,PU(em2(t,r,n),jM)));let em3=jN(2,(e,t)=>{let r={...e.cookies};for(let[e,n,i]of t){let t=em2(e,n,i);if(PR(t))return t;r[e]=t.right}return PA(emQ(r))});function em5(e){let t=e.name+"="+e.valueEncoded;if(void 0===e.options)return t;let r=e.options;if(void 0!==r.maxAge&&(t+="; Max-Age="+Math.trunc(UX(r.maxAge,{onMillis:e=>e/1e3,onNanos:e=>Number(e)/1e9}))),void 0!==r.domain&&(t+="; Domain="+r.domain),void 0!==r.path&&(t+="; Path="+r.path),void 0!==r.priority)switch(r.priority){case"low":t+="; Priority=Low";break;case"medium":t+="; Priority=Medium";break;case"high":t+="; Priority=High"}if(void 0!==r.expires&&(t+="; Expires="+r.expires.toUTCString()),r.httpOnly&&(t+="; HttpOnly"),r.secure&&(t+="; Secure"),r.partitioned&&(t+="; Partitioned"),void 0!==r.sameSite)switch(r.sameSite){case"lax":t+="; SameSite=Lax";break;case"strict":t+="; SameSite=Strict";break;case"none":t+="; SameSite=None"}return t}(e,t)=>PU(em3(e,t),jM);let em4=e=>{try{return decodeURIComponent(e)}catch{return e}},em6=Symbol.for("@effect/platform/Headers"),em8=Object.assign(Object.create(null),{[em6]:em6,[Dk](e){return ebs(this,Vt(e,eba))}}),em7=e=>Object.assign(Object.create(em8),e),em9=Object.create(em8),ebe=e=>{if(void 0===e)return em9;if(Symbol.iterator in e){let t=Object.create(em8);for(let[r,n]of e)t[r.toLowerCase()]=n;return t}let t=Object.create(em8);for(let[r,n]of Object.entries(e))Array.isArray(n)?t[r.toLowerCase()]=n.join(", "):void 0!==n&&(t[r.toLowerCase()]=n);return t},ebt=jN(3,(e,t,r)=>{let n=em7(e);return n[t.toLowerCase()]=r,n}),ebr=jN(2,(e,t)=>em7({...e,...ebe(t)})),ebn=jN(2,(e,t)=>{let r=em7(e);return Object.assign(r,t),r}),ebi=jN(2,(e,t)=>{let r=em7(e),n=t=>{if("string"==typeof t){let n=t.toLowerCase();n in e&&delete r[n]}else for(let n in e)t.test(n)&&delete r[n]};if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else n(t);return r}),ebs=jN(2,(e,t)=>{let r={...e},n=t=>{if("string"==typeof t){let n=t.toLowerCase();n in e&&(r[n]=edj(e[n]))}else for(let n in e)t.test(n)&&(r[n]=edj(e[n]))};if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else n(t);return r}),eba=jL("@effect/platform/Headers/currentRedactedNames",()=>Hj(["authorization","cookie","set-cookie","x-api-key"])),ebo=Symbol.for("@effect/platform/HttpServerResponse"),ebl=Symbol.for("@effect/platform/HttpServerRespondable");class ebu extends KY{status;statusText;cookies;body;[ebo];headers;constructor(e,t,r,n,i){if(super(),this.status=e,this.statusText=t,this.cookies=n,this.body=i,this[ebo]=ebo,i.contentType||i.contentLength){const e={...r};i.contentType&&(e["content-type"]=i.contentType),i.contentLength&&(e["content-length"]=i.contentLength.toString()),this.headers=e}else this.headers=r}commit(){return J7(this)}[ebl](){return J7(this)}[Dy](){return this.toJSON()}toString(){return JSON.stringify(this,null,2)}toJSON(){return{_id:"@effect/platform/HttpServerResponse",status:this.status,statusText:this.statusText,headers:DC(this.headers),cookies:this.cookies.toJSON(),body:this.body.toJSON()}}}let ebc=e=>"object"==typeof e&&null!==e&&ebo in e,ebh=e=>new ebu(e?.status??204,e?.statusText,e?.headers?ebe(e.headers):em9,e?.cookies??emX,emz),ebf=jN(3,(e,t,r)=>new ebu(e.status,e.statusText,ebt(e.headers,t,r),e.cookies,e.body)),ebp=jN(2,(e,t)=>{let r=e.headers;return"Empty"===t._tag&&(r=ebi(ebi(r,"Content-Type"),"Content-length")),new ebu(e.status,e.statusText,r,e.cookies,t)}),ebd=(e,t)=>JX(emq(e),e=>new ebu(t?.status??200,t?.statusText,t?.headers?ebe(t.headers):em9,t?.cookies??emX,e)),ebg=Symbol.for("@effect/platform/HttpServerRespondable"),ebm=ebh({status:400}),ebb=ebh({status:404}),eby=e=>ebc(e)?J7(e):J4(e[ebg]()),ebv=Symbol.for("@effect/platform/HttpServerError"),ebS=jL("@effect/platform/HttpServerError/clientAbortFiberId",()=>B_(-499,0)),ebx=ebh({status:500}),eb_=ebh({status:499}),ebw=ebh({status:503}),ebk=ebv;class ebO extends emO(ebk,"RequestError"){[ebg](){return ebh({status:400})}get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){return this.description?`${this.reason}: ${this.description} (${this.methodAndUrl})`:`${this.reason} error (${this.methodAndUrl})`}}class ebE extends emO(ebk,"RouteNotFound"){constructor(e){super(e),this.stack=`${this.name}: ${this.message}`}[ebg](){return ebh({status:404})}get message(){return`${this.request.method} ${this.request.url} not found`}}let ebC=e=>{let[t,r]=Um(e,[J7(ebx),LX],(e,t)=>{switch(t._tag){case"Empty":return Pe(e);case"Fail":return Pe([((e,t)=>{if(ebc(e))return J7(e);if(jZ(e,ebg))return JC(e[ebg](),()=>J7(t));if(jZ(e,ep2))return J7(ebm);if(jZ(e,Ws))return J7(ebb);return J7(t)})(t.error,ebx),t]);case"Die":var r,n;return Pe([(r=t.defect,n=ebx,ebc(r)?J7(r):jZ(r,ebg)?JC(r[ebg](),()=>J7(n)):J7(n)),t]);case"Interrupt":if("Empty"!==e[1]._tag)return PY();return Pe([J7(t.fiberId===ebS?eb_:ebw),t]);default:return PY()}});return JX(t,e=>r._tag===LH?[e,L1(e)]:[e,L5(r,L1(e))])},ebF=Symbol.for("@effect/platform/HttpIncomingMessage"),ebI=(e,t)=>{let r=edH(e,t);return e=>JU(e.json,r)};class ebT extends PS()("@effect/platform/HttpIncomingMessage/MaxBodySize",{defaultValue:PY}){}let ebR=(e,t)=>{let r,n=e.headers["content-type"]??"";if(n.includes("application/json"))try{r=eeX(e.json)}catch{}else if(n.includes("text/")||n.includes("urlencoded"))try{r=eeX(e.text)}catch{}let i={...t,headers:DC(e.headers),remoteAddress:e.remoteAddress.toJSON()};return void 0!==r&&(i.body=r),i},ebN=Symbol.for("effect/Mailbox"),ebM=Symbol.for("effect/Mailbox/ReadonlyMailbox"),ebA=zd(),ebj=WO(ebA),ebD=WO(!1),ebP=WO(!0),eb$=[ebA,!0];class ebz extends KQ{scheduler;capacity;strategy;[ebN]=ebN;[ebM]=ebM;state={_tag:"Open",takers:new Set,offers:new Set,awaiters:new Set};messages=[];messagesChunk=zd();constructor(e,t,r){super(),this.scheduler=e,this.capacity=t,this.strategy=r}offer(e){return J9(()=>{if("Open"!==this.state._tag)return ebD;if(this.messages.length+this.messagesChunk.length>=this.capacity)switch(this.strategy){case"dropping":return ebD;case"suspend":if(this.capacity<=0&&this.state.takers.size>0)return this.messages.push(e),this.releaseTaker(),ebP;return this.offerRemainingSingle(e);case"sliding":return this.unsafeTake(),this.messages.push(e),ebP}return this.messages.push(e),this.scheduleReleaseTaker(),ebP})}unsafeOffer(e){return"Open"===this.state._tag&&(this.messages.length+this.messagesChunk.length>=this.capacity?"sliding"===this.strategy?(this.unsafeTake(),this.messages.push(e),!0):this.capacity<=0&&this.state.takers.size>0&&(this.messages.push(e),this.releaseTaker(),!0):(this.messages.push(e),this.scheduleReleaseTaker(),!0))}offerAll(e){return J9(()=>{if("Open"!==this.state._tag)return J7(zb(e));let t=this.unsafeOfferAllArray(e);return 0===t.length?ebj:"dropping"===this.strategy?J7(z_(t)):this.offerRemainingArray(t)})}unsafeOfferAll(e){return z_(this.unsafeOfferAllArray(e))}unsafeOfferAllArray(e){if("Open"!==this.state._tag)return $y(e);if(this.capacity===1/0||"sliding"===this.strategy)return this.messages.length>0&&(this.messagesChunk=zT(this.messagesChunk,z_(this.messages))),"sliding"===this.strategy?this.messagesChunk=this.messagesChunk.pipe(zT(zb(e)),zW(this.capacity)):zf(e)?this.messagesChunk=zT(this.messagesChunk,e):this.messages=$y(e),this.scheduleReleaseTaker(),[];let t=this.capacity<=0?this.state.takers.size:this.capacity-this.messages.length-this.messagesChunk.length;if(0===t)return $y(e);let r=[],n=0;for(let i of e)n<t?this.messages.push(i):r.push(i),n++;return this.scheduleReleaseTaker(),r}fail(e){return this.done(Wy(e))}failCause(e){return this.done(Wv(e))}unsafeDone(e){return"Open"===this.state._tag&&(0===this.state.offers.size&&0===this.messages.length&&0===this.messagesChunk.length?this.finalize(e):this.state={...this.state,_tag:"Closing",exit:e},!0)}shutdown=He(()=>{if("Done"===this.state._tag)return!0;this.messages=[],this.messagesChunk=ebA;let e=this.state.offers;if(this.finalize("Open"===this.state._tag?WE:this.state.exit),e.size>0){for(let t of e)"Single"===t._tag?t.resume(ebD):t.resume(WO(z_(t.remaining.slice(t.offset))));e.clear()}return!0});done(e){return He(()=>this.unsafeDone(e))}end=this.done(WE);clear=J9(()=>{if("Done"===this.state._tag)return Wd(this.state.exit,ebA);let e=this.unsafeTakeAll();return this.releaseCapacity(),J7(e)});takeAll=J9(()=>{if("Done"===this.state._tag)return Wd(this.state.exit,eb$);let e=this.unsafeTakeAll();return 0===e.length?Hp(this.awaitTake,this.takeAll):J7([e,this.releaseCapacity()])});takeN(e){return J9(()=>{let t;if("Done"===this.state._tag)return Wd(this.state.exit,eb$);if(e<=0)return J7([ebA,!1]);if((e=Math.min(e,this.capacity))<=this.messagesChunk.length)t=zC(this.messagesChunk,e),this.messagesChunk=zF(this.messagesChunk,e);else{if(!(e<=this.messages.length+this.messagesChunk.length))return Hp(this.awaitTake,this.takeN(e));this.messagesChunk=zT(this.messagesChunk,z_(this.messages)),this.messages=[],t=zC(this.messagesChunk,e),this.messagesChunk=zF(this.messagesChunk,e)}return J7([t,this.releaseCapacity()])})}unsafeTake(){let e;if("Done"===this.state._tag)return WF(this.state.exit,Wy(new Wa));if(this.messagesChunk.length>0)e=zz(this.messagesChunk),this.messagesChunk=zF(this.messagesChunk,1);else if(this.messages.length>0)e=this.messages[0],this.messagesChunk=zF(z_(this.messages),1),this.messages=[];else if(this.capacity<=0&&this.state.offers.size>0)return this.capacity=1,this.releaseCapacity(),this.capacity=0,this.messages.length>0?WO(this.messages.pop()):void 0;else return;return this.releaseCapacity(),WO(e)}take=J9(()=>this.unsafeTake()??Hp(this.awaitTake,this.take));await=JO(e=>"Done"===this.state._tag?e(this.state.exit):(this.state.awaiters.add(e),He(()=>{"Done"!==this.state._tag&&this.state.awaiters.delete(e)})));unsafeSize(){let e=this.messages.length+this.messagesChunk.length;return"Done"===this.state._tag?PY():Pe(e)}size=He(()=>this.unsafeSize());commit(){return this.takeAll}pipe(){return DF(this,arguments)}toJSON(){return{_id:"effect/Mailbox",state:this.state._tag,size:this.unsafeSize().toJSON()}}toString(){return JSON.stringify(this,null,2)}[Dy](){return JSON.stringify(this,null,2)}offerRemainingSingle(e){return JO(t=>{if("Open"!==this.state._tag)return t(ebD);let r={_tag:"Single",message:e,resume:t};return this.state.offers.add(r),He(()=>{"Open"===this.state._tag&&this.state.offers.delete(r)})})}offerRemainingArray(e){return JO(t=>{if("Open"!==this.state._tag)return t(WO(z_(e)));let r={_tag:"Array",remaining:e,offset:0,resume:t};return this.state.offers.add(r),He(()=>{"Open"===this.state._tag&&this.state.offers.delete(r)})})}releaseCapacity(){if("Done"===this.state._tag)return"Success"===this.state.exit._tag;if(0===this.state.offers.size)return"Closing"===this.state._tag&&0===this.messages.length&&0===this.messagesChunk.length&&(this.finalize(this.state.exit),"Success"===this.state.exit._tag);let e=this.capacity-this.messages.length-this.messagesChunk.length;for(let t of this.state.offers)if(0===e)break;else if("Single"===t._tag)this.messages.push(t.message),e--,t.resume(ebP),this.state.offers.delete(t);else{for(;t.offset<t.remaining.length;t.offset++){if(0===e)return!1;this.messages.push(t.remaining[t.offset]),e--}t.resume(ebj),this.state.offers.delete(t)}return!1}awaitTake=JO(e=>"Done"===this.state._tag?e(this.state.exit):(this.state.takers.add(e),He(()=>{"Done"!==this.state._tag&&this.state.takers.delete(e)})));scheduleRunning=!1;scheduleReleaseTaker(){this.scheduleRunning||(this.scheduleRunning=!0,this.scheduler.scheduleTask(this.releaseTaker,0))}releaseTaker=()=>{if(this.scheduleRunning=!1,"Done"===this.state._tag||0===this.state.takers.size)return;let e=(e=>{let t=e[Symbol.iterator]().next();if(t.done)throw Error("unsafeHead: empty iterable");return t.value})(this.state.takers);this.state.takers.delete(e),e(WE)};unsafeTakeAll(){if(this.messagesChunk.length>0){let e=this.messages.length>0?zT(this.messagesChunk,z_(this.messages)):this.messagesChunk;return this.messagesChunk=ebA,this.messages=[],e}if(this.messages.length>0){let e=z_(this.messages);return this.messages=[],e}return"Done"!==this.state._tag&&this.state.offers.size>0?(this.capacity=1,this.releaseCapacity(),this.capacity=0,zm(this.messages.pop())):ebA}finalize(e){if("Done"===this.state._tag)return;let t=this.state;for(let r of(this.state={_tag:"Done",exit:e},t.takers))r(e);for(let r of(t.takers.clear(),t.awaiters))r(e);t.awaiters.clear()}}(e,t)=>Hi(r=>JH(r(e),{onFailure:e=>t.failCause(e),onSuccess:e=>t.end}));let ebL=/; *([!#$%&'*+.^\w`|~-]+)=("(?:[\v\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\v\u0020-\u00ff])*"|[!#$%&'*+.^\w`|~-]+) */gu,ebU=/\\([\v\u0020-\u00ff])/gu,ebB=/^[!#$%&'*+.^\w|~-]+\/[!#$%&'*+.^\w|~-]+$/u,ebq=/^[!#$%&'*+.^\w|~-]+$/u,ebJ={value:"",parameters:Object.create(null)};function ebH(e,t=!1){let r,n,i;if("string"!=typeof e)return ebJ;let s=e.indexOf(";"),a=-1!==s?e.slice(0,s).trim():e.trim();if(!1===(t?ebq:ebB).test(a))return ebJ;let o={value:a.toLowerCase(),parameters:Object.create(null)};if(-1===s)return o;for(ebL.lastIndex=s;n=ebL.exec(e);){if(n.index!==s)return ebJ;s+=n[0].length,r=n[1].toLowerCase(),'"'===(i=n[2])[0]&&(i=i.slice(1,i.length-1),!t&&ebU.test(i)&&(i=i.replace(ebU,"$1"))),o.parameters[r]=i}return s!==e.length?ebJ:o}(eh=e_||(e_={}))[eh.key=0]="key",eh[eh.whitespace=1]="whitespace",eh[eh.value=2]="value";let ebW={_tag:"Continue"},ebK=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1],ebV=[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];(ef=ew||(ew={}))[ef.headers=0]="headers",ef[ef.body=1]="body";let ebG={_tag:"InvalidDisposition"},ebZ={_tag:"EndNotReached"},ebQ={_tag:"ReachedLimit",limit:"MaxParts"},ebY={_tag:"ReachedLimit",limit:"MaxTotalSize"},ebX={_tag:"ReachedLimit",limit:"MaxPartSize"},eb0={_tag:"ReachedLimit",limit:"MaxFieldSize"},eb1=new TextEncoder().encode("\r\n");function eb2(e){return void 0!==e.filename||"application/octet-stream"===e.contentType}function eb3(e){}let eb5=new TextDecoder("utf-8"),eb4=function({headers:e,onFile:t,onField:r,onError:n,onDone:i,isFile:s=eb2,maxParts:a=1/0,maxTotalSize:o=1/0,maxPartSize:l=1/0,maxFieldSize:u=1048576}){var c,h;let f,p,d=ebH(e["content-type"]).parameters.boundary;if(void 0===d)return n({_tag:"InvalidBoundary"}),{write:eb3,end(){}};let g={state:ew.headers,index:0,parts:0,onChunk:eb3,info:void 0,headerSkip:0,partSize:0,totalSize:0,isFile:!1,fieldChunks:[],fieldSize:0};function m(){g.state=ew.body,g.isFile=!0,g.onChunk=eb3}let b=function(){let e=new TextDecoder,t={state:e_.key,headers:Object.create(null),key:"",value:void 0,crlf:0,previousChunk:void 0,pairs:0,size:0};function r(e){return t.state=e_.key,t.headers=Object.create(null),t.key="",t.value=void 0,t.crlf=0,t.previousChunk=void 0,t.pairs=0,t.size=0,e}function n(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function i(e){return r({_tag:"Failure",reason:e,headers:t.headers})}return function(s,a){let o,l=0;if(void 0!==t.previousChunk){o=l=t.previousChunk.length;let e=new Uint8Array(s.length+l);e.set(t.previousChunk),e.set(s,l),t.previousChunk=void 0,s=e}let u=s.length;e:for(;a<u;){if(t.state===e_.key){let r=a;for(;r<u;r++){if(t.size++>16384)return i("HeaderTooLarge");if(58===s[r]){if(t.key+=e.decode(s.subarray(a,r)).toLowerCase(),0===t.key.length)return i("InvalidHeaderName");32===s[r+1]&&32!==s[r+2]&&9!==s[r+2]?(a=r+2,t.state=e_.value,t.size++):32!==s[r+1]&&9!==s[r+1]?(a=r+1,t.state=e_.value):(a=r+1,t.state=e_.whitespace);break}if(1!==ebK[s[r]])return i("InvalidHeaderName")}if(r===u)return t.key+=e.decode(s.subarray(a,u)).toLowerCase(),ebW}if(t.state===e_.whitespace){for(;a<u;a++){if(t.size++>16384)return i("HeaderTooLarge");if(32!==s[a]&&9!==s[a]){t.state=e_.value;break}}if(a===u)return ebW}if(t.state===e_.value){let c=a;for(void 0!==o&&(c=o,o=void 0);c<u;c++){if(t.size++>16384)return i("HeaderTooLarge");if(13===s[c]||t.crlf>0){let o=s[c];if(13===o&&0===t.crlf&&(t.crlf=1,c++,t.size++,o=s[c]),10===o&&1===t.crlf&&(t.crlf=2,c++,t.size++,o=s[c]),13===o&&2===t.crlf&&(t.crlf=3,c++,t.size++,o=s[c]),10===o&&3===t.crlf&&(t.crlf=4,c++,t.size++),t.crlf<4&&c>=u)return t.previousChunk=s.subarray(a),ebW;if(t.crlf>=2){t.value=void 0===t.value?s.subarray(a,c-t.crlf):n(t.value,s.subarray(a,c-t.crlf));let o=e.decode(t.value);if(void 0===t.headers[t.key]?t.headers[t.key]=o:"string"==typeof t.headers[t.key]?t.headers[t.key]=[t.headers[t.key],o]:t.headers[t.key].push(o),a=c,t.size--,4!==t.crlf&&100===t.pairs)return i("TooManyHeaders");if(3===t.crlf)return i("InvalidHeaderValue");if(4===t.crlf)return r({_tag:"Headers",headers:t.headers,endPosition:a-l});t.pairs++,t.key="",t.value=void 0,t.crlf=0,t.state=e_.key;continue e}}else if(1!==ebV[s[c]])return i("InvalidHeaderValue")}if(c===u)return t.value=void 0===t.value?s.subarray(a,u):n(t.value,s.subarray(a,u)),ebW}}return a>u&&(t.size+=u-a),ebW}}(),y=(c=`\r
--${d}`,h=function(e,o){if(0===e)return void m();if(e!==g.index){if(g.index>0)if(g.isFile)g.onChunk(null),g.partSize=0;else{if(1===g.fieldChunks.length)r(g.info,g.fieldChunks[0]);else{let e=new Uint8Array(g.fieldSize),t=0;for(let r=0;r<g.fieldChunks.length;r++){let n=g.fieldChunks[r];e.set(n,t),t+=n.length}r(g.info,e)}g.fieldSize=0,g.fieldChunks=[]}if(g.state=ew.headers,g.index=e,g.headerSkip=2,45===o[0]&&45===o[1])return i();g.parts++,g.parts>a&&n(ebQ)}if((g.partSize+=o.length)>l&&n(ebX),g.state===ew.headers){let e,r=b(o,g.headerSkip);if(g.headerSkip=0,"Continue"===r._tag)return;if("Failure"===r._tag)return m(),n({_tag:"BadHeaders",error:r});let i=ebH(r.headers["content-type"]),a=ebH(r.headers["content-disposition"],!0);if("form-data"===a.value&&!("name"in a.parameters))return m(),n(ebG);if("filename*"in a.parameters){let t=a.parameters["filename*"].split("''");2===t.length&&(e=decodeURIComponent(t[1]))}if(g.info={name:a.parameters.name??"",filename:e??a.parameters.filename,contentType:""===i.value?void 0!==a.parameters.filename?"application/octet-stream":"text/plain":i.value,contentTypeParameters:i.parameters,contentDisposition:a.value,contentDispositionParameters:a.parameters,headers:r.headers},g.state=ew.body,g.isFile=s(g.info),g.isFile&&(g.onChunk=t(g.info)),r.endPosition<o.length)if(g.isFile)g.onChunk(o.subarray(r.endPosition));else{let e=o.subarray(r.endPosition);(g.fieldSize+=e.length)>u&&n(eb0),g.fieldChunks.push(e)}}else g.isFile?g.onChunk(o):((g.fieldSize+=o.length)>u&&n(eb0),g.fieldChunks.push(o))},f=function(e){let t=new TextEncoder().encode(e),r=t.length,n={};for(let e=0;e<r;e++){let r=t[e];void 0===n[r]&&(n[r]=[]),n[r].push(e)}return{needle:t,needleLength:r,indexes:n,firstByte:t[0],previousChunk:void 0,previousChunkLength:0,matchIndex:0}}(c),void 0!==eb1&&(f.previousChunk=eb1,f.previousChunkLength=eb1.length),p=function(){if("Buffer"in globalThis&&!("Bun"in globalThis||"Deno"in globalThis))return function(e,t,r){return Buffer.prototype.indexOf.call(e,t,r)};let e=new Uint8Array(256).fill(f.needle.length);for(let t=0,r=f.needle.length-1;t<r;++t)e[f.needle[t]]=r-t;return function(t,r,n){let i=t.length,s=n+f.needleLength-1;for(;s<i;){for(let e=f.needleLength-1,n=s;e>=0&&t[n]===r[e];e--,n--)if(0===e)return n;s+=e[t[s]]}return -1}}(),{write:function(e){let t=e.length;if(void 0!==f.previousChunk){let r=new Uint8Array(f.previousChunkLength+t);r.set(f.previousChunk),r.set(e,f.previousChunkLength),e=r,t=f.previousChunkLength+t,f.previousChunk=void 0}if(t<f.needleLength){f.previousChunk=e,f.previousChunkLength=t;return}let r=0;for(;r<t;){let n=p(e,f.needle,r);if(n>-1){n>r&&h(f.matchIndex,e.subarray(r,n)),f.matchIndex+=1,r=n+f.needleLength;continue}if(e[t-1]in f.indexes){let n=f.indexes[e[t-1]],i=-1;for(let r=0,s=n.length;r<s;r++){let s=n[r];e[t-1-s]===f.firstByte&&r>i&&(i=s)}-1===i?0===r?h(f.matchIndex,e):h(f.matchIndex,e.subarray(r)):(t-1-i>r&&h(f.matchIndex,e.subarray(r,t-1-i)),f.previousChunk=e.subarray(t-1-i),f.previousChunkLength=i+1)}else 0===r?h(f.matchIndex,e):h(f.matchIndex,e.subarray(r));break}},end:function(){void 0!==f.previousChunk&&f.previousChunk!==eb1&&h(f.matchIndex,f.previousChunk),f.previousChunk=eb1,f.previousChunkLength=eb1?.length??0,f.matchIndex=0}});return{write:e=>(g.totalSize+=e.length)>o?n(ebY):y.write(e),end(){y.end(),g.state===ew.body&&n(ebZ),g.state=ew.headers,g.index=0,g.parts=0,g.onChunk=eb3,g.info=void 0,g.totalSize=0,g.partSize=0,g.fieldChunks=[],g.fieldSize=0}}},eb6=Symbol.for("@effect/platform/Path"),eb8=Py("@effect/platform/Path");function eb7(e,t){let r,n="",i=0,s=-1,a=0;for(let o=0;o<=e.length;++o){if(o<e.length)r=e.charCodeAt(o);else if(47===r)break;else r=47;if(47===r){if(s===o-1||1===a);else if(s!==o-1&&2===a){if(n.length<2||2!==i||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2)){if(n.length>2){let e=n.lastIndexOf("/");if(e!==n.length-1){-1===e?(n="",i=0):i=(n=n.slice(0,e)).length-1-n.lastIndexOf("/"),s=o,a=0;continue}}else if(2===n.length||1===n.length){n="",i=0,s=o,a=0;continue}}t&&(n.length>0?n+="/..":n="..",i=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),i=o-s-1;s=o,a=0}else 46===r&&-1!==a?++a:a=-1}return n}let eb9=function(){let e,t="",r=!1;for(let n=arguments.length-1;n>=-1&&!r;n--){let i;if(n>=0)i=arguments[n];else{let t=globalThis.process;void 0===e&&"process"in globalThis&&"object"==typeof t&&null!==t&&"function"==typeof t.cwd&&(e=t.cwd()),i=e}0!==i.length&&(t=i+"/"+t,r=47===i.charCodeAt(0))}if(t=eb7(t,!r),r)if(t.length>0)return"/"+t;else return"/";return t.length>0?t:"."},eye=/%/g,eyt=/\\/g,eyr=/\n/g,eyn=/\r/g,eyi=/\t/g,eys=eb8.of({[eb6]:eb6,resolve:eb9,normalize(e){if(0===e.length)return".";let t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return(0!==(e=eb7(e,!t)).length||t||(e="."),e.length>0&&r&&(e+="/"),t)?"/"+e:e},isAbsolute:e=>e.length>0&&47===e.charCodeAt(0),join(){let e;if(0==arguments.length)return".";for(let t=0;t<arguments.length;++t){let r=arguments[t];r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":eys.normalize(e)},relative(e,t){if(e===t||(e=eys.resolve(e),t=eys.resolve(t),e===t))return"";let r=1;for(;r<e.length&&47===e.charCodeAt(r);++r);let n=e.length,i=n-r,s=1;for(;s<t.length&&47===t.charCodeAt(s);++s);let a=t.length-s,o=i<a?i:a,l=-1,u=0;for(;u<=o;++u){if(u===o){if(a>o){if(47===t.charCodeAt(s+u))return t.slice(s+u+1);else if(0===u)return t.slice(s+u)}else i>o&&(47===e.charCodeAt(r+u)?l=u:0===u&&(l=0));break}let n=e.charCodeAt(r+u);if(n!==t.charCodeAt(s+u))break;47===n&&(l=u)}let c="";for(u=r+l+1;u<=n;++u)(u===n||47===e.charCodeAt(u))&&(0===c.length?c+="..":c+="/..");return c.length>0?c+t.slice(s+l):(s+=l,47===t.charCodeAt(s)&&++s,t.slice(s))},dirname(e){if(0===e.length)return".";let t=e.charCodeAt(0),r=47===t,n=-1,i=!0;for(let r=e.length-1;r>=1;--r)if(47===(t=e.charCodeAt(r))){if(!i){n=r;break}}else i=!1;return -1===n?r?"/":".":r&&1===n?"//":e.slice(0,n)},basename(e,t){let r,n=0,i=-1,s=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let a=t.length-1,o=-1;for(r=e.length-1;r>=0;--r){let l=e.charCodeAt(r);if(47===l){if(!s){n=r+1;break}}else -1===o&&(s=!1,o=r+1),a>=0&&(l===t.charCodeAt(a)?-1==--a&&(i=r):(a=-1,i=o))}return n===i?i=o:-1===i&&(i=e.length),e.slice(n,i)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!s){n=r+1;break}}else -1===i&&(s=!1,i=r+1);return -1===i?"":e.slice(n,i)},extname(e){let t=-1,r=0,n=-1,i=!0,s=0;for(let a=e.length-1;a>=0;--a){let o=e.charCodeAt(a);if(47===o){if(!i){r=a+1;break}continue}-1===n&&(i=!1,n=a+1),46===o?-1===t?t=a:1!==s&&(s=1):-1!==t&&(s=-1)}return -1===t||-1===n||0===s||1===s&&t===n-1&&t===r+1?"":e.slice(t,n)},format:function(e){let t,r;if(null===e||"object"!=typeof e)throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||""),t?t===e.root?t+r:t+"/"+r:r},parse(e){let t,r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;let n=e.charCodeAt(0),i=47===n;i?(r.root="/",t=1):t=0;let s=-1,a=0,o=-1,l=!0,u=e.length-1,c=0;for(;u>=t;--u){if(47===(n=e.charCodeAt(u))){if(!l){a=u+1;break}continue}-1===o&&(l=!1,o=u+1),46===n?-1===s?s=u:1!==c&&(c=1):-1!==s&&(c=-1)}return -1===s||-1===o||0===c||1===c&&s===o-1&&s===a+1?-1!==o&&(0===a&&i?r.base=r.name=e.slice(1,o):r.base=r.name=e.slice(a,o)):(0===a&&i?(r.name=e.slice(1,s),r.base=e.slice(1,o)):(r.name=e.slice(a,s),r.base=e.slice(a,o)),r.ext=e.slice(s,o)),a>0?r.dir=e.slice(0,a-1):i&&(r.dir="/"),r},sep:"/",fromFileUrl:function(e){if("file:"!==e.protocol)return JD(new emC({module:"Path",method:"fromFileUrl",description:"URL must be of scheme file"}));if(""!==e.hostname)return JD(new emC({module:"Path",method:"fromFileUrl",description:"Invalid file URL host"}));let t=e.pathname;for(let e=0;e<t.length;e++)if("%"===t[e]){let r=32|t.codePointAt(e+2);if("2"===t[e+1]&&102===r)return JD(new emC({module:"Path",method:"fromFileUrl",description:"must not include encoded / characters"}))}return J7(decodeURIComponent(t))},toFileUrl:function(e){var t;let r=new URL("file://"),n=eb9(e);return 47===e.charCodeAt(e.length-1)&&"/"!==n[n.length-1]&&(n+="/"),(t=n).includes("%")&&(t=t.replace(eye,"%25")),t.includes("\\")&&(t=t.replace(eyt,"%5C")),t.includes("\n")&&(t=t.replace(eyr,"%0A")),t.includes("\r")&&(t=t.replace(eyn,"%0D")),t.includes("	")&&(t=t.replace(eyi,"%09")),r.pathname=t,J7(r)},toNamespacedPath:jM}),eya=Symbol.for("@effect/platform/Multipart"),eyo=Symbol.for("@effect/platform/Multipart/MultipartError");class eyl extends eml()("MultipartError",{reason:edK("FileTooLarge","FieldTooLarge","BodyTooLarge","TooManyParts","InternalError","Parse"),cause:emv}){[eyo]=eyo;get message(){return this.reason}}let eyu=e=>"Success"===e._tag?esh:ei7(e.cause);class eyc extends Dx{[eya];constructor(){super(),this[eya]=eya}}class eyh extends eyc{key;contentType;value;_tag="Field";constructor(e,t,r){super(),this.key=e,this.contentType=t,this.value=r}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"Field",key:this.key,contentType:this.contentType,value:this.value}}}class eyf extends eyc{_tag="File";key;name;contentType;content;contentEffect;constructor(e,t){super(),this.key=e.name,this.name=e.filename??e.name,this.contentType=e.contentType,this.content=euB(t),this.contentEffect=t.pipe(esn(eyd),eaC,J1(e=>new eyl({reason:"InternalError",cause:e})))}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"File",key:this.key,name:this.name,contentType:this.contentType}}}let eyp=(e,t)=>JU(emT,r=>J1(ech(t.content,r.sink(e)),e=>new eyl({reason:"InternalError",cause:e}))),eyd=esu(()=>{let e=new Uint8Array(0),t=esa({onInput(r){for(let t of r){let r=new Uint8Array(e.length+t.length);r.set(e,0),r.set(t,e.length),e=r}return t},onFailure:e=>ei7(e),onDone:()=>eso(e)});return t});class eyg extends eyc{key;name;contentType;path;_tag="PersistedFile";constructor(e,t,r,n){super(),this.key=e,this.name=t,this.contentType=r,this.path=n}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"PersistedFile",key:this.key,name:this.name,contentType:this.contentType,path:this.path}}}class eym extends PS()("@effect/platform/Multipart/MaxParts",{defaultValue:PY}){}class eyb extends PS()("@effect/platform/Multipart/MaxFieldSize",{defaultValue:jA(emR(0xa00000))}){}class eyy extends PS()("@effect/platform/Multipart/MaxFileSize",{defaultValue:PY}){}class eyv extends PS()("@effect/platform/Multipart/FieldMimeTypes",{defaultValue:jA(zg("application/json"))}){}let eyS=Symbol.for("effect/FiberSet"),eyx=new Bc(-1,0),ey_=Ub(void 0,{emptyCase:jD,failCase:jD,dieCase:jD,interruptCase:(e,t)=>LR(Bb(t),-1),sequentialCase:(e,t,r)=>t||r,parallelCase:(e,t,r)=>t||r}),eyw=((e=>jZ(e[0],eyS),(e,t,r)=>{"Closed"===e.state._tag?t.unsafeInterruptAsFork(Bg(r?.interruptAs??Bx,eyx)):e.state.backing.has(t)||(e.state.backing.add(t),t.addObserver(n=>{"Closed"!==e.state._tag&&(e.state.backing.delete(t),"Failure"!==n._tag||(r?.propagateInterruption===!0?ey_(n.cause):L8(n.cause))||WL(e.deferred,n))}))}),Symbol.for("@effect/platform/Socket/SocketError"));class eyk extends emO(eyw,"SocketError"){static is(e){return jZ(e,eyw)&&"Close"===e.reason}static isClean(e){return function(t){return eyk.is(t)&&e(t.code)}}get message(){return this.closeReason?`${this.reason}: ${this.code}: ${this.closeReason}`:`${this.reason}: ${this.code}`}}let eyO=Symbol.for("@effect/platform/HttpServerRequest"),eyE=Py("@effect/platform/HttpServerRequest"),eyC=Py("@effect/platform/HttpServerRequest/ParsedSearchParams");class eyF extends Dx{source;url;headersOverride;remoteAddressOverride;[eyO];[ebF];constructor(e,t,r,n){super(),this.source=e,this.url=t,this.headersOverride=r,this.remoteAddressOverride=n,this[eyO]=eyO,this[ebF]=ebF}toJSON(){return ebR(this,{_id:"@effect/platform/HttpServerRequest",method:this.method,url:this.originalUrl})}modify(e){return new eyF(this.source,e.url??this.url,e.headers??this.headersOverride,e.remoteAddress??this.remoteAddressOverride)}get method(){return this.source.method.toUpperCase()}get originalUrl(){return this.source.url}get remoteAddress(){return this.remoteAddressOverride?Pe(this.remoteAddressOverride):PY()}get headers(){return this.headersOverride??=ebe(this.source.headers),this.headersOverride}cachedCookies;get cookies(){return this.cachedCookies?this.cachedCookies:this.cachedCookies=function(e){let t={},r=e.length,n=0,i=0;for(;i!==r;){-1===(i=e.indexOf(";",n))&&(i=r);let s=e.indexOf("=",n);if(-1===s)break;if(s>i){n=i+1;continue}let a=e.substring(n,s++).trim();if(void 0===t[a]){let r=34===e.charCodeAt(s)?e.substring(s+1,i-1).trim():e.substring(s,i).trim();t[a]=-1!==r.indexOf("%")?em4(r):r}n=i+1}return t}(this.headers.cookie??"")}get stream(){return this.source.body?ecq(()=>this.source.body,e=>new ebO({request:this,reason:"Decode",cause:e})):euM(new ebO({request:this,reason:"Decode",description:"can not create stream from empty body"}))}textEffect;get text(){return this.textEffect||(this.textEffect=eeX(eng(ZE({try:()=>this.source.text(),catch:e=>new ebO({request:this,reason:"Decode",cause:e})})))),this.textEffect}get json(){return ZC(this.text,{try:e=>JSON.parse(e),catch:e=>new ebO({request:this,reason:"Decode",cause:e})})}get urlParamsBody(){return JU(this.text,e=>Zs({try:()=>emN(new URLSearchParams(e)),catch:e=>new ebO({request:this,reason:"Decode",cause:e})}))}multipartEffect;get multipart(){return this.multipartEffect||(this.multipartEffect=eeX(eng(((e,t=eyp)=>enm(function*(){let r=yield*emT,n=yield*eb8,i=yield*r.makeTempDirectoryScoped(),s=Object.create(null);return yield*ecf(e,e=>{if("Field"===e._tag)return e.key in s?"string"==typeof s[e.key]?s[e.key]=[s[e.key],e.value]:s[e.key].push(e.value):s[e.key]=e.value,Hs;if(""===e.name)return Hs;let r=n.join(i,n.basename(e.name).slice(-128)),a=new eyg(e.key,e.name,e.contentType,r);return Array.isArray(s[e.key])?s[e.key].push(a):s[e.key]=[a],t(r,e)}),s}).pipe(Zo({SystemError:e=>JD(new eyl({reason:"InternalError",cause:e})),BadArgument:e=>JD(new eyl({reason:"InternalError",cause:e}))})))(this.multipartStream)))),this.multipartEffect}get multipartStream(){return eu9(eu5(this.stream,e=>new eyl({reason:"InternalError",cause:e})),((e,t=16)=>{let r,n,i,s;return r=Xv([Jv(t=>{let r=Pg(t.currentContext,eyv);return J7({headers:e,maxParts:P5(Pg(t.currentContext,eym)),maxFieldSize:Number(Pg(t.currentContext,eyb)),maxPartSize:Pg(t.currentContext,eyy).pipe(P7(Number),P5),maxTotalSize:Pg(t.currentContext,ebT).pipe(P7(Number),P5),isFile:0===r.length?void 0:e=>!zQ(r,t=>e.contentType.includes(t))&&eb2(e)})}),(s=t,Jv(e=>J7(new ebz(e.currentScheduler,"number"==typeof s?s:s?.capacity??1/0,"number"==typeof s?"suspend":s?.strategy??"suspend"))))]),n=([e,t])=>{let r=[],n=PY(),i=eb4({...e,onField(e,t){r.push(new eyh(e.name,e.contentType,(function(e){if("utf-8"===e||"utf8"===e||""===e)return eb5;try{return new TextDecoder(e)}catch(e){return eb5}})(e.contentTypeParameters.charset??"utf-8").decode(t)))},onFile(e){let t=[],n=!1,i=esu(()=>{if(0===t.length)return n?esh:eaB(s,i);let e=z_(t);return t=[],n?esf(e):eaB(esf(e),eaB(s,i))});return r.push(new eyf(e,i)),function(e){null===e?n=!0:t.push(e)}},onError(e){n=Pe(Wy(function(e){if("ReachedLimit"===e._tag)switch(e.limit){case"MaxParts":return new eyl({reason:"TooManyParts",cause:e});case"MaxFieldSize":return new eyl({reason:"FieldTooLarge",cause:e});case"MaxPartSize":return new eyl({reason:"FileTooLarge",cause:e});case"MaxTotalSize":return new eyl({reason:"BodyTooLarge",cause:e})}return new eyl({reason:"Parse",cause:e})}(e)))},onDone(){n=Pe(WE)}}),s=ese(t.takeAll,([e,t])=>esc(()=>{zA(e,zA(i.write)),t&&i.end()})),a=ese(s,()=>{if(0===r.length)return"None"===n._tag?a:eyu(n.value);let e=z_(r);return r=[],eaB(esf(e),"None"===n._tag?a:eyu(n.value))});return ei4(a,{awaitRead:()=>Hs,emit:e=>t.offer(e),error:e=>(n=Pe(Wv(e)),t.end),done:e=>t.end})},i=([,e])=>e.shutdown,ese(esr(GV(()=>Hs)),e=>j$(esr(Hn(Ht(r,t=>GG(e,e=>i(t,e))))),ese(n),ei6(t=>JU(e.get,e=>e(t)))))})(this.headers))}arrayBufferEffect;get arrayBuffer(){return this.arrayBufferEffect||(this.arrayBufferEffect=eeX(eng(ZE({try:()=>this.source.arrayBuffer(),catch:e=>new ebO({request:this,reason:"Decode",cause:e})})))),this.arrayBufferEffect}get upgrade(){return JD(new ebO({request:this,reason:"Decode",description:"Not an upgradeable ServerRequest"}))}}let eyI=(e,t)=>JU(eyE,ebI(e,t)),eyT=e=>{let t=e.headers.host??"localhost",r="https"===e.headers["x-forwarded-proto"]?"https":"http";try{return Pe(new URL(e.url,`${r}://${t}`))}catch{return PY()}},eyR=jL(Symbol.for("@effect/platform/HttpApp/preResponseHandlers"),()=>Hj(PY())),eyN=/^[0-9a-f]{32}$/i,eyM=/^[0-9a-f]{16}$/i,eyA=(()=>Hj(!1),jL(Symbol.for("@effect/platform/HttpMiddleware/tracerDisabledWhen"),()=>Hj(jD))),eyj=PS()("@effect/platform/HttpMiddleware/SpanNameGenerator",{defaultValue:()=>e=>`http.server ${e.method}`}),eyD=e=>Jv(t=>{var r;let n,i,s=Pg(t.currentContext,eyE);if(t.getFiberRef(eyA)(s))return e;let a=P5(eyT(s));void 0!==a&&(""!==a.username||""!==a.password)&&(a.username="REDACTED",a.password="REDACTED");let o=t.getFiberRef(eba),l=ebs(s.headers,o);return env(Pg(t.currentContext,eyj)(s),{parent:P5("Some"===(i=(e=>{if(!e.traceparent)return PY();let t=e.traceparent.split("-");if(4!==t.length)return PY();let[r,n,i,s]=t;return"00"!==r||!1===eyN.test(n)||!1===eyM.test(i)?PY():Pe(Ze({traceId:n,spanId:i,sampled:(1&parseInt(s,16))==1}))})(r=s.headers))._tag||"Some"===(i=(e=>{if(!("b3"in e))return PY();let t=e.b3.split("-");return t.length<2?PY():Pe(Ze({traceId:t[0],spanId:t[1],sampled:!t[2]||"1"===t[2]}))})(r))._tag?i:(n=r)["x-b3-traceid"]&&n["x-b3-spanid"]?Pe(Ze({traceId:n["x-b3-traceid"],spanId:n["x-b3-spanid"],sampled:!n["x-b3-sampled"]||"1"===n["x-b3-sampled"]})):PY()),kind:"server",captureStackTrace:!1},t=>{for(let e in t.attribute("http.request.method",s.method),void 0!==a&&(t.attribute("url.full",a.toString()),t.attribute("url.path",a.pathname),""!==a.search.slice(1)&&t.attribute("url.query",a.search.slice(1)),t.attribute("url.scheme",a.protocol.slice(0,-1))),void 0!==s.headers["user-agent"]&&t.attribute("user_agent.original",s.headers["user-agent"]),l)t.attribute(`http.request.header.${e}`,String(l[e]));return"Some"===s.remoteAddress._tag&&t.attribute("client.address",s.remoteAddress.value),JU(Jj(ZN(e,t)),e=>{let r,n,i="Success"===e._tag?e.value:(n=Ui(e.cause,e=>ebc(e)?(r=e,Pe(LX)):PY()),[r??ebx,n])[0];t.attribute("http.response.status_code",i.status);let s=ebs(i.headers,o);for(let e in s)t.attribute(`http.response.header.${e}`,String(s[e]));return e})})}),eyP=Symbol.for("@effect/platform/HttpApp/handled"),ey$=jL("@effect/platform/HttpApp/ejectedScopes",()=>new WeakSet),eyz=e=>{let t=eeV(e),r=eej(t);return(n,i)=>{var s;let a,o,l=Symbol.for("@effect/platform/HttpApp/resolve"),u=(s=(t,r)=>(r=(e=>{let t,r;if("Stream"!==e.body._tag)return e;let n=Pg(P8(P3(globalThis[ZQ])).currentContext,X$);return ey$.add(n),ebp(e,emH(euT(e.body.stream,(t=n,r=WE,t.close(r))),e.body.contentType,e.body.contentLength))})(r),t[l](((e,t)=>{let r=new globalThis.Headers(e.headers);if(0!==$g(e.cookies.cookies).length)for(let t of Object.values(e.cookies.cookies).map(em5))r.append("set-cookie",t);if(t?.withoutBody)return new Response(void 0,{status:e.status,statusText:e.statusText,headers:r});let n=e.body;switch(n._tag){case"Empty":return new Response(void 0,{status:e.status,statusText:e.statusText,headers:r});case"Uint8Array":case"Raw":if(n.body instanceof Response){for(let[e,t]of r)n.body.headers.set(e,t);return n.body}return new Response(n.body,{status:e.status,statusText:e.statusText,headers:r});case"FormData":return new Response(n.formData,{status:e.status,statusText:e.statusText,headers:r});case"Stream":return new Response(ecT(n.stream,t?.runtime??eeZ),{status:e.status,statusText:e.statusText,headers:r})}})(r,{withoutBody:"HEAD"===t.method,runtime:e})),Hs),o=JC(Jv(e=>JU(n,t=>{let r=Pg(e.currentContext,eyE),n=e.getFiberRef(eyR);return"None"===n._tag?(r[eyP]=!0,Jx(s(r,t),t)):Ht(n.value(r,t),e=>(r[eyP]=!0,s(r,e)))})),e=>Jv(t=>JU(ebC(e),([e,r])=>{let n=Pg(t.currentContext,eyE),i=t.getFiberRef(eyR);return"None"===i._tag?(n[eyP]=!0,XD(s(n,e),JP(r))):XD(Ht(i.value(n,e),e=>(n[eyP]=!0,s(n,e))),JP(r))}))),Hn((a=jM(void 0===i?eyD(o):JH(i(eyD(o)),{onFailure:e=>Jv(t=>{let r=Pg(t.currentContext,eyE);return eyP in r?Hs:JH(ebC(e),{onFailure:e=>s(r,ebh({status:500})),onSuccess:([e])=>s(r,e)})}),onSuccess:e=>Jv(t=>{let r=Pg(t.currentContext,eyE);return eyP in r?Hs:s(r,e)})})),JU(XB(),e=>J2(Xq(a,e),t=>{let r,n;return ey$.has(e)?Hs:(r=e,n=t,r.close(n))})))));return(n,i)=>new Promise(s=>{let a=new Map(e.context.unsafeMap);if(Pu(i))for(let[e,t]of i.unsafeMap)a.set(e,t);let o=new eyF(n,(e=>{if("/"===e[0])return e;let t=e.indexOf("/",e.indexOf("//")+2);return -1===t?"/":e.slice(t)})(n.url));a.set(eyE.key,o),o[l]=s,t.context=Pl(a);let c=r(u);n.signal?.addEventListener("abort",()=>{c.unsafeInterruptAsFork(ebS)},{once:!0})})}},eyL=e=>`http.request.header.${e}`,eyU=e=>`http.response.header.${e}`,eyB=Symbol.for("@effect/platform/HttpClientError");class eyq extends emO(eyB,"RequestError"){get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){return this.description?`${this.reason}: ${this.description} (${this.methodAndUrl})`:`${this.reason} error (${this.methodAndUrl})`}}class eyJ extends emO(eyB,"ResponseError"){get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){let e=`${this.response.status} ${this.methodAndUrl}`;return this.description?`${this.reason}: ${this.description} (${e})`:`${this.reason} error (${e})`}}let eyH=Symbol.for("@effect/platform/HttpClientRequest"),eyW={[eyH]:eyH,...DS,toJSON(){return{_id:"@effect/platform/HttpClientRequest",method:this.method,url:this.url,urlParams:this.urlParams,hash:this.hash,headers:DC(this.headers),body:this.body.toJSON()}},pipe(){return DF(this,arguments)}};function eyK(e,t,r,n,i,s){let a=Object.create(eyW);return a.method=e,a.url=t,a.urlParams=r,a.hash=n,a.headers=i,a.body=s,a}let eyV=eyK("GET","",[],PY(),em9,emz),eyG=e=>(t,r)=>ey3(eyV,{method:e,url:t,...r??void 0}),eyZ=eyG("GET"),eyQ=eyG("POST"),eyY=eyG("PUT"),eyX=eyG("PATCH"),ey0=eyG("DELETE"),ey1=eyG("HEAD"),ey2=eyG("OPTIONS"),ey3=jN(2,(e,t)=>{let r=e;return t.method&&(r=ey7(r,t.method)),t.url&&(r=ey9(r,t.url)),t.headers&&(r=ey4(r,t.headers)),t.urlParams&&(r=evr(r,t.urlParams)),t.hash&&(r=evn(r,t.hash)),t.body&&(r=evi(r,t.body)),t.accept&&(r=ey6(r,t.accept)),t.acceptJson&&(r=ey8(r)),r}),ey5=jN(3,(e,t,r)=>eyK(e.method,e.url,e.urlParams,e.hash,ebt(e.headers,t,r),e.body)),ey4=jN(2,(e,t)=>eyK(e.method,e.url,e.urlParams,e.hash,ebr(e.headers,t),e.body)),ey6=jN(2,(e,t)=>ey5(e,"Accept",t)),ey8=ey6("application/json"),ey7=jN(2,(e,t)=>eyK(t,e.url,e.urlParams,e.hash,e.headers,e.body)),ey9=jN(2,(e,t)=>{if("string"==typeof t)return eyK(e.method,t,e.urlParams,e.hash,e.headers,e.body);let r=new URL(t.toString()),n=emN(r.searchParams),i=r.hash?Pe(r.hash.slice(1)):PY();return r.search="",r.hash="",eyK(e.method,r.toString(),n,i,e.headers,e.body)}),eve=jN(2,(e,t)=>eyK(e.method,t.endsWith("/")&&e.url.startsWith("/")?t+e.url.slice(1):t+e.url,e.urlParams,e.hash,e.headers,e.body)),evt=jN(3,(e,t,r)=>eyK(e.method,e.url,emj(e.urlParams,t,r),e.hash,e.headers,e.body)),evr=jN(2,(e,t)=>eyK(e.method,e.url,emA(e.urlParams,t),e.hash,e.headers,e.body)),evn=jN(2,(e,t)=>eyK(e.method,e.url,e.urlParams,Pe(t),e.headers,e.body)),evi=jN(2,(e,t)=>{let r=e.headers;if("Empty"===t._tag||"FormData"===t._tag)r=ebi(r,["Content-type","Content-length"]);else{let e=t.contentType;e&&(r=ebt(r,"content-type",e));let n=t.contentLength;n&&(r=ebt(r,"content-length",n.toString()))}return eyK(e.method,e.url,e.urlParams,e.hash,r,t)}),evs=jN(2,(e,t)=>JX(emq(t),t=>evi(e,t))),eva=Symbol.for("@effect/platform/HttpClientResponse");class evo extends Dx{request;source;[ebF];[eva];constructor(e,t){super(),this.request=e,this.source=t,this[ebF]=ebF,this[eva]=eva}toJSON(){return ebR(this,{_id:"@effect/platform/HttpClientResponse",request:this.request.toJSON(),status:this.status})}get status(){return this.source.status}get headers(){return ebe(this.source.headers)}cachedCookies;get cookies(){return this.cachedCookies?this.cachedCookies:this.cachedCookies=(e=>{let t=[];for(let r of"string"==typeof e?[e]:e){let e=function(e){let t=e.split(";").map(e=>e.trim()).filter(e=>""!==e);if(0===t.length)return PY();let r=t[0].indexOf("=");if(-1===r)return PY();let n=t[0].slice(0,r);if(!em0.test(n))return PY();let i=t[0].slice(r+1),s=em4(i);if(1===t.length)return Pe(Object.assign(Object.create(em1),{name:n,value:s,valueEncoded:i}));let a={};for(let e=1;e<t.length;e++){let r=t[e],n=r.indexOf("="),i=-1===n?r:r.slice(0,n).trim(),s=-1===n?void 0:r.slice(n+1).trim();switch(i.toLowerCase()){case"domain":{if(void 0===s)break;let e=s.trim().replace(/^\./,"");e&&(a.domain=e);break}case"expires":{if(void 0===s)break;let e=new Date(s);isNaN(e.getTime())||(a.expires=e);break}case"max-age":{if(void 0===s)break;let e=parseInt(s,10);isNaN(e)||(a.maxAge=UW(e));break}case"path":if(void 0===s)break;"/"===s[0]&&(a.path=s);break;case"priority":if(void 0===s)break;switch(s.toLowerCase()){case"low":a.priority="low";break;case"medium":a.priority="medium";break;case"high":a.priority="high"}break;case"httponly":a.httpOnly=!0;break;case"secure":a.secure=!0;break;case"partitioned":a.partitioned=!0;break;case"samesite":if(void 0===s)break;switch(s.toLowerCase()){case"lax":a.sameSite="lax";break;case"strict":a.sameSite="strict";break;case"none":a.sameSite="none"}}}return Pe(Object.assign(Object.create(em1),{name:n,value:s,valueEncoded:i,options:Object.keys(a).length>0?a:void 0}))}(r.trim());D7(e)&&t.push(e.value)}return emY(t)})(this.source.headers.getSetCookie())}get remoteAddress(){return PY()}get stream(){return this.source.body?ecq(()=>this.source.body,e=>new eyJ({request:this.request,response:this,reason:"Decode",cause:e})):euM(new eyJ({request:this.request,response:this,reason:"EmptyBody",description:"can not create stream from empty body"}))}get json(){return ZC(this.text,{try:e=>""===e?null:JSON.parse(e),catch:e=>new eyJ({request:this.request,response:this,reason:"Decode",cause:e})})}textBody;get text(){return this.textBody??=ZE({try:()=>this.source.text(),catch:e=>new eyJ({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(eng,eeX)}get urlParamsBody(){return JU(this.text,e=>Zs({try:()=>emN(new URLSearchParams(e)),catch:e=>new eyJ({request:this.request,response:this,reason:"Decode",cause:e})}))}formDataBody;get formData(){return this.formDataBody??=ZE({try:()=>this.source.formData(),catch:e=>new eyJ({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(eng,eeX)}arrayBufferBody;get arrayBuffer(){return this.arrayBufferBody??=ZE({try:()=>this.source.arrayBuffer(),catch:e=>new eyJ({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(eng,eeX)}}(e,t)=>J9(()=>t(e.status)?J7(e):JD(new eyJ({response:e,request:e.request,reason:"StatusCode",description:"invalid status code"})));let evl=e=>e.status>=200&&e.status<300?J7(e):JD(new eyJ({response:e,request:e.request,reason:"StatusCode",description:"non 2xx status code"})),evu=Symbol.for("@effect/platform/HttpClient"),evc=Py("@effect/platform/HttpClient"),evh=jL(Symbol.for("@effect/platform/HttpClient/tracerDisabledWhen"),()=>Hj(jD)),evf=jL(Symbol.for("@effect/platform/HttpClient/currentTracerPropagation"),()=>Hj(!0)),evp=PS()("@effect/platform/HttpClient/SpanNameGenerator",{defaultValue:()=>e=>`http.client ${e.method}`}),evd={[evu]:evu,pipe(){return DF(this,arguments)},...DS,toJSON:()=>({_id:"@effect/platform/HttpClient"}),get(e,t){return this.execute(eyZ(e,t))},head(e,t){return this.execute(ey1(e,t))},post(e,t){return this.execute(eyQ(e,t))},put(e,t){return this.execute(eyY(e,t))},patch(e,t){return this.execute(eyX(e,t))},del(e,t){return this.execute(ey0(e,t))},options(e,t){return this.execute(ey2(e,t))}},evg=(e,t)=>{let r=Object.create(evd);return r.preprocess=t,r.postprocess=e,r.execute=function(r){return e(t(r))},r},evm=jL("@effect/platform/HttpClient/responseRegistry",()=>{if("FinalizationRegistry"in globalThis&&globalThis.FinalizationRegistry){let e=new FinalizationRegistry(e=>{e.abort()});return{register(t,r){e.register(t,r,t)},unregister(t){e.unregister(t)}}}let e=new Map;return{register(t,r){e.set(t,setTimeout(()=>r.abort(),5e3))},unregister(t){let r=e.get(t);void 0!==r&&(clearTimeout(r),e.delete(t))}}}),evb=jL("@effect/platform/HttpClient/scopedRequests",()=>new WeakMap);class evy{original;controller;constructor(e,t){this.original=e,this.controller=t}[eva]=eva;[ebF]=ebF;applyInterrupt(e){return J9(()=>(evm.unregister(this.original),J3(e,()=>He(()=>{this.controller.abort()}))))}get request(){return this.original.request}get status(){return this.original.status}get headers(){return this.original.headers}get cookies(){return this.original.cookies}get remoteAddress(){return this.original.remoteAddress}get formData(){return this.applyInterrupt(this.original.formData)}get text(){return this.applyInterrupt(this.original.text)}get json(){return this.applyInterrupt(this.original.json)}get urlParamsBody(){return this.applyInterrupt(this.original.urlParamsBody)}get arrayBuffer(){return this.applyInterrupt(this.original.arrayBuffer)}get stream(){return ecS(()=>(evm.unregister(this.original),euR(this.original.stream,e=>((e=>{switch(e._tag){case DR:return D7(Ur(e.effect_instruction_i0));case Dj:return!1}})(e)&&this.controller.abort(),Hs))))}toJSON(){return this.original.toJSON()}[Dy](){return this.original[Dy]()}}let{del:evv,execute:evS,get:evx,head:ev_,options:evw,patch:evk,post:evO,put:evE}=new Proxy({},{get:(e,t,r)=>(...e)=>JU(evc,r=>r[t](...e))}),evC=jN(2,(e,t)=>evg(r=>t(e.postprocess(r)),e.preprocess)),evF=jN(2,(e,t)=>evg(e.postprocess,r=>JX(e.preprocess(r),t))),evI=e=>evC(e,JU(evl)),evT=e=>ecN(JX(e,e=>e.stream)),evR=/\+/g,evN=function(){};evN.prototype=Object.create(null);let evM=/^https?:\/\/.*?\//,evA=/(\/:[^/()]*?)\?(\/?)/;class evj{constructor(e={}){this.options={ignoreTrailingSlash:!0,ignoreDuplicateSlashes:!0,caseSensitive:!1,maxParamLength:100,...e}}options;routes=[];trees={};on(e,t,r){let n=t.match(evA);if(n&&void 0!==n.index){evB(t.length===n.index+n[0].length,"Optional Parameter needs to be the last parameter of the path");let i=t.replace(evA,"$1$2"),s=t.replace(evA,"$2");this.on(e,i,r),this.on(e,s,r);return}for(let n of(this.options.ignoreDuplicateSlashes&&(t=evq(t)),this.options.ignoreTrailingSlash&&(t=evJ(t)),"string"==typeof e?[e]:e))this._on(n,t,r)}all(e,t){this.on(evK,e,t)}_on(e,t,r){void 0===this.trees[e]&&(this.trees[e]=new evz("/"));let n=t;if("*"===n&&0!==this.trees[e].prefix.length){let t=this.trees[e];this.trees[e]=new evz(""),this.trees[e].staticChildren["/"]=t}let i=this.trees[e].prefix.length,s=this.trees[e],a=[];for(let e=0;e<=n.length;e++){if(58===n.charCodeAt(e)&&58===n.charCodeAt(e+1)){e++;continue}let t=58===n.charCodeAt(e)&&58!==n.charCodeAt(e+1),r=42===n.charCodeAt(e);if(t||r||e===n.length&&e!==i){let t=n.slice(i,e);this.options.caseSensitive||(t=t.toLowerCase()),t=(t=t.split("::").join(":")).split("%").join("%25"),s=s.createStaticChild(t)}if(t){let t=!1,r=[],l=e+1;for(let u=l;;u++){let c=n.charCodeAt(u),h=40===c,f=45===c||46===c,p=47===c||u===n.length;if(h||f||p){let c=n.slice(l,u);if(a.push(c),t=t||h||f,h){var o;let e=function(e,t){let r=1;for(;t<e.length;){if("\\"===e[++t]){t++;continue}if(")"===e[t]?r--:"("===e[t]&&r++,!r)return t}throw TypeError('Invalid regexp expression in "'+e+'"')}(n,u),t=n.slice(u,e+1);r.push((94===(o=t).charCodeAt(1)&&(o=o.slice(0,1)+o.slice(2)),36===o.charCodeAt(o.length-2)&&(o=o.slice(0,o.length-2)+o.slice(o.length-1)),o)),u=e+1}else r.push("(.*?)");let d=u;for(;u<n.length;u++){let e=n.charCodeAt(u);if(47===e)break;if(58===e)if(58===n.charCodeAt(u+1))u++;else break}let g=n.slice(d,u);if(g&&(g=(g=g.split("::").join(":")).split("%").join("%25"),r.push(g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))),l=u+1,p||47===n.charCodeAt(u)||u===n.length){let a=t?"()"+g:g,o=n.slice(e,u);n=n.slice(0,e+1)+a+n.slice(u),e+=a.length;let l=t?RegExp("^"+r.join("")+"$"):void 0;s=s.createParametricChild(l,g,o),i=e+1;break}}}}else if(r&&(a.push("*"),s=s.createWildcardChild(),i=e+1,e!==n.length-1))throw Error("Wildcard must be the last character in the route")}for(let t of(this.options.caseSensitive||(n=n.toLowerCase()),"*"===n&&(n="/*"),this.routes))if(t.method===e&&t.pattern===n)throw Error(`Method '${e}' already declared for route '${n}'`);let l={method:e,path:t,pattern:n,params:a,handler:r};this.routes.push(l),s.addRoute(l)}has(e,t){let r=this.trees[e];if(void 0===r)return!1;let n=r.getStaticChild(t);return void 0!==n&&n.isLeafNode}find(e,t){let r,n,i,s=this.trees[e];if(void 0===s)return;47!==t.charCodeAt(0)&&(t=t.replace(evM,"/")),this.options.ignoreDuplicateSlashes&&(t=evq(t));try{t=(r=function(e){let t=!1,r=!1,n="";for(let i=1;i<e.length;i++){let s=e.charCodeAt(i);if(37===s){let n=e.charCodeAt(i+1),s=e.charCodeAt(i+2);void 0===evH(n,s)?t=!0:(r=!0,50===n&&53===s&&(t=!0,e=e.slice(0,i+1)+"25"+e.slice(i+1),i+=2),i+=2)}else if(63===s||59===s||35===s){n=e.slice(i+1),e=e.slice(0,i);break}}return{path:t?decodeURI(e):e,querystring:n,shouldDecodeParam:r}}(t)).path,n=r.querystring,i=r.shouldDecodeParam}catch(e){return}this.options.ignoreTrailingSlash&&(t=evJ(t));let a=t;!1===this.options.caseSensitive&&(t=t.toLowerCase());let o=this.options.maxParamLength,l=s.prefix.length,u=[],c=t.length,h=[];for(;;){if(l===c&&s.isLeafNode){let e=s.handlerStorage?.find();if(void 0!==e)return{handler:e.handler,params:e.createParams(u),searchParams:function(e){let t=new evN;if("string"!=typeof e)return t;let r=e.length,n="",i="",s=-1,a=-1,o=!1,l=!1,u=!1,c=!1,h=!1,f=0;for(let p=0;p<r+1;p++)if(38===(f=p!==r?e.charCodeAt(p):38)){if((h=a>s)||(a=p),n=e.slice(s+1,a),h||n.length>0){if(u&&(n=n.replace(evR," ")),o)try{n=decodeURIComponent(n)||n}catch{}if(h&&(i=e.slice(a+1,p),c&&(i=i.replace(evR," ")),l))try{i=decodeURIComponent(i)||i}catch{}let r=t[n];void 0===r?t[n]=i:r.pop?r.push(i):t[n]=[r,i]}i="",s=p,a=p,o=!1,l=!1,u=!1,c=!1}else 61===f?a<=s?a=p:l=!0:43===f?a>s?c=!0:u=!0:37===f&&(a>s?l=!0:o=!0);return t}(n)}}let e=s.getNextNode(t,l,h,u.length);if(void 0===e){if(0===h.length)return;let t=h.pop();l=t.brotherPathIndex,u.splice(t.paramsCount),e=t.brotherNode}if("StaticNode"===(s=e)._tag){l+=s.prefix.length;continue}if("WildcardNode"===s._tag){let e=a.slice(l);i&&(e=evW(e)),u.push(e),l=c;continue}if("ParametricNode"===s._tag){let e=a.indexOf("/",l);-1===e&&(e=c);let t=a.slice(l,e);if(i&&(t=evW(t)),void 0!==s.regex){let e=s.regex.exec(t);if(null===e)continue;for(let t=1;t<e.length;t++){let r=e[t];if(r.length>o)return;u.push(r)}}else{if(t.length>o)return;u.push(t)}l=e}}}}class evD{handlers=[];unconstrainedHandler;find(){return this.unconstrainedHandler}add(e){var t;let r,n={params:e.params,handler:e.handler,createParams:(r=(t=e.params).length,function(e){let n={};for(let i=0;i<r;i++)n[t[i]]=e[i];return n})};this.handlers.push(n),this.unconstrainedHandler=this.handlers[0]}}class evP{isLeafNode=!1;routes;handlerStorage;addRoute(e){void 0===this.routes?this.routes=[e]:this.routes.push(e),void 0===this.handlerStorage&&(this.handlerStorage=new evD),this.isLeafNode=!0,this.handlerStorage.add(e)}}class ev$ extends evP{staticChildren={};findStaticMatchingChild(e,t){let r=this.staticChildren[e.charAt(t)];if(void 0!==r&&r.matchPrefix(e,t))return r}getStaticChild(e,t=0){if(e.length===t)return this;let r=this.findStaticMatchingChild(e,t);if(void 0!==r)return r.getStaticChild(e,t+r.prefix.length)}createStaticChild(e){if(0===e.length)return this;let t=this.staticChildren[e.charAt(0)];if(t){let r=1;for(;r<t.prefix.length;r++)if(e.charCodeAt(r)!==t.prefix.charCodeAt(r)){t=t.split(this,r);break}return t.createStaticChild(e.slice(r))}let r=e.charAt(0);return this.staticChildren[r]=new evz(e),this.staticChildren[r]}}class evz extends ev${_tag="StaticNode";constructor(e){super(),this.setPrefix(e)}prefix;matchPrefix;parametricChildren=[];wildcardChild;setPrefix(e){if(this.prefix=e,1===e.length)this.matchPrefix=(e,t)=>!0;else{let t=e.length;this.matchPrefix=function(e,r){for(let n=1;n<t;n++)if(e.charCodeAt(r+n)!==this.prefix.charCodeAt(n))return!1;return!0}}}getParametricChild(e){if(void 0===e)return this.parametricChildren.find(e=>!1===e.isRegex);let t=e.source;return this.parametricChildren.find(e=>void 0!==e.regex&&e.regex.source===t)}createParametricChild(e,t,r){let n=this.getParametricChild(e);return void 0!==n?n.nodePaths.add(r):(n=new evL(e,t,r),this.parametricChildren.push(n),this.parametricChildren.sort((e,t)=>e.isRegex?t.isRegex?void 0===e.staticSuffix?1:void 0===t.staticSuffix?-1:t.staticSuffix.endsWith(e.staticSuffix)?1:e.staticSuffix.endsWith(t.staticSuffix)?-1:0:-1:1)),n}createWildcardChild(){return void 0===this.wildcardChild&&(this.wildcardChild=new evU),this.wildcardChild}split(e,t){let r=this.prefix.slice(0,t),n=this.prefix.slice(t);this.setPrefix(n);let i=new evz(r);return i.staticChildren[n.charAt(0)]=this,e.staticChildren[r.charAt(0)]=i,i}getNextNode(e,t,r,n){let i=this.findStaticMatchingChild(e,t),s=0;if(void 0===i){if(0===this.parametricChildren.length)return this.wildcardChild;i=this.parametricChildren[0],s=1}void 0!==this.wildcardChild&&r.push({paramsCount:n,brotherPathIndex:t,brotherNode:this.wildcardChild});for(let e=this.parametricChildren.length-1;e>=s;e--)r.push({paramsCount:n,brotherPathIndex:t,brotherNode:this.parametricChildren[e]});return i}}class evL extends ev${regex;staticSuffix;_tag="ParametricNode";constructor(e,t,r){super(),this.regex=e,this.staticSuffix=t,this.isRegex=!!e,this.nodePaths=new Set([r])}isRegex;nodePaths;getNextNode(e,t){return this.findStaticMatchingChild(e,t)}}class evU extends evP{_tag="WildcardNode";getNextNode(e,t,r,n){}}let evB=(e,t)=>{if(!e)throw Error(t)};function evq(e){return e.replace(/\/\/+/g,"/")}function evJ(e){return e.length>1&&47===e.charCodeAt(e.length-1)?e.slice(0,-1):e}function evH(e,t){return 50===e?53===t?"%":51===t?"#":52===t?"$":54===t?"&":66===t||98===t?"+":67===t||99===t?",":70===t||102===t?"/":void 0:51===e?65===t||97===t?":":66===t||98===t?";":68===t||100===t?"=":70===t||102===t?"?":void 0:52===e&&48===t?"@":void 0}function evW(e){let t=e.indexOf("%");if(-1===t)return e;let r="",n=t;for(let i=t;i<e.length;i++)if(37===e.charCodeAt(i)){let t=evH(e.charCodeAt(i+1),e.charCodeAt(i+2));r+=e.slice(n,i)+t,n=i+3}return e.slice(0,t)+r+e.slice(n)}let evK=["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE"],evV=Symbol.for("@effect/platform/Etag/Generator"),evG=Py("@effect/platform/Etag/Generator"),evZ=Py("@effect/platform/HttpServer"),evQ=jN(e=>Jy(e[0]),(e,t)=>etp(JU(evZ,r=>r.serve(e,t))));JU(evZ,e=>(e=>JU(evc,t=>{if("UnixAddress"===e._tag)return JN(Error("HttpServer.layerTestClient: UnixAddress not supported"));let r="0.0.0.0"===e.hostname?"127.0.0.1":e.hostname;return J7(evF(t,eve(`http://${r}:${e.port}`)))}))(e.address));let evY=Symbol.for("@effect/platform/HttpRouter"),evX=Symbol.for("@effect/platform/HttpRouter/Route"),ev0=Symbol.for("@effect/platform/HttpRouter/RouteContext"),ev1=Py("@effect/platform/HttpRouter/RouteContext"),ev2=jL("@effect/platform/HttpRouter/currentRouterConfig",()=>Hj({}));class ev3 extends KY{routes;mounts;[evY];constructor(e,t){super(),this.routes=e,this.mounts=t,this[evY]=evY,this.httpApp=ev5(this).pipe(JU(e=>this.httpApp=e))}httpApp;commit(){return this.httpApp}toJSON(){return{_id:"Router",routes:this.routes.toJSON(),mounts:this.mounts.toJSON()}}toString(){return JSON.stringify(this,null,2)}[Dy](){return this.toJSON()}}let ev5=e=>JX(HO(ev2),t=>{let r=((e={})=>new evj(e))(t),n=zv(e.mounts).map(([e,t,r])=>[e,new ev8(new ev6("*",r?.includePrefix?`${e}/*`:"/*",t,r?.includePrefix?PY():Pe(e),!1),{}),r]),i=n.length;return zA(e.routes,e=>{"*"===e.method?r.all(e.path,e):r.on(e.method,e.path,e)}),Jv(e=>{let t=Pl(new Map(e.getFiberRef(H$).unsafeMap)),s=Pg(t,eyE);if(i>0){let e=s.url.indexOf("?"),r=-1===e?s.url:s.url.slice(0,e);for(let e=0;e<i;e++){let[i,a,o]=n[e];if(r===i||r.startsWith(i+"/"))return t.unsafeMap.set(ev1.key,a),o?.includePrefix!==!0&&t.unsafeMap.set(eyE.key,ev4(s,i)),HM(JU(a.route.handler,eby),H$,t)}}let a=r.find(s.method,s.url);if(void 0===a&&"HEAD"===s.method&&(a=r.find("GET",s.url)),void 0===a)return JD(new ebE({request:s}));let o=a.handler;"Some"===o.prefix._tag&&t.unsafeMap.set(eyE.key,ev4(s,o.prefix.value)),t.unsafeMap.set(eyC.key,a.searchParams),t.unsafeMap.set(ev1.key,new ev8(o,a.params));let l=Pm(t,K$);"Some"===l._tag&&"Span"===l.value._tag&&l.value.attribute("http.route",o.path);let u=JU(o.handler,eby);return HM(o.uninterruptible?u:JQ(u),H$,t)})});function ev4(e,t){let r=t.length;return e.modify({url:e.url.length<=r?"/":e.url.slice(r)})}class ev6 extends Dx{method;path;handler;prefix;uninterruptible;[evX];constructor(e,t,r,n=PY(),i=!1){super(),this.method=e,this.path=t,this.handler=r,this.prefix=n,this.uninterruptible=i,this[evX]=evX}toJSON(){return{_id:"@effect/platform/HttpRouter/Route",method:this.method,path:this.path,prefix:this.prefix.toJSON()}}}class ev8{route;params;[ev0];constructor(e,t){this.route=e,this.params=t,this[ev0]=ev0}}let ev7=new ev3(zd(),zd()),ev9=jN(2,(e,t)=>new ev3(zO(e.routes,t),e.mounts)),eSe=jN(2,(e,t)=>eSt(e,t)),eSt=(...e)=>new ev3(e.reduce((e,t)=>zT(e,t.routes),zd()),e.reduce((e,t)=>zT(e,t.mounts),zd())),eSr=e=>e.endsWith("/")?e.slice(0,-1):e,eSn=jN(2,(e,t)=>(t=eSr(t),new ev3(zU(e.routes,e=>new ev6(e.method,"/"===e.path?t:t+e.path,e.handler,P1(P7(e.prefix,e=>t+e),()=>Pe(t)),e.uninterruptible)),zU(e.mounts,([e,r])=>["/"===e?t:t+e,r])))),eSi=jN(3,(e,t,r)=>eSe(e,eSn(r,t))),eSs=jN(e=>jZ(e[0],evY),(e,t,r,n)=>new ev3(e.routes,zO(e.mounts,[eSr(t),r,n]))),eSa=e=>jN(e=>jZ(e[0],evY),(t,r,n,i)=>new ev3(zO(t.routes,new ev6(e,r,n,PY(),i?.uninterruptible??!1)),t.mounts)),eSo=eSa("*"),eSl=eSa("GET"),eSu=eSa("POST"),eSc=eSa("PUT"),eSh=eSa("PATCH"),eSf=eSa("DELETE"),eSp=eSa("HEAD"),eSd=eSa("OPTIONS"),eSg=jN(2,(e,t)=>new ev3(zU(e.routes,e=>new ev6(e.method,e.path,t(JU(e.handler,eby)),e.prefix,e.uninterruptible)),zU(e.mounts,([e,r])=>[e,t(r)]))),eSm=((e,t)=>new ev3(zU(e.routes,e=>new ev6(e.method,e.path,t(e.handler),e.prefix,e.uninterruptible)),zU(e.mounts,([e,r])=>[e,JU(t(r),eby)])),()=>{let e=ev7;return{addRoute:t=>He(()=>{e=ev9(e,t)}),all:(t,r,n)=>He(()=>{e=eSo(e,t,r,n)}),get:(t,r,n)=>He(()=>{e=eSl(e,t,r,n)}),post:(t,r,n)=>He(()=>{e=eSu(e,t,r,n)}),put:(t,r,n)=>He(()=>{e=eSc(e,t,r,n)}),patch:(t,r,n)=>He(()=>{e=eSh(e,t,r,n)}),del:(t,r,n)=>He(()=>{e=eSf(e,t,r,n)}),head:(t,r,n)=>He(()=>{e=eSp(e,t,r,n)}),options:(t,r,n)=>He(()=>{e=eSd(e,t,r,n)}),router:He(()=>e),mount:(t,r)=>He(()=>{e=eSi(e,t,r)}),mountApp:(t,r,n)=>He(()=>{e=eSs(e,t,r,n)}),concat:t=>He(()=>{e=eSe(e,t)})}}),eSb=Symbol.for("@effect/matcher/Matcher"),eSy={[eSb]:{_input:ih,_filters:ih,_remaining:ih,_result:ih,_return:ih},_tag:"TypeMatcher",add(e){return function(e){let t=Object.create(eSy);return t.cases=e,t}([...this.cases,e])},pipe(){return sp(this,arguments)}},eSv={[eSb]:{_input:ih,_filters:ih,_remaining:ih,_result:ih,_provided:ih,_return:ih},_tag:"ValueMatcher",add(e){return"Right"===this.value._tag?this:"When"===e._tag&&!0===e.guard(this.provided)||"Not"===e._tag&&!1===e.guard(this.provided)?eSS(this.provided,s3(e.evaluate(this.provided))):this},pipe(){return sp(this,arguments)}};function eSS(e,t){let r=Object.create(eSv);return r.provided=e,r.value=t,r}let eSx=(e,t)=>({_tag:"When",guard:e,evaluate:t}),eS_=e=>{if("function"==typeof e)return e;if(Array.isArray(e)){let t=e.map(eS_),r=t.length;return e=>{if(!Array.isArray(e))return!1;for(let n=0;n<r;n++)if(!1===t[n](e[n]))return!1;return!0}}if(null!==e&&"object"==typeof e){let t=Object.entries(e).map(([e,t])=>[e,eS_(t)]),r=t.length;return e=>{if("object"!=typeof e||null===e)return!1;for(let n=0;n<r;n++){let[r,i]=t[n];if(!(r in e)||!1===i(e[r]))return!1}return!0}}return t=>t===e},eSw=e=>{if("ValueMatcher"===e._tag)return e.value;let t=e.cases.length;if(1===t){let t=e.cases[0];return e=>"When"===t._tag&&!0===t.guard(e)||"Not"===t._tag&&!1===t.guard(e)?s3(t.evaluate(e)):s2(e)}return r=>{for(let n=0;n<t;n++){let t=e.cases[n];if("When"===t._tag&&!0===t.guard(r)||"Not"===t._tag&&!1===t.guard(r))return s3(t.evaluate(r))}return s2(r)}},eSk=(e,t)=>r=>r.add(eSx(eS_(e),t)),eSO=Symbol.for("effect/QueueEnqueue"),eSE=Symbol.for("effect/QueueDequeue"),eSC=Symbol.for("effect/QueueStrategy"),eSF=Symbol.for("effect/BackingQueue"),eSI={_A:e=>e},eST={_A:e=>e},eSR={_In:e=>e},eSN={_Out:e=>e};class eSM extends b${queue;takers;shutdownHook;shutdownFlag;strategy;[eSO]=eSR;[eSE]=eSN;constructor(e,t,r,n,i){super(),this.queue=e,this.takers=t,this.shutdownHook=r,this.shutdownFlag=n,this.strategy=i}pipe(){return sp(this,arguments)}commit(){return this.take}capacity(){return this.queue.capacity()}get size(){return dt(()=>pI(this.unsafeSize(),()=>pY))}unsafeSize(){if(this.shutdownFlag.current)return ah();return sV(this.queue.length()-this.takers.queue._length+this.strategy.surplusSize())}get isEmpty(){return p2(this.size,e=>e<=0)}get isFull(){return p2(this.size,e=>e>=this.capacity())}get shutdown(){return ds(pS(e=>(ib(this.shutdownFlag,hs(!0)),ib(wT(eSZ(this.takers),t=>gW(t,e.id()),!1,!1),dm(this.strategy.shutdown),du(gK(this.shutdownHook,void 0)),pw))))}get isShutdown(){return dr(()=>this.shutdownFlag.current)}get awaitShutdown(){return gB(this.shutdownHook)}isActive(){return!this.shutdownFlag.current}unsafeOffer(e){let t;if(this.shutdownFlag.current)return!1;if(0===this.queue.length()){let r=ib(this.takers,Ca(Ce));r!==Ce?(eSV(r,e),t=!0):t=!1}else t=!1;if(t)return!0;let r=this.queue.offer(e);return eSX(this.strategy,this.queue,this.takers),r}offer(e){return dt(()=>{let t;if(this.shutdownFlag.current)return pY;if(0===this.queue.length()){let r=ib(this.takers,Ca(Ce));r!==Ce?(eSV(r,e),t=!0):t=!1}else t=!1;if(t)return de(!0);let r=this.queue.offer(e);return eSX(this.strategy,this.queue,this.takers),r?de(!0):this.strategy.handleSurplus([e],this.queue,this.takers,this.shutdownFlag)})}offerAll(e){return dt(()=>{if(this.shutdownFlag.current)return pY;let t=a$(e),r=0===this.queue.length()?a$(eSQ(this.takers,t.length)):ou,[n,i]=ib(t,or(r.length));for(let e=0;e<r.length;e++)eSV(r[e],n[e]);if(0===i.length)return de(!0);let s=this.queue.offerAll(i);return eSX(this.strategy,this.queue,this.takers),lv(s)?de(!0):this.strategy.handleSurplus(s,this.queue,this.takers,this.shutdownFlag)})}get take(){return pS(e=>{if(this.shutdownFlag.current)return pY;let t=this.queue.poll(Ce);if(t!==Ce)return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),de(t);{let t=gz(e.id());return ib(dt(()=>(ib(this.takers,Ci(t)),eSX(this.strategy,this.queue,this.takers),this.shutdownFlag.current?pY:gB(t))),p6(()=>dr(()=>eSY(this.takers,t))))}})}get takeAll(){return dt(()=>this.shutdownFlag.current?pY:dr(()=>{let e=this.queue.pollUpTo(1/0);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),lt(e)}))}takeUpTo(e){return dt(()=>this.shutdownFlag.current?pY:dr(()=>{let t=this.queue.pollUpTo(e);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),lt(t)}))}takeBetween(e,t){return dt(()=>eSA(this,e,t,o7()))}}let eSA=(e,t,r,n)=>r<t?de(n):ib(eSU(e,r),pB(i=>{let s=t-i.length;return 1===s?ib(eSL(e),p2(e=>ib(n,ld(i),lu(e)))):s>1?ib(eSL(e),pB(t=>eSA(e,s-1,r-i.length-1,ib(n,ld(i),lu(t))))):de(ib(n,ld(i)))})),eSj=(e,t)=>ib(gL(),p2(r=>{let n;return n=Cr(void 0),new eSM(e,n,r,hn(!1),t)}));class eSD{mutable;[eSF]=eST;constructor(e){this.mutable=e}poll(e){return Ca(this.mutable,e)}pollUpTo(e){return Co(this.mutable,e)}offerAll(e){return Cs(this.mutable,e)}offer(e){return Ci(this.mutable,e)}capacity(){let e;return void 0===(e=this.mutable).capacity?1/0:e.capacity}length(){return this.mutable.queue._length}}let eSP=e=>new eSD(e),eS$=ic(2,(e,t)=>e.offer(t)),eSz=ic(2,(e,t)=>e.offerAll(t)),eSL=e=>e.take,eSU=ic(2,(e,t)=>e.takeUpTo(t)),eSB=ic(3,(e,t,r)=>e.takeBetween(t,r)),eSq=ic(2,(e,t)=>e.takeBetween(t,t)),eSJ=()=>new eSW;class eSH{[eSC]=eSI;putters=Cr(void 0);surplusSize(){return this.putters.queue._length}onCompleteTakersWithEmptyQueue(e){for(;!Cn(this.putters)&&!Cn(e);){let t=Ca(e,void 0),r=Ca(this.putters,void 0);r[2]&&eSV(r[1],!0),eSV(t,r[0])}}get shutdown(){return ib(pL,pB(e=>ib(dr(()=>eSZ(this.putters)),pB(t=>wT(t,([t,r,n])=>n?ib(gW(r,e),pw):dl,!1,!1)))))}handleSurplus(e,t,r,n){return pS(i=>{let s=gz(i.id());return ib(dt(()=>(this.unsafeOffer(e,s),this.unsafeOnQueueEmptySpace(t,r),eSX(this,t,r),n.current?pY:gB(s))),p6(()=>dr(()=>this.unsafeRemove(s))))})}unsafeOnQueueEmptySpace(e,t){let r=!0;for(;r&&(e.capacity()===1/0||e.length()<e.capacity());){let n=ib(this.putters,Ca(Ce));if(n===Ce)r=!1;else{let r=e.offer(n[0]);r&&n[2]?eSV(n[1],!0):r||eSG(this.putters,ib(eSZ(this.putters),lc(n))),eSX(this,e,t)}}}unsafeOffer(e,t){let r=a$(e);for(let e=0;e<r.length;e++){let n=r[e];e===r.length-1?ib(this.putters,Ci([n,t,!0])):ib(this.putters,Ci([n,t,!1]))}}unsafeRemove(e){eSG(this.putters,ib(eSZ(this.putters),lm(([,t])=>t!==e)))}}class eSW{[eSC]=eSI;surplusSize(){return 0}get shutdown(){return dl}onCompleteTakersWithEmptyQueue(){}handleSurplus(e,t,r,n){return de(!1)}unsafeOnQueueEmptySpace(e,t){}}class eSK{[eSC]=eSI;surplusSize(){return 0}get shutdown(){return dl}onCompleteTakersWithEmptyQueue(){}handleSurplus(e,t,r,n){return dr(()=>(this.unsafeOffer(t,e),eSX(this,t,r),!0))}unsafeOnQueueEmptySpace(e,t){}unsafeOffer(e,t){let r,n=t[Symbol.iterator](),i=!0;for(;!(r=n.next()).done&&i;){if(0===e.capacity())return;e.poll(Ce),i=e.offer(r.value)}}}let eSV=(e,t)=>gV(e,de(t)),eSG=(e,t)=>ib(e,Cs(t)),eSZ=e=>ib(e,Co(1/0)),eSQ=(e,t)=>ib(e,Co(t)),eSY=(e,t)=>{eSG(e,ib(eSZ(e),lm(e=>t!==e)))},eSX=(e,t,r)=>{let n=!0;for(;n&&0!==t.length();){let i=ib(r,Ca(Ce));if(i!==Ce){let s=t.poll(Ce);s!==Ce?(eSV(i,s),e.unsafeOnQueueEmptySpace(t,r)):eSG(r,ib(eSZ(r),lc(i))),n=!0}else n=!1}n&&0===t.length()&&!Cn(r)&&e.onCompleteTakersWithEmptyQueue(r)},eS0=e=>ib(dr(()=>Cr(e)),pB(e=>eSj(eSP(e),new eSH))),eS1=e=>ib(dr(()=>Cr(e)),pB(e=>eSj(eSP(e),eSJ()))),eS2=e=>ib(dr(()=>Cr(e)),pB(e=>eSj(eSP(e),new eSK))),eS3=()=>ib(dr(()=>Cr(void 0)),pB(e=>eSj(eSP(e),eSJ()))),eS5=e=>e.shutdown,eS4=Symbol.for("effect/PubSub/AbsentValue"),eS6=(e,t)=>r=>{r.has(e)||r.set(e,new Set),r.get(e).add(t)},eS8=(e,t)=>r=>{if(!r.has(e))return;let n=r.get(e);n.delete(t),0===n.size&&r.delete(e)},eS7=e=>{let t="number"==typeof e?{capacity:e}:e;exf(t.capacity);let r=t.replay&&t.replay>0?new exO(Math.ceil(t.replay)):void 0;return 1===t.capacity?new exn(r):Math.max(Math.pow(2,Math.ceil(Math.log(t.capacity)/Math.log(2))),2)===t.capacity?new ext(t.capacity,r):new eS9(t.capacity,r)};class eS9{capacity;replayBuffer;array;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(e,t){this.capacity=e,this.replayBuffer=t,this.array=Array.from({length:e}),this.subscribers=Array.from({length:e})}replayWindow(){return this.replayBuffer?new exE(this.replayBuffer):exC}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(e){if(this.isFull())return!1;if(0!==this.subscriberCount){let t=this.publisherIndex%this.capacity;this.array[t]=e,this.subscribers[t]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),o7();let t=lt(e),r=t.length,n=this.publisherIndex-this.subscribersIndex,i=Math.min(r,this.capacity-n);if(0===i)return t;let s=0,a=this.publisherIndex+i;for(;this.publisherIndex!==a;){let e=ll(t,s++),r=this.publisherIndex%this.capacity;this.array[r]=e,this.subscribers[r]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(e)}return lf(t,s)}slide(){if(this.subscribersIndex!==this.publisherIndex){let e=this.subscribersIndex%this.capacity;this.array[e]=eS4,this.subscribers[e]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new exe(this,this.publisherIndex,!1)}}class exe{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let e=this.subscriberIndex%this.self.capacity,t=this.self.array[e];return this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=eS4,this.self.subscribersIndex+=1),this.subscriberIndex+=1,t}return e}pollUpTo(e){if(this.unsubscribed)return o7();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let t=Math.min(e,this.self.publisherIndex-this.subscriberIndex);if(t<=0)return o7();let r=[],n=this.subscriberIndex+t;for(;this.subscriberIndex!==n;){let e=this.subscriberIndex%this.self.capacity,t=this.self.array[e];this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=eS4,this.self.subscribersIndex+=1),r.push(t),this.subscriberIndex+=1}return lt(r)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let e=this.subscriberIndex%this.self.capacity;this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=eS4,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class ext{capacity;replayBuffer;array;mask;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(e,t){this.capacity=e,this.replayBuffer=t,this.array=Array.from({length:e}),this.mask=e-1,this.subscribers=Array.from({length:e})}replayWindow(){return this.replayBuffer?new exE(this.replayBuffer):exC}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(e){if(this.isFull())return!1;if(0!==this.subscriberCount){let t=this.publisherIndex&this.mask;this.array[t]=e,this.subscribers[t]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),o7();let t=lt(e),r=t.length,n=this.publisherIndex-this.subscribersIndex,i=Math.min(r,this.capacity-n);if(0===i)return t;let s=0,a=this.publisherIndex+i;for(;this.publisherIndex!==a;){let e=ll(t,s++),r=this.publisherIndex&this.mask;this.array[r]=e,this.subscribers[r]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(e)}return lf(t,s)}slide(){if(this.subscribersIndex!==this.publisherIndex){let e=this.subscribersIndex&this.mask;this.array[e]=eS4,this.subscribers[e]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new exr(this,this.publisherIndex,!1)}}class exr{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let e=this.subscriberIndex&this.self.mask,t=this.self.array[e];return this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=eS4,this.self.subscribersIndex+=1),this.subscriberIndex+=1,t}return e}pollUpTo(e){if(this.unsubscribed)return o7();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let t=Math.min(e,this.self.publisherIndex-this.subscriberIndex);if(t<=0)return o7();let r=[],n=this.subscriberIndex+t;for(;this.subscriberIndex!==n;){let e=this.subscriberIndex&this.self.mask,t=this.self.array[e];this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=eS4,this.self.subscribersIndex+=1),r.push(t),this.subscriberIndex+=1}return lt(r)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let e=this.subscriberIndex&this.self.mask;this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=eS4,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class exn{replayBuffer;publisherIndex=0;subscriberCount=0;subscribers=0;value=eS4;capacity=1;constructor(e){this.replayBuffer=e}replayWindow(){return this.replayBuffer?new exE(this.replayBuffer):exC}pipe(){return sp(this,arguments)}isEmpty(){return 0===this.subscribers}isFull(){return!this.isEmpty()}size(){return+!this.isEmpty()}publish(e){return!this.isFull()&&(0!==this.subscriberCount&&(this.value=e,this.subscribers=this.subscriberCount,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(e),!0)}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),o7();let t=lt(e);return lv(t)?t:this.publish(l_(t))?lf(t,1):t}slide(){this.isFull()&&(this.subscribers=0,this.value=eS4),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new exi(this,this.publisherIndex,!1)}}class exi{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||0===this.self.subscribers||this.subscriberIndex===this.self.publisherIndex}size(){return+!this.isEmpty()}poll(e){if(this.isEmpty())return e;let t=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=eS4),this.subscriberIndex+=1,t}pollUpTo(e){if(this.isEmpty()||e<1)return o7();let t=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=eS4),this.subscriberIndex+=1,le(t)}unsubscribe(){this.unsubscribed||(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex!==this.self.publisherIndex&&(this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=eS4)))}}class exs{replayBuffer;publisherHead={value:eS4,subscribers:0,next:null};publisherTail=this.publisherHead;publisherIndex=0;subscribersIndex=0;capacity=Number.MAX_SAFE_INTEGER;constructor(e){this.replayBuffer=e}replayWindow(){return this.replayBuffer?new exE(this.replayBuffer):exC}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(e){let t=this.publisherTail.subscribers;return 0!==t&&(this.publisherTail.next={value:e,subscribers:t,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0!==this.publisherTail.subscribers)for(let t of e)this.publish(t);else this.replayBuffer&&this.replayBuffer.offerAll(e);return o7()}slide(){this.publisherHead!==this.publisherTail&&(this.publisherHead=this.publisherHead.next,this.publisherHead.value=eS4,this.subscribersIndex+=1),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new exa(this,this.publisherTail,this.publisherIndex,!1)}}class exa{self;subscriberHead;subscriberIndex;unsubscribed;constructor(e,t,r,n){this.self=e,this.subscriberHead=t,this.subscriberIndex=r,this.unsubscribed=n}isEmpty(){if(this.unsubscribed)return!0;let e=!0,t=!0;for(;t;)this.subscriberHead===this.self.publisherTail?t=!1:this.subscriberHead.next.value!==eS4?(e=!1,t=!1):(this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1);return e}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;let t=!0,r=e;for(;t;)if(this.subscriberHead===this.self.publisherTail)t=!1;else{let e=this.subscriberHead.next.value;e!==eS4&&(r=e,this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=eS4,this.self.subscribersIndex+=1),t=!1),this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return r}pollUpTo(e){let t=[],r=0;for(;r!==e;){let n=this.poll(eS4);n===eS4?r=e:(t.push(n),r+=1)}return lt(t)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;this.subscriberHead!==this.self.publisherTail;)this.subscriberHead.next.value!==eS4&&(this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=eS4,this.self.subscribersIndex+=1)),this.subscriberHead=this.subscriberHead.next}}class exo extends b${pubsub;subscribers;subscription;pollers;shutdownHook;shutdownFlag;strategy;replayWindow;[eSE]=eSN;constructor(e,t,r,n,i,s,a,o){super(),this.pubsub=e,this.subscribers=t,this.subscription=r,this.pollers=n,this.shutdownHook=i,this.shutdownFlag=s,this.strategy=a,this.replayWindow=o}commit(){return this.take}pipe(){return sp(this,arguments)}capacity(){return this.pubsub.capacity}isActive(){return!this.shutdownFlag.current}get size(){return dt(()=>this.shutdownFlag.current?pY:de(this.subscription.size()+this.replayWindow.remaining))}unsafeSize(){return this.shutdownFlag.current?ah():sV(this.subscription.size()+this.replayWindow.remaining)}get isFull(){return dt(()=>this.shutdownFlag.current?pY:de(this.subscription.size()===this.capacity()))}get isEmpty(){return p2(this.size,e=>0===e)}get shutdown(){return ds(pS(e=>(hs(this.shutdownFlag,!0),ib(wI(exg(this.pollers),t=>gW(t,e.id()),!1),dm(dr(()=>{this.subscribers.delete(this.subscription),this.subscription.unsubscribe(),this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers)})),du(gK(this.shutdownHook,void 0)),pw))))}get isShutdown(){return dr(()=>this.shutdownFlag.current)}get awaitShutdown(){return gB(this.shutdownHook)}get take(){return pS(e=>{if(this.shutdownFlag.current)return pY;if(this.replayWindow.remaining>0)return de(this.replayWindow.take());let t=Cn(this.pollers)?this.subscription.poll(Ce):Ce;if(t!==Ce)return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),de(t);{let t=gz(e.id());return ib(dt(()=>(ib(this.pollers,Ci(t)),ib(this.subscribers,eS6(this.subscription,this.pollers)),this.strategy.unsafeCompletePollers(this.pubsub,this.subscribers,this.subscription,this.pollers),this.shutdownFlag.current?pY:gB(t))),p6(()=>dr(()=>exv(this.pollers,t))))}})}get takeAll(){return dt(()=>{if(this.shutdownFlag.current)return pY;let e=Cn(this.pollers)?exm(this.subscription):o7();return(this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),this.replayWindow.remaining>0)?de(ld(this.replayWindow.takeAll(),e)):de(e)})}takeUpTo(e){return dt(()=>{let t;if(this.shutdownFlag.current)return pY;if(this.replayWindow.remaining>=e)return de(this.replayWindow.takeN(e));this.replayWindow.remaining>0&&(t=this.replayWindow.takeAll(),e-=t.length);let r=Cn(this.pollers)?exb(this.subscription,e):o7();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),t?de(ld(t,r)):de(r)})}takeBetween(e,t){return dt(()=>exl(this,e,t,o7()))}}let exl=(e,t,r,n)=>r<t?de(n):ib(e.takeUpTo(r),pB(i=>{let s=t-i.length;return 1===s?ib(e.take,p2(e=>ib(n,ld(i),lu(e)))):s>1?ib(e.take,pB(t=>exl(e,s-1,r-i.length-1,ib(n,ld(i),lu(t))))):de(ib(n,ld(i)))}));class exu{pubsub;subscribers;scope;shutdownHook;shutdownFlag;strategy;[eSO]=eSR;[eSE]=eSN;constructor(e,t,r,n,i,s){this.pubsub=e,this.subscribers=t,this.scope=r,this.shutdownHook=n,this.shutdownFlag=i,this.strategy=s}capacity(){return this.pubsub.capacity}get size(){return dt(()=>this.shutdownFlag.current?pY:dr(()=>this.pubsub.size()))}unsafeSize(){return this.shutdownFlag.current?ah():sV(this.pubsub.size())}get isFull(){return p2(this.size,e=>e===this.capacity())}get isEmpty(){return p2(this.size,e=>0===e)}get awaitShutdown(){return gB(this.shutdownHook)}get isShutdown(){return dr(()=>this.shutdownFlag.current)}get shutdown(){return ds(pS(e=>(ib(this.shutdownFlag,hs(!0)),ib(this.scope.close(gC(uz(e.id()))),dm(this.strategy.shutdown),du(gK(this.shutdownHook,void 0)),pw))))}publish(e){return dt(()=>this.shutdownFlag.current?pY:this.pubsub.publish(e)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),de(!0)):this.strategy.handleSurplus(this.pubsub,this.subscribers,le(e),this.shutdownFlag))}isActive(){return!this.shutdownFlag.current}unsafeOffer(e){return!this.shutdownFlag.current&&!!this.pubsub.publish(e)&&(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),!0)}publishAll(e){return dt(()=>{if(this.shutdownFlag.current)return pY;let t=exy(this.pubsub,e);return(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),lv(t))?de(!0):this.strategy.handleSurplus(this.pubsub,this.subscribers,t,this.shutdownFlag)})}get subscribe(){let e,t,r,n=dn(wC([this.scope.fork(bU),(e=this.pubsub,t=this.subscribers,r=this.strategy,p2(gL(),n=>{let i,s,a,o,l,u;return i=e,s=t,a=e.subscribe(),o=Cr(void 0),l=n,u=hn(!1),new exo(i,s,a,o,l,u,r,i.replayWindow())}))]),e=>e[0].addFinalizer(()=>e[1].shutdown));return p2(wO(n,(e,t)=>e[0].close(t)),e=>e[1])}offer(e){return this.publish(e)}offerAll(e){return this.publishAll(e)}pipe(){return sp(this,arguments)}}let exc=(e,t)=>pB(wZ(),r=>p2(gL(),n=>exh(e,new Map,r,n,hn(!1),t))),exh=(e,t,r,n,i,s)=>new exu(e,t,r,n,i,s),exf=e=>{if(e<=0)throw new gm(`Cannot construct PubSub with capacity of ${e}`)},exp=(e,t)=>{gV(e,de(t))},exd=(e,t)=>ib(e,Cs(t)),exg=e=>ib(e,Co(1/0)),exm=e=>e.pollUpTo(1/0),exb=(e,t)=>e.pollUpTo(t),exy=(e,t)=>e.publishAll(t),exv=(e,t)=>{exd(e,ib(exg(e),lm(e=>e!==t)))};class exS{publishers=Cr(void 0);get shutdown(){return pB(pL,e=>pB(dr(()=>exg(this.publishers)),t=>wT(t,([t,r,n])=>n?ib(gW(r,e),pw):dl,!1,!1)))}handleSurplus(e,t,r,n){return pS(i=>{let s=gz(i.id());return ib(dt(()=>(this.unsafeOffer(r,s),this.unsafeOnPubSubEmptySpace(e,t),this.unsafeCompleteSubscribers(e,t),n.current?pY:gB(s))),p6(()=>dr(()=>this.unsafeRemove(s))))})}unsafeOnPubSubEmptySpace(e,t){let r=!0;for(;r&&!e.isFull();){let n=ib(this.publishers,Ca(Ce));if(n===Ce)r=!1;else{let r=e.publish(n[0]);r&&n[2]?exp(n[1],!0):r||exd(this.publishers,ib(exg(this.publishers),lc(n))),this.unsafeCompleteSubscribers(e,t)}}}unsafeCompletePollers(e,t,r,n){return exw(this,e,t,r,n)}unsafeCompleteSubscribers(e,t){return exk(this,e,t)}unsafeOffer(e,t){let r=e[Symbol.iterator](),n=r.next();if(!n.done)for(;;){let e=n.value;if((n=r.next()).done){ib(this.publishers,Ci([e,t,!0]));break}ib(this.publishers,Ci([e,t,!1]))}}unsafeRemove(e){exd(this.publishers,ib(exg(this.publishers),lm(([t,r])=>r!==e)))}}class exx{get shutdown(){return dl}handleSurplus(e,t,r,n){return de(!1)}unsafeOnPubSubEmptySpace(e,t){}unsafeCompletePollers(e,t,r,n){return exw(this,e,t,r,n)}unsafeCompleteSubscribers(e,t){return exk(this,e,t)}}class ex_{get shutdown(){return dl}handleSurplus(e,t,r,n){return dr(()=>(this.unsafeSlidingPublish(e,r),this.unsafeCompleteSubscribers(e,t),!0))}unsafeOnPubSubEmptySpace(e,t){}unsafeCompletePollers(e,t,r,n){return exw(this,e,t,r,n)}unsafeCompleteSubscribers(e,t){return exk(this,e,t)}unsafeSlidingPublish(e,t){let r=t[Symbol.iterator](),n=r.next();if(!n.done&&e.capacity>0){let t=n.value,i=!0;for(;i;){e.slide();let s=e.publish(t);s&&(n=r.next())&&!n.done?t=n.value:s&&(i=!1)}}}}let exw=(e,t,r,n,i)=>{let s=!0;for(;s&&!n.isEmpty();){let a=ib(i,Ca(Ce));if(a===Ce)ib(r,eS8(n,i)),Cn(i)?s=!1:ib(r,eS6(n,i));else{let s=n.poll(Ce);s===Ce?exd(i,ib(exg(i),lc(a))):(exp(a,s),e.unsafeOnPubSubEmptySpace(t,r))}}},exk=(e,t,r)=>{for(let[n,i]of r)for(let s of i)e.unsafeCompletePollers(t,r,n,s)};class exO{capacity;constructor(e){this.capacity=e}head={value:eS4,next:null};tail=this.head;size=0;index=0;slide(){this.index++}offer(e){this.tail.value=e,this.tail.next={value:eS4,next:null},this.tail=this.tail.next,this.size===this.capacity?this.head=this.head.next:this.size+=1}offerAll(e){for(let t of e)this.offer(t)}}class exE{buffer;head;index;remaining;constructor(e){this.buffer=e,this.index=e.index,this.remaining=e.size,this.head=e.head}fastForward(){for(;this.index<this.buffer.index;)this.head=this.head.next,this.index++}take(){if(0===this.remaining)return;this.index<this.buffer.index&&this.fastForward(),this.remaining--;let e=this.head.value;return this.head=this.head.next,e}takeN(e){if(0===this.remaining)return o7();this.index<this.buffer.index&&this.fastForward();let t=Math.min(e,this.remaining),r=Array(t);for(let e=0;e<t;e++){let t=this.head.value;this.head=this.head.next,r[e]=t}return this.remaining-=t,la(r)}takeAll(){return this.takeN(this.remaining)}}let exC={remaining:0,take:()=>void 0,takeN:()=>o7(),takeAll:()=>o7()},exF=e=>dt(()=>exc(eS7(e),new exS)),exI="Continue",exT=Symbol.for("effect/ChannelChildExecutorDecision"),exR={[exT]:exT},exN=e=>{let t=Object.create(exR);return t._tag=exI,t},exM="ContinuationK",exA=Symbol.for("effect/ChannelContinuation"),exj={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutDone:e=>e,_OutErr2:e=>e,_OutElem:e=>e,_OutDone2:e=>e};class exD{onSuccess;onHalt;_tag=exM;[exA]=exj;constructor(e,t){this.onSuccess=e,this.onHalt=t}onExit(e){return"Failure"===e._tag?this.onHalt(e.cause):this.onSuccess(e.value)}}class exP{finalizer;_tag="ContinuationFinalizer";[exA]=exj;constructor(e){this.finalizer=e}}let ex$="PullAfterNext",exz={[Symbol.for("effect/ChannelUpstreamPullStrategy")]:{_A:e=>e}},exL=e=>{let t=Object.create(exz);return t._tag=ex$,t.emitSeparator=e,t},exU="BracketOut",exB="Bridge",exq="ConcatAll",exJ="Emit",exH="Ensuring",exW="Fail",exK="Fold",exV="FromEffect",exG="PipeTo",exZ="Provide",exQ="Read",exY="Succeed",exX="SucceedNow",ex0="Suspend",ex1=Symbol.for("effect/Channel"),ex2={[ex1]:{_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},pipe(){return sp(this,arguments)}},ex3=e=>iD(e,ex1)||pv(e),ex5=ic(2,(e,t)=>{let r=Object.create(ex2);return r._tag=exU,r.acquire=()=>e,r.finalizer=t,r}),ex4=ic(2,(e,t)=>{let r=Object.create(ex2);return r._tag=exK,r.channel=e,r.k=new exD(e_f,t),r}),ex6=e=>e_d(()=>{let t=[];return e_s(e_l(e,ex8(t)),e=>e_g(()=>[lt(t),e]))}),ex8=e=>e_c({onInput:t=>e_s(e_g(()=>{e.push(t)}),()=>ex8(e)),onFailure:e_r,onDone:e_p}),ex7=(e,t,r)=>{let n=Object.create(ex2);return n._tag=exq,n.combineInners=t,n.combineAll=r,n.onPull=()=>exL(ah()),n.onEmit=()=>exN,n.value=()=>e,n.k=ih,n},ex9=ic(4,(e,t,r,n)=>{let i=Object.create(ex2);return i._tag=exq,i.combineInners=r,i.combineAll=n,i.onPull=()=>exL(ah()),i.onEmit=()=>exN,i.value=()=>e,i.k=t,i}),e_e=ic(2,(e,t)=>{let r=Object.create(ex2);return r._tag=exB,r.input=t,r.channel=e,r}),e_t=ic(2,(e,t)=>{let r=Object.create(ex2);return r._tag=exH,r.channel=e,r.finalizer=t,r}),e_r=e=>e_n(uP(e)),e_n=e=>e_i(()=>e),e_i=e=>{let t=Object.create(ex2);return t._tag=exW,t.error=e,t},e_s=ic(2,(e,t)=>{let r=Object.create(ex2);return r._tag=exK,r.channel=e,r.k=new exD(t,e_n),r}),e_a=ic(2,(e,t)=>{let r=Object.create(ex2);return r._tag=exK,r.channel=e,r.k=new exD(t.onSuccess,t.onFailure),r}),e_o=e=>{let t=Object.create(ex2);return t._tag=exV,t.effect=()=>e,t},e_l=ic(2,(e,t)=>{let r=Object.create(ex2);return r._tag=exG,r.left=()=>e,r.right=()=>t,r}),e_u=ic(2,(e,t)=>{let r=Object.create(ex2);return r._tag=exZ,r.context=()=>t,r.inner=e,r}),e_c=e=>e_h({onInput:e.onInput,onFailure:t=>s7(uV(t),{onLeft:e.onFailure,onRight:e_n}),onDone:e.onDone}),e_h=e=>{let t=Object.create(ex2);return t._tag=exQ,t.more=e.onInput,t.done=new exD(e.onDone,e.onFailure),t},e_f=e=>e_g(()=>e),e_p=e=>{let t=Object.create(ex2);return t._tag=exX,t.terminal=e,t},e_d=e=>{let t=Object.create(ex2);return t._tag=ex0,t.channel=e,t},e_g=e=>{let t=Object.create(ex2);return t._tag=exY,t.evaluate=e,t},e_m=e_p(void 0),e_b=e=>{let t=Object.create(ex2);return t._tag=exJ,t.out=e,t},e_y="Done",e_v="Emit",e_S="FromEffect",e_x="Read",e__={[Symbol.for("effect/ChannelState")]:{_E:e=>e,_R:e=>e}},e_w=()=>{let e=Object.create(e__);return e._tag=e_y,e},e_k=()=>{let e=Object.create(e__);return e._tag=e_v,e},e_O=e=>{let t=Object.create(e__);return t._tag=e_S,t.effect=e,t},e_E=(e,t,r,n)=>{let i=Object.create(e__);return i._tag=e_x,i.upstream=e,i.onEffect=t,i.onEmit=r,i.onDone=n,i},e_C=e=>e._tag===e_S,e_F=e=>e_C(e)?v6(e.effect,{onFailure:im,onSuccess:im}):void 0,e_I="PullFromChild",e_T="PullFromUpstream",e_R="DrainChildExecutors",e_N="Emit";class e_M{childExecutor;parentSubexecutor;onEmit;_tag=e_I;constructor(e,t,r){this.childExecutor=e,this.parentSubexecutor=t,this.onEmit=r}close(e){let t=this.childExecutor.close(e),r=this.parentSubexecutor.close(e);return void 0!==t&&void 0!==r?wH(pD(t),pD(r),(e,t)=>ib(e,gD(t))):void 0!==t?t:void 0!==r?r:void 0}enqueuePullFromChild(e){return this}}class e_A{upstreamExecutor;createChild;lastDone;activeChildExecutors;combineChildResults;combineWithChildResult;onPull;onEmit;_tag=e_T;constructor(e,t,r,n,i,s,a,o){this.upstreamExecutor=e,this.createChild=t,this.lastDone=r,this.activeChildExecutors=n,this.combineChildResults=i,this.combineWithChildResult=s,this.onPull=a,this.onEmit=o}close(e){let t=this.upstreamExecutor.close(e);return[...this.activeChildExecutors.map(t=>void 0!==t?t.childExecutor.close(e):void 0),t].reduce((e,t)=>void 0!==e&&void 0!==t?wH(e,pD(t),(e,t)=>gD(e,t)):void 0!==e?e:void 0!==t?pD(t):void 0,void 0)}enqueuePullFromChild(e){return new e_A(this.upstreamExecutor,this.createChild,this.lastDone,[...this.activeChildExecutors,e],this.combineChildResults,this.combineWithChildResult,this.onPull,this.onEmit)}}class e_j{upstreamExecutor;lastDone;activeChildExecutors;upstreamDone;combineChildResults;combineWithChildResult;onPull;_tag=e_R;constructor(e,t,r,n,i,s,a){this.upstreamExecutor=e,this.lastDone=t,this.activeChildExecutors=r,this.upstreamDone=n,this.combineChildResults=i,this.combineWithChildResult=s,this.onPull=a}close(e){let t=this.upstreamExecutor.close(e);return[...this.activeChildExecutors.map(t=>void 0!==t?t.childExecutor.close(e):void 0),t].reduce((e,t)=>void 0!==e&&void 0!==t?wH(e,pD(t),(e,t)=>gD(e,t)):void 0!==e?e:void 0!==t?pD(t):void 0,void 0)}enqueuePullFromChild(e){return new e_j(this.upstreamExecutor,this.lastDone,[...this.activeChildExecutors,e],this.upstreamDone,this.combineChildResults,this.combineWithChildResult,this.onPull)}}class e_D{value;next;_tag=e_N;constructor(e,t){this.value=e,this.next=t}close(e){return this.next.close(e)}enqueuePullFromChild(e){return this}}let e_P={[Symbol.for("effect/ChannelUpstreamPullRequest")]:{_A:e=>e}},e_$=e=>{let t=Object.create(e_P);return t._tag="Pulled",t.value=e,t};class e_z{_activeSubexecutor=void 0;_cancelled=void 0;_closeLastSubstream=void 0;_currentChannel;_done=void 0;_doneStack=[];_emitted=void 0;_executeCloseLastSubstream;_input=void 0;_inProgressFinalizer=void 0;_providedEnv;constructor(e,t,r){this._currentChannel=e,this._executeCloseLastSubstream=r,this._providedEnv=t}run(){let e;for(;void 0===e;)if(void 0!==this._cancelled)e=this.processCancellation();else if(void 0!==this._activeSubexecutor)e=this.runSubexecutor();else try{if(void 0===this._currentChannel)e=e_w();else switch(pv(this._currentChannel)&&(this._currentChannel=e_o(this._currentChannel)),this._currentChannel._tag){case exU:e=this.runBracketOut(this._currentChannel);break;case exB:{let t=this._currentChannel.input;if(this._currentChannel=this._currentChannel.channel,void 0!==this._input){let r=this._input;this._input=void 0;let n=()=>pB(t.awaitRead(),()=>dt(()=>{let e=r.run();switch(e._tag){case e_y:return gR(r.getDone(),{onFailure:e=>t.error(e),onSuccess:e=>t.done(e)});case e_v:return pB(t.emit(r.getEmit()),()=>n());case e_S:return pK(e.effect,{onFailure:e=>t.error(e),onSuccess:()=>n()});case e_x:return e_B(e,()=>n(),e=>t.error(e))}}));e=e_O(pB(wN(p0(n())),e=>dr(()=>this.addFinalizer(t=>pB(dv(e),()=>dt(()=>{let e=this.restorePipe(t,r);return void 0!==e?e:dl}))))))}break}case exq:{let e=new e_z(this._currentChannel.value(),this._providedEnv,e=>dr(()=>{let t=void 0===this._closeLastSubstream?dl:this._closeLastSubstream;this._closeLastSubstream=ib(t,wJ(e))}));e._input=this._input;let t=this._currentChannel;this._activeSubexecutor=new e_A(e,e=>t.k(e),void 0,[],(e,r)=>t.combineInners(e,r),(e,r)=>t.combineAll(e,r),e=>t.onPull(e),e=>t.onEmit(e)),this._closeLastSubstream=void 0,this._currentChannel=void 0;break}case exJ:this._emitted=this._currentChannel.out,this._currentChannel=void 0!==this._activeSubexecutor?void 0:e_m,e=e_k();break;case exH:this.runEnsuring(this._currentChannel);break;case exW:e=this.doneHalt(this._currentChannel.error());break;case exK:this._doneStack.push(this._currentChannel.k),this._currentChannel=this._currentChannel.channel;break;case exV:{let t=void 0===this._providedEnv?this._currentChannel.effect():ib(this._currentChannel.effect(),OA(this._providedEnv));e=e_O(pK(t,{onFailure:e=>{let t=this.doneHalt(e);return void 0!==t&&e_C(t)?t.effect:dl},onSuccess:e=>{let t=this.doneSucceed(e);return void 0!==t&&e_C(t)?t.effect:dl}}));break}case exG:{let e=this._input,t=new e_z(this._currentChannel.left(),this._providedEnv,e=>this._executeCloseLastSubstream(e));t._input=e,this._input=t,this.addFinalizer(t=>{let r=this.restorePipe(t,e);return void 0!==r?r:dl}),this._currentChannel=this._currentChannel.right();break}case exZ:{let e=this._providedEnv;this._providedEnv=this._currentChannel.context(),this._currentChannel=this._currentChannel.inner,this.addFinalizer(()=>dr(()=>{this._providedEnv=e}));break}case exQ:{let t=this._currentChannel;e=e_E(this._input,ih,e=>{try{this._currentChannel=t.more(e)}catch(e){this._currentChannel=t.done.onExit(gO(e))}},e=>{let r=e=>t.done.onExit(e);this._currentChannel=r(e)});break}case exY:e=this.doneSucceed(this._currentChannel.evaluate());break;case exX:e=this.doneSucceed(this._currentChannel.terminal);break;case ex0:this._currentChannel=this._currentChannel.channel()}}catch(e){this._currentChannel=e_n(u$(e))}return e}getDone(){return this._done}getEmit(){return this._emitted}cancelWith(e){this._cancelled=e}clearInProgressFinalizer(){this._inProgressFinalizer=void 0}storeInProgressFinalizer(e){this._inProgressFinalizer=e}popAllFinalizers(e){let t=[],r=this._doneStack.pop();for(;r;)"ContinuationFinalizer"===r._tag&&t.push(r.finalizer),r=this._doneStack.pop();let n=0===t.length?dl:e_U(t,e);return this.storeInProgressFinalizer(n),n}popNextFinalizers(){let e=[];for(;0!==this._doneStack.length;){let t=this._doneStack[this._doneStack.length-1];if(t._tag===exM)break;e.push(t),this._doneStack.pop()}return e}restorePipe(e,t){let r=this._input;return(this._input=t,void 0!==r)?r.close(e):dl}close(e){let t,r,n=this._inProgressFinalizer;void 0!==n&&(t=ib(n,w8(dr(()=>this.clearInProgressFinalizer()))));let i=this.popAllFinalizers(e);void 0!==i&&(r=ib(i,w8(dr(()=>this.clearInProgressFinalizer()))));let s=void 0===this._activeSubexecutor?void 0:this._activeSubexecutor.close(e);if(void 0!==s||void 0!==t||void 0!==r)return ib(pD(e_L(s)),wB(pD(e_L(t))),wB(pD(e_L(r))),p2(([[e,t],r])=>ib(e,gD(t),gD(r))),ds,pB(e=>dt(()=>e)))}doneSucceed(e){if(0===this._doneStack.length)return this._done=gM(e),this._currentChannel=void 0,e_w();let t=this._doneStack[this._doneStack.length-1];if(t._tag===exM){this._doneStack.pop(),this._currentChannel=t.onSuccess(e);return}let r=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=r.reverse(),this._done=gM(e),this._currentChannel=void 0,e_w();let n=e_U(r.map(e=>e.finalizer),gM(e));return this.storeInProgressFinalizer(n),e_O(ib(n,w8(dr(()=>this.clearInProgressFinalizer())),ds,pB(()=>dr(()=>this.doneSucceed(e)))))}doneHalt(e){if(0===this._doneStack.length)return this._done=gC(e),this._currentChannel=void 0,e_w();let t=this._doneStack[this._doneStack.length-1];if(t._tag===exM){this._doneStack.pop();try{this._currentChannel=t.onHalt(e)}catch(e){this._currentChannel=e_n(u$(e))}return}let r=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=r.reverse(),this._done=gC(e),this._currentChannel=void 0,e_w();let n=e_U(r.map(e=>e.finalizer),gC(e));return this.storeInProgressFinalizer(n),e_O(ib(n,w8(dr(()=>this.clearInProgressFinalizer())),ds,pB(()=>dr(()=>this.doneHalt(e)))))}processCancellation(){return this._currentChannel=void 0,this._done=this._cancelled,this._cancelled=void 0,e_w()}runBracketOut(e){return e_O(ds(pK(this.provide(e.acquire()),{onFailure:e=>dr(()=>{this._currentChannel=e_n(e)}),onSuccess:t=>dr(()=>{this.addFinalizer(r=>this.provide(e.finalizer(t,r))),this._currentChannel=e_b(t)})})))}provide(e){return void 0===this._providedEnv?e:ib(e,OA(this._providedEnv))}runEnsuring(e){this.addFinalizer(e.finalizer),this._currentChannel=e.channel}addFinalizer(e){this._doneStack.push(new exP(e))}runSubexecutor(){let e=this._activeSubexecutor;switch(e._tag){case e_I:return this.pullFromChild(e.childExecutor,e.parentSubexecutor,e.onEmit,e);case e_T:return this.pullFromUpstream(e);case e_R:return this.drainChildExecutors(e);case e_N:return this._emitted=e.value,this._activeSubexecutor=e.next,e_k()}}replaceSubexecutor(e){this._currentChannel=void 0,this._activeSubexecutor=e}finishWithExit(e){let t=gR(e,{onFailure:e=>this.doneHalt(e),onSuccess:e=>this.doneSucceed(e)});return this._activeSubexecutor=void 0,void 0===t?dl:e_C(t)?t.effect:dl}finishSubexecutorWithCloseEffect(e,...t){this.addFinalizer(()=>ib(t,wF(t=>ib(dr(()=>t(e)),pB(e=>void 0!==e?e:dl)),{discard:!0})));let r=ib(e,gR({onFailure:e=>this.doneHalt(e),onSuccess:e=>this.doneSucceed(e)}));return this._activeSubexecutor=void 0,r}applyUpstreamPullStrategy(e,t,r){switch(r._tag){case ex$:{let n=!e||t.some(e=>void 0!==e);return[r.emitSeparator,n?[void 0,...t]:t]}case"PullAfterAllEnqueued":{let n=!e||t.some(e=>void 0!==e);return[r.emitSeparator,n?[...t,void 0]:t]}}}pullFromChild(e,t,r,n){return e_E(e,ih,i=>{let s=r(i);switch(s._tag){case exI:break;case"Close":this.finishWithDoneValue(e,t,s.value);break;case"Yield":{let e=t.enqueuePullFromChild(n);this.replaceSubexecutor(e)}}this._activeSubexecutor=new e_D(i,this._activeSubexecutor)},gR({onFailure:r=>{let n=this.handleSubexecutorFailure(e,t,r);return void 0===n?void 0:e_F(n)},onSuccess:r=>{this.finishWithDoneValue(e,t,r)}}))}finishWithDoneValue(e,t,r){switch(t._tag){case e_T:{let n=new e_A(t.upstreamExecutor,t.createChild,void 0!==t.lastDone?t.combineChildResults(t.lastDone,r):r,t.activeChildExecutors,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit);this._closeLastSubstream=e.close(gM(r)),this.replaceSubexecutor(n);break}case e_R:{let n=new e_j(t.upstreamExecutor,void 0!==t.lastDone?t.combineChildResults(t.lastDone,r):r,t.activeChildExecutors,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull);this._closeLastSubstream=e.close(gM(r)),this.replaceSubexecutor(n)}}}handleSubexecutorFailure(e,t,r){return this.finishSubexecutorWithCloseEffect(gC(r),e=>t.close(e),t=>e.close(t))}pullFromUpstream(e){if(0===e.activeChildExecutors.length)return this.performPullFromUpstream(e);let t=e.activeChildExecutors[0],r=new e_A(e.upstreamExecutor,e.createChild,e.lastDone,e.activeChildExecutors.slice(1),e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit);if(void 0===t)return this.performPullFromUpstream(r);this.replaceSubexecutor(new e_M(t.childExecutor,r,t.onEmit))}performPullFromUpstream(e){return e_E(e.upstreamExecutor,e=>{let t=void 0===this._closeLastSubstream?dl:this._closeLastSubstream;return this._closeLastSubstream=void 0,ib(this._executeCloseLastSubstream(t),wJ(e))},t=>{if(void 0!==this._closeLastSubstream){let r=this._closeLastSubstream;return this._closeLastSubstream=void 0,ib(this._executeCloseLastSubstream(r),p2(()=>{let r=new e_z(e.createChild(t),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;let[n,i]=this.applyUpstreamPullStrategy(!1,e.activeChildExecutors,e.onPull(e_$(t)));this._activeSubexecutor=new e_M(r,new e_A(e.upstreamExecutor,e.createChild,e.lastDone,i,e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit),e.onEmit),sW(n)&&(this._activeSubexecutor=new e_D(n.value,this._activeSubexecutor))}))}let r=new e_z(e.createChild(t),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;let[n,i]=this.applyUpstreamPullStrategy(!1,e.activeChildExecutors,e.onPull(e_$(t)));this._activeSubexecutor=new e_M(r,new e_A(e.upstreamExecutor,e.createChild,e.lastDone,i,e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit),e.onEmit),sW(n)&&(this._activeSubexecutor=new e_D(n.value,this._activeSubexecutor))},t=>{if(e.activeChildExecutors.some(e=>void 0!==e)){let t=new e_j(e.upstreamExecutor,e.lastDone,[void 0,...e.activeChildExecutors],e.upstreamExecutor.getDone(),e.combineChildResults,e.combineWithChildResult,e.onPull);if(void 0!==this._closeLastSubstream){let e=this._closeLastSubstream;return this._closeLastSubstream=void 0,ib(this._executeCloseLastSubstream(e),p2(()=>this.replaceSubexecutor(t)))}return void this.replaceSubexecutor(t)}let r=this._closeLastSubstream,n=this.finishSubexecutorWithCloseEffect(ib(t,gT(t=>e.combineWithChildResult(e.lastDone,t))),()=>r,t=>e.upstreamExecutor.close(t));return void 0===n?void 0:e_F(n)})}drainChildExecutors(e){if(0===e.activeChildExecutors.length){let t=this._closeLastSubstream;return void 0!==t&&this.addFinalizer(()=>de(t)),this.finishSubexecutorWithCloseEffect(e.upstreamDone,()=>t,t=>e.upstreamExecutor.close(t))}let t=e.activeChildExecutors[0],r=e.activeChildExecutors.slice(1);if(void 0===t){var n;let t,[i,s]=this.applyUpstreamPullStrategy(!0,r,e.onPull((n=r.reduce((e,t)=>void 0!==t?e+1:e,0),(t=Object.create(e_P))._tag="NoUpstream",t.activeDownstreamCount=n,t)));return(this.replaceSubexecutor(new e_j(e.upstreamExecutor,e.lastDone,s,e.upstreamDone,e.combineChildResults,e.combineWithChildResult,e.onPull)),sW(i))?(this._emitted=i.value,e_k()):void 0}let i=new e_j(e.upstreamExecutor,e.lastDone,r,e.upstreamDone,e.combineChildResults,e.combineWithChildResult,e.onPull);this.replaceSubexecutor(new e_M(t.childExecutor,i,t.onEmit))}}let e_L=e=>void 0!==e?e:dl,e_U=(e,t)=>ib(wF(e,e=>pD(e(t))),p2(e=>ib(gk(e),ap(()=>gA))),pB(e=>dt(()=>e))),e_B=(e,t,r)=>{let n=[e],i=()=>{let e=n.pop();if(void 0===e||void 0===e.upstream)return pA("Unexpected end of input for channel execution");let s=e.upstream.run();switch(s._tag){case e_v:{let s=e.onEmit(e.upstream.getEmit());if(0===n.length){if(void 0===s)return dt(t);return ib(s,pK({onFailure:r,onSuccess:t}))}if(void 0===s)return dt(()=>i());return ib(s,pK({onFailure:r,onSuccess:()=>i()}))}case e_y:{let s=e.onDone(e.upstream.getDone());if(0===n.length){if(void 0===s)return dt(t);return ib(s,pK({onFailure:r,onSuccess:t}))}if(void 0===s)return dt(()=>i());return ib(s,pK({onFailure:r,onSuccess:()=>i()}))}case e_S:return n.push(e),ib(e.onEffect(s.effect),pF(t=>dt(()=>{let r=e.onDone(gC(t));return void 0===r?dl:r})),pK({onFailure:r,onSuccess:()=>i()}));case e_x:return n.push(e),n.push(s),dt(()=>i())}};return i()},e_q=ic(2,(e,t)=>da(r=>{let n,i;return wC([(n=t,i=bU,n.fork(i)),gL(),gL()]).pipe(pB(([n,i,s])=>r(px(dr(()=>new e_z(e,void 0,ih)),e=>dt(()=>e_J(e.run(),e).pipe(p1(i),wJ(gB(i)),wq(gB(s)))),(e,t)=>{let r=e.close(t);return void 0===r?dl:Sg(r,e=>gr(n,p$(e)))})).pipe(kE(t),pB(e=>t.addFinalizer(t=>{let r="Failure"===t._tag?uW(t.cause):void 0;return bD(i).pipe(pB(t=>t?gK(s,void 0).pipe(wJ(e.await),wJ(e.inheritAll)):gK(s,void 0).pipe(wJ(r&&uC(r)>0?dS(e,ib(r,uk(hd,(e,t)=>hb(t)(e)))):dv(e)),wJ(e.inheritAll))))}).pipe(wJ(r(gB(i))))))))})),e_J=(e,t)=>{switch(e._tag){case e_S:return ib(e.effect,pB(()=>e_J(t.run(),t)));case e_v:return e_J(t.run(),t);case e_y:return dt(()=>t.getDone());case e_x:return e_B(e,()=>e_J(t.run(),t),p$)}},e_H="Done",e_W={[Symbol.for("effect/ChannelMergeDecision")]:{_R:e=>e,_E0:e=>e,_Z0:e=>e,_E:e=>e,_Z:e=>e}},e_K=e=>{let t=Object.create(e_W);return t._tag=e_H,t.effect=e,t},e_V=e=>{let t=Object.create(e_W);return t._tag="Await",t.f=e,t},e_G="BothRunning",e_Z="LeftDone",e_Q="RightDone",e_Y=Symbol.for("effect/ChannelMergeState"),e_X={[e_Y]:e_Y},e_0=(e,t)=>{let r=Object.create(e_X);return r._tag=e_G,r.left=e,r.right=t,r},e_1=e=>{let t=Object.create(e_X);return t._tag=e_Z,t.f=e,t},e_2=e=>{let t=Object.create(e_X);return t._tag=e_Q,t.f=e,t},e_3="BackPressure",e_5="BufferSliding",e_4=Symbol.for("effect/ChannelMergeStrategy"),e_6={[e_4]:e_4},e_8=e=>{let t=Object.create(e_6);return t._tag=e_3,t},e_7=ic(2,(e,{onBackPressure:t,onBufferSliding:r})=>{switch(e._tag){case e_3:return t();case e_5:return r()}}),e_9="Empty",ewe="Emit",ewt="Error",ewr="Done",ewn=e=>({_tag:e_9,notifyProducer:e}),ewi=e=>({_tag:ewe,notifyConsumers:e});class ews{ref;constructor(e){this.ref=e}awaitRead(){return pH(vD(this.ref,e=>e._tag===e_9?[gB(e.notifyProducer),e]:[dl,e]))}get close(){return pU(e=>this.error(uz(e)))}done(e){return pH(vD(this.ref,t=>{switch(t._tag){case e_9:return[gB(t.notifyProducer),t];case ewe:return[wF(t.notifyConsumers,t=>gK(t,s2(e)),{discard:!0}),{_tag:ewr,done:e}];case ewt:case ewr:return[pY,t]}}))}emit(e){return pB(gL(),t=>pH(vD(this.ref,r=>{switch(r._tag){case e_9:return[gB(r.notifyProducer),r];case ewe:{let n=r.notifyConsumers[0],i=r.notifyConsumers.slice(1);if(void 0!==n)return[gK(n,s3(e)),0===i.length?ewn(t):ewi(i)];throw Error("Bug: Channel.SingleProducerAsyncInput.emit - Queue was empty! please report an issue at https://github.com/Effect-TS/effect/issues")}case ewt:case ewr:return[pY,r]}})))}error(e){return pH(vD(this.ref,t=>{switch(t._tag){case e_9:return[gB(t.notifyProducer),t];case ewe:return[wF(t.notifyConsumers,t=>gH(t,e),{discard:!0}),{_tag:ewt,cause:e}];case ewt:case ewr:return[pY,t]}}))}get take(){return this.takeWith(e=>gC(uQ(e,s2)),e=>gM(e),e=>gE(s3(e)))}takeWith(e,t,r){return pB(gL(),n=>pH(vD(this.ref,i=>{switch(i._tag){case e_9:return[wJ(gK(i.notifyProducer,void 0),pW(gB(n),{onFailure:e,onSuccess:s7({onLeft:r,onRight:t})})),ewi([n])];case ewe:return[pW(gB(n),{onFailure:e,onSuccess:s7({onLeft:r,onRight:t})}),ewi([...i.notifyConsumers,n])];case ewt:return[de(e(i.cause)),i];case ewr:return[de(r(i.done)),i]}})))}}let ewa=()=>ib(gL(),pB(e=>vM(ewn(e))),p2(e=>new ews(e))),ewo=ic(2,(e,t)=>ewS(e,()=>t)),ewl=ic(2,(e,t)=>ex4(e,e=>s7(uV(e),{onLeft:t,onRight:e_n}))),ewu=ic(2,(e,t)=>ex9(e,t,()=>void 0,()=>void 0)),ewc=e=>e_c({onInput:t=>e_s(e_g(()=>{e.push(t)}),()=>ewc(e)),onFailure:e_r,onDone:e_f}),ewh=e=>{let t=e_h({onInput:()=>t,onFailure:e_n,onDone:e_f});return e_l(e,t)},ewf=ic(2,(e,t)=>e_t(e,()=>t)),ewp=ic(2,(e,t)=>e_a(e,{onFailure:e=>{let r=uV(e);switch(r._tag){case"Left":return t.onFailure(r.left);case"Right":return e_n(r.right)}},onSuccess:t.onSuccess})),ewd=e=>ewL(e.takeWith(e_n,t=>e_s(e_b(t),()=>ewd(e)),e_f)),ewg=e=>e_d(()=>ewm(e)),ewm=e=>ib(e_o(eSL(e)),e_s(s7({onLeft:gR({onFailure:e_n,onSuccess:e_p}),onRight:t=>e_s(e_b(t),()=>ewm(e))}))),ewb=()=>e_c({onInput:e=>e_s(e_b(e),()=>ewb()),onFailure:e_r,onDone:e_p}),ewy=ic(2,(e,t)=>ewI(e,{other:e_o(t),onSelfDone:e=>e_K(dt(()=>e)),onOtherDone:e=>e_K(dt(()=>e))})),ewv=ic(2,(e,t)=>ewy(e,gB(t))),ewS=ic(2,(e,t)=>e_s(e,e=>e_g(()=>t(e)))),ewx=ic(2,(e,t)=>e_s(e,e=>e_o(t(e)))),ew_=ic(2,(e,t)=>eww(e,uQ(t))),eww=ic(2,(e,t)=>ex4(e,e=>e_n(t(e)))),ewk=ic(2,(e,t)=>{let r=e_c({onInput:e=>e_s(e_b(t(e)),()=>r),onFailure:e_r,onDone:e_p});return e_l(e,r)}),ewO=ic(2,(e,t)=>{let r=e_h({onInput:e=>ib(e_o(t(e)),e_s(e_b),e_s(()=>r)),onFailure:e_n,onDone:e_p});return e_l(e,r)}),ewE=ic(3,(e,t,r)=>ewB(n=>Cx(function*(){let i=yield*ewa(),s=ewd(i),a=yield*eS0(r);yield*gr(n,eS5(a));let o=yield*gL(),l=r===1/0?e=>ih:(yield*CO(r)).withPermits,u=yield*s.pipe(e_l(e),ewP(n));yield*u.pipe(pK({onFailure:e=>eS$(a,p$(e)),onSuccess:s7({onLeft:e=>wJ(p0(l(r)(dl)),pw(eS$(a,de(s2(e))))),onRight:e=>Cx(function*(){let r=yield*gL(),i=yield*gL();yield*eS$(a,p2(gB(r),s3)),yield*gK(i,void 0).pipe(wJ(da(r=>pD(r(gB(o))).pipe(kF(pD(r(t(e)))),pB(ih))).pipe(Sg(e=>gH(o,e)),p1(r))),l(1),kE(n)),yield*gB(i)})})}),v8,p0,kE(n));let c=ewL(pW(pH(eSL(a)),{onFailure:e_n,onSuccess:s7({onLeft:e_p,onRight:e=>e_s(e_b(e),()=>c)})}));return e_e(c,i)}))),ewC=({bufferSize:e=16,concurrency:t,mergeStrategy:r=e_8()})=>(n,i)=>ewB(s=>Cx(function*(){let a="unbounded"===t?Number.MAX_SAFE_INTEGER:t,o=yield*ewa(),l=ewd(o),u=yield*eS0(e);yield*gr(s,eS5(u));let c=yield*eS3();yield*gr(s,eS5(c));let h=yield*vM(ah()),f=yield*gL(),p=(yield*CO(a)).withPermits,d=yield*ewP(e_l(l,n),s);function g(e){return e.pipe(pB(s7({onLeft:e=>de(sV(e)),onRight:e=>p_(eS$(u,de(s3(e))),ah())})),EZ({until:e=>sW(e)}),pB(e=>vP(h,af({onNone:()=>sV(e.value),onSome:t=>sV(i(t,e.value))}))),pF(e=>sW(uG(e))?p$(e):eS$(u,p$(e)).pipe(wJ(gK(f,void 0)),pw)))}yield*d.pipe(pK({onFailure:e=>eS$(u,p$(e)).pipe(wJ(de(!1))),onSuccess:s7({onLeft:e=>w3(p0(gB(f)),p0(p(a)(dl)),{onSelfDone:(e,t)=>p_(dv(t),!1),onOtherDone:(t,r)=>wJ(dv(r),h.get.pipe(pB(af({onNone:()=>eS$(u,de(s2(e))),onSome:t=>eS$(u,de(s2(i(t,e))))})),p_(!1)))}),onRight:e=>e_7(r,{onBackPressure:()=>Cx(function*(){let t=yield*gL(),r=wL(t=>ewP(e_l(l,e),t).pipe(pB(e=>w5(pD(g(e)),pD(p0(gB(f))))),pB(ih)));return yield*gK(t,void 0).pipe(wJ(r),p(1),kE(s)),yield*gB(t),!(yield*bD(f))}),onBufferSliding:()=>Cx(function*(){let t=yield*gL(),r=yield*gL(),n=yield*c.size;yield*eSL(c).pipe(pB(e=>gK(e,void 0)),Sb(()=>n>=a)),yield*eS$(c,t);let i=wL(r=>ewP(e_l(l,e),r).pipe(pB(e=>pD(g(e)).pipe(w5(pD(p0(gB(f)))),w5(pD(p0(gB(t)))))),pB(ih)));return yield*gK(r,void 0).pipe(wJ(i),p(1),kE(s)),yield*gB(r),!(yield*bD(f))})})})}),EZ({while:e=>e}),kE(s));let m=ib(eSL(u),pH,pW({onFailure:e_n,onSuccess:s7({onLeft:e_p,onRight:e=>e_s(e_b(e),()=>m)})}),ewL);return e_e(m,o)})),ewF=ic(3,(e,t,r)=>{let n;return(n=r,e=>ewC(n)(e,im))(ewk(e,t))}),ewI=ic(2,(e,t)=>ewB(function(r){return Cx(function*(){let n=yield*ewa(),i=ewd(n),s=yield*ewP(e_l(i,e),r),a=yield*ewP(e_l(i,t.other),r);function o(e,t,n){return(i,s,a)=>{function o(e){return e._tag===e_H?de(e_o(wJ(dv(t),e.effect))):p2(t.await,gR({onFailure:t=>e_o(e.f(gC(t))),onSuccess:s7({onLeft:t=>e_o(e.f(gM(t))),onRight:t=>ewK(e_b(t),l(a(e.f)))})}))}return gR(e,{onFailure:e=>o(i(gC(e))),onSuccess:s7({onLeft:e=>o(i(gM(e))),onRight:e=>de(e_s(e_b(e),()=>e_s(e_o(kE(p0(n),r)),e=>l(s(e,t)))))})})}}function l(e){switch(e._tag){case e_G:return ewL(w3(p0(S$(e.left)),p0(S$(e.right)),{onSelfDone:(r,n)=>wJ(dv(n),o(r,e.right,s)(t.onSelfDone,e_0,e=>e_1(e))),onOtherDone:(r,n)=>wJ(dv(n),o(r,e.left,a)(t.onOtherDone,(e,t)=>e_0(t,e),e=>e_2(e)))}));case e_Z:return ewL(p2(pD(a),gR({onFailure:t=>e_o(e.f(gC(t))),onSuccess:s7({onLeft:t=>e_o(e.f(gM(t))),onRight:t=>e_s(e_b(t),()=>l(e_1(e.f)))})})));case e_Q:return ewL(p2(pD(s),gR({onFailure:t=>e_o(e.f(gC(t))),onSuccess:s7({onLeft:t=>e_o(e.f(gM(t))),onRight:t=>e_s(e_b(t),()=>l(e_2(e.f)))})})))}}return e_o(pS(e=>{let t=pS(t=>(t.transferChildren(e.scope()),dl));return wH(p0(s).pipe(w8(t),kE(r)),p0(a).pipe(w8(t),kE(r)),(e,t)=>e_0(e,t))})).pipe(e_s(l),e_e(n))})})),ewT=((e,t)=>ewl(e,e=>e_i(()=>u$(t(e)))),ic(2,(e,t)=>ewl(e,t))),ewR=ic(2,(e,t)=>e_d(()=>{let r,n=e_c({onInput:e=>e_s(e_b(e),()=>n),onFailure:e=>e_n(u$(r=ewG(e))),onDone:e_p}),i=e_h({onInput:e=>ib(e_b(e),e_s(()=>i)),onFailure:e=>"Die"===e._tag&&ewZ(e.defect)&&sr(e.defect,r)?e_r(e.defect.error):e_n(e),onDone:e_p});return e_l(e_l(e_l(e,n),t),i)})),ewN=((e,t)=>ewB(r=>p2(Oo(t,r),t=>e_u(e,t))),e=>wL(t=>e_q(e,t))),ewM=e=>ewN(ewh(e)),ewA=e=>pB(wW,t=>e_q(e,t)),ewj=e=>ewL(da(t=>p2(wZ(),r=>ex5(Sg(t(wQ(e,r)),e=>{let t,n;return t=r,n=gC(e),t.close(n)}),(e,t)=>{let n,i;return n=r,i=t,n.close(i)})))),ewD=e=>ewU(p2(wK,t=>e_s(e_o(e(t)),e_b))),ewP=ic(2,(e,t)=>wB(dr(()=>new e_z(e,void 0,ih)),k2()).pipe(dn(([e,r])=>{let n,i;return n=t,i=t=>{let n=e.close(t);return void 0!==n?OA(n,r):dl},n.addFinalizer(i)}),ds,p2(([e])=>dt(()=>ew$(e.run(),e))))),ew$=(e,t)=>{switch(e._tag){case e_y:return gR(t.getDone(),{onFailure:p$,onSuccess:e=>de(s2(e))});case e_v:return de(s3(t.getEmit()));case e_S:return ib(e.effect,pB(()=>ew$(t.run(),t)));case e_x:return e_B(e,()=>ew$(t.run(),t),e=>p$(e))}},ewz=e=>e_h({onInput:t=>e_s(e_o(eS$(e,s3(t))),()=>ewz(e)),onFailure:t=>e_o(eS$(e,s2(gC(t)))),onDone:t=>e_o(eS$(e,s2(gM(t))))}),ewL=e=>e_s(e_o(e),ih),ewU=e=>ex7(ewj(e),(e,t)=>e,(e,t)=>e),ewB=e=>ex7(ewD(e),(e,t)=>e,(e,t)=>e),ewq=e=>ewJ(0,e.length,e),ewJ=(e,t,r)=>e===t?e_m:ib(e_b(ib(r,ll(e))),e_s(()=>ewJ(e+1,t,r))),ewH=ic(e=>ex3(e[1]),(e,t,r)=>r?.concurrent?ewI(e,{other:t,onSelfDone:e=>e_V(t=>dt(()=>gj(e,t))),onOtherDone:e=>e_V(t=>dt(()=>gj(t,e)))}):e_s(e,e=>ewS(t,t=>[e,t]))),ewW=ic(e=>ex3(e[1]),(e,t,r)=>r?.concurrent?ewS(ewH(e,t,{concurrent:!0}),e=>e[0]):e_s(e,e=>ewo(t,e))),ewK=ic(e=>ex3(e[1]),(e,t,r)=>r?.concurrent?ewS(ewH(e,t,{concurrent:!0}),e=>e[1]):e_s(e,()=>t)),ewV=Symbol.for("effect/Channel/ChannelException"),ewG=e=>({_tag:"ChannelException",[ewV]:ewV,error:e}),ewZ=e=>iD(e,ewV),ewQ=Symbol.for("effect/RcRef"),ewY={_tag:"Left"},ewX={_tag:"Right"},ew0={_tag:"Both"},ew1={_tag:"Either"},ew2=Symbol.for("effect/Sink"),ew3={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e};class ew5{channel;[ew2]=ew3;constructor(e){this.channel=e}pipe(){return sp(this,arguments)}}let ew4=e=>new ew5(e_d(()=>ekm(e()))),ew6=((e,t)=>ib(e,ew6(lk(t))),ic(2,(e,t)=>{let r=e_c({onInput:e=>ib(e_b(t(e)),e_s(()=>r)),onFailure:e_r,onDone:e_f});return new ew5(ib(r,e_l(ekm(e))))})),ew8=ic(2,(e,t)=>{let r=e_c({onInput:e=>ib(e_o(t(e)),e_s(e_b),e_s(()=>r)),onFailure:e_r,onDone:e_f});return new ew5(ib(r,ewR(ekm(e))))}),ew7=new ew5(ewh(ewb())),ew9=e=>new ew5(e_r(e)),eke=(e,t,r)=>ew4(()=>new ew5(ekt(e,t,r))),ekt=(e,t,r)=>t(e)?e_c({onInput:n=>{let[i,s]=ekr(e,n,t,r,0,n.length);return lS(s)?ib(e_b(s),ewo(i)):ekt(i,t,r)},onFailure:e_r,onDone:()=>e_p(e)}):e_p(e),ekr=(e,t,r,n,i,s)=>{if(i===s)return[e,o7()];let a=n(e,ib(t,ll(i)));return r(a)?ekr(a,t,r,n,i+1,s):[a,ib(t,lf(i+1))]},ekn=ic(2,(e,t)=>new ew5(ib(ekm(e),ex6,ewp({onFailure:e=>ekm(t.onFailure(e)),onSuccess:([e,r])=>e_d(()=>{let n={ref:ib(e,lm(lS))},i=ib(e_g(()=>{let e=n.ref;return n.ref=o7(),e}),e_s(e=>ewq(e)));return e_s(ex6(ib(i,ewK(ewb()),e_l(ekm(t.onSuccess(r))))),([e,t])=>ib(e_f(n.ref),e_s(ewq),ewK(ewq(e)),ewo(t)))})})))),eki=(e,t,r)=>ew4(()=>new ew5(eks(e,t,r))),eks=(e,t,r)=>t(e)?e_c({onInput:n=>ib(e_o(eka(e,n,t,r)),e_s(([e,n])=>ib(n,af({onNone:()=>eks(e,t,r),onSome:t=>ib(e_b(t),ewo(e))})))),onFailure:e_r,onDone:()=>e_p(e)}):e_p(e),eka=(e,t,r,n)=>eko(e,t,0,t.length,r,n),eko=(e,t,r,n,i,s)=>r===n?de([e,ah()]):ib(s(e,ib(t,ll(r))),pB(e=>i(e)?eko(e,t,r+1,n,i,s):de([e,sV(ib(t,lf(r+1)))]))),ekl=ic(2,(e,t)=>ekn(e,{onFailure:ew9,onSuccess:t})),eku=e=>{let t=e_h({onInput:r=>ib(e_o(wF(r,t=>e(t),{discard:!0})),e_s(()=>t)),onFailure:e_n,onDone:()=>e_m});return new ew5(t)},ekc=e=>{let t=e_h({onInput:r=>ib(e_o(e(r)),e_s(()=>t)),onFailure:e_n,onDone:()=>e_m});return new ew5(t)},ekh=(e,t,r,n,i)=>r===n?i:ib(e_o(e(ib(t,ll(r)))),e_s(s=>s?ekh(e,t,r+1,n,i):e_b(ib(t,lf(r)))),ewl(e=>ib(e_b(ib(t,lf(r))),ewK(e_r(e))))),ekf=(e,t)=>t?.shutdown?ekb(p2(wO(de(e),eS5),ekf)):ekc(t=>eSz(e,t)),ekp=ic(2,(e,t)=>new ew5(ib(ekm(e),ewS(t)))),ekd=((e,t)=>new ew5(ib(ekm(e),ewx(t))),ic(2,(e,t)=>eky(function(r){return Cx(function*(){let n,i=yield*exF(t?.capacity??16),s=yield*wQ(i.subscribe,r),a=yield*wQ(i.subscribe,r),o=(n=i,e_d(()=>ewz(n))),l=ewg(s).pipe(e_l(ekm(e)),ewW(e_o(eS5(s))),ewI({other:ewg(a).pipe(e_l(ekm(t.other)),ewW(e_o(eS5(a)))),onSelfDone:t.onSelfDone,onOtherDone:t.onOtherDone}));return new ew5(ewI(o,{other:l,onSelfDone:()=>e_V(ih),onOtherDone:e=>e_K(e)}))})}))),ekg=((e,t,r)=>new ew5(ib(e,ekm,ewl(e=>af(t(e),{onNone:()=>e_i(()=>u$(r(e))),onSome:e_r})))),(e,t,r=0)=>{let n,i=e[Symbol.iterator](),s=0,a=-1;for(;a<0&&(n=i.next())&&!n.done;){let e=n.value;s>=r&&t(e)&&(a=s),s+=1}return a}),ekm=((e,t,r)=>new ew5(ib(e_o(t),e_s(n=>ib(e,ekm,e_s(e=>ib(e_o(t),ewS(t=>[e,r(n,t)]))))))),e=>pv(e)?ekm(new ew5(e_o(e))):e.channel),ekb=e=>new ew5(ewU(e.pipe(p2(e=>ekm(e))))),eky=e=>new ew5(ewB(t=>e(t).pipe(p2(e=>ekm(e))))),ekv=((e=>iD(e[1],ew2),(e,t,r)=>ekv(e,t,(e,t)=>t,r)),ic(e=>iD(e[1],ew2),(e,t,r,n)=>n?.concurrent?ekd(e,{other:t,onSelfDone:gR({onFailure:e=>e_K(p$(e)),onSuccess:e=>e_V(gR({onFailure:p$,onSuccess:t=>de(r(e,t))}))}),onOtherDone:gR({onFailure:e=>e_K(p$(e)),onSuccess:e=>e_V(gR({onFailure:p$,onSuccess:t=>de(r(t,e))}))})}):ekl(e,e=>ekp(t,t=>r(e,t)))));class ekS{value;constructor(e){this.value=e}}let ekx=(e,t)=>{e.isChanged=!0,e.newValue=t},ek_=e=>{e.ref.versioned=new ekS(e.newValue)},ekw=e=>({ref:e.ref,isNew:e.isNew,isChanged:e.isChanged,expected:e.expected,newValue:e.newValue}),ekk=e=>e.ref.versioned!==e.expected,ekO=e=>e.isChanged,ekE="Invalid",ekC="ReadWrite",ekF=e=>{for(let t of e)ek_(t[1])},ekI=e=>{let t="ReadOnly";for(let[,r]of e)if((t=ekk(r)?ekE:ekO(r)?ekC:t)===ekE)break;return t},ekT="WithSTMRuntime",ekR="OnFailure",ekN="OnRetry",ekM="OnSuccess",ekA="Provide",ekj="Sync",ekD="Succeed",ekP="Retry",ek$="Fail",ekz="Interrupt",ekL="Fail",ekU="Interrupt",ekB="Succeed",ekq="Retry",ekJ="Done",ekH="Suspend",ekW="Done",ekK="Interrupted",ekV="Running",ekG="effect/STM/State",ekZ=Symbol.for(ekG),ekQ=e=>({[ekZ]:ekZ,_tag:ekW,exit:e,[i0](){return ib(i1(ekG),i3(i1(ekW)),i3(i1(e)),se(this))},[st]:t=>iD(t,ekZ)&&t._tag===ekW&&sr(e,t.exit)}),ekY=ib(i1(ekG),i3(i1(ekK)),i3(i1("interrupted"))),ekX={[ekZ]:ekZ,_tag:ekK,[i0]:()=>ekY,[st]:e=>iD(e,ekZ)&&e._tag===ekK},ek0=ib(i1(ekG),i3(i1(ekV)),i3(i1("running"))),ek1={[ekZ]:ekZ,_tag:ekV,[i0]:()=>ek0,[st]:e=>iD(e,ekZ)&&e._tag===ekV},ek2=e=>{switch(e._tag){case ekL:return ekQ(gE(e.error));case"Die":return ekQ(gO(e.defect));case ekU:return ekQ(gC(uz(e.fiberId)));case ekB:return ekQ(gM(e.value));case ekq:throw Error("BUG: STM.STMState.fromTExit - please report an issue at https://github.com/Effect-TS/effect/issues")}},ek3="effect/TExit",ek5=Symbol.for(ek3),ek4={_A:e=>e,_E:e=>e},ek6=e=>({[ek5]:ek4,_tag:ekL,error:e,[i0](){return ib(i1(ek3),i3(i1(ekL)),i3(i1(e)),se(this))},[st]:t=>iD(t,ek5)&&t._tag===ekL&&sr(e,t.error)}),ek8=e=>({[ek5]:ek4,_tag:"Die",defect:e,[i0](){return ib(i1(ek3),i3(i1("Die")),i3(i1(e)),se(this))},[st]:t=>iD(t,ek5)&&"Die"===t._tag&&sr(e,t.defect)}),ek7=e=>({[ek5]:ek4,_tag:ekU,fiberId:e,[i0](){return ib(i1(ek3),i3(i1(ekU)),i3(i1(e)),se(this))},[st]:t=>iD(t,ek5)&&t._tag===ekU&&sr(e,t.fiberId)}),ek9=e=>({[ek5]:ek4,_tag:ekB,value:e,[i0](){return ib(i1(ek3),i3(i1(ekB)),i3(i1(e)),se(this))},[st]:t=>iD(t,ek5)&&t._tag===ekB&&sr(e,t.value)}),eOe=ib(i1(ek3),i3(i1(ekq)),i3(i1("retry"))),eOt={[ek5]:ek4,_tag:ekq,[i0]:()=>eOe,[st]:e=>iD(e,ek5)&&e._tag===ekq},eOr=e=>({_tag:ekH,journal:e}),eOn={ref:0},eOi=Symbol.for("effect/STM"),eOs={_R:e=>e,_E:e=>e,_A:e=>e};class eOa{effect_instruction_i0;_op=sg;effect_instruction_i1=void 0;effect_instruction_i2=void 0;[pd];[sT];[ew2];[ex1];get[eOi](){return eOs}constructor(e){this.effect_instruction_i0=e,this[pd]=sM,this[sT]=eOs,this[ew2]=eOs,this[ex1]=eOs}[st](e){return this===e}[i0](){return se(this,i2(this))}[Symbol.iterator](){return new pf(new iV(this))}commit(){return eOo(this,im,im)}pipe(){return sp(this,arguments)}}let eOo=(e,t,r)=>pS(n=>{let i=n.id(),s=n.getFiberRef(dW),a=n.getFiberRef(vB),o=n.getFiberRef(dK),l=eOl(i,e,s,a,o);switch(l._tag){case ekJ:return t(l.exit),l.exit;case ekH:{let n,l=(n=eOn.ref+1,eOn.ref=n,n),u={value:ek1},c=pC(t=>eOu(i,e,l,u,s,a,o,t));return da(e=>ib(e(c),pF(e=>{let n=u.value;return n._tag===ekV&&(u.value=ekX),(n=u.value)._tag===ekW?(t(n.exit),n.exit):(r(),p$(e))})))}}}),eOl=(e,t,r,n,i)=>{let s=new Map,a=new eOf(t,s,e,r).run(),o=ekI(s);if(o===ekC&&a._tag===ekB)ekF(s);else if(o===ekE)throw Error("BUG: STM.TryCommit.tryCommitSync - please report an issue at https://github.com/Effect-TS/effect/issues");switch(a._tag){case ekB:return eOc(gM(a.value),s,n,i);case ekL:return eOc(gC(uP(a.error)),s,n,i);case"Die":return eOc(gC(u$(a.defect)),s,n,i);case ekU:return eOc(gC(uz(e)),s,n,i);case ekq:return eOr(s)}},eOu=(e,t,r,n,i,s,a,o)=>{if(n.value._tag===ekV){let l=((e,t,r,n,i,s)=>{let a=new Map,o=new eOf(t,a,e,n).run(),l=ekI(a);if(l===ekC)ekF(a);else if(l===ekE)throw Error("BUG: STM.TryCommit.tryCommit - please report an issue at https://github.com/Effect-TS/effect/issues");switch(o._tag){case ekB:return r.value=ek2(o),eOc(gM(o.value),a,i,s);case ekL:return r.value=ek2(o),eOc(gC(uP(o.error)),a,i,s);case"Die":return r.value=ek2(o),eOc(gC(u$(o.defect)),a,i,s);case ekU:return r.value=ek2(o),eOc(gC(uz(e)),a,i,s);case ekq:return eOr(a)}})(e,t,n,i,s,a);switch(l._tag){case ekJ:eOh(l.exit,o);break;case ekH:((e,t,r)=>{for(let[,n]of t)n.ref.todos.has(e)||n.ref.todos.set(e,r)})(r,l.journal,()=>eOu(e,t,r,n,i,s,a,o))}}},eOc=(e,t,r,n)=>{let i=(e=>{let t=new Map;for(let[,r]of e){for(let e of r.ref.todos)t.set(e[0],e[1]);r.ref.todos=new Map}return t})(t);return i.size>0&&r.scheduleTask(()=>(e=>{for(let[t,r]of Array.from(e.entries()).sort((e,t)=>e[0]-t[0]))r()})(i),n),{_tag:ekJ,exit:e}},eOh=(e,t)=>{t(e)};class eOf{self;journal;fiberId;contStack=[];env;constructor(e,t,r,n){this.self=e,this.journal=t,this.fiberId=r,this.env=n}getEnv(){return this.env}pushStack(e){this.contStack.push(e)}popStack(){return this.contStack.pop()}nextSuccess(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==ekM;)e=this.popStack();return e}nextFailure(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==ekR;)e=this.popStack();return e}nextRetry(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==ekN;)e=this.popStack();return e}run(){let e,t=this.self;for(;void 0===e&&void 0!==t;)try{let r=t;if(r)switch(r._op){case"Tag":t=eOb((e,t,n)=>cw(n,r));break;case"Left":t=eOv(r.left);break;case"None":t=eOv(new gd);break;case"Right":t=eOC(r.right);break;case"Some":t=eOC(r.value);break;case"Commit":switch(r.effect_instruction_i0){case"Die":e=ek8(iQ(()=>r.effect_instruction_i1()));break;case ek$:{let n=this.nextFailure();void 0===n?e=ek6(iQ(()=>r.effect_instruction_i1())):t=iQ(()=>n.effect_instruction_i2(iQ(()=>r.effect_instruction_i1())));break}case ekP:{let r=this.nextRetry();void 0===r?e=eOt:t=iQ(()=>r.effect_instruction_i2());break}case ekz:e=ek7(this.fiberId);break;case ekT:t=iQ(()=>r.effect_instruction_i1(this));break;case ekM:case ekR:case ekN:this.pushStack(r),t=r.effect_instruction_i1;break;case ekA:{let e=this.env;this.env=iQ(()=>r.effect_instruction_i2(e)),t=ib(r.effect_instruction_i1,eOy(eOF(()=>this.env=e)));break}case ekD:{let n=r.effect_instruction_i1,i=this.nextSuccess();void 0===i?e=ek9(n):t=iQ(()=>i.effect_instruction_i2(n));break}case ekj:{let n=iQ(()=>r.effect_instruction_i1()),i=this.nextSuccess();void 0===i?e=ek9(n):t=iQ(()=>i.effect_instruction_i2(n))}}}}catch(e){t=eOg(e)}return e}}let eOp=ic(2,(e,t)=>{let r=new eOa(ekR);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),eOd=ic(2,(e,t)=>{let r=new eOa(ekA);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),eOg=e=>eOm(()=>e),eOm=e=>{let t=new eOa("Die");return t.effect_instruction_i1=e,t},eOb=e=>eOw(t=>eOC(e(t.journal,t.fiberId,t.getEnv()))),eOy=ic(2,(e,t)=>eO_(e,{onFailure:e=>eOI(t,eOv(e)),onSuccess:e=>eOI(t,eOC(e))})),eOv=e=>eOS(()=>e),eOS=e=>{let t=new eOa(ek$);return t.effect_instruction_i1=e,t},eOx=ic(2,(e,t)=>{let r=new eOa(ekM);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),eO_=ic(2,(e,{onFailure:t,onSuccess:r})=>ib(e,eOk(s3),eOp(e=>ib(t(e),eOk(s2))),eOx(e=>{switch(e._tag){case"Left":return eOC(e.left);case"Right":return r(e.right)}}))),eOw=e=>{let t=new eOa(ekT);return t.effect_instruction_i1=e,t},eOk=ic(2,(e,t)=>ib(e,eOx(e=>eOF(()=>t(e))))),eOO=ic(2,(e,t)=>{let r=new eOa(ekN);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),eOE=new eOa(ekP),eOC=e=>{let t=new eOa(ekD);return t.effect_instruction_i1=e,t},eOF=e=>{let t=new eOa(ekj);return t.effect_instruction_i1=e,t},eOI=ic(2,(e,t)=>ib(e,eOx(()=>t))),eOT=ic(3,(e,t,r)=>ib(e,eOx(e=>ib(t,eOk(t=>r(e,t)))))),eOR=((e,t)=>ib(e,eOk(()=>t)),ic(2,(e,{onFailure:t,onSuccess:r})=>eO_(e,{onFailure:e=>eOC(t(e)),onSuccess:e=>eOC(r(e))}))),eON=ic(e=>iD(e[0],Symbol.iterator),(e,t,r)=>r?.discard?ib(eOF(()=>e[Symbol.iterator]()),eOx(e=>{let r=eOA(()=>{let n=e.next();return n.done?eOj:ib(t(n.value),eOx(()=>r))});return r})):eOA(()=>a$(e).reduce((e,r)=>eOT(e,t(r),(e,t)=>(e.push(t),e)),eOC([])))),eOM=((e,t)=>eO_(e,{onFailure:e=>eOv(t(e)),onSuccess:eOC}),ic(2,(e,t)=>eOd(e,e=>t))),eOA=((e,t,r)=>{let n;return n=n=>eOx(r,r=>eOM(e,cS(n,t,r))),eOx(eOb((e,t,r)=>r),n)},e=>eOx(eOF(e),ih)),eOj=eOC(void 0),eOD=Symbol.for("effect/TRef"),eOP=(e,t)=>{if(t.has(e))return t.get(e);let r={ref:e,isNew:!1,isChanged:!1,expected:e.versioned,newValue:e.versioned.value};return t.set(e,r),r};(e,t)=>eOP(e,t).newValue,(e,t,r)=>eOA(()=>{let n=(t,r,i)=>r<t?eOC(i):ib(e.takeUpTo(r),eOx(s=>{let a=t-s.length;return 1===a?ib(e.take,eOk(e=>ib(i,ld(la(s)),lu(e)))):a>1?ib(e.take,eOx(e=>n(a-1,r-s.length-1,ib(i,ld(la(s)),lu(e))))):eOC(ib(i,ld(la(s))))}));return eOk(n(t,r,o7()),e=>Array.from(e))});class eO${capacity;array;size=0;current=0;constructor(e){this.capacity=e,this.array=Array.from({length:e},im)}head(){return am(this.array[this.current])}lastOrNull(){if(0===this.size)return;let e=0===this.current?this.array.length-1:this.current-1;return this.array[e]??void 0}put(e){this.array[this.current]=e,this.increment()}dropLast(){this.size>0&&(this.decrement(),this.array[this.current]=void 0)}toChunk(){let e=this.current-this.size;return lt(e<0?[...this.array.slice(this.capacity+e,this.capacity),...this.array.slice(0,this.current)]:this.array.slice(e,this.current))}increment(){this.size<this.capacity&&(this.size+=1),this.current=(this.current+1)%this.capacity}decrement(){this.size-=1,this.current>0?this.current-=1:this.current=this.capacity-1}}let eOz=Symbol.for("effect/Stream/Handoff"),eOL="Empty",eOU="Full",eOB=e=>({_tag:eOL,notifyConsumer:e}),eOq=(e,t)=>r=>{switch(r._tag){case eOL:return e(r.notifyConsumer);case eOU:return t(r.value,r.notifyProducer)}},eOJ={_A:e=>e},eOH=()=>ib(gL(),pB(e=>vM(eOB(e))),p2(e=>({[eOz]:eOJ,ref:e}))),eOW=ic(2,(e,t)=>pB(gL(),r=>pH(vD(e.ref,n=>ib(n,eOq(e=>[wJ(gK(e,void 0),gB(r)),{_tag:eOU,value:t,notifyProducer:r}],(r,i)=>[pB(gB(i),()=>ib(e,eOW(t))),n])))))),eOK=e=>pB(gL(),t=>pH(vD(e.ref,r=>ib(r,eOq(t=>[pB(gB(t),()=>eOK(e)),r],(e,r)=>[p_(gK(r,void 0),e),eOB(t)]))))),eOV="Emit",eOG="Halt",eOZ=e=>({_tag:eOG,cause:e}),eOQ=e=>({_tag:"End",reason:e}),eOY=Symbol.for("effect/Take"),eOX={_A:e=>e,_E:e=>e};class eO0{exit;[eOY]=eOX;constructor(e){this.exit=e}pipe(){return sp(this,arguments)}}let eO1=e=>new eO0(gM(e)),eO2=e=>dt(()=>e.exit),eO3=new eO0(gE(ah())),eO5=e=>new eO0(gC(ib(e,uQ(sV)))),eO4=ic(2,(e,{onEnd:t,onFailure:r,onSuccess:n})=>gR(e.exit,{onFailure:e=>af(g2(e),{onNone:t,onSome:r}),onSuccess:n})),eO6=e=>new eO0(gM(le(e))),eO8="ScheduleEnd",eO7="UpstreamEnd",eO9={_tag:eO8},eEe={_tag:eO7},eEt="DrainLeft",eEr="DrainRight",eEn="PullBoth",eEi="PullLeft",eEs="PullRight",eEa={_tag:eEt},eEo={_tag:eEr},eEl={_tag:eEn},eEu=e=>({_tag:eEi,rightChunk:e}),eEc=e=>({_tag:eEs,leftChunk:e}),eEh="PullBoth",eEf="PullLet",eEp="PullRight",eEd={_tag:eEh},eEg=e=>({_tag:eEf,rightChunk:e}),eEm=e=>({_tag:eEp,leftChunk:e}),eEb=Symbol.for("effect/Stream"),eEy={_R:e=>e,_E:e=>e,_A:e=>e};class eEv{channel;[eEb]=eEy;constructor(e){this.channel=e}pipe(){return sp(this,arguments)}}let eES=e=>iD(e,eEb)||pv(e),eEx=4096,eE_=((e,t,r)=>eEz(eE_(e,t,r),e=>s7(e,{onLeft:ah,onRight:sV})),ic(3,(e,t,r)=>eEG(wC([eOH(),vM(eO9),vM(o7()),EM(r),vM(!1),vM(!1)])).pipe(eEL(([r,n,i,s,a,o])=>{let l=e_h({onInput:e=>e_s(e_o(ib(r,eOW({_tag:eOV,elements:e}),Sb(()=>lS(e)))),()=>l),onFailure:e=>e_o(eOW(r,eOZ(e))),onDone:()=>e_o(eOW(r,eOQ(eEe)))}),u=ib(vj(i,o7()),pB(e=>lS(e)?ib(vA(a,!0),wJ(de(ib(e_b(e),e_s(()=>u))))):ib(eOK(r),p2(e=>{switch(e._tag){case eOV:return ib(e_o(vA(a,!0)),ewK(e_b(e.elements)),ewK(e_o(o.get)),e_s(e=>e?e_m:u));case eOG:return e_n(e.cause);case"End":if(e.reason._tag===eO8)return ib(a.get,p2(e=>e?e_o(ib(vA(n,eO9),wJ(vA(o,!0)))):ib(e_o(ib(vA(n,eO9),wJ(vA(o,!0)))),e_s(()=>u))),ewL);return ib(vA(n,e.reason),wJ(vA(o,!0)),e_o)}}))),ewL),c=(e,l,h)=>{let f=ib(vA(a,!1),wJ(vA(o,!1)),wJ(ib(u,ewR(ekm(t)),ex6,ewN,kE(h)))),p=(e,t,r)=>ib(vA(i,ly(e)),wJ(p2(n.get,e=>{switch(e._tag){case eO8:let n;return ib(wC([a.get,f,ib((n=sV(t),s.next(n)),kE(h))]),p2(([e,n,i])=>{let s=ib(r,af({onNone:()=>le(s3(t)),onSome:e=>o9(s3(t),s2(e))}));return e?ib(e_b(s),e_s(()=>c(n,i,h))):c(n,i,h)}),ewL);case eO7:return ib(a.get,p2(e=>e?e_b(le(s3(t))):e_m),ewL)}})),ewL);return ewL(w3(S$(e),S$(l),{onSelfDone:(e,t)=>ib(dv(l),wJ(ib(dt(()=>e),p2(([e,t])=>p(e,t,ah()))))),onOtherDone:(t,n)=>pK(dt(()=>t),{onFailure:t=>s7(uV(t),{onLeft:()=>ib(r,eOW(eOQ(eO9)),wN,wJ(ib(S$(e),p2(([e,t])=>p(e,t,ah()))))),onRight:t=>ib(r,eOW(eOZ(t)),wN,wJ(ib(S$(e),p2(([e,t])=>p(e,t,ah())))))}),onSuccess:t=>ib(r,eOW(eOQ(eO9)),wN,wJ(ib(S$(e),p2(([e,r])=>p(e,r,sV(t))))))})}))};return eCM(r=>e_l(eEK(e),l).pipe(ewN,kE(r),wJ(ewR(u,ekm(t)).pipe(ex6,ewN,kE(r),pB(e=>{let t;return(t=ah(),s.next(t)).pipe(kE(r),p2(t=>new eEv(c(e,t,r))))})))))})))),eEw=((e,t)=>p2(eCC(e,t),e=>eEH(eEQ(e))),(e,t)=>{let r=(e,t)=>{let n=r=>ib(t.get,dn(gB),wJ(gL()),pB(n=>ib(eS$(e,[r,n]),wJ(vA(t,n)),wJ(gB(n)))),pw,e_o);return e_h({onInput:n=>ib(gL(),pB(r=>ib(eS$(e,[eO1(n),r]),pB(e=>ib(vA(t,r),Sb(()=>e))))),pw,e_o,e_s(()=>r(e,t))),onFailure:e=>n(eO5(e)),onDone:()=>n(eO3)})};return ewU(ib(e,pB(e=>ib(gL(),dn(e=>gK(e,void 0)),pB(n=>{let i;return ib(vM(n),pB(n=>ib(t,e_l(r(e,n)),ewA,kC)),p_(i=ib(e_o(eSL(e)),e_s(([e,t])=>ewK(e_o(gK(t,void 0)),eO4(e,{onEnd:()=>e_m,onFailure:e_n,onSuccess:e=>ib(e_b(e),e_s(()=>i))}))))))})))))}),eEk=ic(2,(e,t)=>eEO(e,e=>s7(uV(e),{onLeft:t,onRight:eE$}))),eEO=ic(2,(e,t)=>new eEv(ib(eEK(e),ex4(e=>eEK(t(e)))))),eEE=ic(2,(e,t)=>ib(e,eEO(e=>ib(t(e),ap(()=>eE$(e)))))),eEC=e=>pI(p2(e,sV),e=>"None"===e._tag?Sc:pP(e.value)),eEF=ic(4,(e,t,r,n)=>{let i=(e,t)=>ewK(e_o(eOK(t)),e_h({onInput:r=>e_s(e_o(ib(e,eOW(eO1(r)))),()=>i(e,t)),onFailure:t=>e_o(eOW(e,eO5(t))),onDone:()=>e_o(eOW(e,eO3))}));return new eEv(ewB(s=>wC([eOH(),eOH(),eOH(),eOH()]).pipe(dn(([t,r,n])=>e_l(eEK(e),i(t,n)).pipe(e_q(s),kE(s))),dn(([e,r,n,a])=>e_l(eEK(t),i(r,a)).pipe(e_q(s),kE(s))),p2(([e,t,i,s])=>{let a=eOW(i,void 0).pipe(wJ(eOK(e).pipe(pB(eO2)))),o=eOW(s,void 0).pipe(wJ(eOK(t).pipe(pB(eO2))));return eEK(eCT(r,e=>pB(n(e,a,o),eEC)))}))))}),eEI=ic(2,(e,t)=>new eEv(ib(eEK(e),ewK(eEK(t))))),eET=((e,t)=>eEL(e,()=>t),ic(2,(e,t)=>ib(gL(),pB(r=>ib(e,eEM({maximumLag:t.maximumLag,decide:e=>pB(gB(r),t=>t(e))}),pB(e=>{let n;return ib(wC(lk(0<=(n=t.size-1)?lM(n-0+1,e=>0+e):le(0),t=>p2(e,([e,r])=>[[e,t],r]))),p2(la),pB(e=>{let[n,i]=oS(e,[new Map,o7()],([e,t],[r,n])=>[e.set(r[0],r[1]),ib(t,lc(n))]);return ib(gK(r,e=>p2(t.decide(e),e=>t=>e(n.get(t)))),p_(Array.from(i)))}))})))))),eER={ref:0},eEN=()=>{let e=eER.ref;return eER.ref=e+1,e},eEM=ic(2,(e,t)=>eEA(e,t.maximumLag,t.decide,()=>dl)),eEA=ic(4,(e,t,r,n)=>ib(wO(vM(new Map),(e,t)=>ib(e.get,pB(e=>ib(e.values(),wF(eS5))))),pB(i=>Cx(function*(){let s=yield*CO(1),a=yield*vM(ib(eS0(t),pB(e=>{let t=eEN();return ib(vP(i,r=>r.set(t,e)),p_([t,e]))}))),o=e=>s.withPermits(1)(ib(vA(a,ib(eS0(1),dn(t=>eS$(t,e)),pB(e=>{let t=eEN();return ib(vP(i,r=>r.set(t,e)),p_(aI(t,e)))}))),wJ(ib(i.get,pB(t=>ib(lt(t.values()),wF(t=>ib(eS$(t,e),v0(e=>sW(uG(e))?sV(dl):ah()))))))),wJ(n(e)),pw));return yield*ib(e,eCg(e=>ib(r(e),pB(t=>ib(i.get,pB(r=>ib(r.entries(),Su(o7(),(r,[n,i])=>t(n)?ib(eS$(i,gM(e)),pK({onFailure:e=>sW(uG(e))?de(ib(r,lc(n))):p$(e),onSuccess:()=>de(r)})):de(r)),pB(e=>lS(e)?vP(i,t=>{for(let r of e)t.delete(r);return t}):dl))))),pw)),pK({onFailure:e=>o(gC(ib(e,uQ(sV)))),onSuccess:()=>o(gE(ah()))}),kC),s.withPermits(1)(pH(a.get))})))),eEj=((e,t)=>{let r=e=>e_c({onInput:t=>{let n=ib(t,lf(e)),i=Math.max(0,e-t.length);return lv(t)||i>0?r(i):ib(e_b(n),ewK(ewb()))},onFailure:e_r,onDone:()=>e_m});return new eEv(ib(eEK(e),ewR(r(t))))},new eEv(e_m)),eED=ic(2,(e,t)=>new eEv(ib(eEK(e),ewf(t)))),eEP=e=>ib(eEG(gZ),eEL(e)),eE$=e=>eEG(p$(e)),eEz=((e,t)=>{let r=e=>{let n=e.next();return n.done?e_h({onInput:e=>r(e[Symbol.iterator]()),onFailure:e_n,onDone:e_f}):ib(t(n.value),p2(t=>t?ib(e_b(le(n.value)),e_s(()=>r(e))):r(e)),ewL)};return new eEv(e_d(()=>ib(eEK(e),e_l(r(o7()[Symbol.iterator]())))))},ic(2,(e,t)=>eE4(e,lg(t)))),eEL=ic(e=>eES(e[0]),(e,t,r)=>{let n=r?.bufferSize??16;return r?.switch?eEU(r?.concurrency,()=>eEB(e,1,n,t),r=>eEB(e,r,n,t)):eEU(r?.concurrency,()=>new eEv(ewu(eEK(e),e=>ib(e,lk(e=>eEK(t(e))),ov(e_m,(e,t)=>ib(e,ewK(t)))))),n=>new eEv(ib(eEK(e),ewu(ewq),ewF(e=>eEK(t(e)),r))))}),eEU=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r(Number.MAX_SAFE_INTEGER);default:return e>1?r(e):t()}},eEB=ic(4,(e,t,r,n)=>{let i;return new eEv(ib(eEK(e),ewu(ewq),ewF(e=>eEK(n(e)),{concurrency:t,mergeStrategy:((i=Object.create(e_6))._tag=e_5,i),bufferSize:r})))}),eEq=ic(e=>eES(e[0]),(e,t)=>eEL(e,ih,t)),eEJ=e=>{let t=e_h({onInput:e=>((e,t)=>{let[r,n]=ib(e,lC(e=>!gx(e))),i=ib(lx(n),af({onNone:()=>t,onSome:gR({onFailure:e=>af(g2(e),{onNone:()=>e_m,onSome:e_n}),onSuccess:()=>e_m})}));return ib(e_b(ib(r,lg(e=>gx(e)?sV(e.value):ah()))),e_s(()=>i))})(e,t),onFailure:e=>e_n(e),onDone:()=>e_m});return new eEv(ib(eEK(e),e_l(t)))},eEH=e=>{var t;let r;return t=eEJ(ib(e,eE3(e=>e.exit))),r=e_h({onInput:e=>e_s(ewq(e),()=>r),onFailure:e_n,onDone:()=>e_m}),new eEv(ib(eEK(t),e_l(r)))},eEW=e=>new eEv(e),eEK=e=>{if("channel"in e)return e.channel;if(pv(e))return eEK(eEG(e));throw TypeError("Expected a Stream.")},eEV=e=>new eEv(lv(e)?e_m:e_b(e)),eEG=e=>ib(e,p5(sV),eEZ),eEZ=e=>new eEv(ewL(v6(e,{onFailure:af({onNone:()=>e_m,onSome:e_r}),onSuccess:e=>e_b(le(e))}))),eEQ=(e,t)=>{let r=t?.maxChunkSize??eEx;if(t?.scoped){let n=p2(e.subscribe,e=>eE1(e,{maxChunkSize:r,shutdown:!0}));return t.shutdown?p2(n,eED(e.shutdown)):n}let n=eEL(eCS(e.subscribe),e=>eE1(e,{maxChunkSize:r}));return t?.shutdown?eED(n,e.shutdown):n},eEY=e=>eCx(()=>o6(e)?eEV(e):eEX(e[Symbol.iterator]())),eEX=(e,t=eEx)=>ib(dr(()=>{let r=[],n=e=>ib(dr(()=>{let i=e.next();if(1===t)return i.done?e_m:ib(e_b(le(i.value)),e_s(()=>n(e)));r=[];let s=0;for(;!1===i.done&&(r.push(i.value),!((s+=1)>=t));)i=e.next();return s>0?ib(e_b(la(r)),e_s(()=>n(e))):e_m}),ewL);return new eEv(n(e))}),eCR),eE0=e=>ib(e,p2(eCc),eCN),eE1=(e,t)=>ib(eSB(e,1,t?.maxChunkSize??eEx),pF(t=>ib(e.isShutdown,pB(e=>e&&sW(uG(t))?pP(ah()):p5(p$(t),sV)))),eCc,t?.shutdown?eED(eS5(e)):ih),eE2=((e,t)=>{let r=e=>ib(e.poll,p2(af({onNone:()=>e_c({onInput:t=>e_s(e_b(t),()=>r(e)),onFailure:e_r,onDone:()=>e_m}),onSome:gR({onFailure:e_n,onSuccess:()=>e_m})})),ewL);return new eEv(ewB(n=>t.pipe(kE(n),p2(t=>eEK(e).pipe(e_l(r(t)))))))},ic(2,(e,t)=>new eEv(ib(eEK(e),ewy(t))))),eE3=((e,t)=>new eEv(ib(eEK(e),ewv(t))),ic(2,(e,t)=>new eEv(ib(eEK(e),ewk(lk(t)))))),eE5=((e,t,r)=>{let n=e=>e_c({onInput:t=>{let[i,s]=lO(t,e,r);return e_s(e_b(s),()=>n(i))},onFailure:e_r,onDone:()=>e_m});return new eEv(ib(eEK(e),e_l(n(t))))},ic(3,(e,t,r)=>eCx(()=>{let n=e=>e_c({onInput:t=>ib(dt(()=>{let i=[];return ib(t,Su(e,(e,t)=>ib(r(e,t),pB(([e,t])=>ib(dr(()=>{i.push(t)}),p_(e))))),v6({onFailure:e=>0!==i.length?ewK(e_b(la(i)),e_r(e)):e_r(e),onSuccess:e=>e_s(e_b(la(i)),()=>n(e))}))}),ewL),onFailure:e_r,onDone:()=>e_m});return new eEv(ib(eEK(e),ewR(n(t))))}))),eE4=ic(2,(e,t)=>new eEv(ib(eEK(e),ewk(t)))),eE6=((e,t)=>ib(e,eE4(lb(t))),ic(2,(e,t)=>{let r=e=>{let n=e.next();return n.done?e_h({onInput:e=>r(e[Symbol.iterator]()),onFailure:e_n,onDone:e_f}):ewL(p2(t(n.value),t=>e_s(e_b(le(t)),()=>r(e))))};return new eEv(ib(eEK(e),e_l(e_d(()=>r(o7()[Symbol.iterator]())))))})),eE8=ic(3,(e,t,r)=>new eEv(ib(eEK(e),ewu(ewq),ewE(r,t),ewk(le)))),eE7=((e,t)=>new eEv(ib(eEK(e),ew_(t))),ic(e=>Symbol.iterator in e[0],(e,t)=>eEq(eEY(e),t))),eE9=ic(2,(e,t)=>eCe(e,t,{onSelf:s2,onOther:s3})),eCe=ic(3,(e,t,r)=>{let n=r.haltStrategy?(e=>{switch(e){case"left":return ewY;case"right":return ewX;case"both":return ew0;case"either":return ew1;default:return e}})(r.haltStrategy):ew0,i=e=>t=>e||!gx(t)?e_K(dt(()=>t)):e_V(e=>dt(()=>e));return new eEv(ewI(eEK(eE3(e,r.onSelf)),{other:eEK(eE3(t,r.onOther)),onSelfDone:i("Either"===n._tag||"Left"===n._tag),onOtherDone:i("Either"===n._tag||"Right"===n._tag)}))}),eCt=((e,t)=>new eEv(ib(eEK(e),ewT(()=>eEK(t())))),ic(2,(e,t)=>{let r=e_c({onInput:e=>lv(e)?e_d(()=>r):ib(e_b(e),ewK(ewb())),onFailure:e_r,onDone:()=>e_d(()=>eEK(t()))});return new eEv(ib(eEK(e),e_l(r)))})),eCr=((e=>"function"==typeof e[1],(e,t,r)=>ib(eE6(e,t),eET({size:2,maximumLag:r?.bufferSize??16,decide:s7({onLeft:()=>de(e=>0===e),onRight:()=>de(e=>1===e)})}),pB(([e,t])=>de([eEz(eEJ(eE1(e,{shutdown:!0})),e=>s7(e,{onLeft:sV,onRight:ah})),eEz(eEJ(eE1(t,{shutdown:!0})),e=>s7(e,{onLeft:ah,onRight:sV}))])))),ic(2,(e,t)=>new eEv(ib(eEK(e),e_u(t))))),eCn=((e,t)=>eCa(e,cO(t)),ic(2,(e,t)=>new eEv(ewB(r=>Oo(t,r).pipe(p2(t=>ib(eEK(e),e_u(t)))))))),eCi=ic(3,(e,t,r)=>eCs(e,t,eEG(r))),eCs=ic(3,(e,t,r)=>eEP(n=>eEL(r,r=>ib(e,eCr(cS(n,t,r)))))),eCa=ic(2,(e,t)=>eEP(r=>ib(e,eCr(t(r))))),eCo=((e,t)=>ib(e,eCn(ib(Oh(),Ov(t)))),ic(2,(e,t)=>eCx(()=>{let r=Math.max(t,1),n=eCl(new eCu(r),r);return new eEv(ib(eEK(e),e_l(n)))}))),eCl=(e,t)=>e_h({onInput:r=>{if(r.length===t&&e.isEmpty())return e_s(e_b(r),()=>eCl(e,t));if(r.length>0){let n,i=[],s=0;for(;s<r.length;){for(;s<r.length&&void 0===n;)n=e.write(ib(r,ll(s))),s+=1;void 0!==n&&(i.push(n),n=void 0)}return e_s(((...e)=>ewq(lt(e)))(...i),()=>eCl(e,t))}return e_d(()=>eCl(e,t))},onFailure:t=>ewK(e.emitIfNotEmpty(),e_n(t)),onDone:()=>e.emitIfNotEmpty()});class eCu{n;builder=[];pos=0;constructor(e){this.n=e}isEmpty(){return 0===this.pos}write(e){if(this.builder.push(e),this.pos+=1,this.pos===this.n){let e=la(this.builder);return this.builder=[],this.pos=0,e}}emitIfNotEmpty(){return 0!==this.pos?e_b(la(this.builder)):e_m}}(e,t,r)=>new eEv(ewl(eEK(e),e=>af(t(e),{onNone:()=>e_n(u$(r(e))),onSome:e_r})));let eCc=e=>eCT(e,e=>ib(p2(e,t=>sV([t,e])),pI(af({onNone:()=>de(ah()),onSome:pP})))),eCh=e=>eCc(ib(e,p2(le))),eCf=((e,t)=>eCf(e,t,{onElement:e=>s3(e),onSchedule:s2}),ic(3,(e,t,r)=>ib(EM(t),p2(t=>{let n=ib(e,eCi(E_,t.iterationMeta.get),eE3(r.onElement),eEK),i=ewL(v6(t.next(void 0),{onFailure:()=>e_m,onSuccess:e=>e_s(n,()=>ewK(e_b(le(r.onSchedule(e))),i))}));return new eEv(ewK(n,i))}),eCR))),eCp=((e,t)=>EM(t).pipe(p2(t=>{let r=eEK(eCi(E_,t.iterationMeta.get)(e)).pipe(ewO(e=>p_(t.reset,e)),ewl(e=>t.next(e).pipe(v6({onFailure:()=>e_r(e),onSuccess:()=>r}),ewL)));return r}),ewL,eEW),ic(2,(e,t)=>eEK(e).pipe(ewR(ekm(t)),ewM))),eCd=((e,t,r,n)=>eCp(e,eke(t,r,n)),ic(2,(e,t)=>eCp(e,ekc(t)))),eCg=ic(2,(e,t)=>ib(e,eCv(eku(t)))),eCm=ic(2,(e,t)=>ib(e,eCy(t))),eCb=((e,t)=>ib(e,eCy(t),Ck),ic(2,(e,t)=>{let r=e_h({onInput:e=>e_s(e_o(eSz(t,lk(e,gM))),()=>r),onFailure:e=>e_o(eS$(t,gC(uQ(e,sV)))),onDone:()=>e_o(eS$(t,gE(ah())))});return ib(e_l(eEK(e),r),ewh,ewA,pw)})),eCy=ic(2,(e,t)=>{let r=e_h({onInput:e=>e_s(e_b(eO1(e)),()=>r),onFailure:e=>e_b(eO5(e)),onDone:()=>e_b(eO3)});return ib(e_l(eEK(e),r),ewO(e=>eS$(t,e)),ewh,ewA,pw)}),eCv=ic(2,(e,t)=>ib(eEK(e),ewR(ekm(t)),ewh,ewA)),eCS=((e,t)=>ib(e,eE5(ah(),(e,r)=>{switch(e._tag){case"None":return de([sV(r),r]);case"Some":return ib(t(e.value,r),p2(e=>[sV(e),e]))}})),e=>new eEv(ewf(ewj(ib(e,p2(le))),dl))),eCx=((e,t,r)=>t<=0||r<=0?eEG(pM(new gf("Invalid bounds - `chunkSize` and `stepSize` must be greater than zero"))):new eEv(e_d(()=>{let n=new eO$(t),i=(e,i)=>{if(e<t){let e=n.toChunk();return ib(e_b(lv(e)?o7():le(e)),e_s(()=>i))}let s=e-(e-t)%r;if(s===e)return i;let a=ib(n.toChunk(),lI(e-(s-t+r)));return ib(e_b(lv(a)?o7():le(a)),e_s(()=>i))},s=e=>e_h({onInput:i=>e_s(e_b(lg(i,(i,s)=>{n.put(i);let a=e+s+1;return a<t||(a-t)%r>0?ah():sV(n.toChunk())})),()=>s(e+i.length)),onFailure:t=>i(e,e_n(t)),onDone:()=>i(e,e_m)});return ib(eEK(e),e_l(s(0)))})),e=>new eEv(e_d(()=>eEK(e())))),eC_=ic(2,(e,t)=>{let r=e_c({onInput:e=>{let n=ib(e,lT(t));return n.length===e.length?ib(e_b(n),e_s(()=>r)):e_b(n)},onFailure:e_r,onDone:e_f});return new eEv(ib(eEK(e),ewR(r)))}),eCw=((e,t)=>eE6(e,e=>p_(t(e),e)),(e,t,r,n,i)=>{let s=(e,a)=>e_h({onInput:o=>ib(t(o),wB(bp),p2(([t,l])=>{let u=e+(l-a)/cX(n)*r,c=r+i<0?1/0:r+i,h=u<0?c:Math.min(u,c);return t<=h?ib(e_b(o),e_s(()=>s(h-t,l))):s(e,a)}),ewL),onFailure:e_n,onDone:()=>e_m}),a=ib(bp,p2(e=>s(r,e)),ewL);return new eEv(ib(eEK(e),ewR(a)))}),eCk=(e,t,r,n,i)=>{let s=(e,a)=>e_h({onInput:o=>ib(t(o),wB(bp),p2(([t,l])=>{let u=e+(l-a)/cX(n)*r,c=r+i<0?1/0:r+i,h=(u<0?c:Math.min(u,c))-t,f=cK(Math.max(0,(h>=0?0:-h/r)*cX(n)));return c8(f,cq)?ib(e_o(vW(f)),ewK(e_b(o)),e_s(()=>s(h,l))):e_s(e_b(o),()=>s(h,l))}),ewL),onFailure:e_n,onDone:()=>e_m}),a=ib(bp,p2(e=>s(r,e)),ewL);return new eEv(ib(eEK(e),ewR(a)))},eCO=ic(3,(e,t,r)=>ib(eCF(e),p2(kT({onTimeout:()=>uQ(t(),sV),duration:r})),eE0)),eCE=((e,t,r)=>{let n=new go("Stream Timeout");return ib(e,eCO(()=>u$(n),t),eEE(e=>"Die"===e._tag&&iD(e.defect,ga)&&void 0!==e.defect.message&&"Stream Timeout"===e.defect.message?sV(r):ah()))},e=>{if("number"==typeof e)return exF(e);if("unbounded"===e.capacity){let t;return t={replay:e.replay},dt(()=>{let e;return exc((e=t,new exs(e?.replay?new exO(e.replay):void 0)),new exx)})}switch(e.strategy){case"dropping":return dt(()=>exc(eS7(e),new exx));case"sliding":return dt(()=>exc(eS7(e),new ex_));default:return exF(e)}}),eCC=ic(2,(e,t)=>ib(wO(eCE(t),e=>e.shutdown),dn(t=>ib(e,eCm(t),kC)))),eCF=e=>{let t;return p2((t=eEK(e),pB(wK,e=>ewP(t,e))),e=>ib(e,p5(sV),pB(s7({onLeft:()=>pP(ah()),onRight:de}))))},eCI=ic(e=>eES(e[0]),(e,t)=>dn(wO(t?.strategy==="unbounded"?eS3():t?.strategy==="dropping"?eS1(t.capacity??2):t?.strategy==="sliding"?eS2(t.capacity??2):eS0(t?.capacity??2),e=>eS5(e)),t=>kC(eCy(e,t)))),eCT=((e=>eES(e[0]),(e,t)=>dn(wO(eS0(t?.capacity??2),e=>eS5(e)),t=>kC(eCb(e,t)))),(e,t)=>eCx(()=>{let r=e=>ewL(p2(t(e),af({onNone:()=>e_m,onSome:([e,t])=>e_s(e_b(e),()=>r(t))})));return new eEv(r(e))})),eCR=e=>eEq(eEG(e)),eCN=e=>eEq(eCS(e)),eCM=e=>{let t;return eEq((t=t=>e(t),new eEv(ewD(e=>t(e).pipe(p2(le))))))},eCA=((e,t)=>ib(eEG(t),eEL(t=>t?e:eEj)),ic(3,(e,t,r)=>{let n=(e,t,r)=>{switch(e._tag){case eEh:return ib(eEC(t),wB(eEC(r),{concurrent:!0}),pV({onFailure:e=>de(gE(sV(e))),onSuccess:([e,s])=>sW(e)&&sW(s)?lv(e.value)&&lv(s.value)?n(eEd,t,r):lv(e.value)?n(eEg(s.value),t,r):lv(s.value)?n(eEm(e.value),t,r):de(gM(i(e.value,s.value))):de(gE(ah()))}));case eEf:return pV(t,{onFailure:e=>de(gE(e)),onSuccess:s=>lv(s)?n(eEg(e.rightChunk),t,r):lv(e.rightChunk)?n(eEm(s),t,r):de(gM(i(s,e.rightChunk)))});case eEp:return pV(r,{onFailure:e=>de(gE(e)),onSuccess:s=>lv(s)?n(eEm(e.leftChunk),t,r):lv(e.leftChunk)?n(eEg(s),t,r):de(gM(i(e.leftChunk,s)))})}},i=(e,t)=>{let[n,i]=r(e,t);switch(i._tag){case"Left":if(lv(i.left))return[n,eEd];return[n,eEm(i.left)];case"Right":if(lv(i.right))return[n,eEd];return[n,eEg(i.right)]}};return ib(e,eEF(t,eEd,n))})),eCj=(e,t,r)=>e.length>t.length?[ib(e,lh(t.length),lR(t,r)),s2(ib(e,lf(t.length)))]:[ib(e,lR(ib(t,lh(e.length)),r)),s3(ib(t,lf(e.length)))],eCD=ic(e=>eES(e[0]),(e,t="utf-8")=>eCx(()=>{let r=new TextDecoder(t);return eE3(e,e=>r.decode(e))})),eCP=Symbol.for("effect/GroupBy"),eC$={_R:e=>e,_E:e=>e,_K:e=>e,_V:e=>e},eCz=ic(e=>iD(e[0],eCP),(e,t,r)=>eEL(e.grouped,([e,r])=>t(e,eEH(eE1(r,{shutdown:!0}))),{concurrency:"unbounded",bufferSize:r?.bufferSize??16})),eCL=ic(e=>"function"!=typeof e[0],(e,t,r)=>r?.key?eCz(eCB(e,r.key,{bufferSize:r.bufferSize}),(e,r)=>eE6(r,t)):eEU(r?.concurrency,()=>eE6(e,t),n=>r?.unordered?eEL(e,e=>eEG(t(e)),{concurrency:n}):eE8(e,n,t)));class eCU extends b${dequeue;f;[eSE]={_Out:e=>e};constructor(e,t){super(),this.dequeue=e,this.f=t}capacity(){return this.dequeue.capacity()}get size(){return this.dequeue.size}unsafeSize(){return this.dequeue.unsafeSize()}get awaitShutdown(){return this.dequeue.awaitShutdown}isActive(){return this.dequeue.isActive()}get isShutdown(){return this.dequeue.isShutdown}get shutdown(){return eS5(this.dequeue)}get isFull(){return this.dequeue.isFull}get isEmpty(){return this.dequeue.isEmpty}get take(){return ib(eSL(this.dequeue),p2(e=>this.f(e)))}get takeAll(){return ib(this.dequeue.takeAll,p2(lk(e=>this.f(e))))}takeUpTo(e){return ib(eSU(this.dequeue,e),p2(lk(e=>this.f(e))))}takeBetween(e,t){return ib(eSB(this.dequeue,e,t),p2(lk(e=>this.f(e))))}takeN(e){return ib(eSq(this.dequeue,e),p2(lk(e=>this.f(e))))}poll(){return ib(p2(this.dequeue.takeUpTo(1),lx),p2(ax(e=>this.f(e))))}pipe(){return sp(this,arguments)}commit(){return this.take}}let eCB=ic(e=>"function"!=typeof e[0],(e,t,r)=>{let n=(e,i)=>e_h({onInput:s=>e_s(e_o(wF(eCq(s,t),([t,n])=>{let s=e.get(t);return void 0===s?ib(eS0(r?.bufferSize??16),pB(r=>ib(dr(()=>{e.set(t,r)}),wJ(eS$(i,eO6([t,r]))),wJ(ib(eS$(r,eO1(n)),v0(e=>uJ(e)?sV(dl):ah())))))):v0(eS$(s,eO1(n)),e=>uJ(e)?sV(dl):ah())},{discard:!0})),()=>n(e,i)),onFailure:e=>e_o(eS$(i,eO5(e))),onDone:()=>e_o(ib(wF(e.entries(),([e,t])=>ib(eS$(t,eO3),v0(e=>uJ(e)?sV(dl):ah())),{discard:!0}),wJ(eS$(i,eO3))))});return{[eCP]:eC$,pipe(){return sp(this,arguments)},grouped:eCM(t=>Cx(function*(){let r=new Map,i=yield*eS3();return yield*gr(t,eS5(i)),yield*eEK(e).pipe(e_l(n(r,i)),ewh,e_q(t),kE(t),p_(eEH(eE1(i,{shutdown:!0}))))}))}}),eCq=ic(2,(e,t)=>{let r,n=[],i=e[Symbol.iterator](),s=new Map;for(;(r=i.next())&&!r.done;){let e=r.value,i=t(e);if(s.has(i))s.get(i).push(e);else{let t=[e];n.push([i,t]),s.set(i,t)}}return la(n.map(e=>[e[0],la(e[1])]))}),eCJ=e=>eCp(e,ew7),eCH=ic(2,(e,t)=>e.log({fiberId:hd,logLevel:dO,message:t,cause:uD,context:bJ(),spans:h$(),annotations:l0,date:new Date})),eCW=CD(wb,wy),eCK=CD(wb,wv),eCV=CD(wb,wS),eCG=CD(wb,wx);e.s(["LoggerTypeId",0,SU,"add",0,CN,"addEffect",0,CM,"addScoped",0,CA,"batched",0,wk,"defaultLogger",0,wb,"filterLogLevel",0,SW,"isLogger",0,e=>"object"==typeof e&&null!=e&&SU in e,"json",0,eCW,"jsonLogger",0,S5,"logFmt",0,eCK,"logfmtLogger",0,S1,"make",0,Sq,"map",0,SK,"mapInput",0,SJ,"mapInputOptions",0,SH,"minimumLogLevel",0,e=>O_(wX(wg,e)),"none",0,{[SU]:SB,log:im,pipe(){return sp(this,arguments)}},"pretty",0,eCV,"prettyLogger",0,xn,"prettyLoggerDefault",0,xa,"remove",0,Cj,"replace",0,CD,"replaceEffect",0,CP,"replaceScoped",0,C$,"simple",0,SV,"stringLogger",0,S0,"structured",0,eCG,"structuredLogger",0,S2,"succeed",0,e=>SV(()=>e),"sync",0,e=>SV(e),"test",0,eCH,"tracerLogger",0,w_,"withConsoleError",0,e=>Sq(t=>{cw(bY(t.context,bc),m4).unsafe.error(e.log(t))}),"withConsoleLog",0,wm,"withLeveledConsole",0,e=>Sq(t=>{let r=cw(bY(t.context,bc),m4).unsafe;switch(t.logLevel._tag){case"Debug":return r.debug(e.log(t));case"Info":return r.info(e.log(t));case"Trace":return r.trace(e.log(t));case"Warning":return r.warn(e.log(t));case"Error":case"Fatal":return r.error(e.log(t));default:return r.log(e.log(t))}}),"withMinimumLogLevel",0,CR,"withSpanAnnotations",0,e=>SH(e,e=>{let t=a_(bQ(e.context,dW),ck(bn));return"None"===t._tag?e:{...e,annotations:ib(e.annotations,l4("effect.traceId",t.value.traceId),l4("effect.spanId",t.value.spanId),"Span"===t.value._tag?l4("effect.spanName",t.value.name):ih)}}),"zip",0,SG,"zipLeft",0,SZ,"zipRight",0,SQ],76779);var eCZ=e.i(76779);let eCQ="@effect/platform/FetchHttpClient/Fetch",eCY=(D=(e,t,r,n)=>{let i=n.getFiberRef(H$),s=i.unsafeMap.get(eCQ)??globalThis.fetch,a=i.unsafeMap.get("@effect/platform/FetchHttpClient/FetchOptions")??{},o=a.headers?ebn(ebe(a.headers),e.headers):e.headers,l=n=>JX(ZE({try:()=>s(t,{...a,method:e.method,headers:o,body:n,duplex:"Stream"===e.body._tag?"half":void 0,signal:r}),catch:t=>new eyq({request:e,reason:"Transport",cause:t})}),t=>new evo(e,t));switch(e.body._tag){case"Raw":case"Uint8Array":return l(e.body.body);case"FormData":return l(e.body.formData);case"Stream":return JU(ecI(e.body.stream),l)}return l(void 0)},evg(e=>JU(e,e=>Jv(t=>{let r=evb.get(e),n=r??new AbortController,i=((e,t,r)=>{try{let n=new URL(e,(()=>{if("location"in globalThis&&void 0!==globalThis.location&&void 0!==globalThis.location.origin&&void 0!==globalThis.location.pathname)return location.origin+location.pathname})());for(let e=0;e<t.length;e++){let[r,i]=t[e];void 0!==i&&n.searchParams.append(r,i)}return"Some"===r._tag&&(n.hash=r.value),PA(n)}catch(e){return PM(e)}})(e.url,e.urlParams,e.hash);if("Left"===i._tag)return JD(new eyq({request:e,reason:"InvalidUrl",cause:i.left}));let s=i.right;if(!t.getFiberRef(HY)||t.getFiberRef(evh)(e)){let i=D(e,s,n.signal,t);return r?i:Hi(e=>JH(e(i),{onSuccess:e=>(evm.register(e,n),J7(new evy(e,n))),onFailure:e=>(D7(Ur(e))&&n.abort(),JP(e))}))}return env(Pg(t.currentContext,evp)(e),{kind:"client",captureStackTrace:!1},i=>{i.attribute("http.request.method",e.method),i.attribute("server.address",s.origin),""!==s.port&&i.attribute("server.port",+s.port),i.attribute("url.full",s.toString()),i.attribute("url.path",s.pathname),i.attribute("url.scheme",s.protocol.slice(0,-1));let a=s.search.slice(1);""!==a&&i.attribute("url.query",a);let o=t.getFiberRef(eba),l=ebs(e.headers,o);for(let e in l)i.attribute(eyL(e),String(l[e]));return e=t.getFiberRef(evf)?ey4(e,Object.setPrototypeOf({b3:`${i.traceId}-${i.spanId}-${i.sampled?"1":"0"}${"Some"===i.parent._tag?`-${i.parent.value.spanId}`:""}`,traceparent:`00-${i.traceId}-${i.spanId}-${i.sampled?"01":"00"}`},em8)):e,Hi(a=>a(D(e,s,n.signal,t)).pipe(ZN(i),JH({onSuccess:e=>{i.attribute("http.response.status_code",e.status);let t=ebs(e.headers,o);for(let e in t)i.attribute(eyU(e),String(t[e]));return r?J7(e):(evm.register(e,n),J7(new evy(e,n)))},onFailure:e=>(!r&&D7(Ur(e))&&n.abort(),JP(e))})))})})),J7)),eCX=(P=J7(eCY),eta(evc,JU(WB,e=>JX(P,t=>evC(t,WH(t=>Pb(e,t)))))));class eC0 extends Pv(eCQ)(){}function eC1(e,t){return pB(e.runtimeEffect,e=>pS(r=>(r.setFiberRefs(e.fiberRefs),r.currentRuntimeFlags=e.runtimeFlags,gQ(t,e.context))))}let eC2={...sD,[k$]:k$,pipe(){return sp(this,arguments)},commit(){return this.runtimeEffect}},eC3={get url(){return`file://${e.P("Pictures/APPLICATION DECRYPT FULL NO FXAP/TOOLS WEBSITE/node_modules/uploadthing/dist/upload-builder-BlFOAnsv.js")}`}},eC5=mL().pipe(mK(()=>mU(new Map(Object.entries(Object.fromEntries(Object.entries(eC3?.env??{}).filter(e=>null!=e[1])))),{pathDelim:"_"})),mW("uploadthing"),e=>mJ(e,mM)),eC4=(ep="isDev",$=bF("a boolean property",e=>{switch(e){case"true":case"yes":case"on":case"1":return s3(!0);case"false":case"no":case"off":case"0":return s3(!1);default:return s2(mt([],`Expected a boolean value but received ${e}`))}}),void 0===ep?$:bO($,ep)).pipe(bE(()=>bT("undefined"!=typeof process?"production":void 0).pipe(b_(e=>"development"===e))),bN(!1)),eC6=(L=N$(jk.ast,!0,z),bI("token").pipe(bk(e=>L(e).pipe(s6(e=>mt([],N2.formatIssueSync(e))))))).pipe(v2({ConfigError:e=>new ia({code:"InvalidData"===e._op?"INVALID_SERVER_CONFIG":"MISSING_ENV",message:"InvalidData"===e._op?"Invalid token. A token is a base64 encoded JSON object matching { apiKey: string, appId: string, regions: string[] }.":"Missing token. Please set the `UPLOADTHING_TOKEN` environment variable or provide a token manually through config.",cause:e})}));bI("apiUrl").pipe(bN("https://api.uploadthing.com"),bw(e=>new URL(e)),b_(e=>e.href.replace(/\/$/,"")));let eC8=CF(function*(e){let{regions:t,ingestHost:r}=yield*eC6,n=e?t.find(t=>t===e)??t[0]:t[0];return yield*bI("ingestUrl").pipe(bN(`https://${n}.${r}`),bw(e=>new URL(e)),b_(e=>e.href.replace(/\/$/,"")))});function eC7(e){return{message:e.message}}function eC9(e,t){let r=Object.keys(t)[0];return(r?t[r]?.errorFormatter??eC7:eC7)(e)}bI("utfsHost").pipe(bN("utfs.io")),bI("ufsHost").pipe(bN("ufs.sh")),bM("subdomain","path")("ufsAppIdLocation").pipe(bN("subdomain"));let eFe=(ed="logLevel",U=bk(bI(),e=>{let t=dI.find(t=>t._tag===e);return void 0===t?s2(mt([],`Expected a log level but received ${e}`)):s3(t)}),void 0===ed?U:bO(U,ed)).pipe(bN(dO),pq(e=>eCZ.minimumLogLevel(e)),Sd(e=>Si("Invalid log level").pipe(vX("error",e))),v1("ConfigError",e=>new ia({code:"INVALID_SERVER_CONFIG",message:"Invalid server configuration",cause:e})),OR),eFt=bM("json","logFmt","structured","pretty")("logFormat"),eFr=Cx(function*(){let e=yield*eC4;return eCZ[yield*eFt.pipe(bN(e?"pretty":"json"))]}).pipe(v1("ConfigError",e=>new ia({code:"INVALID_SERVER_CONFIG",message:"Invalid server configuration",cause:e})),OR),eFn=(e,t)=>{let r=t?.mixin??"json",n=yf(t?.level??"Debug");return t=>pB("None"!==r?t[r]:dl,()=>((e,...t)=>v9(e)(...t))(n,`${e} (${t.status})`).pipe(vX("response",t)))},eFi=e=>t=>"ResponseError"===t._tag?eFn(e,{level:"Error"})(t.response):Si(e).pipe(vX("error",t));var eFs=class extends bj("ParserError"){message="Input validation failed. The original error with it's validation issues is in the error cause."},eFa=class extends bA{_tag="FileSizeMismatch";name="FileSizeMismatchError";constructor(e,t,r){super({reason:`You uploaded a ${e} file that was ${(e=>{if(0===e||-1===e)return"0B";let t=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,t)).toFixed(2)}${ie[t]}`})(r)}, but the limit for that type is ${t}`})}},eFo=class extends bA{_tag="FileCountMismatch";name="FileCountMismatchError";constructor(e,t,r,n){super({reason:`You uploaded ${n} file(s) of type '${e}', but the ${t} for that type is ${r}`})}};let eFl=Symbol("uploadthing-region-symbol"),eFu=Symbol("uploadthing-custom-id-symbol");var eFc=class extends cC("uploadthing/AdapterArguments")(){};let eFh=e=>Cx(function*(){let{uploadable:t}=e,r=yield*eyE,{apiKey:n}=yield*eC6,i=yield*iu((yield*r.text),r.headers["x-uploadthing-signature"]??null,n);if(yield*St(`Signature verified: ${i}`),!i)return yield*Si("Invalid signature"),yield*new ia({code:"BAD_REQUEST",message:"Invalid signature"});let s=yield*eyI(Ae({fileKey:MN,error:MN}));yield*St("Handling error callback request with input:").pipe(vX("json",s));let a=yield*eFc;return{body:null,fiber:yield*Sm({try:async()=>t.onUploadError({...a,error:new ia({code:"UPLOAD_FAILED",message:`Upload failed for ${s.fileKey}: ${s.error}`}),fileKey:s.fileKey}),catch:e=>new ia({code:"INTERNAL_SERVER_ERROR",message:"Failed to run onUploadError",cause:e})}).pipe(Sd(e=>Si("Failed to run onUploadError. You probably shouldn't be throwing errors here.").pipe(vX("error",e)))).pipe(Cw,wN)}}).pipe(Ss("handleErrorRequest")),eFf=e=>Cx(function*(){let t,{uploadable:r,fePackage:n,beAdapter:i}=e,s=yield*eyE,{apiKey:a}=yield*eC6,o=yield*iu((yield*s.text),s.headers["x-uploadthing-signature"]??null,a);if(yield*St(`Signature verified: ${o}`),!o)return yield*Si("Invalid signature"),yield*new ia({code:"BAD_REQUEST",message:"Invalid signature"});let l=yield*eyI(Ae({status:MN,file:jC,origin:MN,metadata:function e(t,r,n){return class extends M9({},[{key:t,value:r}],n){static annotations(n){return e(t,r,Mb(this.ast,n))}static key=t;static value=r}}((t={key:MN,value:MI}).key,t.value)}));return yield*St("Handling callback request with input:").pipe(vX("json",l)),{body:null,fiber:yield*Cx(function*(){let e=yield*eFc,t=yield*Sm({try:async()=>r.onUploadComplete({...e,file:{...l.file,get url(){return eq("`file.url` is deprecated and will be removed in uploadthing v9. Use `file.ufsUrl` instead."),l.file.url},get appUrl(){return eq("`file.appUrl` is deprecated and will be removed in uploadthing v9. Use `file.ufsUrl` instead."),l.file.appUrl}},metadata:l.metadata}),catch:e=>new ia({code:"INTERNAL_SERVER_ERROR",message:"Failed to run onUploadComplete. You probably shouldn't be throwing errors here.",cause:e})}),s={fileKey:l.file.key,callbackData:t??null};yield*St("'onUploadComplete' callback finished. Sending response to UploadThing:").pipe(vX("callbackData",s));let o=(yield*evc).pipe(evI);yield*eyQ("/callback-result").pipe(eve(l.origin),ey4({"x-uploadthing-api-key":Ml(a),"x-uploadthing-version":eB,"x-uploadthing-be-adapter":i,"x-uploadthing-fe-package":n}),evs(s),pB(o.execute),Sd(eFi("Failed to register callback result")),pB(ebI(jT)),dn(Se("Sent callback result to UploadThing")),Ck)}).pipe(Cw,wN)}}).pipe(Ss("handleCallbackRequest")),eFp=e=>Cx(function*(){let t,r,n=(yield*evc).pipe(evI),{uploadable:i,fePackage:s,beAdapter:a,slug:o}=e,l=yield*eyI(jR);yield*St("Handling upload request").pipe(vX("json",l)),yield*St("Parsing user input");let u=yield*Sm({try:()=>(function(e){if("parseAsync"in e&&"function"==typeof e.parseAsync)return e.parseAsync;if(MS(e))return t=>{let r;return(r=Mv(e,void 0),(e,t)=>k4(r(e,t)))(t).catch(e=>{let t;throw new eFs({cause:(t=e[kK],gn(ih)(t))})})};if("~standard"in e)return async t=>{let r=await e["~standard"].validate(t);if(r.issues)throw new eFs({cause:r.issues});return r.value};throw Error("Invalid parser")})(i.inputParser)(l.input),catch:e=>new ia({code:"BAD_REQUEST",message:"Invalid input",cause:e})});yield*St("Input parsed successfully").pipe(vX("input",u));let{metadata:c,filesWithCustomIds:h,preferredRegion:f}=yield*(t={json:{input:u,files:l.files},uploadable:i},Cx(function*(){let{json:{files:e,input:r},uploadable:n}=t;yield*St("Running middleware");let i=yield*eFc,s=yield*Sm({try:async()=>n.middleware({...i,input:r,files:e}),catch:e=>e instanceof ia?e:new ia({code:"INTERNAL_SERVER_ERROR",message:"Failed to run middleware",cause:e})});if(s[eFu]&&s[eFu].length!==e.length){let t=`Expected files override to have the same length as original files, got ${s[eFu].length} but expected ${e.length}`;return yield*Si(t),yield*new ia({code:"BAD_REQUEST",message:"Files override must have the same length as files",cause:t})}let a=yield*wF(e,(e,t)=>Cx(function*(){let r=s[eFu]?.[t];return r&&r.size!==e.size&&(yield*Sn("File size mismatch. Reverting to original size")),{name:r?.name??e.name,size:e.size,type:e.type,customId:r?.customId,lastModified:r?.lastModified??Date.now()}}));return{metadata:s,filesWithCustomIds:a,preferredRegion:s[eFl]}}).pipe(Ss("runRouteMiddleware")));yield*St("Parsing route config").pipe(vX("routerConfig",i.routerConfig));let p=yield*n7(i.routerConfig).pipe(v1("InvalidRouteConfig",e=>new ia({code:"BAD_REQUEST",message:"Invalid route config",cause:e})));yield*St("Route config parsed successfully").pipe(vX("routeConfig",p)),yield*St("Validating files meet the config requirements").pipe(vX("files",l.files)),yield*(r=l.files,Cx(function*(){let e={};for(let t of r){let r=yield*n9(t,ir(p));e[r]=(e[r]??0)+1;let n=p[r]?.maxFileSize;if(!n)return yield*new n3(r,"maxFileSize");let i=yield*it(n);if(t.size>i)return yield*new eFa(r,n,t.size)}for(let t in e){let r=p[t];if(!r)return yield*new n3(t);let n=e[t],i=r.minFileCount,s=r.maxFileCount;if(i>s)return yield*new ia({code:"BAD_REQUEST",message:"Invalid config during file count - minFileCount > maxFileCount",cause:`minFileCount must be less than maxFileCount for key ${t}. got: ${i} > ${s}`});if(null!=n&&n<i)return yield*new eFo(t,"minimum",i,n);if(null!=n&&n>s)return yield*new eFo(t,"maximum",s,n)}return null})).pipe(p5(e=>new ia({code:"BAD_REQUEST",message:`Invalid config: ${e._tag}`,cause:"reason"in e?e.reason:e.message}))),yield*St("Files validated.");let d=yield*wF(h,e=>p2(n9(e,ir(p)),t=>({name:e.name,size:e.size,type:e.type||t,lastModified:e.lastModified,customId:e.customId,contentDisposition:p[t]?.contentDisposition??"inline",acl:p[t]?.acl}))).pipe(v2({InvalidFileType:e=>pM(e),UnknownFileType:e=>pM(e)})),g=i.routeOptions,{apiKey:m,appId:b}=yield*eC6,y=yield*eC8(f),v=yield*eC4;yield*St("Generating presigned URLs").pipe(vX("fileUploadRequests",d),vX("ingestUrl",y));let S=yield*wF(d,e=>Cx(function*(){let t,r,n,i=yield*(t=g.getFileHashParts,rG(()=>{let r=JSON.stringify(t?.(e)??[e.name,e.size,e.type,e.lastModified,Date.now()]),n=function(e,t){let r,n,i=e.split(""),s=tt(t);for(let e=0;e<i.length;e++)n=(s%(e+1)+e)%i.length,r=i[e],i[e]=i[n],i[n]=r;return i.join("")}(n1.alphabet,b),i=new n2({alphabet:n,minLength:36}).encode([Math.abs(tt(r))]);return new n2({alphabet:n,minLength:12}).encode([Math.abs(tt(b))])+i}).pipe(nw("generateKey")));return{url:yield*(r=`${y}/${i}`,n={ttlInSeconds:g.presignedURLTTL,data:{"x-ut-identifier":b,"x-ut-file-name":e.name,"x-ut-file-size":e.size,"x-ut-file-type":e.type,"x-ut-slug":o,"x-ut-custom-id":e.customId,"x-ut-content-disposition":e.contentDisposition,"x-ut-acl":e.acl}},r4(function*(){let e,t=new URL(r),i=n.ttlInSeconds?function(e){if("number"==typeof e)return e;let t=e.split(/(\d+)/).filter(Boolean);return Number(t[0])*({s:1,m:60,h:3600,d:86400})[(t[1]??"s").trim().slice(0,1)]}(n.ttlInSeconds):3600,s=Date.now()+1e3*i;t.searchParams.append("expires",s.toString()),n.data&&Object.entries(n.data).forEach(([e,r])=>{if(null==r)return;let n=encodeURIComponent(r);t.searchParams.append(e,n)});let a=yield*(e=t.toString(),r4(function*(){let t=yield*r0({try:()=>crypto.subtle.importKey("raw",il.encode(n0(m)),io,!1,["sign"]),catch:e=>new ia({code:"BAD_REQUEST",message:"Invalid signing secret",cause:e})}),r=yield*nn(r0({try:()=>crypto.subtle.sign(io,t,il.encode(e)),catch:e=>new ia({code:"BAD_REQUEST",cause:e})}),e=>{let t;return"string"==typeof(t=new Uint8Array(e))?nZ(nG.encode(t)):nZ(t)});return`hmac-sha256=${r}`}).pipe(nw("signPayload")));return t.searchParams.append("signature",a),t.href}).pipe(nw("generateSignedURL"))),key:i}}),{concurrency:"unbounded"}),x=yield*eyE,_=yield*eyT(x),w=yield*bI("callbackUrl").pipe(bN(_.origin+_.pathname),p2(e=>eyQ(e).pipe(evt("slug",o)))),k=eyQ("/route-metadata").pipe(eve(y),ey4({"x-uploadthing-api-key":Ml(m),"x-uploadthing-version":eB,"x-uploadthing-be-adapter":a,"x-uploadthing-fe-package":s}),evs({fileKeys:S.map(({key:e})=>e),metadata:c,isDev:v,callbackUrl:w.url,callbackSlug:o,awaitServerData:g.awaitServerData??!0}),pB(n.execute)),O=CF("handleDevStreamError")(function*(e,t){let r=AN(Ae({file:jC})),i=(yield*Mv(r)(t)).file.key;yield*Si("Failed to forward callback request from dev stream").pipe(vX({fileKey:i,error:e.message}));let o=yield*eyQ("/callback-result").pipe(eve(y),ey4({"x-uploadthing-api-key":Ml(m),"x-uploadthing-version":eB,"x-uploadthing-be-adapter":a,"x-uploadthing-fe-package":s}),evs({fileKey:i,error:`Failed to forward callback request from dev stream: ${e.message}`}),pB(n.execute));yield*eFn("Reported callback error to UploadThing")(o)}),E=yield*pQ(v,{onTrue:()=>{let e;return k.pipe(Sf({onSuccess:eFn("Registered metadata",{mixin:"None"}),onFailure:eFi("Failed to register metadata")}),evT,(e=e=>w.pipe(ey4({"uploadthing-hook":e.hook,"x-uploadthing-signature":e.signature}),evi(emB(e.payload,"application/json")),n.execute,dn(eFn("Successfully forwarded callback request from dev stream")),v1("ResponseError",t=>O(t,e.payload)),vX(e),pw,Cw,Ck),t=>{let r="";return t.pipe(eCD(),eCL(e=>Cx(function*(){let t=(r+=e).split("\n"),n=[];for(let e of t)try{n.push(JSON.parse(e)),r=r.slice(e.length+1)}catch{}return yield*St("Received chunks").pipe(vX("chunk",e),vX("parsedChunks",n),vX("buf",r)),n})),eCL(Mv(MU(jF))),eCL(wF(t=>e(t))),eCJ,Ss("handleJsonLineStream"))}))},onFalse:()=>k.pipe(Sf({onSuccess:eFn("Registered metadata"),onFailure:eFi("Failed to register metadata")}),pB(ebI(jI)),Ck)}).pipe(wN),C=S.map((e,t)=>({url:e.url,key:e.key,name:d[t].name,customId:d[t].customId??null}));return yield*Sr("Sending presigned URLs to client").pipe(vX("presignedUrls",C)),{body:C,fiber:E}}).pipe(Ss("handleUploadAction"));var eFd=e.i(23422),eFg=e.i(36348),eFm=e.i(4236),eFb=e.i(33929);let eFy=(eg=void 0,(e,t)=>(function e(t={}){let r={$types:{},routerConfig:{image:{maxFileSize:"4MB"}},routeOptions:{awaitServerData:!0},inputParser:{parseAsync:()=>Promise.resolve(void 0),_input:void 0,_output:void 0},middleware:()=>({}),onUploadError:()=>{},onUploadComplete:()=>void 0,errorFormatter:t.errorFormatter??eC7,...t};return{input:t=>e({...r,inputParser:t}),middleware:t=>e({...r,middleware:t}),onUploadComplete:e=>({...r,onUploadComplete:e}),onUploadError:t=>e({...r,onUploadError:t})}})({routerConfig:e,routeOptions:t??{},...eg})),{GET:eFv,POST:eFS}=(em={router:{assetUploader:eFy({"application/zip":{maxFileSize:"256MB"}}).middleware(async({req:e})=>{let t=await (0,eFd.getServerSession)(eFg.authOptions);if(!t?.user)throw eFm.security.logSecurityEvent("Unauthorized upload attempt",{userId:"unknown"},"medium"),Error("Unauthorized");if(!eFm.security.checkRateLimit(`upload_${t.user.id}`,20,3e5))throw eFm.security.logSecurityEvent("Upload rate limit exceeded",{userId:t.user.id},"medium"),Error("Upload rate limit exceeded");return{userId:t.user.id}}).onUploadComplete(async({metadata:e,file:t})=>{let r=(0,eFm.validateFileUpload)({name:t.name,size:t.size,type:t.type||"application/octet-stream"});if(!r.valid)throw eFm.security.logSecurityEvent("Invalid file uploaded",{userId:e.userId,fileName:t.name,error:r.error},"high"),Error(r.error||"Invalid file");eFm.security.logSecurityEvent("File upload completed",{userId:e.userId,fileName:t.name,fileSize:t.size,fileUrl:t.url},"low");try{let r=await (0,eFb.getSupabaseAdminClient)();await r.from("coin_transactions").insert({user_id:e.userId,amount:0,type:"file_upload",description:`Uploaded: ${t.name} (${(t.size/1024/1024).toFixed(2)}MB)`})}catch(e){console.error("Failed to log upload transaction:",e)}return{uploadedBy:e.userId,fileUrl:t.url,fileName:t.name,fileSize:t.size,uploadedAt:new Date().toISOString()}}),thumbnailUploader:eFy({"image/jpeg":{maxFileSize:"4MB"},"image/png":{maxFileSize:"4MB"},"image/webp":{maxFileSize:"4MB"}}).middleware(async({req:e})=>{let t=await (0,eFd.getServerSession)(eFg.authOptions);if(!t?.user)throw Error("Unauthorized");return{userId:t.user.id}}).onUploadComplete(async({metadata:e,file:t})=>({uploadedBy:e.userId,thumbnailUrl:t.url}))}},eb=e=>de({req:e}),ey=e=>de(e),en=em.config?.fetch,ei=em.config,es=OF(OS(eFr,eFe,OI(eCX,Ok(eC0,en)),Om(p2(dD(eba,e=>e.concat(["x-uploadthing-api-key"])),()=>cy))),O_(w0(bc,cS(mD,mU(new Map(oh((eo=ei??{},X=(e,t)=>"string"==typeof t?aD([e,t]):"number"==typeof t||"boolean"==typeof t?aD([e,String(t)]):aH(t)?ee(e,t):"object"==typeof t&&null!==t?et(e,t):ou(),ee=(e,t)=>aL(t,{onEmpty:()=>aD([e,"<nil>"]),onNonEmpty:of((t,r)=>X(aq(e,{_tag:"KeyIndex",index:r}),t))}),(et=(e,t)=>Object.entries(t).filter(([,e])=>i$(e)).flatMap(([t,r])=>{let n=aq(e,{_tag:"KeyName",name:t}),i=X(n,r);return 0===i.length?aD([n,""]):i}))(ou(),eo)),([e,t])=>[(e=>{let t=[],r=0;for(;r<e.length;){let n=e[r];if("KeyName"===n._tag)if(r+1<e.length){let i=e[r+1];"KeyIndex"===i._tag?(t.push(`${n.name}[${i.index}]`),r+=2):(t.push(n.name),r+=1)}else t.push(n.name),r+=1}return t})(e).join("\uFEFF"),t])),{pathDelim:"\uFEFF",seqDelim:"\uFEFF"}).pipe(mK(()=>eC5)))))),ea=ea??Oa(),Z=k8(wZ()),Q=pS(e=>(G||(G=k5(dn(wQ(OC(es,ea),Z),e=>{Y.cachedRuntime=e}),{scope:Z,scheduler:e.currentScheduler})),pH(G.await))),B=Y=Object.assign(Object.create(eC2),{memoMap:ea,scope:Z,runtimeEffect:Q,cachedRuntime:void 0,runtime:()=>void 0===Y.cachedRuntime?k4(Y.runtimeEffect):Promise.resolve(Y.cachedRuntime),dispose:()=>k4(Y.disposeEffect),disposeEffect:dt(()=>{let e,t;return Y.runtimeEffect=pM("ManagedRuntime disposed"),Y.cachedRuntime=void 0,e=Y.scope,t=gA,e.close(t)}),runFork:(e,t)=>void 0===Y.cachedRuntime?k5(eC1(Y,e),t):kB(Y.cachedRuntime)(e,t),runSyncExit:e=>void 0===Y.cachedRuntime?k7(eC1(Y,e)):kQ(Y.cachedRuntime)(e),runSync:e=>void 0===Y.cachedRuntime?k8(eC1(Y,e)):kJ(Y.cachedRuntime)(e),runPromiseExit:(e,t)=>void 0===Y.cachedRuntime?k6(eC1(Y,e),t):kX(Y.cachedRuntime)(e,t),runCallback:(e,t)=>void 0===Y.cachedRuntime?kq(k3)(eC1(Y,e),t):kq(Y.cachedRuntime)(e,t),runPromise:(e,t)=>void 0===Y.cachedRuntime?k4(eC1(Y,e),t):kY(Y.cachedRuntime)(e,t)}),q=C_(()=>B.runtime().then(eyz)),{POST:J=async(...e)=>await q.pipe(CE(((...e)=>p2(C_(()=>{let e,t;return B.runPromise((e=em,t="nextjs-app",Cx(function*(){let r,n=yield*eC4,i=yield*wF(ir(r=e.router),e=>p2(n7(r[e].routerConfig),t=>({slug:e,config:t}))),s=e.config?.handleDaemonPromise?e.config.handleDaemonPromise:n?"void":"await";if(n&&"await"===s)return yield*new ia({code:"INVALID_SERVER_CONFIG",message:'handleDaemonPromise: "await" is forbidden in development.'});let a=Cx(function*(){return yield*ebd(i)}),o=Cx(function*(){var r,n;let i,a,o,l,{"uploadthing-hook":u,"x-uploadthing-package":c,"x-uploadthing-version":h}=yield*JU(eyE,(i=edH(Ae({"uploadthing-hook":jx.pipe(M4),"x-uploadthing-package":MN.pipe(M6({default:()=>"unknown"})),"x-uploadthing-version":MN.pipe(M6({default:()=>eB}))}),n),e=>i(e.headers)));h!==eB&&(yield*Sn("Client version mismatch. Things may not work as expected, please sync your versions to ensure compatibility.").pipe(vX({clientVersion:h,serverVersion:eB})));let{slug:f,actionType:p}=yield*(a=edH(Ae({actionType:jS.pipe(M4),slug:MN}),r),JU(WB,e=>{let t=Pg(e,eyC),r=Pg(e,ev1);return a({...t,...r.params})})),d=e.router[f];if(!d){let e=`No file route found for slug ${f}`;return yield*Si(e),yield*new ia({code:"NOT_FOUND",message:e})}let{body:g,fiber:m}=yield*eSS(o={actionType:p,uploadthingHook:u},s2(o)).pipe(eSk({actionType:"upload",uploadthingHook:void 0},()=>eFp({uploadable:d,fePackage:c,beAdapter:t,slug:f})),eSk({actionType:void 0,uploadthingHook:"callback"},()=>eFf({uploadable:d,fePackage:c,beAdapter:t})),eSk({actionType:void 0,uploadthingHook:"error"},()=>eFh({uploadable:d})),(l=()=>de({body:null,fiber:null}),e=>{let t=eSw(e);return sX(t)?"Right"===t._tag?t.right:l(t.left):e=>{let r=t(e);return"Right"===r._tag?r.right:l(r.left)}}));return m&&(yield*St("Running fiber as daemon").pipe(vX("handleDaemon",s)),"void"===s||("await"===s?yield*m.await:"function"==typeof s&&s(k4(m.await)))),yield*St("Sending response").pipe(vX("body",g)),yield*ebd(g)}).pipe(v2({ParseError:t=>ebd(eC9(new ia({code:"BAD_REQUEST",message:"Invalid input",cause:t.message}),e.router),{status:400}),UploadThingError:t=>ebd(eC9(t,e.router),{status:is[t.code]})})),l=p2(ebf("x-uploadthing-version",eB));return ev7.pipe(eSl("*",a),eSu("*",o),eSg(l))}).pipe(Ss("createRequestHandler"))))}),Sl(eFc,eb(...e))))(...e)),CE(ey(...e)),Ss("requestHandler"),B.runPromise),GET:J});e.s(["GET",0,eFv,"POST",0,eFS],92713);var eFx=e.i(92713);let eF_=new ek.AppRouteRouteModule({definition:{kind:eO.RouteKind.APP_ROUTE,page:"/api/uploadthing/route",pathname:"/api/uploadthing",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/Pictures/APPLICATION DECRYPT FULL NO FXAP/TOOLS WEBSITE/app/api/uploadthing/route.ts",nextConfigOutput:"",userland:eFx}),{workAsyncStorage:eFw,workUnitAsyncStorage:eFk,serverHooks:eFO}=eF_;function eFE(){return(0,eE.patchFetch)({workAsyncStorage:eFw,workUnitAsyncStorage:eFk})}async function eFC(e,t,r){eF_.isDev&&(0,eC.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/uploadthing/route";n=n.replace(/\/index$/,"")||"/";let i=await eF_.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!i)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:s,params:a,nextConfig:o,parsedUrl:l,isDraftMode:u,prerenderManifest:c,routerServerContext:h,isOnDemandRevalidate:f,revalidateOnlyGenerated:p,resolvedPathname:d,clientReferenceManifest:g,serverActionsManifest:m}=i,b=(0,eR.normalizeAppPath)(n),y=!!(c.dynamicRoutes[b]||c.routes[d]),v=async()=>((null==h?void 0:h.render404)?await h.render404(e,t,l,!1):t.end("This page could not be found"),null);if(y&&!u){let e=!!c.routes[d],t=c.dynamicRoutes[b];if(t&&!1===t.fallback&&!e){if(o.experimental.adapterPath)return await v();throw new eL.NoFallbackError}}let S=null;!y||eF_.isDev||u||(S="/index"===(S=d)?"/":S);let x=!0===eF_.isDev||!y,_=y&&!x;m&&g&&(0,eI.setReferenceManifestsSingleton)({page:n,clientReferenceManifest:g,serverActionsManifest:m,serverModuleMap:(0,eT.createServerModuleMap)({serverActionsManifest:m})});let w=e.method||"GET",k=(0,eF.getTracer)(),O=k.getActiveScopeSpan(),E={params:a,prerenderManifest:c,renderOpts:{experimental:{authInterrupts:!!o.experimental.authInterrupts},cacheComponents:!!o.cacheComponents,supportsDynamicResponse:x,incrementalCache:(0,eC.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:o.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>eF_.onRequestError(e,t,n,h)},sharedContext:{buildId:s}},C=new eN.NodeNextRequest(e),F=new eN.NodeNextResponse(t),I=eM.NextRequestAdapter.fromNodeNextRequest(C,(0,eM.signalFromNodeResponse)(t));try{let i=async e=>eF_.handle(I,E).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=k.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==eA.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let i=r.get("next.route");if(i){let t=`${w} ${i}`;e.setAttributes({"next.route":i,"http.route":i,"next.span_name":t}),e.updateName(t)}else e.updateName(`${w} ${n}`)}),s=!!(0,eC.getRequestMeta)(e,"minimalMode"),a=async a=>{var l,d;let g=async({previousCacheEntry:o})=>{try{if(!s&&f&&p&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await i(a);e.fetchMetrics=E.renderOpts.fetchMetrics;let l=E.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let u=E.renderOpts.collectedTags;if(!y)return await (0,eD.sendResponse)(C,F,n,E.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,eP.toNodeOutgoingHttpHeaders)(n.headers);u&&(t[ez.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==E.renderOpts.collectedRevalidate&&!(E.renderOpts.collectedRevalidate>=ez.INFINITE_CACHE)&&E.renderOpts.collectedRevalidate,i=void 0===E.renderOpts.collectedExpire||E.renderOpts.collectedExpire>=ez.INFINITE_CACHE?void 0:E.renderOpts.collectedExpire;return{value:{kind:eU.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:i}}}}catch(t){throw(null==o?void 0:o.isStale)&&await eF_.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,ej.getRevalidateReason)({isStaticGeneration:_,isOnDemandRevalidate:f})},h),t}},m=await eF_.handleResponse({req:e,nextConfig:o,cacheKey:S,routeKind:eO.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:c,isRoutePPREnabled:!1,isOnDemandRevalidate:f,revalidateOnlyGenerated:p,responseGenerator:g,waitUntil:r.waitUntil,isMinimalMode:s});if(!y)return null;if((null==m||null==(l=m.value)?void 0:l.kind)!==eU.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==m||null==(d=m.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",f?"REVALIDATED":m.isMiss?"MISS":m.isStale?"STALE":"HIT"),u&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let b=(0,eP.fromNodeOutgoingHttpHeaders)(m.value.headers);return s&&y||b.delete(ez.NEXT_CACHE_TAGS_HEADER),!m.cacheControl||t.getHeader("Cache-Control")||b.get("Cache-Control")||b.set("Cache-Control",(0,e$.getCacheControlHeader)(m.cacheControl)),await (0,eD.sendResponse)(C,F,new Response(m.value.body,{headers:b,status:m.value.status||200})),null};O?await a(O):await k.withPropagatedContext(e.headers,()=>k.trace(eA.BaseServerSpan.handleRequest,{spanName:`${w} ${n}`,kind:eF.SpanKind.SERVER,attributes:{"http.method":w,"http.target":e.url}},a))}catch(t){if(t instanceof eL.NoFallbackError||await eF_.onRequestError(e,t,{routerKind:"App Router",routePath:b,routeType:"route",revalidateReason:(0,ej.getRevalidateReason)({isStaticGeneration:_,isOnDemandRevalidate:f})}),y)throw t;return await (0,eD.sendResponse)(C,F,new Response(null,{status:500})),null}}e.s(["handler",()=>eFC,"patchFetch",()=>eFE,"routeModule",()=>eF_,"serverHooks",()=>eFO,"workAsyncStorage",()=>eFw,"workUnitAsyncStorage",()=>eFk],66629)}];

//# sourceMappingURL=bb670_next_dist_esm_build_templates_app-route_4055bd29.js.map