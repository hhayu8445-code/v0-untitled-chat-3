module.exports=[44950,(a,b,c)=>{"use strict";var d=a.r(16482);d.useState,d.useEffect,d.useLayoutEffect,d.useDebugValue,c.useSyncExternalStore=void 0!==d.useSyncExternalStore?d.useSyncExternalStore:function(a,b){return b()}},85963,(a,b,c)=>{"use strict";b.exports=a.r(44950)},31252,a=>{"use strict";let b;var c=a.i(83865),d=a.i(16482),e=a.i(13065),f=a.i(25924),g=a.i(19731),h=a.i(49339),i=a.i(38626),j=a.i(50969),k=a.i(91690),l=a.i(60111),m=a.i(78345),n=a.i(45048),o=a.i(94678),p=a.i(32784),q=a.i(37754),r=a.i(4911),s=a.i(53915),t=a.i(55276),u=a.i(7374);let v=(0,u.default)("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var w=a.i(41596);let x=(0,u.default)("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),y=(0,u.default)("ImagePlus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);var z=a.i(79574),A=a.i(22528),B=a.i(85963);a.s(["ERROR_REVALIDATE_EVENT",()=>3,"FOCUS_EVENT",()=>0,"MUTATE_EVENT",()=>2,"RECONNECT_EVENT",()=>1],16692);var C=Object.prototype.hasOwnProperty;let D=new WeakMap,E=()=>{},F=E(),G=Object,H=a=>a===F,I=(a,b)=>({...a,...b}),J={},K={},L="undefined",M=typeof document!=L,N=!1,O=(a,b)=>{let c=D.get(a);return[()=>!H(b)&&a.get(b)||J,d=>{if(!H(b)){let e=a.get(b);b in K||(K[b]=e),c[5](b,I(e,d),e||J)}},c[6],()=>!H(b)&&b in K?K[b]:!H(b)&&a.get(b)||J]},P=!0,[Q,R]=[E,E],S={initFocus:a=>(M&&document.addEventListener("visibilitychange",a),Q("focus",a),()=>{M&&document.removeEventListener("visibilitychange",a),R("focus",a)}),initReconnect:a=>{let b=()=>{P=!0,a()},c=()=>{P=!1};return Q("online",b),Q("offline",c),()=>{R("online",b),R("offline",c)}}},T=!d.default.useId,U=!0,V=d.useEffect,W="undefined"!=typeof navigator&&navigator.connection;!U&&W&&(["slow-2g","2g"].includes(W.effectiveType)||W.saveData);let X=new WeakMap,Y=(a,b)=>a===`[object ${b}]`,Z=0,$=a=>{let b,c,d=typeof a,e=G.prototype.toString.call(a),f=Y(e,"Date"),g=Y(e,"RegExp"),h=Y(e,"Object");if(G(a)!==a||f||g)b=f?a.toJSON():"symbol"==d?a.toString():"string"==d?JSON.stringify(a):""+a;else{if(b=X.get(a))return b;if(b=++Z+"~",X.set(a,b),Array.isArray(a)){for(c=0,b="@";c<a.length;c++)b+=$(a[c])+",";X.set(a,b)}if(h){b="#";let d=G.keys(a).sort();for(;!H(c=d.pop());)H(a[c])||(b+=c+":"+$(a[c])+",");X.set(a,b)}}return b},_=a=>{if("function"==typeof a)try{a=a()}catch(b){a=""}let b=a;return[a="string"==typeof a?a:(Array.isArray(a)?a.length:a)?$(a):"",b]},aa=0,ab=()=>++aa;async function ac(...a){let[b,c,d,e]=a,f=I({populateCache:!0,throwOnError:!0},"boolean"==typeof e?{revalidate:e}:e||{}),g=f.populateCache,h=f.rollbackOnError,i=f.optimisticData,j=f.throwOnError;if("function"==typeof c){let a=[];for(let d of b.keys())!/^\$(inf|sub)\$/.test(d)&&c(b.get(d)._k)&&a.push(d);return Promise.all(a.map(k))}return k(c);async function k(c){let e,[k]=_(c);if(!k)return;let[l,m]=O(b,k),[n,o,p,q]=D.get(b),r=()=>{let a=n[k];return("function"==typeof f.revalidate?f.revalidate(l().data,c):!1!==f.revalidate)&&(delete p[k],delete q[k],a&&a[0])?a[0](2).then(()=>l().data):l().data};if(a.length<3)return r();let s=d,t=!1,u=ab();o[k]=[u,0];let v=!H(i),w=l(),x=w.data,y=w._c,z=H(y)?x:y;if(v&&m({data:i="function"==typeof i?i(z,x):i,_c:z}),"function"==typeof s)try{s=s(z)}catch(a){e=a,t=!0}if(s&&"function"==typeof s.then){let a;if(s=await s.catch(a=>{e=a,t=!0}),u!==o[k][0]){if(t)throw e;return s}t&&v&&(a=e,"function"==typeof h?h(a):!1!==h)&&(g=!0,m({data:z,_c:F}))}if(g&&!t&&("function"==typeof g?m({data:g(s,z),error:F,_c:F}):m({data:s,error:F,_c:F})),o[k][1]=ab(),Promise.resolve(r()).then(()=>{m({_c:F})}),t){if(j)throw e;return}return s}}let ad=(a,b)=>{if(!D.has(a)){I(S,b);let c=Object.create(null),d=ac.bind(F,a),e=Object.create(null),f=(a,b)=>{let c=e[a]||[];return e[a]=c,c.push(b),()=>c.splice(c.indexOf(b),1)},g=(b,c,d)=>{a.set(b,c);let f=e[b];if(f)for(let a of f)a(c,d)},h=()=>{D.has(a)||D.set(a,[c,Object.create(null),Object.create(null),Object.create(null),d,g,f])};return h(),[a,d,h,E]}return[a,D.get(a)[4]]},[ae,af]=ad(new Map),ag=I({onLoadingSlow:E,onSuccess:E,onError:E,onErrorRetry:(a,b,c,d,e)=>{let f=c.errorRetryCount,g=e.retryCount,h=~~((Math.random()+.5)*(1<<(g<8?g:8)))*c.errorRetryInterval;(H(f)||!(g>f))&&setTimeout(d,h,e)},onDiscarded:E,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:3e3,compare:function a(b,c){var d,e;if(b===c)return!0;if(b&&c&&(d=b.constructor)===c.constructor){if(d===Date)return b.getTime()===c.getTime();if(d===RegExp)return b.toString()===c.toString();if(d===Array){if((e=b.length)===c.length)for(;e--&&a(b[e],c[e]););return -1===e}if(!d||"object"==typeof b){for(d in e=0,b)if(C.call(b,d)&&++e&&!C.call(c,d)||!(d in c)||!a(b[d],c[d]))return!1;return Object.keys(c).length===e}}return b!=b&&c!=c},isPaused:()=>!1,cache:ae,mutate:af,fallback:{}},{isOnline:()=>P,isVisible:()=>{let a=M&&document.visibilityState;return H(a)||"hidden"!==a}}),ah=(a,b)=>{let c=I(a,b);if(b){let{use:d,fallback:e}=a,{use:f,fallback:g}=b;d&&f&&(c.use=d.concat(f)),e&&g&&(c.fallback=I(e,g))}return c},ai=(0,d.createContext)({});var aj=a.i(16692);let ak=!1,al=(ak?window.__SWR_DEVTOOLS_USE__:[]).concat(a=>(b,c,d)=>{let e=c&&((...a)=>{let[d]=_(b),[,,,e]=D.get(ae);if(d.startsWith("$inf$"))return c(...a);let f=e[d];return H(f)?c(...a):(delete e[d],f)});return a(b,e,d)});ak&&(window.__SWR_DEVTOOLS_REACT__=d.default);let am=()=>{},an=am(),ao=(new WeakMap,d.default.use||(a=>{switch(a.status){case"pending":throw a;case"fulfilled":return a.value;case"rejected":throw a.reason;default:throw a.status="pending",a.then(b=>{a.status="fulfilled",a.value=b},b=>{a.status="rejected",a.reason=b}),a}})),ap={dedupe:!0},aq=Promise.resolve(F);G.defineProperty(a=>{let{value:b}=a,c=(0,d.useContext)(ai),e="function"==typeof b,f=(0,d.useMemo)(()=>e?b(c):b,[e,c,b]),g=(0,d.useMemo)(()=>e?f:ah(c,f),[e,c,f]),h=f&&f.provider,i=(0,d.useRef)(F);h&&!i.current&&(i.current=ad(h(g.cache||ae),f));let j=i.current;return j&&(g.cache=j[0],g.mutate=j[1]),V(()=>{if(j)return j[2]&&j[2](),j[3]},[]),(0,d.createElement)(ai.Provider,I(a,{value:g}))},"defaultValue",{value:ag});let ar=(b=(a,b,c)=>{let{cache:e,compare:f,suspense:g,fallbackData:h,revalidateOnMount:i,revalidateIfStale:j,refreshInterval:k,refreshWhenHidden:l,refreshWhenOffline:m,keepPreviousData:n,strictServerPrefetchWarning:o}=c,[p,q,r,s]=D.get(e),[t,u]=_(a),v=(0,d.useRef)(!1),w=(0,d.useRef)(!1),x=(0,d.useRef)(t),y=(0,d.useRef)(b),z=(0,d.useRef)(c),A=()=>z.current.isVisible()&&z.current.isOnline(),[C,G,J,K]=O(e,t),L=(0,d.useRef)({}).current,M=H(h)?H(c.fallback)?F:c.fallback[t]:h,N=(a,b)=>{for(let c in L)if("data"===c){if(!f(a[c],b[c])&&(!H(a[c])||!f($,b[c])))return!1}else if(b[c]!==a[c])return!1;return!0},P=(0,d.useMemo)(()=>{let a=!!t&&!!b&&(H(i)?!z.current.isPaused()&&!g&&!1!==j:i),c=b=>{let c=I(b);return(delete c._k,a)?{isValidating:!0,isLoading:!0,...c}:c},d=C(),e=K(),f=c(d),h=d===e?f:c(e),k=f;return[()=>{let a=c(C());return N(a,k)?(k.data=a.data,k.isLoading=a.isLoading,k.isValidating=a.isValidating,k.error=a.error,k):(k=a,a)},()=>h]},[e,t]),Q=(0,B.useSyncExternalStore)((0,d.useCallback)(a=>J(t,(b,c)=>{N(c,b)||a()}),[e,t]),P[0],P[1]),R=!v.current,S=p[t]&&p[t].length>0,W=Q.data,X=H(W)?M&&"function"==typeof M.then?ao(M):M:W,Y=Q.error,Z=(0,d.useRef)(X),$=n?H(W)?H(Z.current)?X:Z.current:W:X,aa=t&&H(X),ad=!U&&(0,B.useSyncExternalStore)(()=>E,()=>!1,()=>!0);o&&ad&&!g&&aa&&console.warn(`Missing pre-initiated data for serialized key "${t}" during server-side rendering. Data fethcing should be initiated on the server and provided to SWR via fallback data. You can set "strictServerPrefetchWarning: false" to disable this warning.`);let ae=(!S||!!H(Y))&&(R&&!H(i)?i:!z.current.isPaused()&&(g?!H(X)&&j:H(X)||j)),af=!!(t&&b&&R&&ae),ag=H(Q.isValidating)?af:Q.isValidating,ah=H(Q.isLoading)?af:Q.isLoading,ai=(0,d.useCallback)(async a=>{let b,d,e=y.current;if(!t||!e||w.current||z.current.isPaused())return!1;let g=!0,h=a||{},i=!r[t]||!h.dedupe,j=()=>T?!w.current&&t===x.current&&v.current:t===x.current,k={isValidating:!1,isLoading:!1},l=()=>{G(k)},m=()=>{let a=r[t];a&&a[1]===d&&delete r[t]},n={isValidating:!0};H(C().data)&&(n.isLoading=!0);try{if(i&&(G(n),c.loadingTimeout&&H(C().data)&&setTimeout(()=>{g&&j()&&z.current.onLoadingSlow(t,c)},c.loadingTimeout),r[t]=[e(u),ab()]),[b,d]=r[t],b=await b,i&&setTimeout(m,c.dedupingInterval),!r[t]||r[t][1]!==d)return i&&j()&&z.current.onDiscarded(t),!1;k.error=F;let a=q[t];if(!H(a)&&(d<=a[0]||d<=a[1]||0===a[1]))return l(),i&&j()&&z.current.onDiscarded(t),!1;let h=C().data;k.data=f(h,b)?h:b,i&&j()&&z.current.onSuccess(b,t,c)}catch(c){m();let a=z.current,{shouldRetryOnError:b}=a;!a.isPaused()&&(k.error=c,i&&j())&&(a.onError(c,t,a),(!0===b||"function"==typeof b&&b(c))&&(!z.current.revalidateOnFocus||!z.current.revalidateOnReconnect||A())&&a.onErrorRetry(c,t,a,a=>{let b=p[t];b&&b[0]&&b[0](aj.ERROR_REVALIDATE_EVENT,a)},{retryCount:(h.retryCount||0)+1,dedupe:!0}))}return g=!1,l(),!0},[t,e]),ak=(0,d.useCallback)((...a)=>ac(e,x.current,...a),[]);if(V(()=>{y.current=b,z.current=c,H(W)||(Z.current=W)}),V(()=>{var a;let b;if(!t)return;let c=ai.bind(F,ap),d=0;z.current.revalidateOnFocus&&(d=Date.now()+z.current.focusThrottleInterval);let e=(a=(a,b={})=>{if(a==aj.FOCUS_EVENT){let a=Date.now();z.current.revalidateOnFocus&&a>d&&A()&&(d=a+z.current.focusThrottleInterval,c())}else if(a==aj.RECONNECT_EVENT)z.current.revalidateOnReconnect&&A()&&c();else if(a==aj.MUTATE_EVENT)return ai();else if(a==aj.ERROR_REVALIDATE_EVENT)return ai(b)},(b=p[t]||(p[t]=[])).push(a),()=>{let c=b.indexOf(a);c>=0&&(b[c]=b[b.length-1],b.pop())});if(w.current=!1,x.current=t,v.current=!0,G({_k:u}),ae&&!r[t])if(H(X)||U)c();else setTimeout(c,1);return()=>{w.current=!0,e()}},[t]),V(()=>{let a;function b(){let b="function"==typeof k?k(C().data):k;b&&-1!==a&&(a=setTimeout(c,b))}function c(){!C().error&&(l||z.current.isVisible())&&(m||z.current.isOnline())?ai(ap).then(b):b()}return b(),()=>{a&&(clearTimeout(a),a=-1)}},[k,l,m,t]),(0,d.useDebugValue)($),g){if(!T&&U&&aa)throw Error("Fallback data is required when using Suspense in SSR.");aa&&(y.current=b,z.current=c,w.current=!1);let a=s[t];if(ao(!H(a)&&aa?ak(a):aq),!H(Y)&&aa)throw Y;let d=aa?ai(ap):aq;!H($)&&aa&&(d.status="fulfilled",d.value=!0),ao(d)}return{mutate:ak,get data(){return L.data=!0,$},get error(){return L.error=!0,Y},get isValidating(){return L.isValidating=!0,ag},get isLoading(){return L.isLoading=!0,ah}}},function(...a){let c,e=(c=(0,d.useContext)(ai),(0,d.useMemo)(()=>I(ag,c),[c])),[f,g,h]="function"==typeof a[1]?[a[0],a[1],a[2]||{}]:[a[0],null,(null===a[1]?a[2]:a[1])||{}],i=ah(e,h),j=b,{use:k}=i,l=(k||[]).concat(al);for(let a=l.length;a--;)j=l[a](j);return j(f,g||i.fetcher||null,i)}),as=a=>fetch(a).then(a=>a.json());function at(){let{user:a,isLoading:b}=(0,j.useAuth)(),u=(0,e.useRouter)(),B=(0,e.useSearchParams)().get("to"),[C,D]=(0,d.useState)(null),[E,F]=(0,d.useState)(""),[G,H]=(0,d.useState)(!1),[I,J]=(0,d.useState)(""),[K,L]=(0,d.useState)(!0),[M,N]=(0,d.useState)(!1),[O,P]=(0,d.useState)(null),[Q,R]=(0,d.useState)(null),S=(0,d.useRef)(null),T=(0,d.useRef)(null),U=(0,d.useRef)(0),{data:V,mutate:W}=ar(a?"/api/messages/conversations":null,as,{refreshInterval:5e3}),X=V?.conversations||[],{data:Y,mutate:Z}=ar(C?`/api/messages?userId=${C.user.discordId}`:null,as,{refreshInterval:2e3}),$=Y?.messages||[];(0,d.useEffect)(()=>{b||a||u.push("/")},[a,b,u]),(0,d.useEffect)(()=>{S.current?.scrollIntoView({behavior:"smooth"})},[$]),(0,d.useEffect)(()=>{if($.length>U.current&&U.current>0){let b=$[$.length-1];if(b.senderId!==a?.id&&K){let a=new Audio("/notification.mp3");a.volume=.3,a.play().catch(()=>{}),"granted"===Notification.permission&&new Notification("New Message",{body:b.content.substring(0,50),icon:C?.user.avatar||"/placeholder.svg"})}}U.current=$.length},[$,a?.id,K,C]),(0,d.useEffect)(()=>{B&&a&&_(B)},[B,a]),(0,d.useEffect)(()=>{"default"===Notification.permission&&Notification.requestPermission()},[]);let _=async a=>{try{let b=await fetch(`/api/profile/${a}`);if(b.ok){let c=await b.json(),d={id:c.user.id,discordId:c.user.discordId||a,username:c.user.username,avatar:c.user.avatar,membership:c.user.membership};D({id:a,user:d,lastMessage:"",lastMessageAt:new Date().toISOString(),unreadCount:0})}}catch(a){console.error("Failed to start conversation:",a)}},aa=async a=>{let b=a.target.files?.[0];if(b){if(!b.type.startsWith("image/"))return void A.toast.error("Please select an image file");if(b.size>5242880)return void A.toast.error("Image must be less than 5MB");N(!0),P(URL.createObjectURL(b));try{let a=new FormData;a.append("file",b),a.append("folder","messages");let c=await fetch("/api/upload/blob",{method:"POST",body:a});if(!c.ok)throw Error("Upload failed");let d=await c.json();R(d.url),A.toast.success("Image ready to send!")}catch(a){A.toast.error("Failed to upload image"),P(null)}finally{N(!1)}}},ab=()=>{P(null),R(null),T.current&&(T.current.value="")},ac=async()=>{if((E.trim()||Q)&&C&&!G){H(!0);try{let a=Q?`${E.trim()}
[Image: ${Q}]`:E.trim(),b=await fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({receiverId:C.user.discordId,content:a})});if(b.ok)F(""),ab(),Z(),W();else{let a=await b.json();A.toast.error(a.error||"Failed to send message")}}catch(a){A.toast.error("Failed to send message")}finally{H(!1)}}},ad=a=>{let b=new Date(a),c=new Date().getTime()-b.getTime();return c<6e4?"Just now":c<36e5?`${Math.floor(c/6e4)}m ago`:c<864e5?b.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):b.toLocaleDateString()},ae=X.filter(a=>a.user.username.toLowerCase().includes(I.toLowerCase())),af=X.reduce((a,b)=>a+b.unreadCount,0);return b?(0,c.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,c.jsx)(p.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}):a?(0,c.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,c.jsx)(f.Sidebar,{}),(0,c.jsxs)("main",{className:"md:ml-72 transition-all duration-300",children:[(0,c.jsx)(g.Header,{}),(0,c.jsxs)("div",{className:"flex h-[calc(100vh-4rem)]",children:[(0,c.jsxs)("div",{className:"w-80 border-r border-border glass flex flex-col",children:[(0,c.jsxs)("div",{className:"p-4 border-b border-border/50",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Messages"}),af>0&&(0,c.jsx)("span",{className:"flex h-5 min-w-5 px-1 items-center justify-center rounded-full bg-primary text-[10px] font-bold text-primary-foreground",children:af})]}),(0,c.jsxs)("div",{className:"flex items-center gap-1",children:[(0,c.jsx)(h.Button,{size:"icon",variant:"ghost",className:"h-9 w-9 rounded-xl hover:bg-secondary",onClick:()=>L(!K),title:K?"Mute notifications":"Enable notifications",children:K?(0,c.jsx)(w.Bell,{className:"h-4 w-4 text-primary"}):(0,c.jsx)(x,{className:"h-4 w-4 text-muted-foreground"})}),(0,c.jsx)(h.Button,{size:"icon",variant:"ghost",className:"h-9 w-9 rounded-xl hover:bg-secondary",children:(0,c.jsx)(k.Plus,{className:"h-5 w-5"})})]})]}),(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)(l.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,c.jsx)(i.Input,{placeholder:"Search conversations...",value:I,onChange:a=>J(a.target.value),className:"pl-10 h-10 bg-secondary/50 border-border/50 rounded-xl"})]})]}),(0,c.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-thin",children:V?0===ae.length?(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 px-4",children:[(0,c.jsx)(q.MessageSquare,{className:"h-12 w-12 text-muted-foreground/50 mb-3"}),(0,c.jsx)("p",{className:"text-muted-foreground text-center",children:"No conversations yet"}),(0,c.jsx)("p",{className:"text-xs text-muted-foreground text-center mt-1",children:"Start a conversation from a user profile"})]}):ae.map(a=>(0,c.jsxs)("button",{onClick:()=>{D(a),U.current=0,fetch("/api/messages/read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otherUserId:a.user.discordId})}).then(()=>W())},className:`w-full flex items-center gap-3 p-4 transition-colors border-l-2 ${C?.id===a.id?"bg-primary/10 border-l-primary":"border-l-transparent hover:bg-secondary/30"}`,children:[(0,c.jsxs)("div",{className:"relative shrink-0",children:[(0,c.jsx)("img",{src:a.user.avatar||"/placeholder.svg?height=48&width=48&query=user",alt:a.user.username,className:"h-12 w-12 rounded-xl object-cover"}),"vip"===a.user.membership&&(0,c.jsx)(r.Crown,{className:"absolute -bottom-1 -right-1 h-4 w-4 text-primary bg-background rounded-full p-0.5"}),"admin"===a.user.membership&&(0,c.jsx)(s.Shield,{className:"absolute -bottom-1 -right-1 h-4 w-4 text-destructive bg-background rounded-full p-0.5"})]}),(0,c.jsxs)("div",{className:"flex-1 min-w-0 text-left",children:[(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsx)("span",{className:"font-medium text-foreground",children:a.user.username}),(0,c.jsx)("span",{className:"text-[10px] text-muted-foreground",children:ad(a.lastMessageAt)})]}),(0,c.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:a.lastMessage.includes("[Image:")?"Sent an image":a.lastMessage})]}),a.unreadCount>0&&(0,c.jsx)("span",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[10px] font-bold text-primary-foreground shrink-0 animate-pulse",children:a.unreadCount})]},a.id)):(0,c.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,c.jsx)(p.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})})})]}),(0,c.jsx)("div",{className:"flex-1 flex flex-col",children:C?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-border/50 glass",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[(0,c.jsx)("div",{className:"relative",children:(0,c.jsx)("img",{src:C.user.avatar||"/placeholder.svg?height=44&width=44&query=user",alt:C.user.username,className:"h-11 w-11 rounded-xl object-cover"})}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("h3",{className:"font-semibold text-foreground flex items-center gap-2",children:[C.user.username,"vip"===C.user.membership&&(0,c.jsx)(r.Crown,{className:"h-4 w-4 text-primary"}),"admin"===C.user.membership&&(0,c.jsx)(s.Shield,{className:"h-4 w-4 text-destructive"})]}),(0,c.jsxs)("p",{className:"text-xs text-muted-foreground capitalize",children:[C.user.membership," Member"]})]})]}),(0,c.jsx)(h.Button,{variant:"ghost",size:"icon",className:"h-9 w-9 rounded-xl text-muted-foreground hover:text-foreground",children:(0,c.jsx)(n.MoreVertical,{className:"h-5 w-5"})})]}),(0,c.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-4 scrollbar-thin",children:[0===$.length?(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,c.jsx)(q.MessageSquare,{className:"h-12 w-12 text-muted-foreground/50 mb-3"}),(0,c.jsx)("p",{className:"text-muted-foreground",children:"No messages yet"}),(0,c.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Send a message to start the conversation"})]}):$.map(b=>{let d=b.senderId===a.id;return(0,c.jsxs)("div",{className:`flex gap-3 ${d?"justify-end":""}`,children:[!d&&(0,c.jsx)("img",{src:C.user.avatar||"/placeholder.svg?height=32&width=32&query=user",alt:"",className:"h-8 w-8 rounded-lg shrink-0 mt-1"}),(0,c.jsxs)("div",{className:`max-w-md ${d?"order-1":""}`,children:[(0,c.jsx)("div",{className:`rounded-2xl px-4 py-3 ${d?"bg-primary text-primary-foreground rounded-br-md":"glass rounded-bl-md"}`,children:(0,c.jsx)("div",{className:d?"text-primary-foreground":"text-foreground",children:(a=>{let b=a.match(/\[Image: (https?:\/\/[^\]]+)\]/);if(b){let d=a.replace(/\[Image: https?:\/\/[^\]]+\]/,"").trim();return(0,c.jsxs)(c.Fragment,{children:[d&&(0,c.jsx)("p",{className:"mb-2",children:d}),(0,c.jsx)("img",{src:b[1]||"/placeholder.svg",alt:"Shared image",className:"max-w-xs rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(b[1],"_blank")})]})}return(0,c.jsx)("p",{children:a})})(b.content)})}),(0,c.jsxs)("div",{className:`flex items-center gap-1 mt-1 ${d?"justify-end":""}`,children:[(0,c.jsx)("span",{className:"text-[10px] text-muted-foreground",children:ad(b.createdAt)}),d&&(b.read?(0,c.jsx)(v,{className:"h-3 w-3 text-primary"}):(0,c.jsx)(t.Check,{className:"h-3 w-3 text-muted-foreground"}))]})]})]},b.id)}),(0,c.jsx)("div",{ref:S})]}),O&&(0,c.jsx)("div",{className:"px-4 py-2 border-t border-border/50",children:(0,c.jsxs)("div",{className:"relative inline-block",children:[(0,c.jsx)("img",{src:O||"/placeholder.svg",alt:"Preview",className:"h-20 w-20 object-cover rounded-lg"}),M&&(0,c.jsx)("div",{className:"absolute inset-0 bg-background/80 rounded-lg flex items-center justify-center",children:(0,c.jsx)(p.Loader2,{className:"h-5 w-5 animate-spin text-primary"})}),(0,c.jsx)("button",{onClick:ab,className:"absolute -top-2 -right-2 p-1 bg-destructive rounded-full",children:(0,c.jsx)(z.X,{className:"h-3 w-3 text-white"})})]})}),(0,c.jsx)("div",{className:"p-4 border-t border-border/50 glass",children:(0,c.jsxs)("div",{className:"flex items-center gap-3",children:[(0,c.jsx)("input",{ref:T,type:"file",accept:"image/*",onChange:aa,className:"hidden"}),(0,c.jsx)(h.Button,{variant:"ghost",size:"icon",className:"h-9 w-9 rounded-xl text-muted-foreground hover:text-foreground shrink-0",onClick:()=>T.current?.click(),disabled:M,children:(0,c.jsx)(y,{className:"h-5 w-5"})}),(0,c.jsx)(i.Input,{placeholder:"Type a message...",value:E,onChange:a=>F(a.target.value),onKeyDown:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),ac())},className:"flex-1 h-11 bg-secondary/50 border-border/50 rounded-xl"}),(0,c.jsx)(h.Button,{variant:"ghost",size:"icon",className:"h-9 w-9 rounded-xl text-muted-foreground hover:text-foreground shrink-0",children:(0,c.jsx)(o.Smile,{className:"h-5 w-5"})}),(0,c.jsx)(h.Button,{size:"icon",className:"h-10 w-10 rounded-xl bg-primary hover:bg-primary/90 glow-sm shrink-0",onClick:ac,disabled:!E.trim()&&!Q||G||M,children:G?(0,c.jsx)(p.Loader2,{className:"h-5 w-5 animate-spin"}):(0,c.jsx)(m.Send,{className:"h-5 w-5"})})]})})]}):(0,c.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center",children:[(0,c.jsx)(q.MessageSquare,{className:"h-16 w-16 text-muted-foreground/50 mb-4"}),(0,c.jsx)("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Your Messages"}),(0,c.jsx)("p",{className:"text-muted-foreground text-center max-w-sm",children:"Select a conversation to view messages or start a new chat from a user profile"})]})})]})]})]}):null}a.s(["default",()=>at],31252)}];

//# sourceMappingURL=Pictures_APPLICATION%20DECRYPT%20FULL%20NO%20FXAP_TOOLS%20WEBSITE_70773300._.js.map